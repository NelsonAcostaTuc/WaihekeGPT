/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["src_components_layouts_MainLayout_MainLayout_tsx"],{

/***/ "./node_modules/darkreader/darkreader.js":
/*!***********************************************!*\
  !*** ./node_modules/darkreader/darkreader.js ***!
  \***********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval(__webpack_require__.ts("/**\r\n * Dark Reader v4.9.75\r\n * https://darkreader.org/\r\n */\r\n\r\n(function (global, factory) {\r\n     true\r\n        ? factory(exports)\r\n        : 0;\r\n})(this, function (exports) {\r\n    \"use strict\";\r\n\r\n    /******************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\n    var __assign = function () {\r\n        __assign =\r\n            Object.assign ||\r\n            function __assign(t) {\r\n                for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                    s = arguments[i];\r\n                    for (var p in s)\r\n                        if (Object.prototype.hasOwnProperty.call(s, p))\r\n                            t[p] = s[p];\r\n                }\r\n                return t;\r\n            };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        function adopt(value) {\r\n            return value instanceof P\r\n                ? value\r\n                : new P(function (resolve) {\r\n                      resolve(value);\r\n                  });\r\n        }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) {\r\n                try {\r\n                    step(generator.next(value));\r\n                } catch (e) {\r\n                    reject(e);\r\n                }\r\n            }\r\n            function rejected(value) {\r\n                try {\r\n                    step(generator[\"throw\"](value));\r\n                } catch (e) {\r\n                    reject(e);\r\n                }\r\n            }\r\n            function step(result) {\r\n                result.done\r\n                    ? resolve(result.value)\r\n                    : adopt(result.value).then(fulfilled, rejected);\r\n            }\r\n            step(\r\n                (generator = generator.apply(thisArg, _arguments || [])).next()\r\n            );\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = {\r\n                label: 0,\r\n                sent: function () {\r\n                    if (t[0] & 1) throw t[1];\r\n                    return t[1];\r\n                },\r\n                trys: [],\r\n                ops: []\r\n            },\r\n            f,\r\n            y,\r\n            t,\r\n            g;\r\n        return (\r\n            (g = {next: verb(0), throw: verb(1), return: verb(2)}),\r\n            typeof Symbol === \"function\" &&\r\n                (g[Symbol.iterator] = function () {\r\n                    return this;\r\n                }),\r\n            g\r\n        );\r\n        function verb(n) {\r\n            return function (v) {\r\n                return step([n, v]);\r\n            };\r\n        }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while ((g && ((g = 0), op[0] && (_ = 0)), _))\r\n                try {\r\n                    if (\r\n                        ((f = 1),\r\n                        y &&\r\n                            (t =\r\n                                op[0] & 2\r\n                                    ? y[\"return\"]\r\n                                    : op[0]\r\n                                      ? y[\"throw\"] ||\r\n                                        ((t = y[\"return\"]) && t.call(y), 0)\r\n                                      : y.next) &&\r\n                            !(t = t.call(y, op[1])).done)\r\n                    )\r\n                        return t;\r\n                    if (((y = 0), t)) op = [op[0] & 2, t.value];\r\n                    switch (op[0]) {\r\n                        case 0:\r\n                        case 1:\r\n                            t = op;\r\n                            break;\r\n                        case 4:\r\n                            _.label++;\r\n                            return {value: op[1], done: false};\r\n                        case 5:\r\n                            _.label++;\r\n                            y = op[1];\r\n                            op = [0];\r\n                            continue;\r\n                        case 7:\r\n                            op = _.ops.pop();\r\n                            _.trys.pop();\r\n                            continue;\r\n                        default:\r\n                            if (\r\n                                !((t = _.trys),\r\n                                (t = t.length > 0 && t[t.length - 1])) &&\r\n                                (op[0] === 6 || op[0] === 2)\r\n                            ) {\r\n                                _ = 0;\r\n                                continue;\r\n                            }\r\n                            if (\r\n                                op[0] === 3 &&\r\n                                (!t || (op[1] > t[0] && op[1] < t[3]))\r\n                            ) {\r\n                                _.label = op[1];\r\n                                break;\r\n                            }\r\n                            if (op[0] === 6 && _.label < t[1]) {\r\n                                _.label = t[1];\r\n                                t = op;\r\n                                break;\r\n                            }\r\n                            if (t && _.label < t[2]) {\r\n                                _.label = t[2];\r\n                                _.ops.push(op);\r\n                                break;\r\n                            }\r\n                            if (t[2]) _.ops.pop();\r\n                            _.trys.pop();\r\n                            continue;\r\n                    }\r\n                    op = body.call(thisArg, _);\r\n                } catch (e) {\r\n                    op = [6, e];\r\n                    y = 0;\r\n                } finally {\r\n                    f = t = 0;\r\n                }\r\n            if (op[0] & 5) throw op[1];\r\n            return {value: op[0] ? op[1] : void 0, done: true};\r\n        }\r\n    }\r\n\r\n    function __values(o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator,\r\n            m = s && o[s],\r\n            i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\")\r\n            return {\r\n                next: function () {\r\n                    if (o && i >= o.length) o = void 0;\r\n                    return {value: o && o[i++], done: !o};\r\n                }\r\n            };\r\n        throw new TypeError(\r\n            s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\"\r\n        );\r\n    }\r\n\r\n    function __read(o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o),\r\n            r,\r\n            ar = [],\r\n            e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)\r\n                ar.push(r.value);\r\n        } catch (error) {\r\n            e = {error: error};\r\n        } finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            } finally {\r\n                if (e) throw e.error;\r\n            }\r\n        }\r\n        return ar;\r\n    }\r\n\r\n    function __spreadArray(to, from, pack) {\r\n        if (pack || arguments.length === 2)\r\n            for (var i = 0, l = from.length, ar; i < l; i++) {\r\n                if (ar || !(i in from)) {\r\n                    if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n                    ar[i] = from[i];\r\n                }\r\n            }\r\n        return to.concat(ar || Array.prototype.slice.call(from));\r\n    }\r\n\r\n    typeof SuppressedError === \"function\"\r\n        ? SuppressedError\r\n        : function (error, suppressed, message) {\r\n              var e = new Error(message);\r\n              return (\r\n                  (e.name = \"SuppressedError\"),\r\n                  (e.error = error),\r\n                  (e.suppressed = suppressed),\r\n                  e\r\n              );\r\n          };\r\n\r\n    var MessageTypeUItoBG;\r\n    (function (MessageTypeUItoBG) {\r\n        MessageTypeUItoBG[\"GET_DATA\"] = \"ui-bg-get-data\";\r\n        MessageTypeUItoBG[\"GET_DEVTOOLS_DATA\"] = \"ui-bg-get-devtools-data\";\r\n        MessageTypeUItoBG[\"SUBSCRIBE_TO_CHANGES\"] =\r\n            \"ui-bg-subscribe-to-changes\";\r\n        MessageTypeUItoBG[\"UNSUBSCRIBE_FROM_CHANGES\"] =\r\n            \"ui-bg-unsubscribe-from-changes\";\r\n        MessageTypeUItoBG[\"CHANGE_SETTINGS\"] = \"ui-bg-change-settings\";\r\n        MessageTypeUItoBG[\"SET_THEME\"] = \"ui-bg-set-theme\";\r\n        MessageTypeUItoBG[\"TOGGLE_ACTIVE_TAB\"] = \"ui-bg-toggle-active-tab\";\r\n        MessageTypeUItoBG[\"MARK_NEWS_AS_READ\"] = \"ui-bg-mark-news-as-read\";\r\n        MessageTypeUItoBG[\"MARK_NEWS_AS_DISPLAYED\"] =\r\n            \"ui-bg-mark-news-as-displayed\";\r\n        MessageTypeUItoBG[\"LOAD_CONFIG\"] = \"ui-bg-load-config\";\r\n        MessageTypeUItoBG[\"APPLY_DEV_DYNAMIC_THEME_FIXES\"] =\r\n            \"ui-bg-apply-dev-dynamic-theme-fixes\";\r\n        MessageTypeUItoBG[\"RESET_DEV_DYNAMIC_THEME_FIXES\"] =\r\n            \"ui-bg-reset-dev-dynamic-theme-fixes\";\r\n        MessageTypeUItoBG[\"APPLY_DEV_INVERSION_FIXES\"] =\r\n            \"ui-bg-apply-dev-inversion-fixes\";\r\n        MessageTypeUItoBG[\"RESET_DEV_INVERSION_FIXES\"] =\r\n            \"ui-bg-reset-dev-inversion-fixes\";\r\n        MessageTypeUItoBG[\"APPLY_DEV_STATIC_THEMES\"] =\r\n            \"ui-bg-apply-dev-static-themes\";\r\n        MessageTypeUItoBG[\"RESET_DEV_STATIC_THEMES\"] =\r\n            \"ui-bg-reset-dev-static-themes\";\r\n        MessageTypeUItoBG[\"COLOR_SCHEME_CHANGE\"] = \"ui-bg-color-scheme-change\";\r\n        MessageTypeUItoBG[\"HIDE_HIGHLIGHTS\"] = \"ui-bg-hide-highlights\";\r\n    })(MessageTypeUItoBG || (MessageTypeUItoBG = {}));\r\n    var MessageTypeBGtoUI;\r\n    (function (MessageTypeBGtoUI) {\r\n        MessageTypeBGtoUI[\"CHANGES\"] = \"bg-ui-changes\";\r\n    })(MessageTypeBGtoUI || (MessageTypeBGtoUI = {}));\r\n    var DebugMessageTypeBGtoUI;\r\n    (function (DebugMessageTypeBGtoUI) {\r\n        DebugMessageTypeBGtoUI[\"CSS_UPDATE\"] = \"debug-bg-ui-css-update\";\r\n        DebugMessageTypeBGtoUI[\"UPDATE\"] = \"debug-bg-ui-update\";\r\n    })(DebugMessageTypeBGtoUI || (DebugMessageTypeBGtoUI = {}));\r\n    var MessageTypeBGtoCS;\r\n    (function (MessageTypeBGtoCS) {\r\n        MessageTypeBGtoCS[\"ADD_CSS_FILTER\"] = \"bg-cs-add-css-filter\";\r\n        MessageTypeBGtoCS[\"ADD_DYNAMIC_THEME\"] = \"bg-cs-add-dynamic-theme\";\r\n        MessageTypeBGtoCS[\"ADD_STATIC_THEME\"] = \"bg-cs-add-static-theme\";\r\n        MessageTypeBGtoCS[\"ADD_SVG_FILTER\"] = \"bg-cs-add-svg-filter\";\r\n        MessageTypeBGtoCS[\"CLEAN_UP\"] = \"bg-cs-clean-up\";\r\n        MessageTypeBGtoCS[\"FETCH_RESPONSE\"] = \"bg-cs-fetch-response\";\r\n        MessageTypeBGtoCS[\"UNSUPPORTED_SENDER\"] = \"bg-cs-unsupported-sender\";\r\n    })(MessageTypeBGtoCS || (MessageTypeBGtoCS = {}));\r\n    var DebugMessageTypeBGtoCS;\r\n    (function (DebugMessageTypeBGtoCS) {\r\n        DebugMessageTypeBGtoCS[\"RELOAD\"] = \"debug-bg-cs-reload\";\r\n    })(DebugMessageTypeBGtoCS || (DebugMessageTypeBGtoCS = {}));\r\n    var MessageTypeCStoBG;\r\n    (function (MessageTypeCStoBG) {\r\n        MessageTypeCStoBG[\"COLOR_SCHEME_CHANGE\"] = \"cs-bg-color-scheme-change\";\r\n        MessageTypeCStoBG[\"DARK_THEME_DETECTED\"] = \"cs-bg-dark-theme-detected\";\r\n        MessageTypeCStoBG[\"DARK_THEME_NOT_DETECTED\"] =\r\n            \"cs-bg-dark-theme-not-detected\";\r\n        MessageTypeCStoBG[\"FETCH\"] = \"cs-bg-fetch\";\r\n        MessageTypeCStoBG[\"DOCUMENT_CONNECT\"] = \"cs-bg-document-connect\";\r\n        MessageTypeCStoBG[\"DOCUMENT_FORGET\"] = \"cs-bg-document-forget\";\r\n        MessageTypeCStoBG[\"DOCUMENT_FREEZE\"] = \"cs-bg-document-freeze\";\r\n        MessageTypeCStoBG[\"DOCUMENT_RESUME\"] = \"cs-bg-document-resume\";\r\n    })(MessageTypeCStoBG || (MessageTypeCStoBG = {}));\r\n    var DebugMessageTypeCStoBG;\r\n    (function (DebugMessageTypeCStoBG) {\r\n        DebugMessageTypeCStoBG[\"LOG\"] = \"debug-cs-bg-log\";\r\n    })(DebugMessageTypeCStoBG || (DebugMessageTypeCStoBG = {}));\r\n    var MessageTypeCStoUI;\r\n    (function (MessageTypeCStoUI) {\r\n        MessageTypeCStoUI[\"EXPORT_CSS_RESPONSE\"] = \"cs-ui-export-css-response\";\r\n    })(MessageTypeCStoUI || (MessageTypeCStoUI = {}));\r\n    var MessageTypeUItoCS;\r\n    (function (MessageTypeUItoCS) {\r\n        MessageTypeUItoCS[\"EXPORT_CSS\"] = \"ui-cs-export-css\";\r\n    })(MessageTypeUItoCS || (MessageTypeUItoCS = {}));\r\n\r\n    var isNavigatorDefined = typeof navigator !== \"undefined\";\r\n    var userAgent = isNavigatorDefined\r\n        ? navigator.userAgentData &&\r\n          Array.isArray(navigator.userAgentData.brands)\r\n            ? navigator.userAgentData.brands\r\n                  .map(function (brand) {\r\n                      return \"\"\r\n                          .concat(brand.brand.toLowerCase(), \" \")\r\n                          .concat(brand.version);\r\n                  })\r\n                  .join(\" \")\r\n            : navigator.userAgent.toLowerCase()\r\n        : \"some useragent\";\r\n    var platform = isNavigatorDefined\r\n        ? navigator.userAgentData &&\r\n          typeof navigator.userAgentData.platform === \"string\"\r\n            ? navigator.userAgentData.platform.toLowerCase()\r\n            : navigator.platform.toLowerCase()\r\n        : \"some platform\";\r\n    var isChromium =\r\n        userAgent.includes(\"chrome\") || userAgent.includes(\"chromium\");\r\n    var isFirefox =\r\n        userAgent.includes(\"firefox\") ||\r\n        userAgent.includes(\"thunderbird\") ||\r\n        userAgent.includes(\"librewolf\");\r\n    var isSafari = userAgent.includes(\"safari\") && !isChromium;\r\n    var isWindows = platform.startsWith(\"win\");\r\n    var isMacOS = platform.startsWith(\"mac\");\r\n    isNavigatorDefined && navigator.userAgentData\r\n        ? navigator.userAgentData.mobile\r\n        : userAgent.includes(\"mobile\");\r\n    var isShadowDomSupported = typeof ShadowRoot === \"function\";\r\n    var isMatchMediaChangeEventListenerSupported =\r\n        typeof MediaQueryList === \"function\" &&\r\n        typeof MediaQueryList.prototype.addEventListener === \"function\";\r\n    (function () {\r\n        var m = userAgent.match(/chrom(?:e|ium)(?:\\/| )([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return \"\";\r\n    })();\r\n    (function () {\r\n        var m = userAgent.match(/(?:firefox|librewolf)(?:\\/| )([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return \"\";\r\n    })();\r\n    var isDefinedSelectorSupported = (function () {\r\n        try {\r\n            document.querySelector(\":defined\");\r\n            return true;\r\n        } catch (err) {\r\n            return false;\r\n        }\r\n    })();\r\n    var isCSSColorSchemePropSupported = (function () {\r\n        try {\r\n            if (typeof document === \"undefined\") {\r\n                return false;\r\n            }\r\n            var el = document.createElement(\"div\");\r\n            if (!el || typeof el.style !== \"object\") {\r\n                return false;\r\n            }\r\n            if (typeof el.style.colorScheme === \"string\") {\r\n                return true;\r\n            }\r\n            el.setAttribute(\"style\", \"color-scheme: dark\");\r\n            return el.style.colorScheme === \"dark\";\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    })();\r\n\r\n    function getOKResponse(url, mimeType, origin) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        return [\r\n                            4,\r\n                            fetch(url, {\r\n                                cache: \"force-cache\",\r\n                                credentials: \"omit\",\r\n                                referrer: origin\r\n                            })\r\n                        ];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        if (\r\n                            isFirefox &&\r\n                            mimeType === \"text/css\" &&\r\n                            url.startsWith(\"moz-extension://\") &&\r\n                            url.endsWith(\".css\")\r\n                        ) {\r\n                            return [2, response];\r\n                        }\r\n                        if (\r\n                            mimeType &&\r\n                            !response.headers\r\n                                .get(\"Content-Type\")\r\n                                .startsWith(mimeType)\r\n                        ) {\r\n                            throw new Error(\r\n                                \"Mime type mismatch when loading \".concat(url)\r\n                            );\r\n                        }\r\n                        if (!response.ok) {\r\n                            throw new Error(\r\n                                \"Unable to load \"\r\n                                    .concat(url, \" \")\r\n                                    .concat(response.status, \" \")\r\n                                    .concat(response.statusText)\r\n                            );\r\n                        }\r\n                        return [2, response];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function loadAsDataURL(url, mimeType) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        return [4, getOKResponse(url, mimeType)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [4, readResponseAsDataURL(response)];\r\n                    case 2:\r\n                        return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function loadAsBlob(url, mimeType) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        return [4, getOKResponse(url, mimeType)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [4, response.blob()];\r\n                    case 2:\r\n                        return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function readResponseAsDataURL(response) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var blob, dataURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        return [4, response.blob()];\r\n                    case 1:\r\n                        blob = _a.sent();\r\n                        return [\r\n                            4,\r\n                            new Promise(function (resolve) {\r\n                                var reader = new FileReader();\r\n                                reader.onloadend = function () {\r\n                                    return resolve(reader.result);\r\n                                };\r\n                                reader.readAsDataURL(blob);\r\n                            })\r\n                        ];\r\n                    case 2:\r\n                        dataURL = _a.sent();\r\n                        return [2, dataURL];\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    var throwCORSError = function (url) {\r\n        return __awaiter(void 0, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [\r\n                    2,\r\n                    Promise.reject(\r\n                        new Error(\r\n                            [\r\n                                \"Embedded Dark Reader cannot access a cross-origin resource\",\r\n                                url,\r\n                                \"Overview your URLs and CORS policies or use\",\r\n                                \"`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.\",\r\n                                \"See if using `DarkReader.setFetchMethod(window.fetch)`\",\r\n                                \"before `DarkReader.enable()` works.\"\r\n                            ].join(\" \")\r\n                        )\r\n                    )\r\n                ];\r\n            });\r\n        });\r\n    };\r\n    var fetcher = throwCORSError;\r\n    function setFetchMethod$1(fetch) {\r\n        if (fetch) {\r\n            fetcher = fetch;\r\n        } else {\r\n            fetcher = throwCORSError;\r\n        }\r\n    }\r\n    function callFetchMethod(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        return [4, fetcher(url)];\r\n                    case 1:\r\n                        return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!window.chrome) {\r\n        window.chrome = {};\r\n    }\r\n    if (!chrome.runtime) {\r\n        chrome.runtime = {};\r\n    }\r\n    var messageListeners = new Set();\r\n    function sendMessage() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var id_1, _a, url, responseType, response, text_1, error_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (\r\n                            !(\r\n                                args[0] &&\r\n                                args[0].type === MessageTypeCStoBG.FETCH\r\n                            )\r\n                        )\r\n                            return [3, 8];\r\n                        id_1 = args[0].id;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 7, , 8]);\r\n                        (_a = args[0].data),\r\n                            (url = _a.url),\r\n                            (responseType = _a.responseType);\r\n                        return [4, callFetchMethod(url)];\r\n                    case 2:\r\n                        response = _b.sent();\r\n                        if (!(responseType === \"data-url\")) return [3, 4];\r\n                        return [4, readResponseAsDataURL(response)];\r\n                    case 3:\r\n                        text_1 = _b.sent();\r\n                        return [3, 6];\r\n                    case 4:\r\n                        return [4, response.text()];\r\n                    case 5:\r\n                        text_1 = _b.sent();\r\n                        _b.label = 6;\r\n                    case 6:\r\n                        messageListeners.forEach(function (cb) {\r\n                            return cb({\r\n                                type: MessageTypeBGtoCS.FETCH_RESPONSE,\r\n                                data: text_1,\r\n                                error: null,\r\n                                id: id_1\r\n                            });\r\n                        });\r\n                        return [3, 8];\r\n                    case 7:\r\n                        error_1 = _b.sent();\r\n                        console.error(error_1);\r\n                        messageListeners.forEach(function (cb) {\r\n                            return cb({\r\n                                type: MessageTypeBGtoCS.FETCH_RESPONSE,\r\n                                data: null,\r\n                                error: error_1,\r\n                                id: id_1\r\n                            });\r\n                        });\r\n                        return [3, 8];\r\n                    case 8:\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function addMessageListener(callback) {\r\n        messageListeners.add(callback);\r\n    }\r\n    if (typeof chrome.runtime.sendMessage === \"function\") {\r\n        var nativeSendMessage_1 = chrome.runtime.sendMessage;\r\n        chrome.runtime.sendMessage = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            sendMessage.apply(void 0, __spreadArray([], __read(args), false));\r\n            nativeSendMessage_1.apply(chrome.runtime, args);\r\n        };\r\n    } else {\r\n        chrome.runtime.sendMessage = sendMessage;\r\n    }\r\n    if (!chrome.runtime.onMessage) {\r\n        chrome.runtime.onMessage = {};\r\n    }\r\n    if (typeof chrome.runtime.onMessage.addListener === \"function\") {\r\n        var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\r\n        chrome.runtime.onMessage.addListener = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            addMessageListener(args[0]);\r\n            nativeAddListener_1.apply(chrome.runtime.onMessage, args);\r\n        };\r\n    } else {\r\n        chrome.runtime.onMessage.addListener = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return addMessageListener(args[0]);\r\n        };\r\n    }\r\n\r\n    var ThemeEngine;\r\n    (function (ThemeEngine) {\r\n        ThemeEngine[\"cssFilter\"] = \"cssFilter\";\r\n        ThemeEngine[\"svgFilter\"] = \"svgFilter\";\r\n        ThemeEngine[\"staticTheme\"] = \"staticTheme\";\r\n        ThemeEngine[\"dynamicTheme\"] = \"dynamicTheme\";\r\n    })(ThemeEngine || (ThemeEngine = {}));\r\n\r\n    var AutomationMode;\r\n    (function (AutomationMode) {\r\n        AutomationMode[\"NONE\"] = \"\";\r\n        AutomationMode[\"TIME\"] = \"time\";\r\n        AutomationMode[\"SYSTEM\"] = \"system\";\r\n        AutomationMode[\"LOCATION\"] = \"location\";\r\n    })(AutomationMode || (AutomationMode = {}));\r\n\r\n    var DEFAULT_COLORS = {\r\n        darkScheme: {\r\n            background: \"#181a1b\",\r\n            text: \"#e8e6e3\"\r\n        },\r\n        lightScheme: {\r\n            background: \"#dcdad7\",\r\n            text: \"#181a1b\"\r\n        }\r\n    };\r\n    var DEFAULT_THEME = {\r\n        mode: 1,\r\n        brightness: 100,\r\n        contrast: 100,\r\n        grayscale: 0,\r\n        sepia: 0,\r\n        useFont: false,\r\n        fontFamily: isMacOS\r\n            ? \"Helvetica Neue\"\r\n            : isWindows\r\n              ? \"Segoe UI\"\r\n              : \"Open Sans\",\r\n        textStroke: 0,\r\n        engine: ThemeEngine.dynamicTheme,\r\n        stylesheet: \"\",\r\n        darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\r\n        darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\r\n        lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\r\n        lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\r\n        scrollbarColor: isMacOS ? \"\" : \"auto\",\r\n        selectionColor: \"auto\",\r\n        styleSystemControls: !isCSSColorSchemePropSupported,\r\n        lightColorScheme: \"Default\",\r\n        darkColorScheme: \"Default\",\r\n        immediateModify: false\r\n    };\r\n    ({\r\n        schemeVersion: 0,\r\n        enabled: true,\r\n        fetchNews: true,\r\n        theme: DEFAULT_THEME,\r\n        presets: [],\r\n        customThemes: [],\r\n        enabledByDefault: true,\r\n        enabledFor: [],\r\n        disabledFor: [],\r\n        changeBrowserTheme: false,\r\n        syncSettings: true,\r\n        syncSitesFixes: false,\r\n        automation: {\r\n            enabled: false,\r\n            mode: AutomationMode.NONE,\r\n            behavior: \"OnOff\"\r\n        },\r\n        time: {\r\n            activation: \"18:00\",\r\n            deactivation: \"9:00\"\r\n        },\r\n        location: {\r\n            latitude: null,\r\n            longitude: null\r\n        },\r\n        previewNewDesign: false,\r\n        enableForPDF: true,\r\n        enableForProtectedPages: false,\r\n        enableContextMenus: false,\r\n        detectDarkTheme: false\r\n    });\r\n\r\n    function isArrayLike(items) {\r\n        return items.length != null;\r\n    }\r\n    function forEach(items, iterator) {\r\n        var e_1, _a;\r\n        if (isArrayLike(items)) {\r\n            for (var i = 0, len = items.length; i < len; i++) {\r\n                iterator(items[i]);\r\n            }\r\n        } else {\r\n            try {\r\n                for (\r\n                    var items_1 = __values(items), items_1_1 = items_1.next();\r\n                    !items_1_1.done;\r\n                    items_1_1 = items_1.next()\r\n                ) {\r\n                    var item = items_1_1.value;\r\n                    iterator(item);\r\n                }\r\n            } catch (e_1_1) {\r\n                e_1 = {error: e_1_1};\r\n            } finally {\r\n                try {\r\n                    if (items_1_1 && !items_1_1.done && (_a = items_1.return))\r\n                        _a.call(items_1);\r\n                } finally {\r\n                    if (e_1) throw e_1.error;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function push(array, addition) {\r\n        forEach(addition, function (a) {\r\n            return array.push(a);\r\n        });\r\n    }\r\n    function toArray(items) {\r\n        var results = [];\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            results.push(items[i]);\r\n        }\r\n        return results;\r\n    }\r\n\r\n    function logInfo() {}\r\n    function logWarn() {}\r\n\r\n    function throttle(callback) {\r\n        var pending = false;\r\n        var frameId = null;\r\n        var lastArgs;\r\n        var throttled = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            lastArgs = args;\r\n            if (frameId) {\r\n                pending = true;\r\n            } else {\r\n                callback.apply(\r\n                    void 0,\r\n                    __spreadArray([], __read(lastArgs), false)\r\n                );\r\n                frameId = requestAnimationFrame(function () {\r\n                    frameId = null;\r\n                    if (pending) {\r\n                        callback.apply(\r\n                            void 0,\r\n                            __spreadArray([], __read(lastArgs), false)\r\n                        );\r\n                        pending = false;\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        var cancel = function () {\r\n            cancelAnimationFrame(frameId);\r\n            pending = false;\r\n            frameId = null;\r\n        };\r\n        return Object.assign(throttled, {cancel: cancel});\r\n    }\r\n    function createAsyncTasksQueue() {\r\n        var tasks = [];\r\n        var frameId = null;\r\n        function runTasks() {\r\n            var task;\r\n            while ((task = tasks.shift())) {\r\n                task();\r\n            }\r\n            frameId = null;\r\n        }\r\n        function add(task) {\r\n            tasks.push(task);\r\n            if (!frameId) {\r\n                frameId = requestAnimationFrame(runTasks);\r\n            }\r\n        }\r\n        function cancel() {\r\n            tasks.splice(0);\r\n            cancelAnimationFrame(frameId);\r\n            frameId = null;\r\n        }\r\n        return {add: add, cancel: cancel};\r\n    }\r\n    var delayTokens = new Set();\r\n    function requestAnimationFrameOnce(token, callback) {\r\n        if (delayTokens.has(token)) {\r\n            return;\r\n        }\r\n        delayTokens.add(token);\r\n        requestAnimationFrame(function () {\r\n            delayTokens.delete(token);\r\n            callback();\r\n        });\r\n    }\r\n\r\n    function getDuration(time) {\r\n        var duration = 0;\r\n        if (time.seconds) {\r\n            duration += time.seconds * 1000;\r\n        }\r\n        if (time.minutes) {\r\n            duration += time.minutes * 60 * 1000;\r\n        }\r\n        if (time.hours) {\r\n            duration += time.hours * 60 * 60 * 1000;\r\n        }\r\n        if (time.days) {\r\n            duration += time.days * 24 * 60 * 60 * 1000;\r\n        }\r\n        return duration;\r\n    }\r\n\r\n    function removeNode(node) {\r\n        node && node.parentNode && node.parentNode.removeChild(node);\r\n    }\r\n    function watchForNodePosition(node, mode, onRestore) {\r\n        if (onRestore === void 0) {\r\n            onRestore = Function.prototype;\r\n        }\r\n        var MAX_ATTEMPTS_COUNT = 10;\r\n        var RETRY_TIMEOUT = getDuration({seconds: 2});\r\n        var ATTEMPTS_INTERVAL = getDuration({seconds: 10});\r\n        var prevSibling = node.previousSibling;\r\n        var parent = node.parentNode;\r\n        if (!parent) {\r\n            throw new Error(\r\n                \"Unable to watch for node position: parent element not found\"\r\n            );\r\n        }\r\n        if (mode === \"prev-sibling\" && !prevSibling) {\r\n            throw new Error(\r\n                \"Unable to watch for node position: there is no previous sibling\"\r\n            );\r\n        }\r\n        var attempts = 0;\r\n        var start = null;\r\n        var timeoutId = null;\r\n        var restore = throttle(function () {\r\n            if (timeoutId) {\r\n                return;\r\n            }\r\n            attempts++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            } else if (attempts >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attempts = 0;\r\n                        timeoutId = null;\r\n                        restore();\r\n                    }, RETRY_TIMEOUT);\r\n                    return;\r\n                }\r\n                start = now;\r\n                attempts = 1;\r\n            }\r\n            if (mode === \"head\") {\r\n                if (prevSibling && prevSibling.parentNode !== parent) {\r\n                    stop();\r\n                    return;\r\n                }\r\n            }\r\n            if (mode === \"prev-sibling\") {\r\n                if (prevSibling.parentNode == null) {\r\n                    stop();\r\n                    return;\r\n                }\r\n                if (prevSibling.parentNode !== parent) {\r\n                    updateParent(prevSibling.parentNode);\r\n                }\r\n            }\r\n            if (mode === \"head\" && !parent.isConnected) {\r\n                parent = document.head;\r\n            }\r\n            parent.insertBefore(\r\n                node,\r\n                prevSibling && prevSibling.isConnected\r\n                    ? prevSibling.nextSibling\r\n                    : parent.firstChild\r\n            );\r\n            observer.takeRecords();\r\n            onRestore && onRestore();\r\n        });\r\n        var observer = new MutationObserver(function () {\r\n            if (\r\n                (mode === \"head\" &&\r\n                    (node.parentNode !== parent ||\r\n                        !node.parentNode.isConnected)) ||\r\n                (mode === \"prev-sibling\" &&\r\n                    node.previousSibling !== prevSibling)\r\n            ) {\r\n                restore();\r\n            }\r\n        });\r\n        var run = function () {\r\n            observer.observe(parent, {childList: true});\r\n        };\r\n        var stop = function () {\r\n            clearTimeout(timeoutId);\r\n            observer.disconnect();\r\n            restore.cancel();\r\n        };\r\n        var skip = function () {\r\n            observer.takeRecords();\r\n        };\r\n        var updateParent = function (parentNode) {\r\n            parent = parentNode;\r\n            stop();\r\n            run();\r\n        };\r\n        run();\r\n        return {run: run, stop: stop, skip: skip};\r\n    }\r\n    function iterateShadowHosts(root, iterator) {\r\n        if (root == null) {\r\n            return;\r\n        }\r\n        var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\r\n            acceptNode: function (node) {\r\n                return node.shadowRoot == null\r\n                    ? NodeFilter.FILTER_SKIP\r\n                    : NodeFilter.FILTER_ACCEPT;\r\n            }\r\n        });\r\n        for (\r\n            var node = root.shadowRoot ? walker.currentNode : walker.nextNode();\r\n            node != null;\r\n            node = walker.nextNode()\r\n        ) {\r\n            if (node.classList.contains(\"surfingkeys_hints_host\")) {\r\n                continue;\r\n            }\r\n            iterator(node);\r\n            iterateShadowHosts(node.shadowRoot, iterator);\r\n        }\r\n    }\r\n    var isDOMReady = function () {\r\n        return (\r\n            document.readyState === \"complete\" ||\r\n            document.readyState === \"interactive\"\r\n        );\r\n    };\r\n    function setIsDOMReady(newFunc) {\r\n        isDOMReady = newFunc;\r\n    }\r\n    var readyStateListeners = new Set();\r\n    function addDOMReadyListener(listener) {\r\n        isDOMReady() ? listener() : readyStateListeners.add(listener);\r\n    }\r\n    function removeDOMReadyListener(listener) {\r\n        readyStateListeners.delete(listener);\r\n    }\r\n    function isReadyStateComplete() {\r\n        return document.readyState === \"complete\";\r\n    }\r\n    var readyStateCompleteListeners = new Set();\r\n    function addReadyStateCompleteListener(listener) {\r\n        isReadyStateComplete()\r\n            ? listener()\r\n            : readyStateCompleteListeners.add(listener);\r\n    }\r\n    function cleanReadyStateCompleteListeners() {\r\n        readyStateCompleteListeners.clear();\r\n    }\r\n    if (!isDOMReady()) {\r\n        var onReadyStateChange_1 = function () {\r\n            if (isDOMReady()) {\r\n                readyStateListeners.forEach(function (listener) {\r\n                    return listener();\r\n                });\r\n                readyStateListeners.clear();\r\n                if (isReadyStateComplete()) {\r\n                    document.removeEventListener(\r\n                        \"readystatechange\",\r\n                        onReadyStateChange_1\r\n                    );\r\n                    readyStateCompleteListeners.forEach(function (listener) {\r\n                        return listener();\r\n                    });\r\n                    readyStateCompleteListeners.clear();\r\n                }\r\n            }\r\n        };\r\n        document.addEventListener(\"readystatechange\", onReadyStateChange_1);\r\n    }\r\n    var HUGE_MUTATIONS_COUNT = 1000;\r\n    function isHugeMutation(mutations) {\r\n        if (mutations.length > HUGE_MUTATIONS_COUNT) {\r\n            return true;\r\n        }\r\n        var addedNodesCount = 0;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            addedNodesCount += mutations[i].addedNodes.length;\r\n            if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function getElementsTreeOperations(mutations) {\r\n        var additions = new Set();\r\n        var deletions = new Set();\r\n        var moves = new Set();\r\n        mutations.forEach(function (m) {\r\n            forEach(m.addedNodes, function (n) {\r\n                if (n instanceof Element && n.isConnected) {\r\n                    additions.add(n);\r\n                }\r\n            });\r\n            forEach(m.removedNodes, function (n) {\r\n                if (n instanceof Element) {\r\n                    if (n.isConnected) {\r\n                        moves.add(n);\r\n                        additions.delete(n);\r\n                    } else {\r\n                        deletions.add(n);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        var duplicateAdditions = [];\r\n        var duplicateDeletions = [];\r\n        additions.forEach(function (node) {\r\n            if (additions.has(node.parentElement)) {\r\n                duplicateAdditions.push(node);\r\n            }\r\n        });\r\n        deletions.forEach(function (node) {\r\n            if (deletions.has(node.parentElement)) {\r\n                duplicateDeletions.push(node);\r\n            }\r\n        });\r\n        duplicateAdditions.forEach(function (node) {\r\n            return additions.delete(node);\r\n        });\r\n        duplicateDeletions.forEach(function (node) {\r\n            return deletions.delete(node);\r\n        });\r\n        return {additions: additions, moves: moves, deletions: deletions};\r\n    }\r\n    var optimizedTreeObservers = new Map();\r\n    var optimizedTreeCallbacks = new WeakMap();\r\n    function createOptimizedTreeObserver(root, callbacks) {\r\n        var observer;\r\n        var observerCallbacks;\r\n        var domReadyListener;\r\n        if (optimizedTreeObservers.has(root)) {\r\n            observer = optimizedTreeObservers.get(root);\r\n            observerCallbacks = optimizedTreeCallbacks.get(observer);\r\n        } else {\r\n            var hadHugeMutationsBefore_1 = false;\r\n            var subscribedForReadyState_1 = false;\r\n            observer = new MutationObserver(function (mutations) {\r\n                if (isHugeMutation(mutations)) {\r\n                    if (!hadHugeMutationsBefore_1 || isDOMReady()) {\r\n                        observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        });\r\n                    } else if (!subscribedForReadyState_1) {\r\n                        domReadyListener = function () {\r\n                            return observerCallbacks.forEach(function (_a) {\r\n                                var onHugeMutations = _a.onHugeMutations;\r\n                                return onHugeMutations(root);\r\n                            });\r\n                        };\r\n                        addDOMReadyListener(domReadyListener);\r\n                        subscribedForReadyState_1 = true;\r\n                    }\r\n                    hadHugeMutationsBefore_1 = true;\r\n                } else {\r\n                    var elementsOperations_1 =\r\n                        getElementsTreeOperations(mutations);\r\n                    observerCallbacks.forEach(function (_a) {\r\n                        var onMinorMutations = _a.onMinorMutations;\r\n                        return onMinorMutations(elementsOperations_1);\r\n                    });\r\n                }\r\n            });\r\n            observer.observe(root, {childList: true, subtree: true});\r\n            optimizedTreeObservers.set(root, observer);\r\n            observerCallbacks = new Set();\r\n            optimizedTreeCallbacks.set(observer, observerCallbacks);\r\n        }\r\n        observerCallbacks.add(callbacks);\r\n        return {\r\n            disconnect: function () {\r\n                observerCallbacks.delete(callbacks);\r\n                if (domReadyListener) {\r\n                    removeDOMReadyListener(domReadyListener);\r\n                }\r\n                if (observerCallbacks.size === 0) {\r\n                    observer.disconnect();\r\n                    optimizedTreeCallbacks.delete(observer);\r\n                    optimizedTreeObservers.delete(root);\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    var anchor;\r\n    var parsedURLCache = new Map();\r\n    function fixBaseURL($url) {\r\n        if (!anchor) {\r\n            anchor = document.createElement(\"a\");\r\n        }\r\n        anchor.href = $url;\r\n        return anchor.href;\r\n    }\r\n    function parseURL($url, $base) {\r\n        if ($base === void 0) {\r\n            $base = null;\r\n        }\r\n        var key = \"\".concat($url).concat($base ? \";\".concat($base) : \"\");\r\n        if (parsedURLCache.has(key)) {\r\n            return parsedURLCache.get(key);\r\n        }\r\n        if ($base) {\r\n            var parsedURL_1 = new URL($url, fixBaseURL($base));\r\n            parsedURLCache.set(key, parsedURL_1);\r\n            return parsedURL_1;\r\n        }\r\n        var parsedURL = new URL(fixBaseURL($url));\r\n        parsedURLCache.set($url, parsedURL);\r\n        return parsedURL;\r\n    }\r\n    function getAbsoluteURL($base, $relative) {\r\n        if ($relative.match(/^data\\\\?\\:/)) {\r\n            return $relative;\r\n        }\r\n        if (/^\\/\\//.test($relative)) {\r\n            return \"\".concat(location.protocol).concat($relative);\r\n        }\r\n        var b = parseURL($base);\r\n        var a = parseURL($relative, b.href);\r\n        return a.href;\r\n    }\r\n    function isRelativeHrefOnAbsolutePath(href) {\r\n        if (href.startsWith(\"data:\")) {\r\n            return true;\r\n        }\r\n        var url = parseURL(href);\r\n        if (url.protocol !== location.protocol) {\r\n            return false;\r\n        }\r\n        if (url.hostname !== location.hostname) {\r\n            return false;\r\n        }\r\n        if (url.port !== location.port) {\r\n            return false;\r\n        }\r\n        return url.pathname === location.pathname;\r\n    }\r\n\r\n    function iterateCSSRules(rules, iterate, onMediaRuleError) {\r\n        forEach(rules, function (rule) {\r\n            if (rule.selectorText) {\r\n                iterate(rule);\r\n            } else if (rule.href) {\r\n                try {\r\n                    iterateCSSRules(\r\n                        rule.styleSheet.cssRules,\r\n                        iterate,\r\n                        onMediaRuleError\r\n                    );\r\n                } catch (err) {\r\n                    logInfo(\"Found a non-loaded link.\");\r\n                    onMediaRuleError && onMediaRuleError();\r\n                }\r\n            } else if (rule.media) {\r\n                var media = Array.from(rule.media);\r\n                var isScreenOrAllOrQuery = media.some(function (m) {\r\n                    return (\r\n                        m.startsWith(\"screen\") ||\r\n                        m.startsWith(\"all\") ||\r\n                        m.startsWith(\"(\")\r\n                    );\r\n                });\r\n                var isPrintOrSpeech = media.some(function (m) {\r\n                    return m.startsWith(\"print\") || m.startsWith(\"speech\");\r\n                });\r\n                if (isScreenOrAllOrQuery || !isPrintOrSpeech) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            } else if (rule.conditionText) {\r\n                if (CSS.supports(rule.conditionText)) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            } else {\r\n                logWarn(\"CSSRule type not supported\", rule);\r\n            }\r\n        });\r\n    }\r\n    var shorthandVarDependantProperties = [\r\n        \"background\",\r\n        \"border\",\r\n        \"border-color\",\r\n        \"border-bottom\",\r\n        \"border-left\",\r\n        \"border-right\",\r\n        \"border-top\",\r\n        \"outline\",\r\n        \"outline-color\"\r\n    ];\r\n    var shorthandVarDepPropRegexps = isSafari\r\n        ? shorthandVarDependantProperties.map(function (prop) {\r\n              var regexp = new RegExp(\"\".concat(prop, \":\\\\s*(.*?)\\\\s*;\"));\r\n              return [prop, regexp];\r\n          })\r\n        : null;\r\n    function iterateCSSDeclarations(style, iterate) {\r\n        forEach(style, function (property) {\r\n            var value = style.getPropertyValue(property).trim();\r\n            if (!value) {\r\n                return;\r\n            }\r\n            iterate(property, value);\r\n        });\r\n        var cssText = style.cssText;\r\n        if (cssText.includes(\"var(\")) {\r\n            if (isSafari) {\r\n                shorthandVarDepPropRegexps.forEach(function (_a) {\r\n                    var _b = __read(_a, 2),\r\n                        prop = _b[0],\r\n                        regexp = _b[1];\r\n                    var match = cssText.match(regexp);\r\n                    if (match && match[1]) {\r\n                        var val = match[1].trim();\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            } else {\r\n                shorthandVarDependantProperties.forEach(function (prop) {\r\n                    var val = style.getPropertyValue(prop);\r\n                    if (val && val.includes(\"var(\")) {\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    var cssURLRegex = /url\\((('.*?')|(\".*?\")|([^\\)]*?))\\)/g;\r\n    var cssImportRegex =\r\n        /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)? ?(screen)?;?/gi;\r\n    function getCSSURLValue(cssURL) {\r\n        return cssURL\r\n            .trim()\r\n            .replace(/[\\n\\r\\\\]+/g, \"\")\r\n            .replace(/^url\\((.*)\\)$/, \"$1\")\r\n            .trim()\r\n            .replace(/^\"(.*)\"$/, \"$1\")\r\n            .replace(/^'(.*)'$/, \"$1\")\r\n            .replace(/(?:\\\\(.))/g, \"$1\");\r\n    }\r\n    function getCSSBaseBath(url) {\r\n        var cssURL = parseURL(url);\r\n        return \"\"\r\n            .concat(cssURL.origin)\r\n            .concat(\r\n                cssURL.pathname\r\n                    .replace(/\\?.*$/, \"\")\r\n                    .replace(/(\\/)([^\\/]+)$/i, \"$1\")\r\n            );\r\n    }\r\n    function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\r\n        return $css.replace(cssURLRegex, function (match) {\r\n            var pathValue = getCSSURLValue(match);\r\n            try {\r\n                return \"url('\".concat(\r\n                    getAbsoluteURL(cssBasePath, pathValue),\r\n                    \"')\"\r\n                );\r\n            } catch (err) {\r\n                return match;\r\n            }\r\n        });\r\n    }\r\n    var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\r\n    function removeCSSComments($css) {\r\n        return $css.replace(cssCommentsRegex, \"\");\r\n    }\r\n    var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\r\n    function replaceCSSFontFace($css) {\r\n        return $css.replace(fontFaceRegex, \"\");\r\n    }\r\n\r\n    function evalMath(expression) {\r\n        var rpnStack = [];\r\n        var workingStack = [];\r\n        var lastToken;\r\n        for (var i = 0, len = expression.length; i < len; i++) {\r\n            var token = expression[i];\r\n            if (!token || token === \" \") {\r\n                continue;\r\n            }\r\n            if (operators.has(token)) {\r\n                var op = operators.get(token);\r\n                while (workingStack.length) {\r\n                    var currentOp = operators.get(workingStack[0]);\r\n                    if (!currentOp) {\r\n                        break;\r\n                    }\r\n                    if (op.lessOrEqualThan(currentOp)) {\r\n                        rpnStack.push(workingStack.shift());\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                workingStack.unshift(token);\r\n            } else if (!lastToken || operators.has(lastToken)) {\r\n                rpnStack.push(token);\r\n            } else {\r\n                rpnStack[rpnStack.length - 1] += token;\r\n            }\r\n            lastToken = token;\r\n        }\r\n        rpnStack.push.apply(\r\n            rpnStack,\r\n            __spreadArray([], __read(workingStack), false)\r\n        );\r\n        var stack = [];\r\n        for (var i = 0, len = rpnStack.length; i < len; i++) {\r\n            var op = operators.get(rpnStack[i]);\r\n            if (op) {\r\n                var args = stack.splice(0, 2);\r\n                stack.push(op.exec(args[1], args[0]));\r\n            } else {\r\n                stack.unshift(parseFloat(rpnStack[i]));\r\n            }\r\n        }\r\n        return stack[0];\r\n    }\r\n    var Operator = (function () {\r\n        function Operator(precedence, method) {\r\n            this.precendce = precedence;\r\n            this.execMethod = method;\r\n        }\r\n        Operator.prototype.exec = function (left, right) {\r\n            return this.execMethod(left, right);\r\n        };\r\n        Operator.prototype.lessOrEqualThan = function (op) {\r\n            return this.precendce <= op.precendce;\r\n        };\r\n        return Operator;\r\n    })();\r\n    var operators = new Map([\r\n        [\r\n            \"+\",\r\n            new Operator(1, function (left, right) {\r\n                return left + right;\r\n            })\r\n        ],\r\n        [\r\n            \"-\",\r\n            new Operator(1, function (left, right) {\r\n                return left - right;\r\n            })\r\n        ],\r\n        [\r\n            \"*\",\r\n            new Operator(2, function (left, right) {\r\n                return left * right;\r\n            })\r\n        ],\r\n        [\r\n            \"/\",\r\n            new Operator(2, function (left, right) {\r\n                return left / right;\r\n            })\r\n        ]\r\n    ]);\r\n\r\n    function getMatches(regex, input, group) {\r\n        if (group === void 0) {\r\n            group = 0;\r\n        }\r\n        var matches = [];\r\n        var m;\r\n        while ((m = regex.exec(input))) {\r\n            matches.push(m[group]);\r\n        }\r\n        return matches;\r\n    }\r\n    function formatCSS(text) {\r\n        function trimLeft(text) {\r\n            return text.replace(/^\\s+/, \"\");\r\n        }\r\n        function getIndent(depth) {\r\n            if (depth === 0) {\r\n                return \"\";\r\n            }\r\n            return \" \".repeat(4 * depth);\r\n        }\r\n        if (text.length < 50000) {\r\n            var emptyRuleRegexp = /[^{}]+{\\s*}/;\r\n            while (emptyRuleRegexp.test(text)) {\r\n                text = text.replace(emptyRuleRegexp, \"\");\r\n            }\r\n        }\r\n        var css = text\r\n            .replace(/\\s{2,}/g, \" \")\r\n            .replace(/\\{/g, \"{\\n\")\r\n            .replace(/\\}/g, \"\\n}\\n\")\r\n            .replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, \";\\n\")\r\n            .replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, \",\\n\")\r\n            .replace(/\\n\\s*\\n/g, \"\\n\")\r\n            .split(\"\\n\");\r\n        var depth = 0;\r\n        var formatted = [];\r\n        for (var x = 0, len = css.length; x < len; x++) {\r\n            var line = \"\".concat(css[x], \"\\n\");\r\n            if (line.includes(\"{\")) {\r\n                formatted.push(getIndent(depth++) + trimLeft(line));\r\n            } else if (line.includes(\"}\")) {\r\n                formatted.push(getIndent(--depth) + trimLeft(line));\r\n            } else {\r\n                formatted.push(getIndent(depth) + trimLeft(line));\r\n            }\r\n        }\r\n        return formatted.join(\"\").trim();\r\n    }\r\n    function getParenthesesRange(input, searchStartIndex) {\r\n        if (searchStartIndex === void 0) {\r\n            searchStartIndex = 0;\r\n        }\r\n        var length = input.length;\r\n        var depth = 0;\r\n        var firstOpenIndex = -1;\r\n        for (var i = searchStartIndex; i < length; i++) {\r\n            if (depth === 0) {\r\n                var openIndex = input.indexOf(\"(\", i);\r\n                if (openIndex < 0) {\r\n                    break;\r\n                }\r\n                firstOpenIndex = openIndex;\r\n                depth++;\r\n                i = openIndex;\r\n            } else {\r\n                var closingIndex = input.indexOf(\")\", i);\r\n                if (closingIndex < 0) {\r\n                    break;\r\n                }\r\n                var openIndex = input.indexOf(\"(\", i);\r\n                if (openIndex < 0 || closingIndex < openIndex) {\r\n                    depth--;\r\n                    if (depth === 0) {\r\n                        return {start: firstOpenIndex, end: closingIndex + 1};\r\n                    }\r\n                    i = closingIndex;\r\n                } else {\r\n                    depth++;\r\n                    i = openIndex;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    var hslaParseCache = new Map();\r\n    var rgbaParseCache = new Map();\r\n    function parseColorWithCache($color) {\r\n        $color = $color.trim();\r\n        if (rgbaParseCache.has($color)) {\r\n            return rgbaParseCache.get($color);\r\n        }\r\n        if ($color.includes(\"calc(\")) {\r\n            $color = lowerCalcExpression($color);\r\n        }\r\n        var color = parse($color);\r\n        color && rgbaParseCache.set($color, color);\r\n        return color;\r\n    }\r\n    function parseToHSLWithCache(color) {\r\n        if (hslaParseCache.has(color)) {\r\n            return hslaParseCache.get(color);\r\n        }\r\n        var rgb = parseColorWithCache(color);\r\n        if (!rgb) {\r\n            return null;\r\n        }\r\n        var hsl = rgbToHSL(rgb);\r\n        hslaParseCache.set(color, hsl);\r\n        return hsl;\r\n    }\r\n    function clearColorCache() {\r\n        hslaParseCache.clear();\r\n        rgbaParseCache.clear();\r\n    }\r\n    function hslToRGB(_a) {\r\n        var h = _a.h,\r\n            s = _a.s,\r\n            l = _a.l,\r\n            _b = _a.a,\r\n            a = _b === void 0 ? 1 : _b;\r\n        if (s === 0) {\r\n            var _c = __read(\r\n                    [l, l, l].map(function (x) {\r\n                        return Math.round(x * 255);\r\n                    }),\r\n                    3\r\n                ),\r\n                r_1 = _c[0],\r\n                b_1 = _c[1],\r\n                g_1 = _c[2];\r\n            return {r: r_1, g: g_1, b: b_1, a: a};\r\n        }\r\n        var c = (1 - Math.abs(2 * l - 1)) * s;\r\n        var x = c * (1 - Math.abs(((h / 60) % 2) - 1));\r\n        var m = l - c / 2;\r\n        var _d = __read(\r\n                (h < 60\r\n                    ? [c, x, 0]\r\n                    : h < 120\r\n                      ? [x, c, 0]\r\n                      : h < 180\r\n                        ? [0, c, x]\r\n                        : h < 240\r\n                          ? [0, x, c]\r\n                          : h < 300\r\n                            ? [x, 0, c]\r\n                            : [c, 0, x]\r\n                ).map(function (n) {\r\n                    return Math.round((n + m) * 255);\r\n                }),\r\n                3\r\n            ),\r\n            r = _d[0],\r\n            g = _d[1],\r\n            b = _d[2];\r\n        return {r: r, g: g, b: b, a: a};\r\n    }\r\n    function rgbToHSL(_a) {\r\n        var r255 = _a.r,\r\n            g255 = _a.g,\r\n            b255 = _a.b,\r\n            _b = _a.a,\r\n            a = _b === void 0 ? 1 : _b;\r\n        var r = r255 / 255;\r\n        var g = g255 / 255;\r\n        var b = b255 / 255;\r\n        var max = Math.max(r, g, b);\r\n        var min = Math.min(r, g, b);\r\n        var c = max - min;\r\n        var l = (max + min) / 2;\r\n        if (c === 0) {\r\n            return {h: 0, s: 0, l: l, a: a};\r\n        }\r\n        var h =\r\n            (max === r\r\n                ? ((g - b) / c) % 6\r\n                : max === g\r\n                  ? (b - r) / c + 2\r\n                  : (r - g) / c + 4) * 60;\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        var s = c / (1 - Math.abs(2 * l - 1));\r\n        return {h: h, s: s, l: l, a: a};\r\n    }\r\n    function toFixed(n, digits) {\r\n        if (digits === void 0) {\r\n            digits = 0;\r\n        }\r\n        var fixed = n.toFixed(digits);\r\n        if (digits === 0) {\r\n            return fixed;\r\n        }\r\n        var dot = fixed.indexOf(\".\");\r\n        if (dot >= 0) {\r\n            var zerosMatch = fixed.match(/0+$/);\r\n            if (zerosMatch) {\r\n                if (zerosMatch.index === dot + 1) {\r\n                    return fixed.substring(0, dot);\r\n                }\r\n                return fixed.substring(0, zerosMatch.index);\r\n            }\r\n        }\r\n        return fixed;\r\n    }\r\n    function rgbToString(rgb) {\r\n        var r = rgb.r,\r\n            g = rgb.g,\r\n            b = rgb.b,\r\n            a = rgb.a;\r\n        if (a != null && a < 1) {\r\n            return \"rgba(\"\r\n                .concat(toFixed(r), \", \")\r\n                .concat(toFixed(g), \", \")\r\n                .concat(toFixed(b), \", \")\r\n                .concat(toFixed(a, 2), \")\");\r\n        }\r\n        return \"rgb(\"\r\n            .concat(toFixed(r), \", \")\r\n            .concat(toFixed(g), \", \")\r\n            .concat(toFixed(b), \")\");\r\n    }\r\n    function rgbToHexString(_a) {\r\n        var r = _a.r,\r\n            g = _a.g,\r\n            b = _a.b,\r\n            a = _a.a;\r\n        return \"#\".concat(\r\n            (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b])\r\n                .map(function (x) {\r\n                    return \"\".concat(x < 16 ? \"0\" : \"\").concat(x.toString(16));\r\n                })\r\n                .join(\"\")\r\n        );\r\n    }\r\n    function hslToString(hsl) {\r\n        var h = hsl.h,\r\n            s = hsl.s,\r\n            l = hsl.l,\r\n            a = hsl.a;\r\n        if (a != null && a < 1) {\r\n            return \"hsla(\"\r\n                .concat(toFixed(h), \", \")\r\n                .concat(toFixed(s * 100), \"%, \")\r\n                .concat(toFixed(l * 100), \"%, \")\r\n                .concat(toFixed(a, 2), \")\");\r\n        }\r\n        return \"hsl(\"\r\n            .concat(toFixed(h), \", \")\r\n            .concat(toFixed(s * 100), \"%, \")\r\n            .concat(toFixed(l * 100), \"%)\");\r\n    }\r\n    var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\r\n    var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\r\n    var hexMatch = /^#[0-9a-f]+$/i;\r\n    function parse($color) {\r\n        var c = $color.trim().toLowerCase();\r\n        if (c.match(rgbMatch)) {\r\n            return parseRGB(c);\r\n        }\r\n        if (c.match(hslMatch)) {\r\n            return parseHSL(c);\r\n        }\r\n        if (c.match(hexMatch)) {\r\n            return parseHex(c);\r\n        }\r\n        if (knownColors.has(c)) {\r\n            return getColorByName(c);\r\n        }\r\n        if (systemColors.has(c)) {\r\n            return getSystemColor(c);\r\n        }\r\n        if ($color === \"transparent\") {\r\n            return {r: 0, g: 0, b: 0, a: 0};\r\n        }\r\n        return null;\r\n    }\r\n    function getNumbers($color) {\r\n        var numbers = [];\r\n        var prevPos = 0;\r\n        var isMining = false;\r\n        var startIndex = $color.indexOf(\"(\");\r\n        $color = $color.substring(startIndex + 1, $color.length - 1);\r\n        for (var i = 0; i < $color.length; i++) {\r\n            var c = $color[i];\r\n            if ((c >= \"0\" && c <= \"9\") || c === \".\" || c === \"+\" || c === \"-\") {\r\n                isMining = true;\r\n            } else if (isMining && (c === \" \" || c === \",\" || c === \"/\")) {\r\n                numbers.push($color.substring(prevPos, i));\r\n                isMining = false;\r\n                prevPos = i + 1;\r\n            } else if (!isMining) {\r\n                prevPos = i + 1;\r\n            }\r\n        }\r\n        if (isMining) {\r\n            numbers.push($color.substring(prevPos, $color.length));\r\n        }\r\n        return numbers;\r\n    }\r\n    function getNumbersFromString(str, range, units) {\r\n        var raw = getNumbers(str);\r\n        var unitsList = Object.entries(units);\r\n        var numbers = raw\r\n            .map(function (r) {\r\n                return r.trim();\r\n            })\r\n            .map(function (r, i) {\r\n                var n;\r\n                var unit = unitsList.find(function (_a) {\r\n                    var _b = __read(_a, 1),\r\n                        u = _b[0];\r\n                    return r.endsWith(u);\r\n                });\r\n                if (unit) {\r\n                    n =\r\n                        (parseFloat(r.substring(0, r.length - unit[0].length)) /\r\n                            unit[1]) *\r\n                        range[i];\r\n                } else {\r\n                    n = parseFloat(r);\r\n                }\r\n                if (range[i] > 1) {\r\n                    return Math.round(n);\r\n                }\r\n                return n;\r\n            });\r\n        return numbers;\r\n    }\r\n    var rgbRange = [255, 255, 255, 1];\r\n    var rgbUnits = {\"%\": 100};\r\n    function parseRGB($rgb) {\r\n        var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4),\r\n            r = _a[0],\r\n            g = _a[1],\r\n            b = _a[2],\r\n            _b = _a[3],\r\n            a = _b === void 0 ? 1 : _b;\r\n        return {r: r, g: g, b: b, a: a};\r\n    }\r\n    var hslRange = [360, 1, 1, 1];\r\n    var hslUnits = {\"%\": 100, \"deg\": 360, \"rad\": 2 * Math.PI, \"turn\": 1};\r\n    function parseHSL($hsl) {\r\n        var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4),\r\n            h = _a[0],\r\n            s = _a[1],\r\n            l = _a[2],\r\n            _b = _a[3],\r\n            a = _b === void 0 ? 1 : _b;\r\n        return hslToRGB({h: h, s: s, l: l, a: a});\r\n    }\r\n    function parseHex($hex) {\r\n        var h = $hex.substring(1);\r\n        switch (h.length) {\r\n            case 3:\r\n            case 4: {\r\n                var _a = __read(\r\n                        [0, 1, 2].map(function (i) {\r\n                            return parseInt(\"\".concat(h[i]).concat(h[i]), 16);\r\n                        }),\r\n                        3\r\n                    ),\r\n                    r = _a[0],\r\n                    g = _a[1],\r\n                    b = _a[2];\r\n                var a =\r\n                    h.length === 3\r\n                        ? 1\r\n                        : parseInt(\"\".concat(h[3]).concat(h[3]), 16) / 255;\r\n                return {r: r, g: g, b: b, a: a};\r\n            }\r\n            case 6:\r\n            case 8: {\r\n                var _b = __read(\r\n                        [0, 2, 4].map(function (i) {\r\n                            return parseInt(h.substring(i, i + 2), 16);\r\n                        }),\r\n                        3\r\n                    ),\r\n                    r = _b[0],\r\n                    g = _b[1],\r\n                    b = _b[2];\r\n                var a =\r\n                    h.length === 6 ? 1 : parseInt(h.substring(6, 8), 16) / 255;\r\n                return {r: r, g: g, b: b, a: a};\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getColorByName($color) {\r\n        var n = knownColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function getSystemColor($color) {\r\n        var n = systemColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function lowerCalcExpression(color) {\r\n        var searchIndex = 0;\r\n        var replaceBetweenIndices = function (start, end, replacement) {\r\n            color =\r\n                color.substring(0, start) + replacement + color.substring(end);\r\n        };\r\n        while ((searchIndex = color.indexOf(\"calc(\")) !== -1) {\r\n            var range = getParenthesesRange(color, searchIndex);\r\n            if (!range) {\r\n                break;\r\n            }\r\n            var slice = color.slice(range.start + 1, range.end - 1);\r\n            var includesPercentage = slice.includes(\"%\");\r\n            slice = slice.split(\"%\").join(\"\");\r\n            var output = Math.round(evalMath(slice));\r\n            replaceBetweenIndices(\r\n                range.start - 4,\r\n                range.end,\r\n                output + (includesPercentage ? \"%\" : \"\")\r\n            );\r\n        }\r\n        return color;\r\n    }\r\n    var knownColors = new Map(\r\n        Object.entries({\r\n            aliceblue: 0xf0f8ff,\r\n            antiquewhite: 0xfaebd7,\r\n            aqua: 0x00ffff,\r\n            aquamarine: 0x7fffd4,\r\n            azure: 0xf0ffff,\r\n            beige: 0xf5f5dc,\r\n            bisque: 0xffe4c4,\r\n            black: 0x000000,\r\n            blanchedalmond: 0xffebcd,\r\n            blue: 0x0000ff,\r\n            blueviolet: 0x8a2be2,\r\n            brown: 0xa52a2a,\r\n            burlywood: 0xdeb887,\r\n            cadetblue: 0x5f9ea0,\r\n            chartreuse: 0x7fff00,\r\n            chocolate: 0xd2691e,\r\n            coral: 0xff7f50,\r\n            cornflowerblue: 0x6495ed,\r\n            cornsilk: 0xfff8dc,\r\n            crimson: 0xdc143c,\r\n            cyan: 0x00ffff,\r\n            darkblue: 0x00008b,\r\n            darkcyan: 0x008b8b,\r\n            darkgoldenrod: 0xb8860b,\r\n            darkgray: 0xa9a9a9,\r\n            darkgrey: 0xa9a9a9,\r\n            darkgreen: 0x006400,\r\n            darkkhaki: 0xbdb76b,\r\n            darkmagenta: 0x8b008b,\r\n            darkolivegreen: 0x556b2f,\r\n            darkorange: 0xff8c00,\r\n            darkorchid: 0x9932cc,\r\n            darkred: 0x8b0000,\r\n            darksalmon: 0xe9967a,\r\n            darkseagreen: 0x8fbc8f,\r\n            darkslateblue: 0x483d8b,\r\n            darkslategray: 0x2f4f4f,\r\n            darkslategrey: 0x2f4f4f,\r\n            darkturquoise: 0x00ced1,\r\n            darkviolet: 0x9400d3,\r\n            deeppink: 0xff1493,\r\n            deepskyblue: 0x00bfff,\r\n            dimgray: 0x696969,\r\n            dimgrey: 0x696969,\r\n            dodgerblue: 0x1e90ff,\r\n            firebrick: 0xb22222,\r\n            floralwhite: 0xfffaf0,\r\n            forestgreen: 0x228b22,\r\n            fuchsia: 0xff00ff,\r\n            gainsboro: 0xdcdcdc,\r\n            ghostwhite: 0xf8f8ff,\r\n            gold: 0xffd700,\r\n            goldenrod: 0xdaa520,\r\n            gray: 0x808080,\r\n            grey: 0x808080,\r\n            green: 0x008000,\r\n            greenyellow: 0xadff2f,\r\n            honeydew: 0xf0fff0,\r\n            hotpink: 0xff69b4,\r\n            indianred: 0xcd5c5c,\r\n            indigo: 0x4b0082,\r\n            ivory: 0xfffff0,\r\n            khaki: 0xf0e68c,\r\n            lavender: 0xe6e6fa,\r\n            lavenderblush: 0xfff0f5,\r\n            lawngreen: 0x7cfc00,\r\n            lemonchiffon: 0xfffacd,\r\n            lightblue: 0xadd8e6,\r\n            lightcoral: 0xf08080,\r\n            lightcyan: 0xe0ffff,\r\n            lightgoldenrodyellow: 0xfafad2,\r\n            lightgray: 0xd3d3d3,\r\n            lightgrey: 0xd3d3d3,\r\n            lightgreen: 0x90ee90,\r\n            lightpink: 0xffb6c1,\r\n            lightsalmon: 0xffa07a,\r\n            lightseagreen: 0x20b2aa,\r\n            lightskyblue: 0x87cefa,\r\n            lightslategray: 0x778899,\r\n            lightslategrey: 0x778899,\r\n            lightsteelblue: 0xb0c4de,\r\n            lightyellow: 0xffffe0,\r\n            lime: 0x00ff00,\r\n            limegreen: 0x32cd32,\r\n            linen: 0xfaf0e6,\r\n            magenta: 0xff00ff,\r\n            maroon: 0x800000,\r\n            mediumaquamarine: 0x66cdaa,\r\n            mediumblue: 0x0000cd,\r\n            mediumorchid: 0xba55d3,\r\n            mediumpurple: 0x9370db,\r\n            mediumseagreen: 0x3cb371,\r\n            mediumslateblue: 0x7b68ee,\r\n            mediumspringgreen: 0x00fa9a,\r\n            mediumturquoise: 0x48d1cc,\r\n            mediumvioletred: 0xc71585,\r\n            midnightblue: 0x191970,\r\n            mintcream: 0xf5fffa,\r\n            mistyrose: 0xffe4e1,\r\n            moccasin: 0xffe4b5,\r\n            navajowhite: 0xffdead,\r\n            navy: 0x000080,\r\n            oldlace: 0xfdf5e6,\r\n            olive: 0x808000,\r\n            olivedrab: 0x6b8e23,\r\n            orange: 0xffa500,\r\n            orangered: 0xff4500,\r\n            orchid: 0xda70d6,\r\n            palegoldenrod: 0xeee8aa,\r\n            palegreen: 0x98fb98,\r\n            paleturquoise: 0xafeeee,\r\n            palevioletred: 0xdb7093,\r\n            papayawhip: 0xffefd5,\r\n            peachpuff: 0xffdab9,\r\n            peru: 0xcd853f,\r\n            pink: 0xffc0cb,\r\n            plum: 0xdda0dd,\r\n            powderblue: 0xb0e0e6,\r\n            purple: 0x800080,\r\n            rebeccapurple: 0x663399,\r\n            red: 0xff0000,\r\n            rosybrown: 0xbc8f8f,\r\n            royalblue: 0x4169e1,\r\n            saddlebrown: 0x8b4513,\r\n            salmon: 0xfa8072,\r\n            sandybrown: 0xf4a460,\r\n            seagreen: 0x2e8b57,\r\n            seashell: 0xfff5ee,\r\n            sienna: 0xa0522d,\r\n            silver: 0xc0c0c0,\r\n            skyblue: 0x87ceeb,\r\n            slateblue: 0x6a5acd,\r\n            slategray: 0x708090,\r\n            slategrey: 0x708090,\r\n            snow: 0xfffafa,\r\n            springgreen: 0x00ff7f,\r\n            steelblue: 0x4682b4,\r\n            tan: 0xd2b48c,\r\n            teal: 0x008080,\r\n            thistle: 0xd8bfd8,\r\n            tomato: 0xff6347,\r\n            turquoise: 0x40e0d0,\r\n            violet: 0xee82ee,\r\n            wheat: 0xf5deb3,\r\n            white: 0xffffff,\r\n            whitesmoke: 0xf5f5f5,\r\n            yellow: 0xffff00,\r\n            yellowgreen: 0x9acd32\r\n        })\r\n    );\r\n    var systemColors = new Map(\r\n        Object.entries({\r\n            \"ActiveBorder\": 0x3b99fc,\r\n            \"ActiveCaption\": 0x000000,\r\n            \"AppWorkspace\": 0xaaaaaa,\r\n            \"Background\": 0x6363ce,\r\n            \"ButtonFace\": 0xffffff,\r\n            \"ButtonHighlight\": 0xe9e9e9,\r\n            \"ButtonShadow\": 0x9fa09f,\r\n            \"ButtonText\": 0x000000,\r\n            \"CaptionText\": 0x000000,\r\n            \"GrayText\": 0x7f7f7f,\r\n            \"Highlight\": 0xb2d7ff,\r\n            \"HighlightText\": 0x000000,\r\n            \"InactiveBorder\": 0xffffff,\r\n            \"InactiveCaption\": 0xffffff,\r\n            \"InactiveCaptionText\": 0x000000,\r\n            \"InfoBackground\": 0xfbfcc5,\r\n            \"InfoText\": 0x000000,\r\n            \"Menu\": 0xf6f6f6,\r\n            \"MenuText\": 0xffffff,\r\n            \"Scrollbar\": 0xaaaaaa,\r\n            \"ThreeDDarkShadow\": 0x000000,\r\n            \"ThreeDFace\": 0xc0c0c0,\r\n            \"ThreeDHighlight\": 0xffffff,\r\n            \"ThreeDLightShadow\": 0xffffff,\r\n            \"ThreeDShadow\": 0x000000,\r\n            \"Window\": 0xececec,\r\n            \"WindowFrame\": 0xaaaaaa,\r\n            \"WindowText\": 0x000000,\r\n            \"-webkit-focus-ring-color\": 0xe59700\r\n        }).map(function (_a) {\r\n            var _b = __read(_a, 2),\r\n                key = _b[0],\r\n                value = _b[1];\r\n            return [key.toLowerCase(), value];\r\n        })\r\n    );\r\n    function getSRGBLightness(r, g, b) {\r\n        return (0.2126 * r + 0.7152 * g + 0.0722 * b) / 255;\r\n    }\r\n\r\n    function scale(x, inLow, inHigh, outLow, outHigh) {\r\n        return ((x - inLow) * (outHigh - outLow)) / (inHigh - inLow) + outLow;\r\n    }\r\n    function clamp(x, min, max) {\r\n        return Math.min(max, Math.max(min, x));\r\n    }\r\n    function multiplyMatrices(m1, m2) {\r\n        var result = [];\r\n        for (var i = 0, len = m1.length; i < len; i++) {\r\n            result[i] = [];\r\n            for (var j = 0, len2 = m2[0].length; j < len2; j++) {\r\n                var sum = 0;\r\n                for (var k = 0, len3 = m1[0].length; k < len3; k++) {\r\n                    sum += m1[i][k] * m2[k][j];\r\n                }\r\n                result[i][j] = sum;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function createFilterMatrix(config) {\r\n        var m = Matrix.identity();\r\n        if (config.sepia !== 0) {\r\n            m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\r\n        }\r\n        if (config.contrast !== 100) {\r\n            m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\r\n        }\r\n        if (config.brightness !== 100) {\r\n            m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\r\n        }\r\n        if (config.mode === 1) {\r\n            m = multiplyMatrices(m, Matrix.invertNHue());\r\n        }\r\n        return m;\r\n    }\r\n    function applyColorMatrix(_a, matrix) {\r\n        var _b = __read(_a, 3),\r\n            r = _b[0],\r\n            g = _b[1],\r\n            b = _b[2];\r\n        var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\r\n        var result = multiplyMatrices(matrix, rgb);\r\n        return [0, 1, 2].map(function (i) {\r\n            return clamp(Math.round(result[i][0] * 255), 0, 255);\r\n        });\r\n    }\r\n    var Matrix = {\r\n        identity: function () {\r\n            return [\r\n                [1, 0, 0, 0, 0],\r\n                [0, 1, 0, 0, 0],\r\n                [0, 0, 1, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        invertNHue: function () {\r\n            return [\r\n                [0.333, -0.667, -0.667, 0, 1],\r\n                [-0.667, 0.333, -0.667, 0, 1],\r\n                [-0.667, -0.667, 0.333, 0, 1],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        brightness: function (v) {\r\n            return [\r\n                [v, 0, 0, 0, 0],\r\n                [0, v, 0, 0, 0],\r\n                [0, 0, v, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        contrast: function (v) {\r\n            var t = (1 - v) / 2;\r\n            return [\r\n                [v, 0, 0, 0, t],\r\n                [0, v, 0, 0, t],\r\n                [0, 0, v, 0, t],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        sepia: function (v) {\r\n            return [\r\n                [\r\n                    0.393 + 0.607 * (1 - v),\r\n                    0.769 - 0.769 * (1 - v),\r\n                    0.189 - 0.189 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.349 - 0.349 * (1 - v),\r\n                    0.686 + 0.314 * (1 - v),\r\n                    0.168 - 0.168 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.272 - 0.272 * (1 - v),\r\n                    0.534 - 0.534 * (1 - v),\r\n                    0.131 + 0.869 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        grayscale: function (v) {\r\n            return [\r\n                [\r\n                    0.2126 + 0.7874 * (1 - v),\r\n                    0.7152 - 0.7152 * (1 - v),\r\n                    0.0722 - 0.0722 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.2126 - 0.2126 * (1 - v),\r\n                    0.7152 + 0.2848 * (1 - v),\r\n                    0.0722 - 0.0722 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.2126 - 0.2126 * (1 - v),\r\n                    0.7152 - 0.7152 * (1 - v),\r\n                    0.0722 + 0.9278 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        }\r\n    };\r\n\r\n    function getBgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme\r\n            ? \"darkSchemeBackgroundColor\"\r\n            : \"lightSchemeBackgroundColor\";\r\n        return theme[prop];\r\n    }\r\n    function getFgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme\r\n            ? \"darkSchemeTextColor\"\r\n            : \"lightSchemeTextColor\";\r\n        return theme[prop];\r\n    }\r\n    var colorModificationCache = new Map();\r\n    function clearColorModificationCache() {\r\n        colorModificationCache.clear();\r\n    }\r\n    var rgbCacheKeys = [\"r\", \"g\", \"b\", \"a\"];\r\n    var themeCacheKeys$1 = [\r\n        \"mode\",\r\n        \"brightness\",\r\n        \"contrast\",\r\n        \"grayscale\",\r\n        \"sepia\",\r\n        \"darkSchemeBackgroundColor\",\r\n        \"darkSchemeTextColor\",\r\n        \"lightSchemeBackgroundColor\",\r\n        \"lightSchemeTextColor\"\r\n    ];\r\n    function getCacheId(rgb, theme) {\r\n        var resultId = \"\";\r\n        rgbCacheKeys.forEach(function (key) {\r\n            resultId += \"\".concat(rgb[key], \";\");\r\n        });\r\n        themeCacheKeys$1.forEach(function (key) {\r\n            resultId += \"\".concat(theme[key], \";\");\r\n        });\r\n        return resultId;\r\n    }\r\n    function modifyColorWithCache(\r\n        rgb,\r\n        theme,\r\n        modifyHSL,\r\n        poleColor,\r\n        anotherPoleColor\r\n    ) {\r\n        var fnCache;\r\n        if (colorModificationCache.has(modifyHSL)) {\r\n            fnCache = colorModificationCache.get(modifyHSL);\r\n        } else {\r\n            fnCache = new Map();\r\n            colorModificationCache.set(modifyHSL, fnCache);\r\n        }\r\n        var id = getCacheId(rgb, theme);\r\n        if (fnCache.has(id)) {\r\n            return fnCache.get(id);\r\n        }\r\n        var hsl = rgbToHSL(rgb);\r\n        var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\r\n        var anotherPole =\r\n            anotherPoleColor == null\r\n                ? null\r\n                : parseToHSLWithCache(anotherPoleColor);\r\n        var modified = modifyHSL(hsl, pole, anotherPole);\r\n        var _a = hslToRGB(modified),\r\n            r = _a.r,\r\n            g = _a.g,\r\n            b = _a.b,\r\n            a = _a.a;\r\n        var matrix = createFilterMatrix(theme);\r\n        var _b = __read(applyColorMatrix([r, g, b], matrix), 3),\r\n            rf = _b[0],\r\n            gf = _b[1],\r\n            bf = _b[2];\r\n        var color =\r\n            a === 1\r\n                ? rgbToHexString({r: rf, g: gf, b: bf})\r\n                : rgbToString({r: rf, g: gf, b: bf, a: a});\r\n        fnCache.set(id, color);\r\n        return color;\r\n    }\r\n    function noopHSL(hsl) {\r\n        return hsl;\r\n    }\r\n    function modifyColor(rgb, theme) {\r\n        return modifyColorWithCache(rgb, theme, noopHSL);\r\n    }\r\n    function modifyLightSchemeColor(rgb, theme) {\r\n        var poleBg = getBgPole(theme);\r\n        var poleFg = getFgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            theme,\r\n            modifyLightModeHSL,\r\n            poleFg,\r\n            poleBg\r\n        );\r\n    }\r\n    function modifyLightModeHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h,\r\n            s = _a.s,\r\n            l = _a.l,\r\n            a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral;\r\n        if (isDark) {\r\n            isNeutral = l < 0.2 || s < 0.12;\r\n        } else {\r\n            var isBlue = h > 200 && h < 280;\r\n            isNeutral = s < 0.24 || (l > 0.8 && isBlue);\r\n        }\r\n        var hx = h;\r\n        var sx = l;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            } else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\r\n        return {h: hx, s: sx, l: lx, a: a};\r\n    }\r\n    var MAX_BG_LIGHTNESS = 0.4;\r\n    function modifyBgHSL(_a, pole) {\r\n        var h = _a.h,\r\n            s = _a.s,\r\n            l = _a.l,\r\n            a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isBlue = h > 200 && h < 280;\r\n        var isNeutral = s < 0.12 || (l > 0.8 && isBlue);\r\n        if (isDark) {\r\n            var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\r\n            if (isNeutral) {\r\n                var hx_1 = pole.h;\r\n                var sx = pole.s;\r\n                return {h: hx_1, s: sx, l: lx_1, a: a};\r\n            }\r\n            return {h: h, s: s, l: lx_1, a: a};\r\n        }\r\n        var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\r\n        if (isNeutral) {\r\n            var hx_2 = pole.h;\r\n            var sx = pole.s;\r\n            return {h: hx_2, s: sx, l: lx, a: a};\r\n        }\r\n        var hx = h;\r\n        var isYellow = h > 60 && h < 180;\r\n        if (isYellow) {\r\n            var isCloserToGreen = h > 120;\r\n            if (isCloserToGreen) {\r\n                hx = scale(h, 120, 180, 135, 180);\r\n            } else {\r\n                hx = scale(h, 60, 120, 60, 105);\r\n            }\r\n        }\r\n        if (hx > 40 && hx < 80) {\r\n            lx *= 0.75;\r\n        }\r\n        return {h: hx, s: s, l: lx, a: a};\r\n    }\r\n    function modifyBackgroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getBgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            __assign(__assign({}, theme), {mode: 0}),\r\n            modifyBgHSL,\r\n            pole\r\n        );\r\n    }\r\n    var MIN_FG_LIGHTNESS = 0.55;\r\n    function modifyBlueFgHue(hue) {\r\n        return scale(hue, 205, 245, 205, 220);\r\n    }\r\n    function modifyFgHSL(_a, pole) {\r\n        var h = _a.h,\r\n            s = _a.s,\r\n            l = _a.l,\r\n            a = _a.a;\r\n        var isLight = l > 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var isBlue = !isNeutral && h > 205 && h < 245;\r\n        if (isLight) {\r\n            var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\r\n            if (isNeutral) {\r\n                var hx_3 = pole.h;\r\n                var sx = pole.s;\r\n                return {h: hx_3, s: sx, l: lx_2, a: a};\r\n            }\r\n            var hx_4 = h;\r\n            if (isBlue) {\r\n                hx_4 = modifyBlueFgHue(h);\r\n            }\r\n            return {h: hx_4, s: s, l: lx_2, a: a};\r\n        }\r\n        if (isNeutral) {\r\n            var hx_5 = pole.h;\r\n            var sx = pole.s;\r\n            var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n            return {h: hx_5, s: sx, l: lx_3, a: a};\r\n        }\r\n        var hx = h;\r\n        var lx;\r\n        if (isBlue) {\r\n            hx = modifyBlueFgHue(h);\r\n            lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\r\n        } else {\r\n            lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n        }\r\n        return {h: hx, s: s, l: lx, a: a};\r\n    }\r\n    function modifyForegroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getFgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            __assign(__assign({}, theme), {mode: 0}),\r\n            modifyFgHSL,\r\n            pole\r\n        );\r\n    }\r\n    function modifyBorderHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h,\r\n            s = _a.s,\r\n            l = _a.l,\r\n            a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var hx = h;\r\n        var sx = s;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            } else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, 0.5, 0.2);\r\n        return {h: hx, s: sx, l: lx, a: a};\r\n    }\r\n    function modifyBorderColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var poleFg = getFgPole(theme);\r\n        var poleBg = getBgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            __assign(__assign({}, theme), {mode: 0}),\r\n            modifyBorderHSL,\r\n            poleFg,\r\n            poleBg\r\n        );\r\n    }\r\n    function modifyShadowColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\r\n    function modifyGradientColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\r\n\r\n    function createTextStyle(config) {\r\n        var lines = [];\r\n        lines.push(\r\n            '*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {'\r\n        );\r\n        if (config.useFont && config.fontFamily) {\r\n            lines.push(\r\n                \"  font-family: \".concat(config.fontFamily, \" !important;\")\r\n            );\r\n        }\r\n        if (config.textStroke > 0) {\r\n            lines.push(\r\n                \"  -webkit-text-stroke: \".concat(\r\n                    config.textStroke,\r\n                    \"px !important;\"\r\n                )\r\n            );\r\n            lines.push(\r\n                \"  text-stroke: \".concat(config.textStroke, \"px !important;\")\r\n            );\r\n        }\r\n        lines.push(\"}\");\r\n        return lines.join(\"\\n\");\r\n    }\r\n\r\n    var FilterMode;\r\n    (function (FilterMode) {\r\n        FilterMode[(FilterMode[\"light\"] = 0)] = \"light\";\r\n        FilterMode[(FilterMode[\"dark\"] = 1)] = \"dark\";\r\n    })(FilterMode || (FilterMode = {}));\r\n    function getCSSFilterValue(config) {\r\n        var filters = [];\r\n        if (config.mode === FilterMode.dark) {\r\n            filters.push(\"invert(100%) hue-rotate(180deg)\");\r\n        }\r\n        if (config.brightness !== 100) {\r\n            filters.push(\"brightness(\".concat(config.brightness, \"%)\"));\r\n        }\r\n        if (config.contrast !== 100) {\r\n            filters.push(\"contrast(\".concat(config.contrast, \"%)\"));\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            filters.push(\"grayscale(\".concat(config.grayscale, \"%)\"));\r\n        }\r\n        if (config.sepia !== 0) {\r\n            filters.push(\"sepia(\".concat(config.sepia, \"%)\"));\r\n        }\r\n        if (filters.length === 0) {\r\n            return null;\r\n        }\r\n        return filters.join(\" \");\r\n    }\r\n\r\n    function toSVGMatrix(matrix) {\r\n        return matrix\r\n            .slice(0, 4)\r\n            .map(function (m) {\r\n                return m\r\n                    .map(function (m) {\r\n                        return m.toFixed(3);\r\n                    })\r\n                    .join(\" \");\r\n            })\r\n            .join(\" \");\r\n    }\r\n    function getSVGFilterMatrixValue(config) {\r\n        return toSVGMatrix(createFilterMatrix(config));\r\n    }\r\n\r\n    function hexify(number) {\r\n        return (number < 16 ? \"0\" : \"\") + number.toString(16);\r\n    }\r\n    function generateUID() {\r\n        if (\"randomUUID\" in crypto) {\r\n            var uuid = crypto.randomUUID();\r\n            return (\r\n                uuid.substring(0, 8) +\r\n                uuid.substring(9, 13) +\r\n                uuid.substring(14, 18) +\r\n                uuid.substring(19, 23) +\r\n                uuid.substring(24)\r\n            );\r\n        }\r\n        if (\"getRandomValues\" in crypto) {\r\n            return Array.from(crypto.getRandomValues(new Uint8Array(16)))\r\n                .map(function (x) {\r\n                    return hexify(x);\r\n                })\r\n                .join(\"\");\r\n        }\r\n        return Math.floor(Math.random() * Math.pow(2, 55)).toString(36);\r\n    }\r\n\r\n    var resolvers$1 = new Map();\r\n    var rejectors = new Map();\r\n    function bgFetch(request) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [\r\n                    2,\r\n                    new Promise(function (resolve, reject) {\r\n                        var id = generateUID();\r\n                        resolvers$1.set(id, resolve);\r\n                        rejectors.set(id, reject);\r\n                        chrome.runtime.sendMessage({\r\n                            type: MessageTypeCStoBG.FETCH,\r\n                            data: request,\r\n                            id: id\r\n                        });\r\n                    })\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    chrome.runtime.onMessage.addListener(function (_a) {\r\n        var type = _a.type,\r\n            data = _a.data,\r\n            error = _a.error,\r\n            id = _a.id;\r\n        if (type === MessageTypeBGtoCS.FETCH_RESPONSE) {\r\n            var resolve = resolvers$1.get(id);\r\n            var reject = rejectors.get(id);\r\n            resolvers$1.delete(id);\r\n            rejectors.delete(id);\r\n            if (error) {\r\n                reject && reject(error);\r\n            } else {\r\n                resolve && resolve(data);\r\n            }\r\n        }\r\n    });\r\n\r\n    var MAX_FRAME_DURATION = 1000 / 60;\r\n    var AsyncQueue = (function () {\r\n        function AsyncQueue() {\r\n            this.queue = [];\r\n            this.timerId = null;\r\n        }\r\n        AsyncQueue.prototype.addTask = function (task) {\r\n            this.queue.push(task);\r\n            this.scheduleFrame();\r\n        };\r\n        AsyncQueue.prototype.stop = function () {\r\n            if (this.timerId !== null) {\r\n                cancelAnimationFrame(this.timerId);\r\n                this.timerId = null;\r\n            }\r\n            this.queue = [];\r\n        };\r\n        AsyncQueue.prototype.scheduleFrame = function () {\r\n            var _this = this;\r\n            if (this.timerId) {\r\n                return;\r\n            }\r\n            this.timerId = requestAnimationFrame(function () {\r\n                _this.timerId = null;\r\n                var start = Date.now();\r\n                var cb;\r\n                while ((cb = _this.queue.shift())) {\r\n                    cb();\r\n                    if (Date.now() - start >= MAX_FRAME_DURATION) {\r\n                        _this.scheduleFrame();\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        return AsyncQueue;\r\n    })();\r\n\r\n    var imageManager = new AsyncQueue();\r\n    function getImageDetails(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                return [\r\n                    2,\r\n                    new Promise(function (resolve, reject) {\r\n                        return __awaiter(_this, void 0, void 0, function () {\r\n                            var dataURL_1, _a, blob_1, _b, image_1, _c, error_1;\r\n                            var _d, _e;\r\n                            return __generator(this, function (_f) {\r\n                                switch (_f.label) {\r\n                                    case 0:\r\n                                        _f.trys.push([0, 14, , 15]);\r\n                                        if (!url.startsWith(\"data:\"))\r\n                                            return [3, 1];\r\n                                        _a = url;\r\n                                        return [3, 3];\r\n                                    case 1:\r\n                                        return [4, getDataURL(url)];\r\n                                    case 2:\r\n                                        _a = _f.sent();\r\n                                        _f.label = 3;\r\n                                    case 3:\r\n                                        dataURL_1 = _a;\r\n                                        if (\r\n                                            !(\r\n                                                (_d =\r\n                                                    tryConvertDataURLToBlobSync(\r\n                                                        dataURL_1\r\n                                                    )) !== null && _d !== void 0\r\n                                            )\r\n                                        )\r\n                                            return [3, 4];\r\n                                        _b = _d;\r\n                                        return [3, 6];\r\n                                    case 4:\r\n                                        return [4, loadAsBlob(url)];\r\n                                    case 5:\r\n                                        _b = _f.sent();\r\n                                        _f.label = 6;\r\n                                    case 6:\r\n                                        blob_1 = _b;\r\n                                        if (\r\n                                            !dataURL_1.startsWith(\r\n                                                \"data:image/svg+xml\"\r\n                                            )\r\n                                        )\r\n                                            return [3, 8];\r\n                                        return [4, loadImage(dataURL_1)];\r\n                                    case 7:\r\n                                        image_1 = _f.sent();\r\n                                        return [3, 13];\r\n                                    case 8:\r\n                                        return [\r\n                                            4,\r\n                                            tryCreateImageBitmap(blob_1)\r\n                                        ];\r\n                                    case 9:\r\n                                        if (\r\n                                            !(\r\n                                                (_e = _f.sent()) !== null &&\r\n                                                _e !== void 0\r\n                                            )\r\n                                        )\r\n                                            return [3, 10];\r\n                                        _c = _e;\r\n                                        return [3, 12];\r\n                                    case 10:\r\n                                        return [4, loadImage(dataURL_1)];\r\n                                    case 11:\r\n                                        _c = _f.sent();\r\n                                        _f.label = 12;\r\n                                    case 12:\r\n                                        image_1 = _c;\r\n                                        _f.label = 13;\r\n                                    case 13:\r\n                                        imageManager.addTask(function () {\r\n                                            var analysis =\r\n                                                analyzeImage(image_1);\r\n                                            resolve(\r\n                                                __assign(\r\n                                                    {\r\n                                                        src: url,\r\n                                                        blob: blob_1,\r\n                                                        dataURL: dataURL_1,\r\n                                                        width: image_1.width,\r\n                                                        height: image_1.height\r\n                                                    },\r\n                                                    analysis\r\n                                                )\r\n                                            );\r\n                                        });\r\n                                        return [3, 15];\r\n                                    case 14:\r\n                                        error_1 = _f.sent();\r\n                                        reject(error_1);\r\n                                        return [3, 15];\r\n                                    case 15:\r\n                                        return [2];\r\n                                }\r\n                            });\r\n                        });\r\n                    })\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    function getDataURL(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parsedURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        parsedURL = new URL(url);\r\n                        if (!(parsedURL.origin === location.origin))\r\n                            return [3, 2];\r\n                        return [4, loadAsDataURL(url)];\r\n                    case 1:\r\n                        return [2, _a.sent()];\r\n                    case 2:\r\n                        return [\r\n                            4,\r\n                            bgFetch({url: url, responseType: \"data-url\"})\r\n                        ];\r\n                    case 3:\r\n                        return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function tryCreateImageBitmap(blob) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var err_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, 2, , 3]);\r\n                        return [4, createImageBitmap(blob)];\r\n                    case 1:\r\n                        return [2, _a.sent()];\r\n                    case 2:\r\n                        err_1 = _a.sent();\r\n                        logWarn(\r\n                            \"Unable to create image bitmap for type \"\r\n                                .concat(blob.type, \": \")\r\n                                .concat(String(err_1))\r\n                        );\r\n                        return [2, null];\r\n                    case 3:\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var INCOMPLETE_DOC_LOADING_IMAGE_LIMIT = 256;\r\n    var loadingImagesCount = 0;\r\n    function loadImage(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [\r\n                    2,\r\n                    new Promise(function (resolve, reject) {\r\n                        var image = new Image();\r\n                        image.onload = function () {\r\n                            return resolve(image);\r\n                        };\r\n                        image.onerror = function () {\r\n                            return reject(\"Unable to load image \".concat(url));\r\n                        };\r\n                        if (\r\n                            ++loadingImagesCount <=\r\n                                INCOMPLETE_DOC_LOADING_IMAGE_LIMIT ||\r\n                            isReadyStateComplete()\r\n                        ) {\r\n                            image.src = url;\r\n                        } else {\r\n                            addReadyStateCompleteListener(function () {\r\n                                return (image.src = url);\r\n                            });\r\n                        }\r\n                    })\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    var MAX_ANALYSIS_PIXELS_COUNT = 32 * 32;\r\n    var canvas;\r\n    var context;\r\n    function createCanvas() {\r\n        var maxWidth = MAX_ANALYSIS_PIXELS_COUNT;\r\n        var maxHeight = MAX_ANALYSIS_PIXELS_COUNT;\r\n        canvas = document.createElement(\"canvas\");\r\n        canvas.width = maxWidth;\r\n        canvas.height = maxHeight;\r\n        context = canvas.getContext(\"2d\", {willReadFrequently: true});\r\n        context.imageSmoothingEnabled = false;\r\n    }\r\n    function removeCanvas() {\r\n        canvas = null;\r\n        context = null;\r\n    }\r\n    var LARGE_IMAGE_PIXELS_COUNT = 512 * 512;\r\n    function analyzeImage(image) {\r\n        if (!canvas) {\r\n            createCanvas();\r\n        }\r\n        var sw;\r\n        var sh;\r\n        if (image instanceof HTMLImageElement) {\r\n            sw = image.naturalWidth;\r\n            sh = image.naturalHeight;\r\n        } else {\r\n            sw = image.width;\r\n            sh = image.height;\r\n        }\r\n        if (sw === 0 || sh === 0) {\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: false,\r\n                isTooLarge: false\r\n            };\r\n        }\r\n        if (sw * sh > LARGE_IMAGE_PIXELS_COUNT) {\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: true\r\n            };\r\n        }\r\n        var sourcePixelsCount = sw * sh;\r\n        var k = Math.min(\r\n            1,\r\n            Math.sqrt(MAX_ANALYSIS_PIXELS_COUNT / sourcePixelsCount)\r\n        );\r\n        var width = Math.ceil(sw * k);\r\n        var height = Math.ceil(sh * k);\r\n        context.clearRect(0, 0, width, height);\r\n        context.drawImage(image, 0, 0, sw, sh, 0, 0, width, height);\r\n        var imageData = context.getImageData(0, 0, width, height);\r\n        var d = imageData.data;\r\n        var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\r\n        var DARK_LIGHTNESS_THRESHOLD = 0.4;\r\n        var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\r\n        var transparentPixelsCount = 0;\r\n        var darkPixelsCount = 0;\r\n        var lightPixelsCount = 0;\r\n        var i, x, y;\r\n        var r, g, b, a;\r\n        var l;\r\n        for (y = 0; y < height; y++) {\r\n            for (x = 0; x < width; x++) {\r\n                i = 4 * (y * width + x);\r\n                r = d[i + 0];\r\n                g = d[i + 1];\r\n                b = d[i + 2];\r\n                a = d[i + 3];\r\n                if (a / 255 < TRANSPARENT_ALPHA_THRESHOLD) {\r\n                    transparentPixelsCount++;\r\n                } else {\r\n                    l = getSRGBLightness(r, g, b);\r\n                    if (l < DARK_LIGHTNESS_THRESHOLD) {\r\n                        darkPixelsCount++;\r\n                    }\r\n                    if (l > LIGHT_LIGHTNESS_THRESHOLD) {\r\n                        lightPixelsCount++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var totalPixelsCount = width * height;\r\n        var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\r\n        var DARK_IMAGE_THRESHOLD = 0.7;\r\n        var LIGHT_IMAGE_THRESHOLD = 0.7;\r\n        var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\r\n        return {\r\n            isDark: darkPixelsCount / opaquePixelsCount >= DARK_IMAGE_THRESHOLD,\r\n            isLight:\r\n                lightPixelsCount / opaquePixelsCount >= LIGHT_IMAGE_THRESHOLD,\r\n            isTransparent:\r\n                transparentPixelsCount / totalPixelsCount >=\r\n                TRANSPARENT_IMAGE_THRESHOLD,\r\n            isLarge: false\r\n        };\r\n    }\r\n    var isBlobURLSupported = null;\r\n    var canUseProxy = false;\r\n    var blobURLCheckRequested = false;\r\n    var blobURLCheckAwaiters = [];\r\n    document.addEventListener(\r\n        \"__darkreader__inlineScriptsAllowed\",\r\n        function () {\r\n            return (canUseProxy = true);\r\n        },\r\n        {once: true}\r\n    );\r\n    function requestBlobURLCheck() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!canUseProxy) {\r\n                            return [2];\r\n                        }\r\n                        if (!blobURLCheckRequested) return [3, 2];\r\n                        return [\r\n                            4,\r\n                            new Promise(function (resolve) {\r\n                                return blobURLCheckAwaiters.push(resolve);\r\n                            })\r\n                        ];\r\n                    case 1:\r\n                        return [2, _a.sent()];\r\n                    case 2:\r\n                        blobURLCheckRequested = true;\r\n                        return [\r\n                            4,\r\n                            new Promise(function (resolve) {\r\n                                document.addEventListener(\r\n                                    \"__darkreader__blobURLCheckResponse\",\r\n                                    function (e) {\r\n                                        isBlobURLSupported =\r\n                                            e.detail.blobURLAllowed;\r\n                                        resolve();\r\n                                        blobURLCheckAwaiters.forEach(\r\n                                            function (r) {\r\n                                                return r();\r\n                                            }\r\n                                        );\r\n                                        blobURLCheckAwaiters.splice(0);\r\n                                    },\r\n                                    {once: true}\r\n                                );\r\n                                document.dispatchEvent(\r\n                                    new CustomEvent(\r\n                                        \"__darkreader__blobURLCheckRequest\"\r\n                                    )\r\n                                );\r\n                            })\r\n                        ];\r\n                    case 3:\r\n                        _a.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function isBlobURLCheckResultReady() {\r\n        return isBlobURLSupported != null || !canUseProxy;\r\n    }\r\n    function onCSPError(err) {\r\n        if (err.blockedURI === \"blob\") {\r\n            isBlobURLSupported = false;\r\n            document.removeEventListener(\"securitypolicyviolation\", onCSPError);\r\n        }\r\n    }\r\n    document.addEventListener(\"securitypolicyviolation\", onCSPError);\r\n    var objectURLs = new Set();\r\n    function getFilteredImageURL(_a, theme) {\r\n        var dataURL = _a.dataURL,\r\n            width = _a.width,\r\n            height = _a.height;\r\n        if (dataURL.startsWith(\"data:image/svg+xml\")) {\r\n            dataURL = escapeXML(dataURL);\r\n        }\r\n        var matrix = getSVGFilterMatrixValue(theme);\r\n        var svg = [\r\n            '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"'\r\n                .concat(width, '\" height=\"')\r\n                .concat(height, '\">'),\r\n            \"<defs>\",\r\n            '<filter id=\"darkreader-image-filter\">',\r\n            '<feColorMatrix type=\"matrix\" values=\"'.concat(matrix, '\" />'),\r\n            \"</filter>\",\r\n            \"</defs>\",\r\n            '<image width=\"'\r\n                .concat(width, '\" height=\"')\r\n                .concat(\r\n                    height,\r\n                    '\" filter=\"url(#darkreader-image-filter)\" xlink:href=\"'\r\n                )\r\n                .concat(dataURL, '\" />'),\r\n            \"</svg>\"\r\n        ].join(\"\");\r\n        if (!isBlobURLSupported) {\r\n            return \"data:image/svg+xml;base64,\".concat(btoa(svg));\r\n        }\r\n        var bytes = new Uint8Array(svg.length);\r\n        for (var i = 0; i < svg.length; i++) {\r\n            bytes[i] = svg.charCodeAt(i);\r\n        }\r\n        var blob = new Blob([bytes], {type: \"image/svg+xml\"});\r\n        var objectURL = URL.createObjectURL(blob);\r\n        objectURLs.add(objectURL);\r\n        return objectURL;\r\n    }\r\n    var xmlEscapeChars = {\r\n        \"<\": \"&lt;\",\r\n        \">\": \"&gt;\",\r\n        \"&\": \"&amp;\",\r\n        \"'\": \"&apos;\",\r\n        '\"': \"&quot;\"\r\n    };\r\n    function escapeXML(str) {\r\n        return str.replace(/[<>&'\"]/g, function (c) {\r\n            var _a;\r\n            return (_a = xmlEscapeChars[c]) !== null && _a !== void 0 ? _a : c;\r\n        });\r\n    }\r\n    var dataURLBlobURLs = new Map();\r\n    function tryConvertDataURLToBlobSync(dataURL) {\r\n        var colonIndex = dataURL.indexOf(\":\");\r\n        var semicolonIndex = dataURL.indexOf(\";\", colonIndex + 1);\r\n        var commaIndex = dataURL.indexOf(\",\", semicolonIndex + 1);\r\n        var encoding = dataURL\r\n            .substring(semicolonIndex + 1, commaIndex)\r\n            .toLocaleLowerCase();\r\n        var mediaType = dataURL.substring(colonIndex + 1, semicolonIndex);\r\n        if (encoding !== \"base64\" || !mediaType) {\r\n            return null;\r\n        }\r\n        var characters = atob(dataURL.substring(commaIndex + 1));\r\n        var bytes = new Uint8Array(characters.length);\r\n        for (var i = 0; i < characters.length; i++) {\r\n            bytes[i] = characters.charCodeAt(i);\r\n        }\r\n        return new Blob([bytes], {type: mediaType});\r\n    }\r\n    function tryConvertDataURLToBlobURL(dataURL) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var blobURL, blob, response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!isBlobURLSupported) {\r\n                            return [2, null];\r\n                        }\r\n                        blobURL = dataURLBlobURLs.get(dataURL);\r\n                        if (blobURL) {\r\n                            return [2, blobURL];\r\n                        }\r\n                        blob = tryConvertDataURLToBlobSync(dataURL);\r\n                        if (!!blob) return [3, 3];\r\n                        return [4, fetch(dataURL)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [4, response.blob()];\r\n                    case 2:\r\n                        blob = _a.sent();\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        blobURL = URL.createObjectURL(blob);\r\n                        dataURLBlobURLs.set(dataURL, blobURL);\r\n                        return [2, blobURL];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function cleanImageProcessingCache() {\r\n        imageManager && imageManager.stop();\r\n        removeCanvas();\r\n        objectURLs.forEach(function (u) {\r\n            return URL.revokeObjectURL(u);\r\n        });\r\n        objectURLs.clear();\r\n        dataURLBlobURLs.forEach(function (u) {\r\n            return URL.revokeObjectURL(u);\r\n        });\r\n        dataURLBlobURLs.clear();\r\n    }\r\n\r\n    var gradientLength = \"gradient\".length;\r\n    var conicGradient = \"conic-\";\r\n    var conicGradientLength = conicGradient.length;\r\n    var radialGradient = \"radial-\";\r\n    var linearGradient = \"linear-\";\r\n    function parseGradient(value) {\r\n        var result = [];\r\n        var index = 0;\r\n        var startIndex = conicGradient.length;\r\n        var _loop_1 = function () {\r\n            var typeGradient;\r\n            [linearGradient, radialGradient, conicGradient].find(\r\n                function (possibleType) {\r\n                    if (index - possibleType.length >= 0) {\r\n                        var possibleGradient = value.substring(\r\n                            index - possibleType.length,\r\n                            index\r\n                        );\r\n                        if (possibleGradient === possibleType) {\r\n                            if (\r\n                                value.slice(\r\n                                    index - possibleType.length - 10,\r\n                                    index - possibleType.length - 1\r\n                                ) === \"repeating\"\r\n                            ) {\r\n                                typeGradient = \"repeating-\".concat(\r\n                                    possibleType,\r\n                                    \"gradient\"\r\n                                );\r\n                                return true;\r\n                            }\r\n                            if (\r\n                                value.slice(\r\n                                    index - possibleType.length - 8,\r\n                                    index - possibleType.length - 1\r\n                                ) === \"-webkit\"\r\n                            ) {\r\n                                typeGradient = \"-webkit-\".concat(\r\n                                    possibleType,\r\n                                    \"gradient\"\r\n                                );\r\n                                return true;\r\n                            }\r\n                            typeGradient = \"\".concat(possibleType, \"gradient\");\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n            if (!typeGradient) {\r\n                return \"break\";\r\n            }\r\n            var _a = getParenthesesRange(value, index + gradientLength),\r\n                start = _a.start,\r\n                end = _a.end;\r\n            var match = value.substring(start + 1, end - 1);\r\n            startIndex = end + 1 + conicGradientLength;\r\n            result.push({\r\n                typeGradient: typeGradient,\r\n                match: match,\r\n                offset: typeGradient.length + 2,\r\n                index: index - typeGradient.length + gradientLength,\r\n                hasComma: true\r\n            });\r\n        };\r\n        while ((index = value.indexOf(\"gradient\", startIndex)) !== -1) {\r\n            var state_1 = _loop_1();\r\n            if (state_1 === \"break\") break;\r\n        }\r\n        if (result.length) {\r\n            result[result.length - 1].hasComma = false;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function getPriority(ruleStyle, property) {\r\n        return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\r\n    }\r\n    function getModifiableCSSDeclaration(\r\n        property,\r\n        value,\r\n        rule,\r\n        variablesStore,\r\n        ignoreImageSelectors,\r\n        isCancelled\r\n    ) {\r\n        if (property.startsWith(\"--\")) {\r\n            var modifier = getVariableModifier(\r\n                variablesStore,\r\n                property,\r\n                value,\r\n                rule,\r\n                ignoreImageSelectors,\r\n                isCancelled\r\n            );\r\n            if (modifier) {\r\n                return {\r\n                    property: property,\r\n                    value: modifier,\r\n                    important: getPriority(rule.style, property),\r\n                    sourceValue: value\r\n                };\r\n            }\r\n        } else if (value.includes(\"var(\")) {\r\n            var modifier = getVariableDependantModifier(\r\n                variablesStore,\r\n                property,\r\n                value\r\n            );\r\n            if (modifier) {\r\n                return {\r\n                    property: property,\r\n                    value: modifier,\r\n                    important: getPriority(rule.style, property),\r\n                    sourceValue: value\r\n                };\r\n            }\r\n        } else if (property === \"color-scheme\") {\r\n            return null;\r\n        } else if (\r\n            (property.includes(\"color\") &&\r\n                property !== \"-webkit-print-color-adjust\") ||\r\n            property === \"fill\" ||\r\n            property === \"stroke\" ||\r\n            property === \"stop-color\"\r\n        ) {\r\n            var modifier = getColorModifier(property, value, rule);\r\n            if (modifier) {\r\n                return {\r\n                    property: property,\r\n                    value: modifier,\r\n                    important: getPriority(rule.style, property),\r\n                    sourceValue: value\r\n                };\r\n            }\r\n        } else if (\r\n            property === \"background-image\" ||\r\n            property === \"list-style-image\"\r\n        ) {\r\n            var modifier = getBgImageModifier(\r\n                value,\r\n                rule,\r\n                ignoreImageSelectors,\r\n                isCancelled\r\n            );\r\n            if (modifier) {\r\n                return {\r\n                    property: property,\r\n                    value: modifier,\r\n                    important: getPriority(rule.style, property),\r\n                    sourceValue: value\r\n                };\r\n            }\r\n        } else if (property.includes(\"shadow\")) {\r\n            var modifier = getShadowModifier(value);\r\n            if (modifier) {\r\n                return {\r\n                    property: property,\r\n                    value: modifier,\r\n                    important: getPriority(rule.style, property),\r\n                    sourceValue: value\r\n                };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function joinSelectors() {\r\n        var selectors = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            selectors[_i] = arguments[_i];\r\n        }\r\n        return selectors.filter(Boolean).join(\", \");\r\n    }\r\n    function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\r\n        var lines = [];\r\n        if (!isIFrame) {\r\n            lines.push(\"html {\");\r\n            lines.push(\r\n                \"    background-color: \".concat(\r\n                    modifyBackgroundColor({r: 255, g: 255, b: 255}, theme),\r\n                    \" !important;\"\r\n                )\r\n            );\r\n            lines.push(\"}\");\r\n        }\r\n        if (isCSSColorSchemePropSupported) {\r\n            lines.push(\"html {\");\r\n            lines.push(\r\n                \"    color-scheme: \".concat(\r\n                    theme.mode === 1 ? \"dark\" : \"dark light\",\r\n                    \" !important;\"\r\n                )\r\n            );\r\n            lines.push(\"}\");\r\n        }\r\n        var bgSelectors = joinSelectors(\r\n            isIFrame ? \"\" : \"html, body\",\r\n            styleSystemControls ? \"input, textarea, select, button, dialog\" : \"\"\r\n        );\r\n        if (bgSelectors) {\r\n            lines.push(\"\".concat(bgSelectors, \" {\"));\r\n            lines.push(\r\n                \"    background-color: \".concat(\r\n                    modifyBackgroundColor({r: 255, g: 255, b: 255}, theme),\r\n                    \";\"\r\n                )\r\n            );\r\n            lines.push(\"}\");\r\n        }\r\n        lines.push(\r\n            \"\".concat(\r\n                joinSelectors(\r\n                    \"html, body\",\r\n                    styleSystemControls ? \"input, textarea, select, button\" : \"\"\r\n                ),\r\n                \" {\"\r\n            )\r\n        );\r\n        lines.push(\r\n            \"    border-color: \".concat(\r\n                modifyBorderColor({r: 76, g: 76, b: 76}, theme),\r\n                \";\"\r\n            )\r\n        );\r\n        lines.push(\r\n            \"    color: \".concat(\r\n                modifyForegroundColor({r: 0, g: 0, b: 0}, theme),\r\n                \";\"\r\n            )\r\n        );\r\n        lines.push(\"}\");\r\n        lines.push(\"a {\");\r\n        lines.push(\r\n            \"    color: \".concat(\r\n                modifyForegroundColor({r: 0, g: 64, b: 255}, theme),\r\n                \";\"\r\n            )\r\n        );\r\n        lines.push(\"}\");\r\n        lines.push(\"table {\");\r\n        lines.push(\r\n            \"    border-color: \".concat(\r\n                modifyBorderColor({r: 128, g: 128, b: 128}, theme),\r\n                \";\"\r\n            )\r\n        );\r\n        lines.push(\"}\");\r\n        lines.push(\"::placeholder {\");\r\n        lines.push(\r\n            \"    color: \".concat(\r\n                modifyForegroundColor({r: 169, g: 169, b: 169}, theme),\r\n                \";\"\r\n            )\r\n        );\r\n        lines.push(\"}\");\r\n        lines.push(\"input:-webkit-autofill,\");\r\n        lines.push(\"textarea:-webkit-autofill,\");\r\n        lines.push(\"select:-webkit-autofill {\");\r\n        lines.push(\r\n            \"    background-color: \".concat(\r\n                modifyBackgroundColor({r: 250, g: 255, b: 189}, theme),\r\n                \" !important;\"\r\n            )\r\n        );\r\n        lines.push(\r\n            \"    color: \".concat(\r\n                modifyForegroundColor({r: 0, g: 0, b: 0}, theme),\r\n                \" !important;\"\r\n            )\r\n        );\r\n        lines.push(\"}\");\r\n        if (theme.scrollbarColor) {\r\n            lines.push(getModifiedScrollbarStyle(theme));\r\n        }\r\n        if (theme.selectionColor) {\r\n            lines.push(getModifiedSelectionStyle(theme));\r\n        }\r\n        return lines.join(\"\\n\");\r\n    }\r\n    function getSelectionColor(theme) {\r\n        var backgroundColorSelection;\r\n        var foregroundColorSelection;\r\n        if (theme.selectionColor === \"auto\") {\r\n            backgroundColorSelection = modifyBackgroundColor(\r\n                {r: 0, g: 96, b: 212},\r\n                __assign(__assign({}, theme), {grayscale: 0})\r\n            );\r\n            foregroundColorSelection = modifyForegroundColor(\r\n                {r: 255, g: 255, b: 255},\r\n                __assign(__assign({}, theme), {grayscale: 0})\r\n            );\r\n        } else {\r\n            var rgb = parseColorWithCache(theme.selectionColor);\r\n            var hsl = rgbToHSL(rgb);\r\n            backgroundColorSelection = theme.selectionColor;\r\n            if (hsl.l < 0.5) {\r\n                foregroundColorSelection = \"#FFF\";\r\n            } else {\r\n                foregroundColorSelection = \"#000\";\r\n            }\r\n        }\r\n        return {\r\n            backgroundColorSelection: backgroundColorSelection,\r\n            foregroundColorSelection: foregroundColorSelection\r\n        };\r\n    }\r\n    function getModifiedSelectionStyle(theme) {\r\n        var lines = [];\r\n        var modifiedSelectionColor = getSelectionColor(theme);\r\n        var backgroundColorSelection =\r\n            modifiedSelectionColor.backgroundColorSelection;\r\n        var foregroundColorSelection =\r\n            modifiedSelectionColor.foregroundColorSelection;\r\n        [\"::selection\", \"::-moz-selection\"].forEach(function (selection) {\r\n            lines.push(\"\".concat(selection, \" {\"));\r\n            lines.push(\r\n                \"    background-color: \".concat(\r\n                    backgroundColorSelection,\r\n                    \" !important;\"\r\n                )\r\n            );\r\n            lines.push(\r\n                \"    color: \".concat(foregroundColorSelection, \" !important;\")\r\n            );\r\n            lines.push(\"}\");\r\n        });\r\n        return lines.join(\"\\n\");\r\n    }\r\n    function getModifiedScrollbarStyle(theme) {\r\n        var lines = [];\r\n        var colorTrack;\r\n        var colorIcons;\r\n        var colorThumb;\r\n        var colorThumbHover;\r\n        var colorThumbActive;\r\n        var colorCorner;\r\n        if (theme.scrollbarColor === \"auto\") {\r\n            colorTrack = modifyBackgroundColor({r: 241, g: 241, b: 241}, theme);\r\n            colorIcons = modifyForegroundColor({r: 96, g: 96, b: 96}, theme);\r\n            colorThumb = modifyBackgroundColor({r: 176, g: 176, b: 176}, theme);\r\n            colorThumbHover = modifyBackgroundColor(\r\n                {r: 144, g: 144, b: 144},\r\n                theme\r\n            );\r\n            colorThumbActive = modifyBackgroundColor(\r\n                {r: 96, g: 96, b: 96},\r\n                theme\r\n            );\r\n            colorCorner = modifyBackgroundColor(\r\n                {r: 255, g: 255, b: 255},\r\n                theme\r\n            );\r\n        } else {\r\n            var rgb = parseColorWithCache(theme.scrollbarColor);\r\n            var hsl_1 = rgbToHSL(rgb);\r\n            var isLight = hsl_1.l > 0.5;\r\n            var lighten = function (lighter) {\r\n                return __assign(__assign({}, hsl_1), {\r\n                    l: clamp(hsl_1.l + lighter, 0, 1)\r\n                });\r\n            };\r\n            var darken = function (darker) {\r\n                return __assign(__assign({}, hsl_1), {\r\n                    l: clamp(hsl_1.l - darker, 0, 1)\r\n                });\r\n            };\r\n            colorTrack = hslToString(darken(0.4));\r\n            colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\r\n            colorThumb = hslToString(hsl_1);\r\n            colorThumbHover = hslToString(lighten(0.1));\r\n            colorThumbActive = hslToString(lighten(0.2));\r\n            colorCorner = hslToString(darken(0.5));\r\n        }\r\n        lines.push(\"::-webkit-scrollbar {\");\r\n        lines.push(\"    background-color: \".concat(colorTrack, \";\"));\r\n        lines.push(\"    color: \".concat(colorIcons, \";\"));\r\n        lines.push(\"}\");\r\n        lines.push(\"::-webkit-scrollbar-thumb {\");\r\n        lines.push(\"    background-color: \".concat(colorThumb, \";\"));\r\n        lines.push(\"}\");\r\n        lines.push(\"::-webkit-scrollbar-thumb:hover {\");\r\n        lines.push(\"    background-color: \".concat(colorThumbHover, \";\"));\r\n        lines.push(\"}\");\r\n        lines.push(\"::-webkit-scrollbar-thumb:active {\");\r\n        lines.push(\"    background-color: \".concat(colorThumbActive, \";\"));\r\n        lines.push(\"}\");\r\n        lines.push(\"::-webkit-scrollbar-corner {\");\r\n        lines.push(\"    background-color: \".concat(colorCorner, \";\"));\r\n        lines.push(\"}\");\r\n        if (isFirefox) {\r\n            lines.push(\"* {\");\r\n            lines.push(\r\n                \"    scrollbar-color: \"\r\n                    .concat(colorThumb, \" \")\r\n                    .concat(colorTrack, \";\")\r\n            );\r\n            lines.push(\"}\");\r\n        }\r\n        return lines.join(\"\\n\");\r\n    }\r\n    function getModifiedFallbackStyle(filter, _a) {\r\n        var strict = _a.strict;\r\n        var factory = defaultFallbackFactory;\r\n        return factory(filter, {strict: strict});\r\n    }\r\n    function defaultFallbackFactory(filter, _a) {\r\n        var strict = _a.strict;\r\n        var lines = [];\r\n        var isMicrosoft = [\"microsoft.com\", \"docs.microsoft.com\"].includes(\r\n            location.hostname\r\n        );\r\n        lines.push(\r\n            \"html, body, \".concat(\r\n                strict\r\n                    ? \"body :not(iframe)\".concat(\r\n                          isMicrosoft\r\n                              ? ':not(div[style^=\"position:absolute;top:0;left:-\"]'\r\n                              : \"\"\r\n                      )\r\n                    : \"body > :not(iframe)\",\r\n                \" {\"\r\n            )\r\n        );\r\n        lines.push(\r\n            \"    background-color: \".concat(\r\n                modifyBackgroundColor({r: 255, g: 255, b: 255}, filter),\r\n                \" !important;\"\r\n            )\r\n        );\r\n        lines.push(\r\n            \"    border-color: \".concat(\r\n                modifyBorderColor({r: 64, g: 64, b: 64}, filter),\r\n                \" !important;\"\r\n            )\r\n        );\r\n        lines.push(\r\n            \"    color: \".concat(\r\n                modifyForegroundColor({r: 0, g: 0, b: 0}, filter),\r\n                \" !important;\"\r\n            )\r\n        );\r\n        lines.push(\"}\");\r\n        return lines.join(\"\\n\");\r\n    }\r\n    var unparsableColors = new Set([\r\n        \"inherit\",\r\n        \"transparent\",\r\n        \"initial\",\r\n        \"currentcolor\",\r\n        \"none\",\r\n        \"unset\"\r\n    ]);\r\n    function getColorModifier(prop, value, rule) {\r\n        if (unparsableColors.has(value.toLowerCase())) {\r\n            return value;\r\n        }\r\n        var rgb = parseColorWithCache(value);\r\n        if (!rgb) {\r\n            return null;\r\n        }\r\n        if (prop.includes(\"background\")) {\r\n            if (\r\n                (rule.style.webkitMaskImage &&\r\n                    rule.style.webkitMaskImage !== \"none\") ||\r\n                (rule.style.webkitMask &&\r\n                    !rule.style.webkitMask.startsWith(\"none\")) ||\r\n                (rule.style.mask && rule.style.mask !== \"none\") ||\r\n                (rule.style.getPropertyValue(\"mask-image\") &&\r\n                    rule.style.getPropertyValue(\"mask-image\") !== \"none\")\r\n            ) {\r\n                return function (filter) {\r\n                    return modifyForegroundColor(rgb, filter);\r\n                };\r\n            }\r\n            return function (filter) {\r\n                return modifyBackgroundColor(rgb, filter);\r\n            };\r\n        }\r\n        if (prop.includes(\"border\") || prop.includes(\"outline\")) {\r\n            return function (filter) {\r\n                return modifyBorderColor(rgb, filter);\r\n            };\r\n        }\r\n        return function (filter) {\r\n            return modifyForegroundColor(rgb, filter);\r\n        };\r\n    }\r\n    var imageDetailsCache = new Map();\r\n    var awaitingForImageLoading = new Map();\r\n    function shouldIgnoreImage(selectorText, selectors) {\r\n        if (!selectorText || selectors.length === 0) {\r\n            return false;\r\n        }\r\n        if (\r\n            selectors.some(function (s) {\r\n                return s === \"*\";\r\n            })\r\n        ) {\r\n            return true;\r\n        }\r\n        var ruleSelectors = selectorText.split(/,\\s*/g);\r\n        var _loop_1 = function (i) {\r\n            var ignoredSelector = selectors[i];\r\n            if (\r\n                ruleSelectors.some(function (s) {\r\n                    return s === ignoredSelector;\r\n                })\r\n            ) {\r\n                return {value: true};\r\n            }\r\n        };\r\n        for (var i = 0; i < selectors.length; i++) {\r\n            var state_1 = _loop_1(i);\r\n            if (typeof state_1 === \"object\") return state_1.value;\r\n        }\r\n        return false;\r\n    }\r\n    function getBgImageModifier(\r\n        value,\r\n        rule,\r\n        ignoreImageSelectors,\r\n        isCancelled\r\n    ) {\r\n        var _this = this;\r\n        try {\r\n            var gradients = parseGradient(value);\r\n            var urls = getMatches(cssURLRegex, value);\r\n            if (urls.length === 0 && gradients.length === 0) {\r\n                return value;\r\n            }\r\n            var getIndices = function (matches) {\r\n                var index = 0;\r\n                return matches.map(function (match) {\r\n                    var valueIndex = value.indexOf(match, index);\r\n                    index = valueIndex + match.length;\r\n                    return {match: match, index: valueIndex};\r\n                });\r\n            };\r\n            var matches_1 = gradients\r\n                .map(function (i) {\r\n                    return __assign({type: \"gradient\"}, i);\r\n                })\r\n                .concat(\r\n                    getIndices(urls).map(function (i) {\r\n                        return __assign({type: \"url\", offset: 0}, i);\r\n                    })\r\n                )\r\n                .sort(function (a, b) {\r\n                    return a.index > b.index ? 1 : -1;\r\n                });\r\n            var getGradientModifier_1 = function (gradient) {\r\n                var typeGradient = gradient.typeGradient,\r\n                    match = gradient.match,\r\n                    hasComma = gradient.hasComma;\r\n                var partsRegex =\r\n                    /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?([^\\(\\), ]|( (?!calc)))*),?/g;\r\n                var colorStopRegex =\r\n                    /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\r\n                var parts = getMatches(partsRegex, match, 1).map(\r\n                    function (part) {\r\n                        part = part.trim();\r\n                        var rgb = parseColorWithCache(part);\r\n                        if (rgb) {\r\n                            return function (filter) {\r\n                                return modifyGradientColor(rgb, filter);\r\n                            };\r\n                        }\r\n                        var space = part.lastIndexOf(\" \");\r\n                        rgb = parseColorWithCache(part.substring(0, space));\r\n                        if (rgb) {\r\n                            return function (filter) {\r\n                                return \"\"\r\n                                    .concat(\r\n                                        modifyGradientColor(rgb, filter),\r\n                                        \" \"\r\n                                    )\r\n                                    .concat(part.substring(space + 1));\r\n                            };\r\n                        }\r\n                        var colorStopMatch = part.match(colorStopRegex);\r\n                        if (colorStopMatch) {\r\n                            rgb = parseColorWithCache(colorStopMatch[3]);\r\n                            if (rgb) {\r\n                                return function (filter) {\r\n                                    return \"\"\r\n                                        .concat(colorStopMatch[1], \"(\")\r\n                                        .concat(\r\n                                            colorStopMatch[2]\r\n                                                ? \"\".concat(\r\n                                                      colorStopMatch[2],\r\n                                                      \", \"\r\n                                                  )\r\n                                                : \"\"\r\n                                        )\r\n                                        .concat(\r\n                                            modifyGradientColor(rgb, filter),\r\n                                            \")\"\r\n                                        );\r\n                                };\r\n                            }\r\n                        }\r\n                        return function () {\r\n                            return part;\r\n                        };\r\n                    }\r\n                );\r\n                return function (filter) {\r\n                    return \"\"\r\n                        .concat(typeGradient, \"(\")\r\n                        .concat(\r\n                            parts\r\n                                .map(function (modify) {\r\n                                    return modify(filter);\r\n                                })\r\n                                .join(\", \"),\r\n                            \")\"\r\n                        )\r\n                        .concat(hasComma ? \", \" : \"\");\r\n                };\r\n            };\r\n            var getURLModifier_1 = function (urlValue) {\r\n                var _a;\r\n                if (\r\n                    shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)\r\n                ) {\r\n                    return null;\r\n                }\r\n                var url = getCSSURLValue(urlValue);\r\n                var isURLEmpty = url.length === 0;\r\n                var parentStyleSheet = rule.parentStyleSheet;\r\n                var baseURL =\r\n                    parentStyleSheet && parentStyleSheet.href\r\n                        ? getCSSBaseBath(parentStyleSheet.href)\r\n                        : ((_a = parentStyleSheet.ownerNode) === null ||\r\n                          _a === void 0\r\n                              ? void 0\r\n                              : _a.baseURI) || location.origin;\r\n                url = getAbsoluteURL(baseURL, url);\r\n                return function (filter) {\r\n                    return __awaiter(_this, void 0, void 0, function () {\r\n                        var imageDetails,\r\n                            awaiters_1,\r\n                            err_1,\r\n                            bgImageValue,\r\n                            blobURL;\r\n                        return __generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    if (isURLEmpty) {\r\n                                        return [2, \"url('')\"];\r\n                                    }\r\n                                    imageDetails = null;\r\n                                    if (!imageDetailsCache.has(url))\r\n                                        return [3, 1];\r\n                                    imageDetails = imageDetailsCache.get(url);\r\n                                    return [3, 9];\r\n                                case 1:\r\n                                    _a.trys.push([1, 8, , 9]);\r\n                                    if (!!isBlobURLCheckResultReady())\r\n                                        return [3, 3];\r\n                                    return [4, requestBlobURLCheck()];\r\n                                case 2:\r\n                                    _a.sent();\r\n                                    _a.label = 3;\r\n                                case 3:\r\n                                    if (!awaitingForImageLoading.has(url))\r\n                                        return [3, 5];\r\n                                    awaiters_1 =\r\n                                        awaitingForImageLoading.get(url);\r\n                                    return [\r\n                                        4,\r\n                                        new Promise(function (resolve) {\r\n                                            return awaiters_1.push(resolve);\r\n                                        })\r\n                                    ];\r\n                                case 4:\r\n                                    imageDetails = _a.sent();\r\n                                    if (!imageDetails) {\r\n                                        return [2, null];\r\n                                    }\r\n                                    return [3, 7];\r\n                                case 5:\r\n                                    awaitingForImageLoading.set(url, []);\r\n                                    return [4, getImageDetails(url)];\r\n                                case 6:\r\n                                    imageDetails = _a.sent();\r\n                                    imageDetailsCache.set(url, imageDetails);\r\n                                    awaitingForImageLoading\r\n                                        .get(url)\r\n                                        .forEach(function (resolve) {\r\n                                            return resolve(imageDetails);\r\n                                        });\r\n                                    awaitingForImageLoading.delete(url);\r\n                                    _a.label = 7;\r\n                                case 7:\r\n                                    if (isCancelled()) {\r\n                                        return [2, null];\r\n                                    }\r\n                                    return [3, 9];\r\n                                case 8:\r\n                                    err_1 = _a.sent();\r\n                                    logWarn(err_1);\r\n                                    if (awaitingForImageLoading.has(url)) {\r\n                                        awaitingForImageLoading\r\n                                            .get(url)\r\n                                            .forEach(function (resolve) {\r\n                                                return resolve(null);\r\n                                            });\r\n                                        awaitingForImageLoading.delete(url);\r\n                                    }\r\n                                    return [3, 9];\r\n                                case 9:\r\n                                    if (imageDetails) {\r\n                                        bgImageValue = getBgImageValue_1(\r\n                                            imageDetails,\r\n                                            filter\r\n                                        );\r\n                                        if (bgImageValue) {\r\n                                            return [2, bgImageValue];\r\n                                        }\r\n                                    }\r\n                                    if (!url.startsWith(\"data:\"))\r\n                                        return [3, 11];\r\n                                    return [4, tryConvertDataURLToBlobURL(url)];\r\n                                case 10:\r\n                                    blobURL = _a.sent();\r\n                                    if (blobURL) {\r\n                                        return [\r\n                                            2,\r\n                                            'url(\"'.concat(blobURL, '\")')\r\n                                        ];\r\n                                    }\r\n                                    _a.label = 11;\r\n                                case 11:\r\n                                    return [2, 'url(\"'.concat(url, '\")')];\r\n                            }\r\n                        });\r\n                    });\r\n                };\r\n            };\r\n            var getBgImageValue_1 = function (imageDetails, filter) {\r\n                var isDark = imageDetails.isDark,\r\n                    isLight = imageDetails.isLight,\r\n                    isTransparent = imageDetails.isTransparent,\r\n                    isLarge = imageDetails.isLarge,\r\n                    width = imageDetails.width;\r\n                var result;\r\n                var logSrc = imageDetails.src.startsWith(\"data:\")\r\n                    ? \"data:\"\r\n                    : imageDetails.src;\r\n                if (isLarge) {\r\n                    logInfo(\"Not modifying too large image \".concat(logSrc));\r\n                    result = null;\r\n                } else if (\r\n                    isDark &&\r\n                    isTransparent &&\r\n                    filter.mode === 1 &&\r\n                    width > 2\r\n                ) {\r\n                    logInfo(\"Inverting dark image \".concat(logSrc));\r\n                    var inverted = getFilteredImageURL(\r\n                        imageDetails,\r\n                        __assign(__assign({}, filter), {\r\n                            sepia: clamp(filter.sepia + 10, 0, 100)\r\n                        })\r\n                    );\r\n                    result = 'url(\"'.concat(inverted, '\")');\r\n                } else if (isLight && !isTransparent && filter.mode === 1) {\r\n                    logInfo(\"Dimming light image \".concat(logSrc));\r\n                    var dimmed = getFilteredImageURL(imageDetails, filter);\r\n                    result = 'url(\"'.concat(dimmed, '\")');\r\n                } else if (filter.mode === 0 && isLight) {\r\n                    logInfo(\"Applying filter to image \".concat(logSrc));\r\n                    var filtered = getFilteredImageURL(\r\n                        imageDetails,\r\n                        __assign(__assign({}, filter), {\r\n                            brightness: clamp(filter.brightness - 10, 5, 200),\r\n                            sepia: clamp(filter.sepia + 10, 0, 100)\r\n                        })\r\n                    );\r\n                    result = 'url(\"'.concat(filtered, '\")');\r\n                } else {\r\n                    logInfo(\"Not modifying the image \".concat(logSrc));\r\n                    result = null;\r\n                }\r\n                return result;\r\n            };\r\n            var modifiers_1 = [];\r\n            var matchIndex_1 = 0;\r\n            var prevHasComma_1 = false;\r\n            matches_1.forEach(function (_a, i) {\r\n                var type = _a.type,\r\n                    match = _a.match,\r\n                    index = _a.index,\r\n                    typeGradient = _a.typeGradient,\r\n                    hasComma = _a.hasComma,\r\n                    offset = _a.offset;\r\n                var matchStart = index;\r\n                var prefixStart = matchIndex_1;\r\n                var matchEnd = matchStart + match.length + offset;\r\n                matchIndex_1 = matchEnd;\r\n                if (prefixStart !== matchStart) {\r\n                    if (prevHasComma_1) {\r\n                        modifiers_1.push(function () {\r\n                            var betweenValue = value.substring(\r\n                                prefixStart,\r\n                                matchStart\r\n                            );\r\n                            if (betweenValue[0] === \",\") {\r\n                                betweenValue = betweenValue.substring(1);\r\n                            }\r\n                            return betweenValue;\r\n                        });\r\n                    } else {\r\n                        modifiers_1.push(function () {\r\n                            return value.substring(prefixStart, matchStart);\r\n                        });\r\n                    }\r\n                }\r\n                prevHasComma_1 = hasComma || false;\r\n                if (type === \"url\") {\r\n                    modifiers_1.push(getURLModifier_1(match));\r\n                } else if (type === \"gradient\") {\r\n                    modifiers_1.push(\r\n                        getGradientModifier_1({\r\n                            match: match,\r\n                            index: index,\r\n                            typeGradient: typeGradient,\r\n                            hasComma: hasComma || false,\r\n                            offset: offset\r\n                        })\r\n                    );\r\n                }\r\n                if (i === matches_1.length - 1) {\r\n                    modifiers_1.push(function () {\r\n                        return value.substring(matchEnd);\r\n                    });\r\n                }\r\n            });\r\n            return function (filter) {\r\n                var results = modifiers_1\r\n                    .filter(Boolean)\r\n                    .map(function (modify) {\r\n                        return modify(filter);\r\n                    });\r\n                if (\r\n                    results.some(function (r) {\r\n                        return r instanceof Promise;\r\n                    })\r\n                ) {\r\n                    return Promise.all(results).then(function (asyncResults) {\r\n                        return asyncResults.filter(Boolean).join(\"\");\r\n                    });\r\n                }\r\n                var combinedResult = results.join(\"\");\r\n                if (combinedResult.endsWith(\", initial\")) {\r\n                    return combinedResult.slice(0, -9);\r\n                }\r\n                return combinedResult;\r\n            };\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifierWithInfo(value) {\r\n        try {\r\n            var index_1 = 0;\r\n            var colorMatches_1 = getMatches(\r\n                /(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/gi,\r\n                value,\r\n                2\r\n            );\r\n            var notParsed_1 = 0;\r\n            var modifiers_2 = colorMatches_1.map(function (match, i) {\r\n                var prefixIndex = index_1;\r\n                var matchIndex = value.indexOf(match, index_1);\r\n                var matchEnd = matchIndex + match.length;\r\n                index_1 = matchEnd;\r\n                var rgb = parseColorWithCache(match);\r\n                if (!rgb) {\r\n                    notParsed_1++;\r\n                    return function () {\r\n                        return value.substring(prefixIndex, matchEnd);\r\n                    };\r\n                }\r\n                return function (filter) {\r\n                    return \"\"\r\n                        .concat(value.substring(prefixIndex, matchIndex))\r\n                        .concat(modifyShadowColor(rgb, filter))\r\n                        .concat(\r\n                            i === colorMatches_1.length - 1\r\n                                ? value.substring(matchEnd)\r\n                                : \"\"\r\n                        );\r\n                };\r\n            });\r\n            return function (filter) {\r\n                var modified = modifiers_2\r\n                    .map(function (modify) {\r\n                        return modify(filter);\r\n                    })\r\n                    .join(\"\");\r\n                return {\r\n                    matchesLength: colorMatches_1.length,\r\n                    unparseableMatchesLength: notParsed_1,\r\n                    result: modified\r\n                };\r\n            };\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifier(value) {\r\n        var shadowModifier = getShadowModifierWithInfo(value);\r\n        if (!shadowModifier) {\r\n            return null;\r\n        }\r\n        return function (theme) {\r\n            return shadowModifier(theme).result;\r\n        };\r\n    }\r\n    function getVariableModifier(\r\n        variablesStore,\r\n        prop,\r\n        value,\r\n        rule,\r\n        ignoredImgSelectors,\r\n        isCancelled\r\n    ) {\r\n        return variablesStore.getModifierForVariable({\r\n            varName: prop,\r\n            sourceValue: value,\r\n            rule: rule,\r\n            ignoredImgSelectors: ignoredImgSelectors,\r\n            isCancelled: isCancelled\r\n        });\r\n    }\r\n    function getVariableDependantModifier(variablesStore, prop, value) {\r\n        return variablesStore.getModifierForVarDependant(prop, value);\r\n    }\r\n    function cleanModificationCache() {\r\n        clearColorModificationCache();\r\n        imageDetailsCache.clear();\r\n        cleanImageProcessingCache();\r\n        awaitingForImageLoading.clear();\r\n    }\r\n\r\n    var VAR_TYPE_BGCOLOR = 1 << 0;\r\n    var VAR_TYPE_TEXTCOLOR = 1 << 1;\r\n    var VAR_TYPE_BORDERCOLOR = 1 << 2;\r\n    var VAR_TYPE_BGIMG = 1 << 3;\r\n    var VariablesStore = (function () {\r\n        function VariablesStore() {\r\n            this.varTypes = new Map();\r\n            this.rulesQueue = [];\r\n            this.inlineStyleQueue = [];\r\n            this.definedVars = new Set();\r\n            this.varRefs = new Map();\r\n            this.unknownColorVars = new Set();\r\n            this.unknownBgVars = new Set();\r\n            this.undefinedVars = new Set();\r\n            this.initialVarTypes = new Map();\r\n            this.changedTypeVars = new Set();\r\n            this.typeChangeSubscriptions = new Map();\r\n            this.unstableVarValues = new Map();\r\n        }\r\n        VariablesStore.prototype.clear = function () {\r\n            this.varTypes.clear();\r\n            this.rulesQueue.splice(0);\r\n            this.inlineStyleQueue.splice(0);\r\n            this.definedVars.clear();\r\n            this.varRefs.clear();\r\n            this.unknownColorVars.clear();\r\n            this.unknownBgVars.clear();\r\n            this.undefinedVars.clear();\r\n            this.initialVarTypes.clear();\r\n            this.changedTypeVars.clear();\r\n            this.typeChangeSubscriptions.clear();\r\n            this.unstableVarValues.clear();\r\n        };\r\n        VariablesStore.prototype.isVarType = function (varName, typeNum) {\r\n            return (\r\n                this.varTypes.has(varName) &&\r\n                (this.varTypes.get(varName) & typeNum) > 0\r\n            );\r\n        };\r\n        VariablesStore.prototype.addRulesForMatching = function (rules) {\r\n            this.rulesQueue.push(rules);\r\n        };\r\n        VariablesStore.prototype.addInlineStyleForMatching = function (style) {\r\n            this.inlineStyleQueue.push(style);\r\n        };\r\n        VariablesStore.prototype.matchVariablesAndDependents = function () {\r\n            var _this = this;\r\n            if (\r\n                this.rulesQueue.length === 0 &&\r\n                this.inlineStyleQueue.length === 0\r\n            ) {\r\n                return;\r\n            }\r\n            this.changedTypeVars.clear();\r\n            this.initialVarTypes = new Map(this.varTypes);\r\n            this.collectRootVariables();\r\n            this.collectVariablesAndVarDep();\r\n            this.collectRootVarDependents();\r\n            this.varRefs.forEach(function (refs, v) {\r\n                refs.forEach(function (r) {\r\n                    if (_this.varTypes.has(v)) {\r\n                        _this.resolveVariableType(r, _this.varTypes.get(v));\r\n                    }\r\n                });\r\n            });\r\n            this.unknownColorVars.forEach(function (v) {\r\n                if (_this.unknownBgVars.has(v)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                    _this.unknownBgVars.delete(v);\r\n                    _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\r\n                } else if (\r\n                    _this.isVarType(\r\n                        v,\r\n                        VAR_TYPE_BGCOLOR |\r\n                            VAR_TYPE_TEXTCOLOR |\r\n                            VAR_TYPE_BORDERCOLOR\r\n                    )\r\n                ) {\r\n                    _this.unknownColorVars.delete(v);\r\n                } else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.unknownBgVars.forEach(function (v) {\r\n                var hasColor =\r\n                    _this.findVarRef(v, function (ref) {\r\n                        return (\r\n                            _this.unknownColorVars.has(ref) ||\r\n                            _this.isVarType(\r\n                                ref,\r\n                                VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR\r\n                            )\r\n                        );\r\n                    }) != null;\r\n                if (hasColor) {\r\n                    _this.iterateVarRefs(v, function (ref) {\r\n                        _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                    });\r\n                } else if (\r\n                    _this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)\r\n                ) {\r\n                    _this.unknownBgVars.delete(v);\r\n                } else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.changedTypeVars.forEach(function (varName) {\r\n                if (_this.typeChangeSubscriptions.has(varName)) {\r\n                    _this.typeChangeSubscriptions\r\n                        .get(varName)\r\n                        .forEach(function (callback) {\r\n                            callback();\r\n                        });\r\n                }\r\n            });\r\n            this.changedTypeVars.clear();\r\n        };\r\n        VariablesStore.prototype.getModifierForVariable = function (options) {\r\n            var _this = this;\r\n            return function (theme) {\r\n                var varName = options.varName,\r\n                    sourceValue = options.sourceValue,\r\n                    rule = options.rule,\r\n                    ignoredImgSelectors = options.ignoredImgSelectors,\r\n                    isCancelled = options.isCancelled;\r\n                var getDeclarations = function () {\r\n                    var declarations = [];\r\n                    var addModifiedValue = function (\r\n                        typeNum,\r\n                        varNameWrapper,\r\n                        colorModifier\r\n                    ) {\r\n                        if (!_this.isVarType(varName, typeNum)) {\r\n                            return;\r\n                        }\r\n                        var property = varNameWrapper(varName);\r\n                        var modifiedValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            if (isConstructedColorVar(sourceValue)) {\r\n                                var value = insertVarValues(\r\n                                    sourceValue,\r\n                                    _this.unstableVarValues\r\n                                );\r\n                                if (!value) {\r\n                                    value =\r\n                                        typeNum === VAR_TYPE_BGCOLOR\r\n                                            ? \"#ffffff\"\r\n                                            : \"#000000\";\r\n                                }\r\n                                modifiedValue = colorModifier(value, theme);\r\n                            } else {\r\n                                modifiedValue = replaceCSSVariablesNames(\r\n                                    sourceValue,\r\n                                    function (v) {\r\n                                        return varNameWrapper(v);\r\n                                    },\r\n                                    function (fallback) {\r\n                                        return colorModifier(fallback, theme);\r\n                                    }\r\n                                );\r\n                            }\r\n                        } else {\r\n                            modifiedValue = colorModifier(sourceValue, theme);\r\n                        }\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue\r\n                        });\r\n                    };\r\n                    addModifiedValue(\r\n                        VAR_TYPE_BGCOLOR,\r\n                        wrapBgColorVariableName,\r\n                        tryModifyBgColor\r\n                    );\r\n                    addModifiedValue(\r\n                        VAR_TYPE_TEXTCOLOR,\r\n                        wrapTextColorVariableName,\r\n                        tryModifyTextColor\r\n                    );\r\n                    addModifiedValue(\r\n                        VAR_TYPE_BORDERCOLOR,\r\n                        wrapBorderColorVariableName,\r\n                        tryModifyBorderColor\r\n                    );\r\n                    if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\r\n                        var property = wrapBgImgVariableName(varName);\r\n                        var modifiedValue = sourceValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            modifiedValue = replaceCSSVariablesNames(\r\n                                sourceValue,\r\n                                function (v) {\r\n                                    return wrapBgColorVariableName(v);\r\n                                },\r\n                                function (fallback) {\r\n                                    return tryModifyBgColor(fallback, theme);\r\n                                }\r\n                            );\r\n                        }\r\n                        var bgModifier = getBgImageModifier(\r\n                            modifiedValue,\r\n                            rule,\r\n                            ignoredImgSelectors,\r\n                            isCancelled\r\n                        );\r\n                        modifiedValue =\r\n                            typeof bgModifier === \"function\"\r\n                                ? bgModifier(theme)\r\n                                : bgModifier;\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue\r\n                        });\r\n                    }\r\n                    return declarations;\r\n                };\r\n                var callbacks = new Set();\r\n                var addListener = function (onTypeChange) {\r\n                    var callback = function () {\r\n                        var decs = getDeclarations();\r\n                        onTypeChange(decs);\r\n                    };\r\n                    callbacks.add(callback);\r\n                    _this.subscribeForVarTypeChange(varName, callback);\r\n                };\r\n                var removeListeners = function () {\r\n                    callbacks.forEach(function (callback) {\r\n                        _this.unsubscribeFromVariableTypeChanges(\r\n                            varName,\r\n                            callback\r\n                        );\r\n                    });\r\n                };\r\n                return {\r\n                    declarations: getDeclarations(),\r\n                    onTypeChange: {\r\n                        addListener: addListener,\r\n                        removeListeners: removeListeners\r\n                    }\r\n                };\r\n            };\r\n        };\r\n        VariablesStore.prototype.getModifierForVarDependant = function (\r\n            property,\r\n            sourceValue\r\n        ) {\r\n            var _this = this;\r\n            if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\r\n                var isBg_1 = property.startsWith(\"background\");\r\n                var isText_1 = isTextColorProperty(property);\r\n                return function (theme) {\r\n                    var value = insertVarValues(\r\n                        sourceValue,\r\n                        _this.unstableVarValues\r\n                    );\r\n                    if (!value) {\r\n                        value = isBg_1 ? \"#ffffff\" : \"#000000\";\r\n                    }\r\n                    var modifier = isBg_1\r\n                        ? tryModifyBgColor\r\n                        : isText_1\r\n                          ? tryModifyTextColor\r\n                          : tryModifyBorderColor;\r\n                    return modifier(value, theme);\r\n                };\r\n            }\r\n            if (property === \"background-color\") {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(\r\n                        sourceValue,\r\n                        function (v) {\r\n                            return wrapBgColorVariableName(v);\r\n                        },\r\n                        function (fallback) {\r\n                            return tryModifyBgColor(fallback, theme);\r\n                        }\r\n                    );\r\n                };\r\n            }\r\n            if (isTextColorProperty(property)) {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(\r\n                        sourceValue,\r\n                        function (v) {\r\n                            return wrapTextColorVariableName(v);\r\n                        },\r\n                        function (fallback) {\r\n                            return tryModifyTextColor(fallback, theme);\r\n                        }\r\n                    );\r\n                };\r\n            }\r\n            if (\r\n                property === \"background\" ||\r\n                property === \"background-image\" ||\r\n                property === \"box-shadow\"\r\n            ) {\r\n                return function (theme) {\r\n                    var unknownVars = new Set();\r\n                    var modify = function () {\r\n                        var variableReplaced = replaceCSSVariablesNames(\r\n                            sourceValue,\r\n                            function (v) {\r\n                                if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\r\n                                    return wrapBgColorVariableName(v);\r\n                                }\r\n                                if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\r\n                                    return wrapBgImgVariableName(v);\r\n                                }\r\n                                unknownVars.add(v);\r\n                                return v;\r\n                            },\r\n                            function (fallback) {\r\n                                return tryModifyBgColor(fallback, theme);\r\n                            }\r\n                        );\r\n                        if (property === \"box-shadow\") {\r\n                            var shadowModifier =\r\n                                getShadowModifierWithInfo(variableReplaced);\r\n                            var modifiedShadow = shadowModifier(theme);\r\n                            if (\r\n                                modifiedShadow.unparseableMatchesLength !==\r\n                                modifiedShadow.matchesLength\r\n                            ) {\r\n                                return modifiedShadow.result;\r\n                            }\r\n                        }\r\n                        return variableReplaced;\r\n                    };\r\n                    var modified = modify();\r\n                    if (unknownVars.size > 0) {\r\n                        return new Promise(function (resolve) {\r\n                            var firstUnknownVar = unknownVars\r\n                                .values()\r\n                                .next().value;\r\n                            var callback = function () {\r\n                                _this.unsubscribeFromVariableTypeChanges(\r\n                                    firstUnknownVar,\r\n                                    callback\r\n                                );\r\n                                var newValue = modify();\r\n                                resolve(newValue);\r\n                            };\r\n                            _this.subscribeForVarTypeChange(\r\n                                firstUnknownVar,\r\n                                callback\r\n                            );\r\n                        });\r\n                    }\r\n                    return modified;\r\n                };\r\n            }\r\n            if (\r\n                property.startsWith(\"border\") ||\r\n                property.startsWith(\"outline\")\r\n            ) {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(\r\n                        sourceValue,\r\n                        function (v) {\r\n                            return wrapBorderColorVariableName(v);\r\n                        },\r\n                        function (fallback) {\r\n                            return tryModifyBorderColor(fallback, theme);\r\n                        }\r\n                    );\r\n                };\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.subscribeForVarTypeChange = function (\r\n            varName,\r\n            callback\r\n        ) {\r\n            if (!this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.set(varName, new Set());\r\n            }\r\n            var rootStore = this.typeChangeSubscriptions.get(varName);\r\n            if (!rootStore.has(callback)) {\r\n                rootStore.add(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (\r\n            varName,\r\n            callback\r\n        ) {\r\n            if (this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.get(varName).delete(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.collectVariablesAndVarDep = function () {\r\n            var _this = this;\r\n            this.rulesQueue.forEach(function (rules) {\r\n                iterateCSSRules(rules, function (rule) {\r\n                    if (rule.style) {\r\n                        _this.collectVarsFromCSSDeclarations(rule.style);\r\n                    }\r\n                });\r\n            });\r\n            this.inlineStyleQueue.forEach(function (style) {\r\n                _this.collectVarsFromCSSDeclarations(style);\r\n            });\r\n            this.rulesQueue.splice(0);\r\n            this.inlineStyleQueue.splice(0);\r\n        };\r\n        VariablesStore.prototype.collectVarsFromCSSDeclarations = function (\r\n            style\r\n        ) {\r\n            var _this = this;\r\n            iterateCSSDeclarations(style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    _this.inspectVariable(property, value);\r\n                }\r\n                if (isVarDependant(value)) {\r\n                    _this.inspectVarDependant(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.shouldProcessRootVariables = function () {\r\n            var _a;\r\n            return (\r\n                this.rulesQueue.length > 0 &&\r\n                ((_a = document.documentElement.getAttribute(\"style\")) ===\r\n                    null || _a === void 0\r\n                    ? void 0\r\n                    : _a.includes(\"--\"))\r\n            );\r\n        };\r\n        VariablesStore.prototype.collectRootVariables = function () {\r\n            var _this = this;\r\n            if (!this.shouldProcessRootVariables()) {\r\n                return;\r\n            }\r\n            iterateCSSDeclarations(\r\n                document.documentElement.style,\r\n                function (property, value) {\r\n                    if (isVariable(property)) {\r\n                        _this.inspectVariable(property, value);\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        VariablesStore.prototype.inspectVariable = function (varName, value) {\r\n            this.unstableVarValues.set(varName, value);\r\n            if (isVarDependant(value) && isConstructedColorVar(value)) {\r\n                this.unknownColorVars.add(varName);\r\n                this.definedVars.add(varName);\r\n            }\r\n            if (this.definedVars.has(varName)) {\r\n                return;\r\n            }\r\n            this.definedVars.add(varName);\r\n            var isColor =\r\n                rawValueRegex.test(value) || parseColorWithCache(value);\r\n            if (isColor) {\r\n                this.unknownColorVars.add(varName);\r\n            } else if (\r\n                value.includes(\"url(\") ||\r\n                value.includes(\"linear-gradient(\") ||\r\n                value.includes(\"radial-gradient(\")\r\n            ) {\r\n                this.resolveVariableType(varName, VAR_TYPE_BGIMG);\r\n            }\r\n        };\r\n        VariablesStore.prototype.resolveVariableType = function (\r\n            varName,\r\n            typeNum\r\n        ) {\r\n            var initialType = this.initialVarTypes.get(varName) || 0;\r\n            var currentType = this.varTypes.get(varName) || 0;\r\n            var newType = currentType | typeNum;\r\n            this.varTypes.set(varName, newType);\r\n            if (newType !== initialType || this.undefinedVars.has(varName)) {\r\n                this.changedTypeVars.add(varName);\r\n                this.undefinedVars.delete(varName);\r\n            }\r\n            this.unknownColorVars.delete(varName);\r\n            this.unknownBgVars.delete(varName);\r\n        };\r\n        VariablesStore.prototype.collectRootVarDependents = function () {\r\n            var _this = this;\r\n            if (!this.shouldProcessRootVariables()) {\r\n                return;\r\n            }\r\n            iterateCSSDeclarations(\r\n                document.documentElement.style,\r\n                function (property, value) {\r\n                    if (isVarDependant(value)) {\r\n                        _this.inspectVarDependant(property, value);\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        VariablesStore.prototype.inspectVarDependant = function (\r\n            property,\r\n            value\r\n        ) {\r\n            var _this = this;\r\n            if (isVariable(property)) {\r\n                this.iterateVarDeps(value, function (ref) {\r\n                    if (!_this.varRefs.has(property)) {\r\n                        _this.varRefs.set(property, new Set());\r\n                    }\r\n                    _this.varRefs.get(property).add(ref);\r\n                });\r\n            } else if (\r\n                property === \"background-color\" ||\r\n                property === \"box-shadow\"\r\n            ) {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\r\n                });\r\n            } else if (isTextColorProperty(property)) {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR);\r\n                });\r\n            } else if (\r\n                property.startsWith(\"border\") ||\r\n                property.startsWith(\"outline\")\r\n            ) {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR);\r\n                });\r\n            } else if (\r\n                property === \"background\" ||\r\n                property === \"background-image\"\r\n            ) {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                        return;\r\n                    }\r\n                    var isBgColor =\r\n                        _this.findVarRef(v, function (ref) {\r\n                            return (\r\n                                _this.unknownColorVars.has(ref) ||\r\n                                _this.isVarType(\r\n                                    ref,\r\n                                    VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR\r\n                                )\r\n                            );\r\n                        }) != null;\r\n                    _this.iterateVarRefs(v, function (ref) {\r\n                        if (isBgColor) {\r\n                            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                        } else {\r\n                            _this.unknownBgVars.add(ref);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        };\r\n        VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\r\n            var varDeps = new Set();\r\n            iterateVarDependencies(value, function (v) {\r\n                return varDeps.add(v);\r\n            });\r\n            varDeps.forEach(function (v) {\r\n                return iterator(v);\r\n            });\r\n        };\r\n        VariablesStore.prototype.findVarRef = function (\r\n            varName,\r\n            iterator,\r\n            stack\r\n        ) {\r\n            var e_1, _a;\r\n            if (stack === void 0) {\r\n                stack = new Set();\r\n            }\r\n            if (stack.has(varName)) {\r\n                return null;\r\n            }\r\n            stack.add(varName);\r\n            var result = iterator(varName);\r\n            if (result) {\r\n                return varName;\r\n            }\r\n            var refs = this.varRefs.get(varName);\r\n            if (!refs || refs.size === 0) {\r\n                return null;\r\n            }\r\n            try {\r\n                for (\r\n                    var refs_1 = __values(refs), refs_1_1 = refs_1.next();\r\n                    !refs_1_1.done;\r\n                    refs_1_1 = refs_1.next()\r\n                ) {\r\n                    var ref = refs_1_1.value;\r\n                    var found = this.findVarRef(ref, iterator, stack);\r\n                    if (found) {\r\n                        return found;\r\n                    }\r\n                }\r\n            } catch (e_1_1) {\r\n                e_1 = {error: e_1_1};\r\n            } finally {\r\n                try {\r\n                    if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return))\r\n                        _a.call(refs_1);\r\n                } finally {\r\n                    if (e_1) throw e_1.error;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.iterateVarRefs = function (varName, iterator) {\r\n            this.findVarRef(varName, function (ref) {\r\n                iterator(ref);\r\n                return false;\r\n            });\r\n        };\r\n        VariablesStore.prototype.setOnRootVariableChange = function (callback) {\r\n            this.onRootVariableDefined = callback;\r\n        };\r\n        VariablesStore.prototype.putRootVars = function (styleElement, theme) {\r\n            var e_2, _a;\r\n            var _this = this;\r\n            var sheet = styleElement.sheet;\r\n            if (sheet.cssRules.length > 0) {\r\n                sheet.deleteRule(0);\r\n            }\r\n            var declarations = new Map();\r\n            iterateCSSDeclarations(\r\n                document.documentElement.style,\r\n                function (property, value) {\r\n                    if (isVariable(property)) {\r\n                        if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\r\n                            declarations.set(\r\n                                wrapBgColorVariableName(property),\r\n                                tryModifyBgColor(value, theme)\r\n                            );\r\n                        }\r\n                        if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\r\n                            declarations.set(\r\n                                wrapTextColorVariableName(property),\r\n                                tryModifyTextColor(value, theme)\r\n                            );\r\n                        }\r\n                        if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\r\n                            declarations.set(\r\n                                wrapBorderColorVariableName(property),\r\n                                tryModifyBorderColor(value, theme)\r\n                            );\r\n                        }\r\n                        _this.subscribeForVarTypeChange(\r\n                            property,\r\n                            _this.onRootVariableDefined\r\n                        );\r\n                    }\r\n                }\r\n            );\r\n            var cssLines = [];\r\n            cssLines.push(\":root {\");\r\n            try {\r\n                for (\r\n                    var declarations_1 = __values(declarations),\r\n                        declarations_1_1 = declarations_1.next();\r\n                    !declarations_1_1.done;\r\n                    declarations_1_1 = declarations_1.next()\r\n                ) {\r\n                    var _b = __read(declarations_1_1.value, 2),\r\n                        property = _b[0],\r\n                        value = _b[1];\r\n                    cssLines.push(\r\n                        \"    \".concat(property, \": \").concat(value, \";\")\r\n                    );\r\n                }\r\n            } catch (e_2_1) {\r\n                e_2 = {error: e_2_1};\r\n            } finally {\r\n                try {\r\n                    if (\r\n                        declarations_1_1 &&\r\n                        !declarations_1_1.done &&\r\n                        (_a = declarations_1.return)\r\n                    )\r\n                        _a.call(declarations_1);\r\n                } finally {\r\n                    if (e_2) throw e_2.error;\r\n                }\r\n            }\r\n            cssLines.push(\"}\");\r\n            var cssText = cssLines.join(\"\\n\");\r\n            sheet.insertRule(cssText);\r\n        };\r\n        return VariablesStore;\r\n    })();\r\n    var variablesStore = new VariablesStore();\r\n    function getVariableRange(input, searchStart) {\r\n        if (searchStart === void 0) {\r\n            searchStart = 0;\r\n        }\r\n        var start = input.indexOf(\"var(\", searchStart);\r\n        if (start >= 0) {\r\n            var range = getParenthesesRange(input, start + 3);\r\n            if (range) {\r\n                return {start: start, end: range.end};\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getVariablesMatches(input) {\r\n        var ranges = [];\r\n        var i = 0;\r\n        var range;\r\n        while ((range = getVariableRange(input, i))) {\r\n            var start = range.start,\r\n                end = range.end;\r\n            ranges.push({\r\n                start: start,\r\n                end: end,\r\n                value: input.substring(start, end)\r\n            });\r\n            i = range.end + 1;\r\n        }\r\n        return ranges;\r\n    }\r\n    function replaceVariablesMatches(input, replacer) {\r\n        var matches = getVariablesMatches(input);\r\n        var matchesCount = matches.length;\r\n        if (matchesCount === 0) {\r\n            return input;\r\n        }\r\n        var inputLength = input.length;\r\n        var replacements = matches.map(function (m) {\r\n            return replacer(m.value);\r\n        });\r\n        var parts = [];\r\n        parts.push(input.substring(0, matches[0].start));\r\n        for (var i = 0; i < matchesCount; i++) {\r\n            parts.push(replacements[i]);\r\n            var start = matches[i].end;\r\n            var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\r\n            parts.push(input.substring(start, end));\r\n        }\r\n        return parts.join(\"\");\r\n    }\r\n    function getVariableNameAndFallback(match) {\r\n        var commaIndex = match.indexOf(\",\");\r\n        var name;\r\n        var fallback;\r\n        if (commaIndex >= 0) {\r\n            name = match.substring(4, commaIndex).trim();\r\n            fallback = match.substring(commaIndex + 1, match.length - 1).trim();\r\n        } else {\r\n            name = match.substring(4, match.length - 1).trim();\r\n            fallback = \"\";\r\n        }\r\n        return {name: name, fallback: fallback};\r\n    }\r\n    function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match),\r\n                name = _a.name,\r\n                fallback = _a.fallback;\r\n            var newName = nameReplacer(name);\r\n            if (!fallback) {\r\n                return \"var(\".concat(newName, \")\");\r\n            }\r\n            var newFallback;\r\n            if (isVarDependant(fallback)) {\r\n                newFallback = replaceCSSVariablesNames(\r\n                    fallback,\r\n                    nameReplacer,\r\n                    fallbackReplacer\r\n                );\r\n            } else if (fallbackReplacer) {\r\n                newFallback = fallbackReplacer(fallback);\r\n            } else {\r\n                newFallback = fallback;\r\n            }\r\n            return \"var(\".concat(newName, \", \").concat(newFallback, \")\");\r\n        };\r\n        return replaceVariablesMatches(value, matchReplacer);\r\n    }\r\n    function iterateVarDependencies(value, iterator) {\r\n        replaceCSSVariablesNames(value, function (varName) {\r\n            iterator(varName);\r\n            return varName;\r\n        });\r\n    }\r\n    function wrapBgColorVariableName(name) {\r\n        return \"--darkreader-bg\".concat(name);\r\n    }\r\n    function wrapTextColorVariableName(name) {\r\n        return \"--darkreader-text\".concat(name);\r\n    }\r\n    function wrapBorderColorVariableName(name) {\r\n        return \"--darkreader-border\".concat(name);\r\n    }\r\n    function wrapBgImgVariableName(name) {\r\n        return \"--darkreader-bgimg\".concat(name);\r\n    }\r\n    function isVariable(property) {\r\n        return property.startsWith(\"--\");\r\n    }\r\n    function isVarDependant(value) {\r\n        return value.includes(\"var(\");\r\n    }\r\n    function isConstructedColorVar(value) {\r\n        return value.match(/^\\s*(rgb|hsl)a?\\(/);\r\n    }\r\n    function isTextColorProperty(property) {\r\n        return (\r\n            property === \"color\" ||\r\n            property === \"caret-color\" ||\r\n            property === \"-webkit-text-fill-color\"\r\n        );\r\n    }\r\n    var rawValueRegex = /^\\d{1,3}, ?\\d{1,3}, ?\\d{1,3}$/;\r\n    function parseRawValue(color) {\r\n        if (rawValueRegex.test(color)) {\r\n            var splitted = color.split(\",\");\r\n            var resultInRGB_1 = \"rgb(\";\r\n            splitted.forEach(function (number) {\r\n                resultInRGB_1 += \"\".concat(number.trim(), \", \");\r\n            });\r\n            resultInRGB_1 = resultInRGB_1.substring(\r\n                0,\r\n                resultInRGB_1.length - 2\r\n            );\r\n            resultInRGB_1 += \")\";\r\n            return {isRaw: true, color: resultInRGB_1};\r\n        }\r\n        return {isRaw: false, color: color};\r\n    }\r\n    function handleRawValue(color, theme, modifyFunction) {\r\n        var _a = parseRawValue(color),\r\n            isRaw = _a.isRaw,\r\n            newColor = _a.color;\r\n        var rgb = parseColorWithCache(newColor);\r\n        if (rgb) {\r\n            var outputColor = modifyFunction(rgb, theme);\r\n            if (isRaw) {\r\n                var outputInRGB = parseColorWithCache(outputColor);\r\n                return outputInRGB\r\n                    ? \"\"\r\n                          .concat(outputInRGB.r, \", \")\r\n                          .concat(outputInRGB.g, \", \")\r\n                          .concat(outputInRGB.b)\r\n                    : outputColor;\r\n            }\r\n            return outputColor;\r\n        }\r\n        return newColor;\r\n    }\r\n    function tryModifyBgColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyBackgroundColor);\r\n    }\r\n    function tryModifyTextColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyForegroundColor);\r\n    }\r\n    function tryModifyBorderColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyBorderColor);\r\n    }\r\n    function insertVarValues(source, varValues, stack) {\r\n        if (stack === void 0) {\r\n            stack = new Set();\r\n        }\r\n        var containsUnresolvedVar = false;\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match),\r\n                name = _a.name,\r\n                fallback = _a.fallback;\r\n            if (stack.has(name)) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            stack.add(name);\r\n            var varValue = varValues.get(name) || fallback;\r\n            var inserted = null;\r\n            if (varValue) {\r\n                if (isVarDependant(varValue)) {\r\n                    inserted = insertVarValues(varValue, varValues, stack);\r\n                } else {\r\n                    inserted = varValue;\r\n                }\r\n            }\r\n            if (!inserted) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            return inserted;\r\n        };\r\n        var replaced = replaceVariablesMatches(source, matchReplacer);\r\n        if (containsUnresolvedVar) {\r\n            return null;\r\n        }\r\n        return replaced;\r\n    }\r\n\r\n    var overrides$1 = {\r\n        \"background-color\": {\r\n            customProp: \"--darkreader-inline-bgcolor\",\r\n            cssProp: \"background-color\",\r\n            dataAttr: \"data-darkreader-inline-bgcolor\"\r\n        },\r\n        \"background-image\": {\r\n            customProp: \"--darkreader-inline-bgimage\",\r\n            cssProp: \"background-image\",\r\n            dataAttr: \"data-darkreader-inline-bgimage\"\r\n        },\r\n        \"border-color\": {\r\n            customProp: \"--darkreader-inline-border\",\r\n            cssProp: \"border-color\",\r\n            dataAttr: \"data-darkreader-inline-border\"\r\n        },\r\n        \"border-bottom-color\": {\r\n            customProp: \"--darkreader-inline-border-bottom\",\r\n            cssProp: \"border-bottom-color\",\r\n            dataAttr: \"data-darkreader-inline-border-bottom\"\r\n        },\r\n        \"border-left-color\": {\r\n            customProp: \"--darkreader-inline-border-left\",\r\n            cssProp: \"border-left-color\",\r\n            dataAttr: \"data-darkreader-inline-border-left\"\r\n        },\r\n        \"border-right-color\": {\r\n            customProp: \"--darkreader-inline-border-right\",\r\n            cssProp: \"border-right-color\",\r\n            dataAttr: \"data-darkreader-inline-border-right\"\r\n        },\r\n        \"border-top-color\": {\r\n            customProp: \"--darkreader-inline-border-top\",\r\n            cssProp: \"border-top-color\",\r\n            dataAttr: \"data-darkreader-inline-border-top\"\r\n        },\r\n        \"box-shadow\": {\r\n            customProp: \"--darkreader-inline-boxshadow\",\r\n            cssProp: \"box-shadow\",\r\n            dataAttr: \"data-darkreader-inline-boxshadow\"\r\n        },\r\n        \"color\": {\r\n            customProp: \"--darkreader-inline-color\",\r\n            cssProp: \"color\",\r\n            dataAttr: \"data-darkreader-inline-color\"\r\n        },\r\n        \"fill\": {\r\n            customProp: \"--darkreader-inline-fill\",\r\n            cssProp: \"fill\",\r\n            dataAttr: \"data-darkreader-inline-fill\"\r\n        },\r\n        \"stroke\": {\r\n            customProp: \"--darkreader-inline-stroke\",\r\n            cssProp: \"stroke\",\r\n            dataAttr: \"data-darkreader-inline-stroke\"\r\n        },\r\n        \"outline-color\": {\r\n            customProp: \"--darkreader-inline-outline\",\r\n            cssProp: \"outline-color\",\r\n            dataAttr: \"data-darkreader-inline-outline\"\r\n        },\r\n        \"stop-color\": {\r\n            customProp: \"--darkreader-inline-stopcolor\",\r\n            cssProp: \"stop-color\",\r\n            dataAttr: \"data-darkreader-inline-stopcolor\"\r\n        }\r\n    };\r\n    var shorthandOverrides = {\r\n        background: {\r\n            customProp: \"--darkreader-inline-bg\",\r\n            cssProp: \"background\",\r\n            dataAttr: \"data-darkreader-inline-bg\"\r\n        }\r\n    };\r\n    var overridesList = Object.values(overrides$1);\r\n    var normalizedPropList = {};\r\n    overridesList.forEach(function (_a) {\r\n        var cssProp = _a.cssProp,\r\n            customProp = _a.customProp;\r\n        return (normalizedPropList[customProp] = cssProp);\r\n    });\r\n    var INLINE_STYLE_ATTRS = [\r\n        \"style\",\r\n        \"fill\",\r\n        \"stop-color\",\r\n        \"stroke\",\r\n        \"bgcolor\",\r\n        \"color\"\r\n    ];\r\n    var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) {\r\n        return \"[\".concat(attr, \"]\");\r\n    }).join(\", \");\r\n    function getInlineOverrideStyle() {\r\n        var allOverrides = overridesList.concat(\r\n            Object.values(shorthandOverrides)\r\n        );\r\n        return allOverrides\r\n            .map(function (_a) {\r\n                var dataAttr = _a.dataAttr,\r\n                    customProp = _a.customProp,\r\n                    cssProp = _a.cssProp;\r\n                return [\r\n                    \"[\".concat(dataAttr, \"] {\"),\r\n                    \"  \"\r\n                        .concat(cssProp, \": var(\")\r\n                        .concat(customProp, \") !important;\"),\r\n                    \"}\"\r\n                ].join(\"\\n\");\r\n            })\r\n            .join(\"\\n\");\r\n    }\r\n    function getInlineStyleElements(root) {\r\n        var results = [];\r\n        if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\r\n            results.push(root);\r\n        }\r\n        if (\r\n            root instanceof Element ||\r\n            (isShadowDomSupported && root instanceof ShadowRoot) ||\r\n            root instanceof Document\r\n        ) {\r\n            push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        }\r\n        return results;\r\n    }\r\n    var treeObservers = new Map();\r\n    var attrObservers = new Map();\r\n    function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\r\n        deepWatchForInlineStyles(\r\n            document,\r\n            elementStyleDidChange,\r\n            shadowRootDiscovered\r\n        );\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            deepWatchForInlineStyles(\r\n                host.shadowRoot,\r\n                elementStyleDidChange,\r\n                shadowRootDiscovered\r\n            );\r\n        });\r\n    }\r\n    function deepWatchForInlineStyles(\r\n        root,\r\n        elementStyleDidChange,\r\n        shadowRootDiscovered\r\n    ) {\r\n        if (treeObservers.has(root)) {\r\n            treeObservers.get(root).disconnect();\r\n            attrObservers.get(root).disconnect();\r\n        }\r\n        var discoveredNodes = new WeakSet();\r\n        function discoverNodes(node) {\r\n            getInlineStyleElements(node).forEach(function (el) {\r\n                if (discoveredNodes.has(el)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(el);\r\n                elementStyleDidChange(el);\r\n            });\r\n            iterateShadowHosts(node, function (n) {\r\n                if (discoveredNodes.has(node)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(node);\r\n                shadowRootDiscovered(n.shadowRoot);\r\n                deepWatchForInlineStyles(\r\n                    n.shadowRoot,\r\n                    elementStyleDidChange,\r\n                    shadowRootDiscovered\r\n                );\r\n            });\r\n            variablesStore.matchVariablesAndDependents();\r\n        }\r\n        var treeObserver = createOptimizedTreeObserver(root, {\r\n            onMinorMutations: function (_a) {\r\n                var additions = _a.additions;\r\n                additions.forEach(function (added) {\r\n                    return discoverNodes(added);\r\n                });\r\n            },\r\n            onHugeMutations: function () {\r\n                discoverNodes(root);\r\n            }\r\n        });\r\n        treeObservers.set(root, treeObserver);\r\n        var attemptCount = 0;\r\n        var start = null;\r\n        var ATTEMPTS_INTERVAL = getDuration({seconds: 10});\r\n        var RETRY_TIMEOUT = getDuration({seconds: 2});\r\n        var MAX_ATTEMPTS_COUNT = 50;\r\n        var cache = [];\r\n        var timeoutId = null;\r\n        var handleAttributeMutations = throttle(function (mutations) {\r\n            var handledTargets = new Set();\r\n            mutations.forEach(function (m) {\r\n                var target = m.target;\r\n                if (handledTargets.has(target)) {\r\n                    return;\r\n                }\r\n                if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\r\n                    handledTargets.add(target);\r\n                    elementStyleDidChange(target);\r\n                }\r\n            });\r\n            variablesStore.matchVariablesAndDependents();\r\n        });\r\n        var attrObserver = new MutationObserver(function (mutations) {\r\n            if (timeoutId) {\r\n                cache.push.apply(\r\n                    cache,\r\n                    __spreadArray([], __read(mutations), false)\r\n                );\r\n                return;\r\n            }\r\n            attemptCount++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            } else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attemptCount = 0;\r\n                        timeoutId = null;\r\n                        var attributeCache = cache;\r\n                        cache = [];\r\n                        handleAttributeMutations(attributeCache);\r\n                    }, RETRY_TIMEOUT);\r\n                    cache.push.apply(\r\n                        cache,\r\n                        __spreadArray([], __read(mutations), false)\r\n                    );\r\n                    return;\r\n                }\r\n                start = now;\r\n                attemptCount = 1;\r\n            }\r\n            handleAttributeMutations(mutations);\r\n        });\r\n        attrObserver.observe(root, {\r\n            attributes: true,\r\n            attributeFilter: INLINE_STYLE_ATTRS.concat(\r\n                overridesList.map(function (_a) {\r\n                    var dataAttr = _a.dataAttr;\r\n                    return dataAttr;\r\n                })\r\n            ),\r\n            subtree: true\r\n        });\r\n        attrObservers.set(root, attrObserver);\r\n    }\r\n    function stopWatchingForInlineStyles() {\r\n        treeObservers.forEach(function (o) {\r\n            return o.disconnect();\r\n        });\r\n        attrObservers.forEach(function (o) {\r\n            return o.disconnect();\r\n        });\r\n        treeObservers.clear();\r\n        attrObservers.clear();\r\n    }\r\n    var inlineStyleCache = new WeakMap();\r\n    var filterProps = [\"brightness\", \"contrast\", \"grayscale\", \"sepia\", \"mode\"];\r\n    function getInlineStyleCacheKey(el, theme) {\r\n        return INLINE_STYLE_ATTRS.map(function (attr) {\r\n            return \"\".concat(attr, '=\"').concat(el.getAttribute(attr), '\"');\r\n        })\r\n            .concat(\r\n                filterProps.map(function (prop) {\r\n                    return \"\".concat(prop, '=\"').concat(theme[prop], '\"');\r\n                })\r\n            )\r\n            .join(\" \");\r\n    }\r\n    function shouldIgnoreInlineStyle(element, selectors) {\r\n        for (var i = 0, len = selectors.length; i < len; i++) {\r\n            var ingnoredSelector = selectors[i];\r\n            if (element.matches(ingnoredSelector)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function overrideInlineStyle(\r\n        element,\r\n        theme,\r\n        ignoreInlineSelectors,\r\n        ignoreImageSelectors\r\n    ) {\r\n        var _a;\r\n        var cacheKey = getInlineStyleCacheKey(element, theme);\r\n        if (cacheKey === inlineStyleCache.get(element)) {\r\n            return;\r\n        }\r\n        var unsetProps = new Set(Object.keys(overrides$1));\r\n        function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\r\n            var mod = getModifiableCSSDeclaration(\r\n                modifierCSSProp,\r\n                cssVal,\r\n                {style: element.style},\r\n                variablesStore,\r\n                ignoreImageSelectors,\r\n                null\r\n            );\r\n            if (!mod) {\r\n                return;\r\n            }\r\n            function setStaticValue(value) {\r\n                var _a;\r\n                var _b =\r\n                        (_a = overrides$1[targetCSSProp]) !== null &&\r\n                        _a !== void 0\r\n                            ? _a\r\n                            : shorthandOverrides[targetCSSProp],\r\n                    customProp = _b.customProp,\r\n                    dataAttr = _b.dataAttr;\r\n                element.style.setProperty(customProp, value);\r\n                if (!element.hasAttribute(dataAttr)) {\r\n                    element.setAttribute(dataAttr, \"\");\r\n                }\r\n                unsetProps.delete(targetCSSProp);\r\n            }\r\n            function setVarDeclaration(mod) {\r\n                var prevDeclarations = [];\r\n                function setProps(declarations) {\r\n                    prevDeclarations.forEach(function (_a) {\r\n                        var property = _a.property;\r\n                        element.style.removeProperty(property);\r\n                    });\r\n                    declarations.forEach(function (_a) {\r\n                        var property = _a.property,\r\n                            value = _a.value;\r\n                        if (!(value instanceof Promise)) {\r\n                            element.style.setProperty(property, value);\r\n                        }\r\n                    });\r\n                    prevDeclarations = declarations;\r\n                }\r\n                setProps(mod.declarations);\r\n                mod.onTypeChange.addListener(setProps);\r\n            }\r\n            function setAsyncValue(promise) {\r\n                promise.then(function (value) {\r\n                    if (\r\n                        value &&\r\n                        targetCSSProp === \"background\" &&\r\n                        value.startsWith(\"var(--darkreader-bg--\")\r\n                    ) {\r\n                        setStaticValue(value);\r\n                    }\r\n                });\r\n            }\r\n            var value =\r\n                typeof mod.value === \"function\" ? mod.value(theme) : mod.value;\r\n            if (typeof value === \"string\") {\r\n                setStaticValue(value);\r\n            } else if (value instanceof Promise) {\r\n                setAsyncValue(value);\r\n            } else if (typeof value === \"object\") {\r\n                setVarDeclaration(value);\r\n            }\r\n        }\r\n        if (ignoreInlineSelectors.length > 0) {\r\n            if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\r\n                unsetProps.forEach(function (cssProp) {\r\n                    element.removeAttribute(overrides$1[cssProp].dataAttr);\r\n                });\r\n                return;\r\n            }\r\n        }\r\n        if (element.hasAttribute(\"bgcolor\")) {\r\n            var value = element.getAttribute(\"bgcolor\");\r\n            if (\r\n                value.match(/^[0-9a-f]{3}$/i) ||\r\n                value.match(/^[0-9a-f]{6}$/i)\r\n            ) {\r\n                value = \"#\".concat(value);\r\n            }\r\n            setCustomProp(\"background-color\", \"background-color\", value);\r\n        }\r\n        if (element.hasAttribute(\"color\") && element.rel !== \"mask-icon\") {\r\n            var value = element.getAttribute(\"color\");\r\n            if (\r\n                value.match(/^[0-9a-f]{3}$/i) ||\r\n                value.match(/^[0-9a-f]{6}$/i)\r\n            ) {\r\n                value = \"#\".concat(value);\r\n            }\r\n            setCustomProp(\"color\", \"color\", value);\r\n        }\r\n        if (element instanceof SVGElement) {\r\n            if (element.hasAttribute(\"fill\")) {\r\n                var SMALL_SVG_LIMIT_1 = 32;\r\n                var value_1 = element.getAttribute(\"fill\");\r\n                if (value_1 !== \"none\") {\r\n                    if (!(element instanceof SVGTextElement)) {\r\n                        var handleSVGElement = function () {\r\n                            var _a = element.getBoundingClientRect(),\r\n                                width = _a.width,\r\n                                height = _a.height;\r\n                            var isBg =\r\n                                width > SMALL_SVG_LIMIT_1 ||\r\n                                height > SMALL_SVG_LIMIT_1;\r\n                            setCustomProp(\r\n                                \"fill\",\r\n                                isBg ? \"background-color\" : \"color\",\r\n                                value_1\r\n                            );\r\n                        };\r\n                        if (isReadyStateComplete()) {\r\n                            handleSVGElement();\r\n                        } else {\r\n                            addReadyStateCompleteListener(handleSVGElement);\r\n                        }\r\n                    } else {\r\n                        setCustomProp(\"fill\", \"color\", value_1);\r\n                    }\r\n                }\r\n            }\r\n            if (element.hasAttribute(\"stop-color\")) {\r\n                setCustomProp(\r\n                    \"stop-color\",\r\n                    \"background-color\",\r\n                    element.getAttribute(\"stop-color\")\r\n                );\r\n            }\r\n        }\r\n        if (element.hasAttribute(\"stroke\")) {\r\n            var value = element.getAttribute(\"stroke\");\r\n            setCustomProp(\r\n                \"stroke\",\r\n                element instanceof SVGLineElement ||\r\n                    element instanceof SVGTextElement\r\n                    ? \"border-color\"\r\n                    : \"color\",\r\n                value\r\n            );\r\n        }\r\n        element.style &&\r\n            iterateCSSDeclarations(element.style, function (property, value) {\r\n                if (property === \"background-image\" && value.includes(\"url\")) {\r\n                    return;\r\n                }\r\n                if (\r\n                    overrides$1.hasOwnProperty(property) ||\r\n                    (property.startsWith(\"--\") && !normalizedPropList[property])\r\n                ) {\r\n                    setCustomProp(property, property, value);\r\n                } else if (\r\n                    property === \"background\" &&\r\n                    value.includes(\"var(\")\r\n                ) {\r\n                    setCustomProp(\"background\", \"background\", value);\r\n                } else {\r\n                    var overriddenProp = normalizedPropList[property];\r\n                    if (\r\n                        overriddenProp &&\r\n                        !element.style.getPropertyValue(overriddenProp) &&\r\n                        !element.hasAttribute(overriddenProp)\r\n                    ) {\r\n                        if (\r\n                            overriddenProp === \"background-color\" &&\r\n                            element.hasAttribute(\"bgcolor\")\r\n                        ) {\r\n                            return;\r\n                        }\r\n                        element.style.setProperty(property, \"\");\r\n                    }\r\n                }\r\n            });\r\n        if (\r\n            element.style &&\r\n            element instanceof SVGTextElement &&\r\n            element.style.fill\r\n        ) {\r\n            setCustomProp(\r\n                \"fill\",\r\n                \"color\",\r\n                element.style.getPropertyValue(\"fill\")\r\n            );\r\n        }\r\n        if (\r\n            (_a = element.getAttribute(\"style\")) === null || _a === void 0\r\n                ? void 0\r\n                : _a.includes(\"--\")\r\n        ) {\r\n            variablesStore.addInlineStyleForMatching(element.style);\r\n        }\r\n        forEach(unsetProps, function (cssProp) {\r\n            element.removeAttribute(overrides$1[cssProp].dataAttr);\r\n        });\r\n        inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\r\n    }\r\n\r\n    var metaThemeColorName = \"theme-color\";\r\n    var metaThemeColorSelector = 'meta[name=\"'.concat(metaThemeColorName, '\"]');\r\n    var srcMetaThemeColor = null;\r\n    var observer = null;\r\n    function changeMetaThemeColor(meta, theme) {\r\n        srcMetaThemeColor = srcMetaThemeColor || meta.content;\r\n        var color = parseColorWithCache(srcMetaThemeColor);\r\n        if (!color) {\r\n            return;\r\n        }\r\n        meta.content = modifyBackgroundColor(color, theme);\r\n    }\r\n    function changeMetaThemeColorWhenAvailable(theme) {\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta) {\r\n            changeMetaThemeColor(meta, theme);\r\n        } else {\r\n            if (observer) {\r\n                observer.disconnect();\r\n            }\r\n            observer = new MutationObserver(function (mutations) {\r\n                loop: for (var i = 0; i < mutations.length; i++) {\r\n                    var addedNodes = mutations[i].addedNodes;\r\n                    for (var j = 0; j < addedNodes.length; j++) {\r\n                        var node = addedNodes[j];\r\n                        if (\r\n                            node instanceof HTMLMetaElement &&\r\n                            node.name === metaThemeColorName\r\n                        ) {\r\n                            observer.disconnect();\r\n                            observer = null;\r\n                            changeMetaThemeColor(node, theme);\r\n                            break loop;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            observer.observe(document.head, {childList: true});\r\n        }\r\n    }\r\n    function restoreMetaThemeColor() {\r\n        if (observer) {\r\n            observer.disconnect();\r\n            observer = null;\r\n        }\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta && srcMetaThemeColor) {\r\n            meta.content = srcMetaThemeColor;\r\n        }\r\n    }\r\n\r\n    var themeCacheKeys = [\r\n        \"mode\",\r\n        \"brightness\",\r\n        \"contrast\",\r\n        \"grayscale\",\r\n        \"sepia\",\r\n        \"darkSchemeBackgroundColor\",\r\n        \"darkSchemeTextColor\",\r\n        \"lightSchemeBackgroundColor\",\r\n        \"lightSchemeTextColor\"\r\n    ];\r\n    function getThemeKey(theme) {\r\n        var resultKey = \"\";\r\n        themeCacheKeys.forEach(function (key) {\r\n            resultKey += \"\".concat(key, \":\").concat(theme[key], \";\");\r\n        });\r\n        return resultKey;\r\n    }\r\n    var asyncQueue = createAsyncTasksQueue();\r\n    function createStyleSheetModifier() {\r\n        var renderId = 0;\r\n        var rulesTextCache = new Set();\r\n        var rulesModCache = new Map();\r\n        var varTypeChangeCleaners = new Set();\r\n        var prevFilterKey = null;\r\n        var hasNonLoadedLink = false;\r\n        var wasRebuilt = false;\r\n        function shouldRebuildStyle() {\r\n            return hasNonLoadedLink && !wasRebuilt;\r\n        }\r\n        function modifySheet(options) {\r\n            var rules = options.sourceCSSRules;\r\n            var theme = options.theme,\r\n                ignoreImageAnalysis = options.ignoreImageAnalysis,\r\n                force = options.force,\r\n                prepareSheet = options.prepareSheet,\r\n                isAsyncCancelled = options.isAsyncCancelled;\r\n            var rulesChanged = rulesModCache.size === 0;\r\n            var notFoundCacheKeys = new Set(rulesModCache.keys());\r\n            var themeKey = getThemeKey(theme);\r\n            var themeChanged = themeKey !== prevFilterKey;\r\n            if (hasNonLoadedLink) {\r\n                wasRebuilt = true;\r\n            }\r\n            var modRules = [];\r\n            iterateCSSRules(\r\n                rules,\r\n                function (rule) {\r\n                    var cssText = rule.cssText;\r\n                    var textDiffersFromPrev = false;\r\n                    notFoundCacheKeys.delete(cssText);\r\n                    if (rule.parentRule instanceof CSSMediaRule) {\r\n                        cssText += \";\".concat(rule.parentRule.media.mediaText);\r\n                    }\r\n                    if (!rulesTextCache.has(cssText)) {\r\n                        rulesTextCache.add(cssText);\r\n                        textDiffersFromPrev = true;\r\n                    }\r\n                    if (textDiffersFromPrev) {\r\n                        rulesChanged = true;\r\n                    } else {\r\n                        modRules.push(rulesModCache.get(cssText));\r\n                        return;\r\n                    }\r\n                    if (rule.style.all === \"revert\") {\r\n                        return;\r\n                    }\r\n                    var modDecs = [];\r\n                    rule.style &&\r\n                        iterateCSSDeclarations(\r\n                            rule.style,\r\n                            function (property, value) {\r\n                                var mod = getModifiableCSSDeclaration(\r\n                                    property,\r\n                                    value,\r\n                                    rule,\r\n                                    variablesStore,\r\n                                    ignoreImageAnalysis,\r\n                                    isAsyncCancelled\r\n                                );\r\n                                if (mod) {\r\n                                    modDecs.push(mod);\r\n                                }\r\n                            }\r\n                        );\r\n                    var modRule = null;\r\n                    if (modDecs.length > 0) {\r\n                        var parentRule = rule.parentRule;\r\n                        modRule = {\r\n                            selector: rule.selectorText,\r\n                            declarations: modDecs,\r\n                            parentRule: parentRule\r\n                        };\r\n                        modRules.push(modRule);\r\n                    }\r\n                    rulesModCache.set(cssText, modRule);\r\n                },\r\n                function () {\r\n                    hasNonLoadedLink = true;\r\n                }\r\n            );\r\n            notFoundCacheKeys.forEach(function (key) {\r\n                rulesTextCache.delete(key);\r\n                rulesModCache.delete(key);\r\n            });\r\n            prevFilterKey = themeKey;\r\n            if (!force && !rulesChanged && !themeChanged) {\r\n                return;\r\n            }\r\n            renderId++;\r\n            function setRule(target, index, rule) {\r\n                var e_1, _a;\r\n                var selector = rule.selector,\r\n                    declarations = rule.declarations;\r\n                var selectorText = selector;\r\n                if (\r\n                    isChromium &&\r\n                    selector.startsWith(\":is(\") &&\r\n                    (selector.includes(\":is()\") ||\r\n                        selector.includes(\":where()\") ||\r\n                        (selector.includes(\":where(\") &&\r\n                            selector.includes(\":-moz\")))\r\n                ) {\r\n                    selectorText = \".darkreader-unsupported-selector\";\r\n                }\r\n                var ruleText = \"\".concat(selectorText, \" {\");\r\n                try {\r\n                    for (\r\n                        var declarations_1 = __values(declarations),\r\n                            declarations_1_1 = declarations_1.next();\r\n                        !declarations_1_1.done;\r\n                        declarations_1_1 = declarations_1.next()\r\n                    ) {\r\n                        var dec = declarations_1_1.value;\r\n                        var property = dec.property,\r\n                            value = dec.value,\r\n                            important = dec.important;\r\n                        if (value) {\r\n                            ruleText += \" \"\r\n                                .concat(property, \": \")\r\n                                .concat(value)\r\n                                .concat(important ? \" !important\" : \"\", \";\");\r\n                        }\r\n                    }\r\n                } catch (e_1_1) {\r\n                    e_1 = {error: e_1_1};\r\n                } finally {\r\n                    try {\r\n                        if (\r\n                            declarations_1_1 &&\r\n                            !declarations_1_1.done &&\r\n                            (_a = declarations_1.return)\r\n                        )\r\n                            _a.call(declarations_1);\r\n                    } finally {\r\n                        if (e_1) throw e_1.error;\r\n                    }\r\n                }\r\n                ruleText += \" }\";\r\n                target.insertRule(ruleText, index);\r\n            }\r\n            var asyncDeclarations = new Map();\r\n            var varDeclarations = new Map();\r\n            var asyncDeclarationCounter = 0;\r\n            var varDeclarationCounter = 0;\r\n            var rootReadyGroup = {rule: null, rules: [], isGroup: true};\r\n            var groupRefs = new WeakMap();\r\n            function getGroup(rule) {\r\n                if (rule == null) {\r\n                    return rootReadyGroup;\r\n                }\r\n                if (groupRefs.has(rule)) {\r\n                    return groupRefs.get(rule);\r\n                }\r\n                var group = {rule: rule, rules: [], isGroup: true};\r\n                groupRefs.set(rule, group);\r\n                var parentGroup = getGroup(rule.parentRule);\r\n                parentGroup.rules.push(group);\r\n                return group;\r\n            }\r\n            varTypeChangeCleaners.forEach(function (clear) {\r\n                return clear();\r\n            });\r\n            varTypeChangeCleaners.clear();\r\n            modRules\r\n                .filter(function (r) {\r\n                    return r;\r\n                })\r\n                .forEach(function (_a) {\r\n                    var selector = _a.selector,\r\n                        declarations = _a.declarations,\r\n                        parentRule = _a.parentRule;\r\n                    var group = getGroup(parentRule);\r\n                    var readyStyleRule = {\r\n                        selector: selector,\r\n                        declarations: [],\r\n                        isGroup: false\r\n                    };\r\n                    var readyDeclarations = readyStyleRule.declarations;\r\n                    group.rules.push(readyStyleRule);\r\n                    function handleAsyncDeclaration(\r\n                        property,\r\n                        modified,\r\n                        important,\r\n                        sourceValue\r\n                    ) {\r\n                        var asyncKey = ++asyncDeclarationCounter;\r\n                        var asyncDeclaration = {\r\n                            property: property,\r\n                            value: null,\r\n                            important: important,\r\n                            asyncKey: asyncKey,\r\n                            sourceValue: sourceValue\r\n                        };\r\n                        readyDeclarations.push(asyncDeclaration);\r\n                        var currentRenderId = renderId;\r\n                        modified.then(function (asyncValue) {\r\n                            if (\r\n                                !asyncValue ||\r\n                                isAsyncCancelled() ||\r\n                                currentRenderId !== renderId\r\n                            ) {\r\n                                return;\r\n                            }\r\n                            asyncDeclaration.value = asyncValue;\r\n                            asyncQueue.add(function () {\r\n                                if (\r\n                                    isAsyncCancelled() ||\r\n                                    currentRenderId !== renderId\r\n                                ) {\r\n                                    return;\r\n                                }\r\n                                rebuildAsyncRule(asyncKey);\r\n                            });\r\n                        });\r\n                    }\r\n                    function handleVarDeclarations(\r\n                        property,\r\n                        modified,\r\n                        important,\r\n                        sourceValue\r\n                    ) {\r\n                        var varDecs = modified.declarations,\r\n                            onTypeChange = modified.onTypeChange;\r\n                        var varKey = ++varDeclarationCounter;\r\n                        var currentRenderId = renderId;\r\n                        var initialIndex = readyDeclarations.length;\r\n                        var oldDecs = [];\r\n                        if (varDecs.length === 0) {\r\n                            var tempDec = {\r\n                                property: property,\r\n                                value: sourceValue,\r\n                                important: important,\r\n                                sourceValue: sourceValue,\r\n                                varKey: varKey\r\n                            };\r\n                            readyDeclarations.push(tempDec);\r\n                            oldDecs = [tempDec];\r\n                        }\r\n                        varDecs.forEach(function (mod) {\r\n                            if (mod.value instanceof Promise) {\r\n                                handleAsyncDeclaration(\r\n                                    mod.property,\r\n                                    mod.value,\r\n                                    important,\r\n                                    sourceValue\r\n                                );\r\n                            } else {\r\n                                var readyDec = {\r\n                                    property: mod.property,\r\n                                    value: mod.value,\r\n                                    important: important,\r\n                                    sourceValue: sourceValue,\r\n                                    varKey: varKey\r\n                                };\r\n                                readyDeclarations.push(readyDec);\r\n                                oldDecs.push(readyDec);\r\n                            }\r\n                        });\r\n                        onTypeChange.addListener(function (newDecs) {\r\n                            if (\r\n                                isAsyncCancelled() ||\r\n                                currentRenderId !== renderId\r\n                            ) {\r\n                                return;\r\n                            }\r\n                            var readyVarDecs = newDecs.map(function (mod) {\r\n                                return {\r\n                                    property: mod.property,\r\n                                    value: mod.value,\r\n                                    important: important,\r\n                                    sourceValue: sourceValue,\r\n                                    varKey: varKey\r\n                                };\r\n                            });\r\n                            var index = readyDeclarations.indexOf(\r\n                                oldDecs[0],\r\n                                initialIndex\r\n                            );\r\n                            readyDeclarations.splice.apply(\r\n                                readyDeclarations,\r\n                                __spreadArray(\r\n                                    [index, oldDecs.length],\r\n                                    __read(readyVarDecs),\r\n                                    false\r\n                                )\r\n                            );\r\n                            oldDecs = readyVarDecs;\r\n                            rebuildVarRule(varKey);\r\n                        });\r\n                        varTypeChangeCleaners.add(function () {\r\n                            return onTypeChange.removeListeners();\r\n                        });\r\n                    }\r\n                    declarations.forEach(function (_a) {\r\n                        var property = _a.property,\r\n                            value = _a.value,\r\n                            important = _a.important,\r\n                            sourceValue = _a.sourceValue;\r\n                        if (typeof value === \"function\") {\r\n                            var modified = value(theme);\r\n                            if (modified instanceof Promise) {\r\n                                handleAsyncDeclaration(\r\n                                    property,\r\n                                    modified,\r\n                                    important,\r\n                                    sourceValue\r\n                                );\r\n                            } else if (property.startsWith(\"--\")) {\r\n                                handleVarDeclarations(\r\n                                    property,\r\n                                    modified,\r\n                                    important,\r\n                                    sourceValue\r\n                                );\r\n                            } else {\r\n                                readyDeclarations.push({\r\n                                    property: property,\r\n                                    value: modified,\r\n                                    important: important,\r\n                                    sourceValue: sourceValue\r\n                                });\r\n                            }\r\n                        } else {\r\n                            readyDeclarations.push({\r\n                                property: property,\r\n                                value: value,\r\n                                important: important,\r\n                                sourceValue: sourceValue\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n            var sheet = prepareSheet();\r\n            function buildStyleSheet() {\r\n                function createTarget(group, parent) {\r\n                    var rule = group.rule;\r\n                    if (rule instanceof CSSMediaRule) {\r\n                        var media = rule.media;\r\n                        var index = parent.cssRules.length;\r\n                        parent.insertRule(\r\n                            \"@media \".concat(media.mediaText, \" {}\"),\r\n                            index\r\n                        );\r\n                        return parent.cssRules[index];\r\n                    }\r\n                    return parent;\r\n                }\r\n                function iterateReadyRules(group, target, styleIterator) {\r\n                    group.rules.forEach(function (r) {\r\n                        if (r.isGroup) {\r\n                            var t = createTarget(r, target);\r\n                            iterateReadyRules(r, t, styleIterator);\r\n                        } else {\r\n                            styleIterator(r, target);\r\n                        }\r\n                    });\r\n                }\r\n                iterateReadyRules(\r\n                    rootReadyGroup,\r\n                    sheet,\r\n                    function (rule, target) {\r\n                        var index = target.cssRules.length;\r\n                        rule.declarations.forEach(function (_a) {\r\n                            var asyncKey = _a.asyncKey,\r\n                                varKey = _a.varKey;\r\n                            if (asyncKey != null) {\r\n                                asyncDeclarations.set(asyncKey, {\r\n                                    rule: rule,\r\n                                    target: target,\r\n                                    index: index\r\n                                });\r\n                            }\r\n                            if (varKey != null) {\r\n                                varDeclarations.set(varKey, {\r\n                                    rule: rule,\r\n                                    target: target,\r\n                                    index: index\r\n                                });\r\n                            }\r\n                        });\r\n                        setRule(target, index, rule);\r\n                    }\r\n                );\r\n            }\r\n            function rebuildAsyncRule(key) {\r\n                var _a = asyncDeclarations.get(key),\r\n                    rule = _a.rule,\r\n                    target = _a.target,\r\n                    index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n                asyncDeclarations.delete(key);\r\n            }\r\n            function rebuildVarRule(key) {\r\n                var _a = varDeclarations.get(key),\r\n                    rule = _a.rule,\r\n                    target = _a.target,\r\n                    index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n            }\r\n            buildStyleSheet();\r\n        }\r\n        return {\r\n            modifySheet: modifySheet,\r\n            shouldRebuildStyle: shouldRebuildStyle\r\n        };\r\n    }\r\n\r\n    var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\r\n    function isFontsGoogleApiStyle(element) {\r\n        if (!element.href) {\r\n            return false;\r\n        }\r\n        try {\r\n            var elementURL = new URL(element.href);\r\n            return elementURL.hostname === \"fonts.googleapis.com\";\r\n        } catch (err) {\r\n            logInfo(\"Couldn't construct \".concat(element.href, \" as URL\"));\r\n            return false;\r\n        }\r\n    }\r\n    function shouldManageStyle(element) {\r\n        return (\r\n            (element instanceof HTMLStyleElement ||\r\n                element instanceof SVGStyleElement ||\r\n                (element instanceof HTMLLinkElement &&\r\n                    Boolean(element.rel) &&\r\n                    element.rel.toLowerCase().includes(\"stylesheet\") &&\r\n                    Boolean(element.href) &&\r\n                    !element.disabled &&\r\n                    (isFirefox\r\n                        ? !element.href.startsWith(\"moz-extension://\")\r\n                        : true) &&\r\n                    !isFontsGoogleApiStyle(element))) &&\r\n            !element.classList.contains(\"darkreader\") &&\r\n            element.media.toLowerCase() !== \"print\" &&\r\n            !element.classList.contains(\"stylus\")\r\n        );\r\n    }\r\n    function getManageableStyles(node, results, deep) {\r\n        if (results === void 0) {\r\n            results = [];\r\n        }\r\n        if (deep === void 0) {\r\n            deep = true;\r\n        }\r\n        if (shouldManageStyle(node)) {\r\n            results.push(node);\r\n        } else if (\r\n            node instanceof Element ||\r\n            (isShadowDomSupported && node instanceof ShadowRoot) ||\r\n            node === document\r\n        ) {\r\n            forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) {\r\n                return getManageableStyles(style, results, false);\r\n            });\r\n            if (deep) {\r\n                iterateShadowHosts(node, function (host) {\r\n                    return getManageableStyles(host.shadowRoot, results, false);\r\n                });\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    var syncStyleSet = new WeakSet();\r\n    var corsStyleSet = new WeakSet();\r\n    var canOptimizeUsingProxy$1 = false;\r\n    document.addEventListener(\r\n        \"__darkreader__inlineScriptsAllowed\",\r\n        function () {\r\n            canOptimizeUsingProxy$1 = true;\r\n        },\r\n        {once: true, passive: true}\r\n    );\r\n    var loadingLinkCounter = 0;\r\n    var rejectorsForLoadingLinks = new Map();\r\n    function cleanLoadingLinks() {\r\n        rejectorsForLoadingLinks.clear();\r\n    }\r\n    function manageStyle(element, _a) {\r\n        var update = _a.update,\r\n            loadingStart = _a.loadingStart,\r\n            loadingEnd = _a.loadingEnd;\r\n        var prevStyles = [];\r\n        var next = element;\r\n        while (\r\n            (next = next.nextElementSibling) &&\r\n            next.matches(\".darkreader\")\r\n        ) {\r\n            prevStyles.push(next);\r\n        }\r\n        var corsCopy =\r\n            prevStyles.find(function (el) {\r\n                return el.matches(\".darkreader--cors\") && !corsStyleSet.has(el);\r\n            }) || null;\r\n        var syncStyle =\r\n            prevStyles.find(function (el) {\r\n                return el.matches(\".darkreader--sync\") && !syncStyleSet.has(el);\r\n            }) || null;\r\n        var corsCopyPositionWatcher = null;\r\n        var syncStylePositionWatcher = null;\r\n        var cancelAsyncOperations = false;\r\n        var isOverrideEmpty = true;\r\n        var sheetModifier = createStyleSheetModifier();\r\n        var observer = new MutationObserver(function () {\r\n            update();\r\n        });\r\n        var observerOptions = {\r\n            attributes: true,\r\n            childList: true,\r\n            subtree: true,\r\n            characterData: true\r\n        };\r\n        function containsCSSImport() {\r\n            var _a;\r\n            if (!(element instanceof HTMLStyleElement)) {\r\n                return false;\r\n            }\r\n            var cssText = removeCSSComments(\r\n                (_a = element.textContent) !== null && _a !== void 0 ? _a : \"\"\r\n            ).trim();\r\n            return cssText.match(cssImportRegex);\r\n        }\r\n        function hasImports(cssRules, checkCrossOrigin) {\r\n            var result = false;\r\n            if (cssRules) {\r\n                var rule = void 0;\r\n                cssRulesLoop: for (\r\n                    var i = 0, len = cssRules.length;\r\n                    i < len;\r\n                    i++\r\n                ) {\r\n                    rule = cssRules[i];\r\n                    if (rule.href) {\r\n                        if (checkCrossOrigin) {\r\n                            if (\r\n                                !rule.href.startsWith(\r\n                                    \"https://fonts.googleapis.com/\"\r\n                                ) &&\r\n                                rule.href.startsWith(\"http\") &&\r\n                                !rule.href.startsWith(location.origin)\r\n                            ) {\r\n                                result = true;\r\n                                break cssRulesLoop;\r\n                            }\r\n                        } else {\r\n                            result = true;\r\n                            break cssRulesLoop;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        function getRulesSync() {\r\n            if (corsCopy) {\r\n                return corsCopy.sheet.cssRules;\r\n            }\r\n            if (containsCSSImport()) {\r\n                return null;\r\n            }\r\n            var cssRules = safeGetSheetRules();\r\n            if (\r\n                element instanceof HTMLLinkElement &&\r\n                !isRelativeHrefOnAbsolutePath(element.href) &&\r\n                hasImports(cssRules, false)\r\n            ) {\r\n                return null;\r\n            }\r\n            if (hasImports(cssRules, true)) {\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function insertStyle() {\r\n            if (corsCopy) {\r\n                if (element.nextSibling !== corsCopy) {\r\n                    element.parentNode.insertBefore(\r\n                        corsCopy,\r\n                        element.nextSibling\r\n                    );\r\n                }\r\n                if (corsCopy.nextSibling !== syncStyle) {\r\n                    element.parentNode.insertBefore(\r\n                        syncStyle,\r\n                        corsCopy.nextSibling\r\n                    );\r\n                }\r\n            } else if (element.nextSibling !== syncStyle) {\r\n                element.parentNode.insertBefore(syncStyle, element.nextSibling);\r\n            }\r\n        }\r\n        function createSyncStyle() {\r\n            syncStyle =\r\n                element instanceof SVGStyleElement\r\n                    ? document.createElementNS(\r\n                          \"http://www.w3.org/2000/svg\",\r\n                          \"style\"\r\n                      )\r\n                    : document.createElement(\"style\");\r\n            syncStyle.classList.add(\"darkreader\");\r\n            syncStyle.classList.add(\"darkreader--sync\");\r\n            syncStyle.media = \"screen\";\r\n            if (element.title) {\r\n                syncStyle.title = element.title;\r\n            }\r\n            syncStyleSet.add(syncStyle);\r\n        }\r\n        var isLoadingRules = false;\r\n        var wasLoadingError = false;\r\n        var loadingLinkId = ++loadingLinkCounter;\r\n        function getRulesAsync() {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var cssText,\r\n                    cssBasePath,\r\n                    _a,\r\n                    cssRules,\r\n                    accessError,\r\n                    fullCSSText;\r\n                var _b;\r\n                return __generator(this, function (_c) {\r\n                    switch (_c.label) {\r\n                        case 0:\r\n                            if (!(element instanceof HTMLLinkElement))\r\n                                return [3, 7];\r\n                            (_a = __read(getRulesOrError(), 2)),\r\n                                (cssRules = _a[0]),\r\n                                (accessError = _a[1]);\r\n                            if (\r\n                                !(\r\n                                    (isSafari && !element.sheet) ||\r\n                                    (!isSafari && !cssRules && !accessError) ||\r\n                                    isStillLoadingError(accessError)\r\n                                )\r\n                            )\r\n                                return [3, 5];\r\n                            _c.label = 1;\r\n                        case 1:\r\n                            _c.trys.push([1, 3, , 4]);\r\n                            return [4, linkLoading(element, loadingLinkId)];\r\n                        case 2:\r\n                            _c.sent();\r\n                            return [3, 4];\r\n                        case 3:\r\n                            _c.sent();\r\n                            wasLoadingError = true;\r\n                            return [3, 4];\r\n                        case 4:\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            (_b = __read(getRulesOrError(), 2)),\r\n                                (cssRules = _b[0]),\r\n                                (accessError = _b[1]);\r\n                            _c.label = 5;\r\n                        case 5:\r\n                            if (cssRules) {\r\n                                if (!hasImports(cssRules, false)) {\r\n                                    return [2, cssRules];\r\n                                }\r\n                            }\r\n                            return [4, loadText(element.href)];\r\n                        case 6:\r\n                            cssText = _c.sent();\r\n                            cssBasePath = getCSSBaseBath(element.href);\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            return [3, 8];\r\n                        case 7:\r\n                            if (containsCSSImport()) {\r\n                                cssText = element.textContent.trim();\r\n                                cssBasePath = getCSSBaseBath(location.href);\r\n                            } else {\r\n                                return [2, null];\r\n                            }\r\n                            _c.label = 8;\r\n                        case 8:\r\n                            if (!cssText) return [3, 13];\r\n                            _c.label = 9;\r\n                        case 9:\r\n                            _c.trys.push([9, 11, , 12]);\r\n                            return [4, replaceCSSImports(cssText, cssBasePath)];\r\n                        case 10:\r\n                            fullCSSText = _c.sent();\r\n                            corsCopy = createCORSCopy(element, fullCSSText);\r\n                            return [3, 12];\r\n                        case 11:\r\n                            _c.sent();\r\n                            return [3, 12];\r\n                        case 12:\r\n                            if (corsCopy) {\r\n                                corsCopyPositionWatcher = watchForNodePosition(\r\n                                    corsCopy,\r\n                                    \"prev-sibling\"\r\n                                );\r\n                                return [2, corsCopy.sheet.cssRules];\r\n                            }\r\n                            _c.label = 13;\r\n                        case 13:\r\n                            return [2, null];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function details(options) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                if (options.secondRound) {\r\n                    return null;\r\n                }\r\n                if (isLoadingRules || wasLoadingError) {\r\n                    return null;\r\n                }\r\n                isLoadingRules = true;\r\n                loadingStart();\r\n                getRulesAsync()\r\n                    .then(function (results) {\r\n                        isLoadingRules = false;\r\n                        loadingEnd();\r\n                        if (results) {\r\n                            update();\r\n                        }\r\n                    })\r\n                    .catch(function (err) {\r\n                        isLoadingRules = false;\r\n                        loadingEnd();\r\n                    });\r\n                return null;\r\n            }\r\n            return {rules: rules};\r\n        }\r\n        var forceRenderStyle = false;\r\n        function render(theme, ignoreImageAnalysis) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                return;\r\n            }\r\n            cancelAsyncOperations = false;\r\n            function removeCSSRulesFromSheet(sheet) {\r\n                if (!sheet) {\r\n                    return;\r\n                }\r\n                for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\r\n                    sheet.deleteRule(i);\r\n                }\r\n            }\r\n            function prepareOverridesSheet() {\r\n                if (!syncStyle) {\r\n                    createSyncStyle();\r\n                }\r\n                syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n                insertStyle();\r\n                if (syncStyle.sheet == null) {\r\n                    syncStyle.textContent = \"\";\r\n                }\r\n                var sheet = syncStyle.sheet;\r\n                removeCSSRulesFromSheet(sheet);\r\n                if (syncStylePositionWatcher) {\r\n                    syncStylePositionWatcher.run();\r\n                } else {\r\n                    syncStylePositionWatcher = watchForNodePosition(\r\n                        syncStyle,\r\n                        \"prev-sibling\",\r\n                        function () {\r\n                            forceRenderStyle = true;\r\n                            buildOverrides();\r\n                        }\r\n                    );\r\n                }\r\n                return syncStyle.sheet;\r\n            }\r\n            function buildOverrides() {\r\n                var force = forceRenderStyle;\r\n                forceRenderStyle = false;\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: force,\r\n                    isAsyncCancelled: function () {\r\n                        return cancelAsyncOperations;\r\n                    }\r\n                });\r\n                isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\r\n                if (sheetModifier.shouldRebuildStyle()) {\r\n                    addReadyStateCompleteListener(function () {\r\n                        return update();\r\n                    });\r\n                }\r\n            }\r\n            buildOverrides();\r\n        }\r\n        function getRulesOrError() {\r\n            try {\r\n                if (element.sheet == null) {\r\n                    return [null, null];\r\n                }\r\n                return [element.sheet.cssRules, null];\r\n            } catch (err) {\r\n                return [null, err];\r\n            }\r\n        }\r\n        function isStillLoadingError(error) {\r\n            return error && error.message && error.message.includes(\"loading\");\r\n        }\r\n        function safeGetSheetRules() {\r\n            var _a = __read(getRulesOrError(), 2),\r\n                cssRules = _a[0],\r\n                err = _a[1];\r\n            if (err) {\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function watchForSheetChanges() {\r\n            watchForSheetChangesUsingProxy();\r\n            if (!(canOptimizeUsingProxy$1 && element.sheet)) {\r\n                watchForSheetChangesUsingRAF();\r\n            }\r\n        }\r\n        var rulesChangeKey = null;\r\n        var rulesCheckFrameId = null;\r\n        function getRulesChangeKey() {\r\n            var rules = safeGetSheetRules();\r\n            return rules ? rules.length : null;\r\n        }\r\n        function didRulesKeyChange() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        function watchForSheetChangesUsingRAF() {\r\n            rulesChangeKey = getRulesChangeKey();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            var checkForUpdate = function () {\r\n                if (didRulesKeyChange()) {\r\n                    rulesChangeKey = getRulesChangeKey();\r\n                    update();\r\n                }\r\n                if (canOptimizeUsingProxy$1 && element.sheet) {\r\n                    stopWatchingForSheetChangesUsingRAF();\r\n                    return;\r\n                }\r\n                rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\r\n            };\r\n            checkForUpdate();\r\n        }\r\n        function stopWatchingForSheetChangesUsingRAF() {\r\n            cancelAnimationFrame(rulesCheckFrameId);\r\n        }\r\n        var areSheetChangesPending = false;\r\n        function onSheetChange() {\r\n            canOptimizeUsingProxy$1 = true;\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            if (areSheetChangesPending) {\r\n                return;\r\n            }\r\n            function handleSheetChanges() {\r\n                areSheetChangesPending = false;\r\n                if (cancelAsyncOperations) {\r\n                    return;\r\n                }\r\n                update();\r\n            }\r\n            areSheetChangesPending = true;\r\n            if (typeof queueMicrotask === \"function\") {\r\n                queueMicrotask(handleSheetChanges);\r\n            } else {\r\n                requestAnimationFrame(handleSheetChanges);\r\n            }\r\n        }\r\n        function watchForSheetChangesUsingProxy() {\r\n            element.addEventListener(\r\n                \"__darkreader__updateSheet\",\r\n                onSheetChange,\r\n                {passive: true}\r\n            );\r\n        }\r\n        function stopWatchingForSheetChangesUsingProxy() {\r\n            element.removeEventListener(\r\n                \"__darkreader__updateSheet\",\r\n                onSheetChange\r\n            );\r\n        }\r\n        function stopWatchingForSheetChanges() {\r\n            stopWatchingForSheetChangesUsingProxy();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n        }\r\n        function pause() {\r\n            observer.disconnect();\r\n            cancelAsyncOperations = true;\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n            stopWatchingForSheetChanges();\r\n        }\r\n        function destroy() {\r\n            pause();\r\n            removeNode(corsCopy);\r\n            removeNode(syncStyle);\r\n            loadingEnd();\r\n            if (rejectorsForLoadingLinks.has(loadingLinkId)) {\r\n                var reject = rejectorsForLoadingLinks.get(loadingLinkId);\r\n                rejectorsForLoadingLinks.delete(loadingLinkId);\r\n                reject && reject();\r\n            }\r\n        }\r\n        function watch() {\r\n            observer.observe(element, observerOptions);\r\n            if (element instanceof HTMLStyleElement) {\r\n                watchForSheetChanges();\r\n            }\r\n        }\r\n        var maxMoveCount = 10;\r\n        var moveCount = 0;\r\n        function restore() {\r\n            if (!syncStyle) {\r\n                return;\r\n            }\r\n            moveCount++;\r\n            if (moveCount > maxMoveCount) {\r\n                return;\r\n            }\r\n            insertStyle();\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.skip();\r\n            if (!isOverrideEmpty) {\r\n                forceRenderStyle = true;\r\n                update();\r\n            }\r\n        }\r\n        return {\r\n            details: details,\r\n            render: render,\r\n            pause: pause,\r\n            destroy: destroy,\r\n            watch: watch,\r\n            restore: restore\r\n        };\r\n    }\r\n    function linkLoading(link, loadingId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [\r\n                    2,\r\n                    new Promise(function (resolve, reject) {\r\n                        var cleanUp = function () {\r\n                            link.removeEventListener(\"load\", onLoad);\r\n                            link.removeEventListener(\"error\", onError);\r\n                            rejectorsForLoadingLinks.delete(loadingId);\r\n                        };\r\n                        var onLoad = function () {\r\n                            cleanUp();\r\n                            resolve();\r\n                        };\r\n                        var onError = function () {\r\n                            cleanUp();\r\n                            reject(\r\n                                \"Linkelement \"\r\n                                    .concat(loadingId, \" couldn't be loaded. \")\r\n                                    .concat(link.href)\r\n                            );\r\n                        };\r\n                        rejectorsForLoadingLinks.set(loadingId, function () {\r\n                            cleanUp();\r\n                            reject();\r\n                        });\r\n                        link.addEventListener(\"load\", onLoad, {passive: true});\r\n                        link.addEventListener(\"error\", onError, {\r\n                            passive: true\r\n                        });\r\n                        if (!link.href) {\r\n                            onError();\r\n                        }\r\n                    })\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    function getCSSImportURL(importDeclaration) {\r\n        return getCSSURLValue(\r\n            importDeclaration\r\n                .substring(7)\r\n                .trim()\r\n                .replace(/;$/, \"\")\r\n                .replace(/screen$/, \"\")\r\n        );\r\n    }\r\n    function loadText(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!url.startsWith(\"data:\")) return [3, 3];\r\n                        return [4, fetch(url)];\r\n                    case 1:\r\n                        return [4, _a.sent().text()];\r\n                    case 2:\r\n                        return [2, _a.sent()];\r\n                    case 3:\r\n                        return [\r\n                            4,\r\n                            bgFetch({\r\n                                url: url,\r\n                                responseType: \"text\",\r\n                                mimeType: \"text/css\",\r\n                                origin: window.location.origin\r\n                            })\r\n                        ];\r\n                    case 4:\r\n                        return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function replaceCSSImports(cssText, basePath, cache) {\r\n        if (cache === void 0) {\r\n            cache = new Map();\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var importMatches,\r\n                importMatches_1,\r\n                importMatches_1_1,\r\n                match,\r\n                importURL,\r\n                absoluteURL,\r\n                importedCSS,\r\n                e_1_1;\r\n            var e_1, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        cssText = removeCSSComments(cssText);\r\n                        cssText = replaceCSSFontFace(cssText);\r\n                        cssText = replaceCSSRelativeURLsWithAbsolute(\r\n                            cssText,\r\n                            basePath\r\n                        );\r\n                        importMatches = getMatches(cssImportRegex, cssText);\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 10, 11, 12]);\r\n                        (importMatches_1 = __values(importMatches)),\r\n                            (importMatches_1_1 = importMatches_1.next());\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!!importMatches_1_1.done) return [3, 9];\r\n                        match = importMatches_1_1.value;\r\n                        importURL = getCSSImportURL(match);\r\n                        absoluteURL = getAbsoluteURL(basePath, importURL);\r\n                        importedCSS = void 0;\r\n                        if (!cache.has(absoluteURL)) return [3, 3];\r\n                        importedCSS = cache.get(absoluteURL);\r\n                        return [3, 7];\r\n                    case 3:\r\n                        _b.trys.push([3, 6, , 7]);\r\n                        return [4, loadText(absoluteURL)];\r\n                    case 4:\r\n                        importedCSS = _b.sent();\r\n                        cache.set(absoluteURL, importedCSS);\r\n                        return [\r\n                            4,\r\n                            replaceCSSImports(\r\n                                importedCSS,\r\n                                getCSSBaseBath(absoluteURL),\r\n                                cache\r\n                            )\r\n                        ];\r\n                    case 5:\r\n                        importedCSS = _b.sent();\r\n                        return [3, 7];\r\n                    case 6:\r\n                        _b.sent();\r\n                        importedCSS = \"\";\r\n                        return [3, 7];\r\n                    case 7:\r\n                        cssText = cssText.split(match).join(importedCSS);\r\n                        _b.label = 8;\r\n                    case 8:\r\n                        importMatches_1_1 = importMatches_1.next();\r\n                        return [3, 2];\r\n                    case 9:\r\n                        return [3, 12];\r\n                    case 10:\r\n                        e_1_1 = _b.sent();\r\n                        e_1 = {error: e_1_1};\r\n                        return [3, 12];\r\n                    case 11:\r\n                        try {\r\n                            if (\r\n                                importMatches_1_1 &&\r\n                                !importMatches_1_1.done &&\r\n                                (_a = importMatches_1.return)\r\n                            )\r\n                                _a.call(importMatches_1);\r\n                        } finally {\r\n                            if (e_1) throw e_1.error;\r\n                        }\r\n                        return [7];\r\n                    case 12:\r\n                        cssText = cssText.trim();\r\n                        return [2, cssText];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function createCORSCopy(srcElement, cssText) {\r\n        if (!cssText) {\r\n            return null;\r\n        }\r\n        var cors = document.createElement(\"style\");\r\n        cors.classList.add(\"darkreader\");\r\n        cors.classList.add(\"darkreader--cors\");\r\n        cors.media = \"screen\";\r\n        cors.textContent = cssText;\r\n        srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\r\n        cors.sheet.disabled = true;\r\n        corsStyleSet.add(cors);\r\n        return cors;\r\n    }\r\n\r\n    var observers = [];\r\n    var observedRoots;\r\n    var definedCustomElements = new Set();\r\n    var undefinedGroups = new Map();\r\n    var elementsDefinitionCallback;\r\n    function isCustomElement(element) {\r\n        if (element.tagName.includes(\"-\") || element.getAttribute(\"is\")) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function recordUndefinedElement(element) {\r\n        var tag = element.tagName.toLowerCase();\r\n        if (!tag.includes(\"-\")) {\r\n            var extendedTag = element.getAttribute(\"is\");\r\n            if (extendedTag) {\r\n                tag = extendedTag;\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n        if (!undefinedGroups.has(tag)) {\r\n            undefinedGroups.set(tag, new Set());\r\n            customElementsWhenDefined(tag).then(function () {\r\n                if (elementsDefinitionCallback) {\r\n                    var elements = undefinedGroups.get(tag);\r\n                    undefinedGroups.delete(tag);\r\n                    elementsDefinitionCallback(Array.from(elements));\r\n                }\r\n            });\r\n        }\r\n        undefinedGroups.get(tag).add(element);\r\n    }\r\n    function collectUndefinedElements(root) {\r\n        if (!isDefinedSelectorSupported) {\r\n            return;\r\n        }\r\n        forEach(\r\n            root.querySelectorAll(\":not(:defined)\"),\r\n            recordUndefinedElement\r\n        );\r\n    }\r\n    var canOptimizeUsingProxy = false;\r\n    document.addEventListener(\r\n        \"__darkreader__inlineScriptsAllowed\",\r\n        function () {\r\n            canOptimizeUsingProxy = true;\r\n        },\r\n        {once: true, passive: true}\r\n    );\r\n    var resolvers = new Map();\r\n    function handleIsDefined(e) {\r\n        canOptimizeUsingProxy = true;\r\n        var tag = e.detail.tag;\r\n        definedCustomElements.add(tag);\r\n        if (resolvers.has(tag)) {\r\n            var r = resolvers.get(tag);\r\n            resolvers.delete(tag);\r\n            r.forEach(function (r) {\r\n                return r();\r\n            });\r\n        }\r\n    }\r\n    function customElementsWhenDefined(tag) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                if (definedCustomElements.has(tag)) {\r\n                    return [2];\r\n                }\r\n                return [\r\n                    2,\r\n                    new Promise(function (resolve) {\r\n                        if (\r\n                            window.customElements &&\r\n                            typeof customElements.whenDefined === \"function\"\r\n                        ) {\r\n                            customElements.whenDefined(tag).then(function () {\r\n                                return resolve();\r\n                            });\r\n                        } else if (canOptimizeUsingProxy) {\r\n                            if (resolvers.has(tag)) {\r\n                                resolvers.get(tag).push(resolve);\r\n                            } else {\r\n                                resolvers.set(tag, [resolve]);\r\n                            }\r\n                            document.dispatchEvent(\r\n                                new CustomEvent(\r\n                                    \"__darkreader__addUndefinedResolver\",\r\n                                    {detail: {tag: tag}}\r\n                                )\r\n                            );\r\n                        } else {\r\n                            var checkIfDefined_1 = function () {\r\n                                var elements = undefinedGroups.get(tag);\r\n                                if (elements && elements.size > 0) {\r\n                                    if (\r\n                                        elements\r\n                                            .values()\r\n                                            .next()\r\n                                            .value.matches(\":defined\")\r\n                                    ) {\r\n                                        resolve();\r\n                                    } else {\r\n                                        requestAnimationFrame(checkIfDefined_1);\r\n                                    }\r\n                                }\r\n                            };\r\n                            requestAnimationFrame(checkIfDefined_1);\r\n                        }\r\n                    })\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    function watchWhenCustomElementsDefined(callback) {\r\n        elementsDefinitionCallback = callback;\r\n    }\r\n    function unsubscribeFromDefineCustomElements() {\r\n        elementsDefinitionCallback = null;\r\n        undefinedGroups.clear();\r\n        document.removeEventListener(\r\n            \"__darkreader__isDefined\",\r\n            handleIsDefined\r\n        );\r\n    }\r\n    function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\r\n        stopWatchingForStyleChanges();\r\n        var prevStyles = new Set(currentStyles);\r\n        var prevStyleSiblings = new WeakMap();\r\n        var nextStyleSiblings = new WeakMap();\r\n        function saveStylePosition(style) {\r\n            prevStyleSiblings.set(style, style.previousElementSibling);\r\n            nextStyleSiblings.set(style, style.nextElementSibling);\r\n        }\r\n        function forgetStylePosition(style) {\r\n            prevStyleSiblings.delete(style);\r\n            nextStyleSiblings.delete(style);\r\n        }\r\n        function didStylePositionChange(style) {\r\n            return (\r\n                style.previousElementSibling !== prevStyleSiblings.get(style) ||\r\n                style.nextElementSibling !== nextStyleSiblings.get(style)\r\n            );\r\n        }\r\n        currentStyles.forEach(saveStylePosition);\r\n        function handleStyleOperations(operations) {\r\n            var createdStyles = operations.createdStyles,\r\n                removedStyles = operations.removedStyles,\r\n                movedStyles = operations.movedStyles;\r\n            createdStyles.forEach(function (s) {\r\n                return saveStylePosition(s);\r\n            });\r\n            movedStyles.forEach(function (s) {\r\n                return saveStylePosition(s);\r\n            });\r\n            removedStyles.forEach(function (s) {\r\n                return forgetStylePosition(s);\r\n            });\r\n            createdStyles.forEach(function (s) {\r\n                return prevStyles.add(s);\r\n            });\r\n            removedStyles.forEach(function (s) {\r\n                return prevStyles.delete(s);\r\n            });\r\n            if (\r\n                createdStyles.size + removedStyles.size + movedStyles.size >\r\n                0\r\n            ) {\r\n                update({\r\n                    created: Array.from(createdStyles),\r\n                    removed: Array.from(removedStyles),\r\n                    moved: Array.from(movedStyles),\r\n                    updated: []\r\n                });\r\n            }\r\n        }\r\n        function handleMinorTreeMutations(_a) {\r\n            var additions = _a.additions,\r\n                moves = _a.moves,\r\n                deletions = _a.deletions;\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            additions.forEach(function (node) {\r\n                return getManageableStyles(node).forEach(function (style) {\r\n                    return createdStyles.add(style);\r\n                });\r\n            });\r\n            deletions.forEach(function (node) {\r\n                return getManageableStyles(node).forEach(function (style) {\r\n                    return removedStyles.add(style);\r\n                });\r\n            });\r\n            moves.forEach(function (node) {\r\n                return getManageableStyles(node).forEach(function (style) {\r\n                    return movedStyles.add(style);\r\n                });\r\n            });\r\n            handleStyleOperations({\r\n                createdStyles: createdStyles,\r\n                removedStyles: removedStyles,\r\n                movedStyles: movedStyles\r\n            });\r\n            additions.forEach(function (n) {\r\n                extendedIterateShadowHosts(n);\r\n                collectUndefinedElements(n);\r\n            });\r\n            additions.forEach(function (node) {\r\n                return isCustomElement(node) && recordUndefinedElement(node);\r\n            });\r\n        }\r\n        function handleHugeTreeMutations(root) {\r\n            var styles = new Set(getManageableStyles(root));\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            styles.forEach(function (s) {\r\n                if (!prevStyles.has(s)) {\r\n                    createdStyles.add(s);\r\n                }\r\n            });\r\n            prevStyles.forEach(function (s) {\r\n                if (!styles.has(s)) {\r\n                    removedStyles.add(s);\r\n                }\r\n            });\r\n            styles.forEach(function (s) {\r\n                if (\r\n                    !createdStyles.has(s) &&\r\n                    !removedStyles.has(s) &&\r\n                    didStylePositionChange(s)\r\n                ) {\r\n                    movedStyles.add(s);\r\n                }\r\n            });\r\n            handleStyleOperations({\r\n                createdStyles: createdStyles,\r\n                removedStyles: removedStyles,\r\n                movedStyles: movedStyles\r\n            });\r\n            extendedIterateShadowHosts(root);\r\n            collectUndefinedElements(root);\r\n        }\r\n        function handleAttributeMutations(mutations) {\r\n            var updatedStyles = new Set();\r\n            var removedStyles = new Set();\r\n            mutations.forEach(function (m) {\r\n                var target = m.target;\r\n                if (target.isConnected) {\r\n                    if (shouldManageStyle(target)) {\r\n                        updatedStyles.add(target);\r\n                    } else if (\r\n                        target instanceof HTMLLinkElement &&\r\n                        target.disabled\r\n                    ) {\r\n                        removedStyles.add(target);\r\n                    }\r\n                }\r\n            });\r\n            if (updatedStyles.size + removedStyles.size > 0) {\r\n                update({\r\n                    updated: Array.from(updatedStyles),\r\n                    created: [],\r\n                    removed: Array.from(removedStyles),\r\n                    moved: []\r\n                });\r\n            }\r\n        }\r\n        function observe(root) {\r\n            if (observedRoots.has(root)) {\r\n                return;\r\n            }\r\n            var treeObserver = createOptimizedTreeObserver(root, {\r\n                onMinorMutations: handleMinorTreeMutations,\r\n                onHugeMutations: handleHugeTreeMutations\r\n            });\r\n            var attrObserver = new MutationObserver(handleAttributeMutations);\r\n            attrObserver.observe(root, {\r\n                attributeFilter: [\"rel\", \"disabled\", \"media\", \"href\"],\r\n                subtree: true\r\n            });\r\n            observers.push(treeObserver, attrObserver);\r\n            observedRoots.add(root);\r\n        }\r\n        function subscribeForShadowRootChanges(node) {\r\n            var shadowRoot = node.shadowRoot;\r\n            if (shadowRoot == null || observedRoots.has(shadowRoot)) {\r\n                return;\r\n            }\r\n            observe(shadowRoot);\r\n            shadowRootDiscovered(shadowRoot);\r\n        }\r\n        function extendedIterateShadowHosts(node) {\r\n            iterateShadowHosts(node, subscribeForShadowRootChanges);\r\n        }\r\n        observe(document);\r\n        extendedIterateShadowHosts(document.documentElement);\r\n        watchWhenCustomElementsDefined(function (hosts) {\r\n            var newStyles = [];\r\n            hosts.forEach(function (host) {\r\n                return push(newStyles, getManageableStyles(host.shadowRoot));\r\n            });\r\n            update({created: newStyles, updated: [], removed: [], moved: []});\r\n            hosts.forEach(function (host) {\r\n                var shadowRoot = host.shadowRoot;\r\n                if (shadowRoot == null) {\r\n                    return;\r\n                }\r\n                subscribeForShadowRootChanges(host);\r\n                extendedIterateShadowHosts(shadowRoot);\r\n                collectUndefinedElements(shadowRoot);\r\n            });\r\n        });\r\n        document.addEventListener(\"__darkreader__isDefined\", handleIsDefined, {\r\n            passive: true\r\n        });\r\n        collectUndefinedElements(document);\r\n    }\r\n    function resetObservers() {\r\n        observers.forEach(function (o) {\r\n            return o.disconnect();\r\n        });\r\n        observers.splice(0, observers.length);\r\n        observedRoots = new WeakSet();\r\n    }\r\n    function stopWatchingForStyleChanges() {\r\n        resetObservers();\r\n        unsubscribeFromDefineCustomElements();\r\n    }\r\n\r\n    var overrides = new WeakSet();\r\n    function hasAdoptedStyleSheets(node) {\r\n        return (\r\n            Array.isArray(node.adoptedStyleSheets) &&\r\n            node.adoptedStyleSheets.length > 0\r\n        );\r\n    }\r\n    function createAdoptedStyleSheetOverride(node) {\r\n        var cancelAsyncOperations = false;\r\n        function iterateSourceSheets(iterator) {\r\n            node.adoptedStyleSheets.forEach(function (sheet) {\r\n                if (!overrides.has(sheet)) {\r\n                    iterator(sheet);\r\n                }\r\n            });\r\n        }\r\n        function injectSheet(sheet, override) {\r\n            var newSheets = __spreadArray(\r\n                [],\r\n                __read(node.adoptedStyleSheets),\r\n                false\r\n            );\r\n            var sheetIndex = newSheets.indexOf(sheet);\r\n            var overrideIndex = newSheets.indexOf(override);\r\n            if (overrideIndex >= 0) {\r\n                newSheets.splice(overrideIndex, 1);\r\n            }\r\n            newSheets.splice(sheetIndex + 1, 0, override);\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function clear() {\r\n            var newSheets = __spreadArray(\r\n                [],\r\n                __read(node.adoptedStyleSheets),\r\n                false\r\n            );\r\n            for (var i = newSheets.length - 1; i >= 0; i--) {\r\n                var sheet = newSheets[i];\r\n                if (overrides.has(sheet)) {\r\n                    newSheets.splice(i, 1);\r\n                    overrides.delete(sheet);\r\n                }\r\n            }\r\n            if (node.adoptedStyleSheets.length !== newSheets.length) {\r\n                node.adoptedStyleSheets = newSheets;\r\n            }\r\n        }\r\n        function destroy() {\r\n            cancelAsyncOperations = true;\r\n            clear();\r\n            if (frameId) {\r\n                cancelAnimationFrame(frameId);\r\n                frameId = null;\r\n            }\r\n        }\r\n        var rulesChangeKey = 0;\r\n        function getRulesChangeKey() {\r\n            var count = 0;\r\n            iterateSourceSheets(function (sheet) {\r\n                count += sheet.cssRules.length;\r\n            });\r\n            if (count === 1) {\r\n                var rule = node.adoptedStyleSheets[0].cssRules[0];\r\n                return rule instanceof CSSStyleRule ? rule.style.length : count;\r\n            }\r\n            return count;\r\n        }\r\n        function render(theme, ignoreImageAnalysis) {\r\n            clear();\r\n            var _loop_1 = function (i) {\r\n                var sheet = node.adoptedStyleSheets[i];\r\n                if (overrides.has(sheet)) {\r\n                    return \"continue\";\r\n                }\r\n                var rules = sheet.cssRules;\r\n                var override = new CSSStyleSheet();\r\n                var prepareSheet = function () {\r\n                    for (\r\n                        var i_1 = override.cssRules.length - 1;\r\n                        i_1 >= 0;\r\n                        i_1--\r\n                    ) {\r\n                        override.deleteRule(i_1);\r\n                    }\r\n                    injectSheet(sheet, override);\r\n                    overrides.add(override);\r\n                    return override;\r\n                };\r\n                var sheetModifier = createStyleSheetModifier();\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: false,\r\n                    isAsyncCancelled: function () {\r\n                        return cancelAsyncOperations;\r\n                    }\r\n                });\r\n            };\r\n            for (var i = node.adoptedStyleSheets.length - 1; i >= 0; i--) {\r\n                _loop_1(i);\r\n            }\r\n            rulesChangeKey = getRulesChangeKey();\r\n        }\r\n        function checkForUpdates() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        var frameId = null;\r\n        function watch(callback) {\r\n            frameId = requestAnimationFrame(function () {\r\n                if (checkForUpdates()) {\r\n                    var sheets = node.adoptedStyleSheets.filter(function (s) {\r\n                        return !overrides.has(s);\r\n                    });\r\n                    callback(sheets);\r\n                }\r\n                watch(callback);\r\n            });\r\n        }\r\n        return {\r\n            render: render,\r\n            destroy: destroy,\r\n            watch: watch\r\n        };\r\n    }\r\n    var StyleSheetCommandBuilder = (function () {\r\n        function StyleSheetCommandBuilder(onChange) {\r\n            this.cssRules = [];\r\n            this.commands = [];\r\n            this.onChange = onChange;\r\n        }\r\n        StyleSheetCommandBuilder.prototype.insertRule = function (\r\n            cssText,\r\n            index\r\n        ) {\r\n            if (index === void 0) {\r\n                index = 0;\r\n            }\r\n            this.commands.push({\r\n                type: \"insert\",\r\n                index: index,\r\n                cssText: cssText\r\n            });\r\n            this.cssRules.splice(\r\n                index,\r\n                0,\r\n                new StyleSheetCommandBuilder(this.onChange)\r\n            );\r\n            this.onChange();\r\n            return index;\r\n        };\r\n        StyleSheetCommandBuilder.prototype.deleteRule = function (index) {\r\n            this.commands.push({type: \"delete\", index: index});\r\n            this.cssRules.splice(index, 1);\r\n            this.onChange();\r\n        };\r\n        StyleSheetCommandBuilder.prototype.replaceSync = function (cssText) {\r\n            this.commands.splice(0);\r\n            this.commands.push({type: \"replace\", cssText: cssText});\r\n            if (cssText === \"\") {\r\n                this.cssRules.splice(0);\r\n            } else {\r\n                throw new Error(\r\n                    \"StyleSheetCommandBuilder.replaceSync() is not fully supported\"\r\n                );\r\n            }\r\n            this.onChange();\r\n        };\r\n        StyleSheetCommandBuilder.prototype.getDeepCSSCommands = function () {\r\n            var deep = [];\r\n            this.commands.forEach(function (command) {\r\n                deep.push({\r\n                    type: command.type,\r\n                    cssText: command.type !== \"delete\" ? command.cssText : \"\",\r\n                    path: command.type === \"replace\" ? [] : [command.index]\r\n                });\r\n            });\r\n            this.cssRules.forEach(function (rule, i) {\r\n                var childCommands = rule.getDeepCSSCommands();\r\n                childCommands.forEach(function (c) {\r\n                    return c.path.unshift(i);\r\n                });\r\n            });\r\n            return deep;\r\n        };\r\n        StyleSheetCommandBuilder.prototype.clearDeepCSSCommands = function () {\r\n            this.commands.splice(0);\r\n            this.cssRules.forEach(function (rule) {\r\n                return rule.clearDeepCSSCommands();\r\n            });\r\n        };\r\n        return StyleSheetCommandBuilder;\r\n    })();\r\n    function createAdoptedStyleSheetFallback(onChange) {\r\n        var cancelAsyncOperations = false;\r\n        var sourceCSSRules = [];\r\n        var lastTheme;\r\n        var lastIgnoreImageAnalysis;\r\n        function updateCSS(cssRules) {\r\n            sourceCSSRules = cssRules;\r\n            if (lastTheme && lastIgnoreImageAnalysis) {\r\n                render(lastTheme, lastIgnoreImageAnalysis);\r\n            }\r\n        }\r\n        var builder = new StyleSheetCommandBuilder(onChange);\r\n        function render(theme, ignoreImageAnalysis) {\r\n            lastTheme = theme;\r\n            lastIgnoreImageAnalysis = ignoreImageAnalysis;\r\n            var prepareSheet = function () {\r\n                builder.replaceSync(\"\");\r\n                return builder;\r\n            };\r\n            var sheetModifier = createStyleSheetModifier();\r\n            sheetModifier.modifySheet({\r\n                prepareSheet: prepareSheet,\r\n                sourceCSSRules: sourceCSSRules,\r\n                theme: theme,\r\n                ignoreImageAnalysis: ignoreImageAnalysis,\r\n                force: false,\r\n                isAsyncCancelled: function () {\r\n                    return cancelAsyncOperations;\r\n                }\r\n            });\r\n        }\r\n        function commands() {\r\n            var commands = builder.getDeepCSSCommands();\r\n            builder.clearDeepCSSCommands();\r\n            return commands;\r\n        }\r\n        function destroy() {\r\n            cancelAsyncOperations = true;\r\n        }\r\n        return {\r\n            render: render,\r\n            destroy: destroy,\r\n            updateCSS: updateCSS,\r\n            commands: commands\r\n        };\r\n    }\r\n\r\n    function injectProxy(\r\n        enableStyleSheetsProxy,\r\n        enableCustomElementRegistryProxy\r\n    ) {\r\n        document.dispatchEvent(\r\n            new CustomEvent(\"__darkreader__inlineScriptsAllowed\")\r\n        );\r\n        var addRuleDescriptor = Object.getOwnPropertyDescriptor(\r\n            CSSStyleSheet.prototype,\r\n            \"addRule\"\r\n        );\r\n        var insertRuleDescriptor = Object.getOwnPropertyDescriptor(\r\n            CSSStyleSheet.prototype,\r\n            \"insertRule\"\r\n        );\r\n        var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(\r\n            CSSStyleSheet.prototype,\r\n            \"deleteRule\"\r\n        );\r\n        var removeRuleDescriptor = Object.getOwnPropertyDescriptor(\r\n            CSSStyleSheet.prototype,\r\n            \"removeRule\"\r\n        );\r\n        var replaceDescriptor = Object.getOwnPropertyDescriptor(\r\n            CSSStyleSheet.prototype,\r\n            \"replace\"\r\n        );\r\n        var replaceSyncDescriptor = Object.getOwnPropertyDescriptor(\r\n            CSSStyleSheet.prototype,\r\n            \"replaceSync\"\r\n        );\r\n        var documentStyleSheetsDescriptor = enableStyleSheetsProxy\r\n            ? Object.getOwnPropertyDescriptor(Document.prototype, \"styleSheets\")\r\n            : null;\r\n        var customElementRegistryDefineDescriptor =\r\n            enableCustomElementRegistryProxy\r\n                ? Object.getOwnPropertyDescriptor(\r\n                      CustomElementRegistry.prototype,\r\n                      \"define\"\r\n                  )\r\n                : null;\r\n        var shouldWrapHTMLElement = [\r\n            \"baidu.com\",\r\n            \"baike.baidu.com\",\r\n            \"ditu.baidu.com\",\r\n            \"map.baidu.com\",\r\n            \"maps.baidu.com\",\r\n            \"haokan.baidu.com\",\r\n            \"pan.baidu.com\",\r\n            \"passport.baidu.com\",\r\n            \"tieba.baidu.com\",\r\n            \"www.baidu.com\"\r\n        ].includes(location.hostname);\r\n        var getElementsByTagNameDescriptor = shouldWrapHTMLElement\r\n            ? Object.getOwnPropertyDescriptor(\r\n                  Element.prototype,\r\n                  \"getElementsByTagName\"\r\n              )\r\n            : null;\r\n        var shouldProxyChildNodes = location.hostname === \"www.vy.no\";\r\n        var childNodesDescriptor = shouldProxyChildNodes\r\n            ? Object.getOwnPropertyDescriptor(Node.prototype, \"childNodes\")\r\n            : null;\r\n        var cleaners = [];\r\n        var cleanUp = function () {\r\n            Object.defineProperty(\r\n                CSSStyleSheet.prototype,\r\n                \"addRule\",\r\n                addRuleDescriptor\r\n            );\r\n            Object.defineProperty(\r\n                CSSStyleSheet.prototype,\r\n                \"insertRule\",\r\n                insertRuleDescriptor\r\n            );\r\n            Object.defineProperty(\r\n                CSSStyleSheet.prototype,\r\n                \"deleteRule\",\r\n                deleteRuleDescriptor\r\n            );\r\n            Object.defineProperty(\r\n                CSSStyleSheet.prototype,\r\n                \"removeRule\",\r\n                removeRuleDescriptor\r\n            );\r\n            Object.defineProperty(\r\n                CSSStyleSheet.prototype,\r\n                \"replace\",\r\n                replaceDescriptor\r\n            );\r\n            Object.defineProperty(\r\n                CSSStyleSheet.prototype,\r\n                \"replaceSync\",\r\n                replaceSyncDescriptor\r\n            );\r\n            document.removeEventListener(\"__darkreader__cleanUp\", cleanUp);\r\n            document.removeEventListener(\r\n                \"__darkreader__addUndefinedResolver\",\r\n                addUndefinedResolver\r\n            );\r\n            document.removeEventListener(\r\n                \"__darkreader__blobURLCheckRequest\",\r\n                checkBlobURLSupport\r\n            );\r\n            if (enableStyleSheetsProxy) {\r\n                Object.defineProperty(\r\n                    Document.prototype,\r\n                    \"styleSheets\",\r\n                    documentStyleSheetsDescriptor\r\n                );\r\n            }\r\n            if (enableCustomElementRegistryProxy) {\r\n                Object.defineProperty(\r\n                    CustomElementRegistry.prototype,\r\n                    \"define\",\r\n                    customElementRegistryDefineDescriptor\r\n                );\r\n            }\r\n            if (shouldWrapHTMLElement) {\r\n                Object.defineProperty(\r\n                    Element.prototype,\r\n                    \"getElementsByTagName\",\r\n                    getElementsByTagNameDescriptor\r\n                );\r\n            }\r\n            if (shouldProxyChildNodes) {\r\n                Object.defineProperty(\r\n                    Node.prototype,\r\n                    \"childNodes\",\r\n                    childNodesDescriptor\r\n                );\r\n            }\r\n            cleaners.forEach(function (clean) {\r\n                return clean();\r\n            });\r\n            cleaners.splice(0);\r\n        };\r\n        var addUndefinedResolverInner = function (tag) {\r\n            customElements.whenDefined(tag).then(function () {\r\n                document.dispatchEvent(\r\n                    new CustomEvent(\"__darkreader__isDefined\", {\r\n                        detail: {tag: tag}\r\n                    })\r\n                );\r\n            });\r\n        };\r\n        var addUndefinedResolver = function (e) {\r\n            return addUndefinedResolverInner(e.detail.tag);\r\n        };\r\n        document.addEventListener(\"__darkreader__cleanUp\", cleanUp, {\r\n            passive: true\r\n        });\r\n        document.addEventListener(\r\n            \"__darkreader__addUndefinedResolver\",\r\n            addUndefinedResolver,\r\n            {passive: true}\r\n        );\r\n        document.addEventListener(\r\n            \"__darkreader__blobURLCheckRequest\",\r\n            checkBlobURLSupport,\r\n            {once: true}\r\n        );\r\n        var updateSheetEvent = new Event(\"__darkreader__updateSheet\");\r\n        function proxyAddRule(selector, style, index) {\r\n            addRuleDescriptor.value.call(this, selector, style, index);\r\n            if (\r\n                this.ownerNode &&\r\n                !(\r\n                    this.ownerNode.classList &&\r\n                    this.ownerNode.classList.contains(\"darkreader\")\r\n                )\r\n            ) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return -1;\r\n        }\r\n        function proxyInsertRule(rule, index) {\r\n            var returnValue = insertRuleDescriptor.value.call(\r\n                this,\r\n                rule,\r\n                index\r\n            );\r\n            if (\r\n                this.ownerNode &&\r\n                !(\r\n                    this.ownerNode.classList &&\r\n                    this.ownerNode.classList.contains(\"darkreader\")\r\n                )\r\n            ) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return returnValue;\r\n        }\r\n        function proxyDeleteRule(index) {\r\n            deleteRuleDescriptor.value.call(this, index);\r\n            if (\r\n                this.ownerNode &&\r\n                !(\r\n                    this.ownerNode.classList &&\r\n                    this.ownerNode.classList.contains(\"darkreader\")\r\n                )\r\n            ) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyRemoveRule(index) {\r\n            removeRuleDescriptor.value.call(this, index);\r\n            if (\r\n                this.ownerNode &&\r\n                !(\r\n                    this.ownerNode.classList &&\r\n                    this.ownerNode.classList.contains(\"darkreader\")\r\n                )\r\n            ) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyReplace(cssText) {\r\n            var _this = this;\r\n            var returnValue = replaceDescriptor.value.call(this, cssText);\r\n            if (\r\n                this.ownerNode &&\r\n                !(\r\n                    this.ownerNode.classList &&\r\n                    this.ownerNode.classList.contains(\"darkreader\")\r\n                ) &&\r\n                returnValue &&\r\n                returnValue instanceof Promise\r\n            ) {\r\n                returnValue.then(function () {\r\n                    return _this.ownerNode.dispatchEvent(updateSheetEvent);\r\n                });\r\n            }\r\n            return returnValue;\r\n        }\r\n        function proxyReplaceSync(cssText) {\r\n            replaceSyncDescriptor.value.call(this, cssText);\r\n            if (\r\n                this.ownerNode &&\r\n                !(\r\n                    this.ownerNode.classList &&\r\n                    this.ownerNode.classList.contains(\"darkreader\")\r\n                )\r\n            ) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyDocumentStyleSheets() {\r\n            var _this = this;\r\n            var getCurrentValue = function () {\r\n                var docSheets = documentStyleSheetsDescriptor.get.call(_this);\r\n                var filteredSheets = __spreadArray(\r\n                    [],\r\n                    __read(docSheets),\r\n                    false\r\n                ).filter(function (styleSheet) {\r\n                    return (\r\n                        styleSheet.ownerNode &&\r\n                        !(\r\n                            styleSheet.ownerNode.classList &&\r\n                            styleSheet.ownerNode.classList.contains(\r\n                                \"darkreader\"\r\n                            )\r\n                        )\r\n                    );\r\n                });\r\n                filteredSheets.item = function (item) {\r\n                    return filteredSheets[item];\r\n                };\r\n                return Object.setPrototypeOf(\r\n                    filteredSheets,\r\n                    StyleSheetList.prototype\r\n                );\r\n            };\r\n            var elements = getCurrentValue();\r\n            var styleSheetListBehavior = {\r\n                get: function (_, property) {\r\n                    return getCurrentValue()[property];\r\n                }\r\n            };\r\n            elements = new Proxy(elements, styleSheetListBehavior);\r\n            return elements;\r\n        }\r\n        function proxyCustomElementRegistryDefine(name, constructor, options) {\r\n            addUndefinedResolverInner(name);\r\n            customElementRegistryDefineDescriptor.value.call(\r\n                this,\r\n                name,\r\n                constructor,\r\n                options\r\n            );\r\n        }\r\n        function proxyGetElementsByTagName(tagName) {\r\n            var _this = this;\r\n            if (tagName !== \"style\") {\r\n                return getElementsByTagNameDescriptor.value.call(this, tagName);\r\n            }\r\n            var getCurrentElementValue = function () {\r\n                var elements = getElementsByTagNameDescriptor.value.call(\r\n                    _this,\r\n                    tagName\r\n                );\r\n                return Object.setPrototypeOf(\r\n                    __spreadArray([], __read(elements), false).filter(\r\n                        function (element) {\r\n                            return (\r\n                                element &&\r\n                                !(\r\n                                    element.classList &&\r\n                                    element.classList.contains(\"darkreader\")\r\n                                )\r\n                            );\r\n                        }\r\n                    ),\r\n                    NodeList.prototype\r\n                );\r\n            };\r\n            var elements = getCurrentElementValue();\r\n            var nodeListBehavior = {\r\n                get: function (_, property) {\r\n                    return getCurrentElementValue()[\r\n                        Number(property) || property\r\n                    ];\r\n                }\r\n            };\r\n            elements = new Proxy(elements, nodeListBehavior);\r\n            return elements;\r\n        }\r\n        function proxyChildNodes() {\r\n            var childNodes = childNodesDescriptor.get.call(this);\r\n            return Object.setPrototypeOf(\r\n                __spreadArray([], __read(childNodes), false).filter(\r\n                    function (element) {\r\n                        return (\r\n                            !element.classList ||\r\n                            !element.classList.contains(\"darkreader\")\r\n                        );\r\n                    }\r\n                ),\r\n                NodeList.prototype\r\n            );\r\n        }\r\n        function checkBlobURLSupport() {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var svg, bytes, i, blob, objectURL, blobURLAllowed, image_1;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            svg =\r\n                                '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1\" height=\"1\"><rect width=\"1\" height=\"1\" fill=\"transparent\"/></svg>';\r\n                            bytes = new Uint8Array(svg.length);\r\n                            for (i = 0; i < svg.length; i++) {\r\n                                bytes[i] = svg.charCodeAt(i);\r\n                            }\r\n                            blob = new Blob([bytes], {type: \"image/svg+xml\"});\r\n                            objectURL = URL.createObjectURL(blob);\r\n                            _a.label = 1;\r\n                        case 1:\r\n                            _a.trys.push([1, 3, , 4]);\r\n                            image_1 = new Image();\r\n                            return [\r\n                                4,\r\n                                new Promise(function (resolve, reject) {\r\n                                    image_1.onload = function () {\r\n                                        return resolve();\r\n                                    };\r\n                                    image_1.onerror = function () {\r\n                                        return reject();\r\n                                    };\r\n                                    image_1.src = objectURL;\r\n                                })\r\n                            ];\r\n                        case 2:\r\n                            _a.sent();\r\n                            blobURLAllowed = true;\r\n                            return [3, 4];\r\n                        case 3:\r\n                            _a.sent();\r\n                            blobURLAllowed = false;\r\n                            return [3, 4];\r\n                        case 4:\r\n                            document.dispatchEvent(\r\n                                new CustomEvent(\r\n                                    \"__darkreader__blobURLCheckResponse\",\r\n                                    {detail: {blobURLAllowed: blobURLAllowed}}\r\n                                )\r\n                            );\r\n                            return [2];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        Object.defineProperty(\r\n            CSSStyleSheet.prototype,\r\n            \"addRule\",\r\n            __assign(__assign({}, addRuleDescriptor), {value: proxyAddRule})\r\n        );\r\n        Object.defineProperty(\r\n            CSSStyleSheet.prototype,\r\n            \"insertRule\",\r\n            __assign(__assign({}, insertRuleDescriptor), {\r\n                value: proxyInsertRule\r\n            })\r\n        );\r\n        Object.defineProperty(\r\n            CSSStyleSheet.prototype,\r\n            \"deleteRule\",\r\n            __assign(__assign({}, deleteRuleDescriptor), {\r\n                value: proxyDeleteRule\r\n            })\r\n        );\r\n        Object.defineProperty(\r\n            CSSStyleSheet.prototype,\r\n            \"removeRule\",\r\n            __assign(__assign({}, removeRuleDescriptor), {\r\n                value: proxyRemoveRule\r\n            })\r\n        );\r\n        Object.defineProperty(\r\n            CSSStyleSheet.prototype,\r\n            \"replace\",\r\n            __assign(__assign({}, replaceDescriptor), {value: proxyReplace})\r\n        );\r\n        Object.defineProperty(\r\n            CSSStyleSheet.prototype,\r\n            \"replaceSync\",\r\n            __assign(__assign({}, replaceSyncDescriptor), {\r\n                value: proxyReplaceSync\r\n            })\r\n        );\r\n        if (enableStyleSheetsProxy) {\r\n            Object.defineProperty(\r\n                Document.prototype,\r\n                \"styleSheets\",\r\n                __assign(__assign({}, documentStyleSheetsDescriptor), {\r\n                    get: proxyDocumentStyleSheets\r\n                })\r\n            );\r\n        }\r\n        if (enableCustomElementRegistryProxy) {\r\n            Object.defineProperty(\r\n                CustomElementRegistry.prototype,\r\n                \"define\",\r\n                __assign(__assign({}, customElementRegistryDefineDescriptor), {\r\n                    value: proxyCustomElementRegistryDefine\r\n                })\r\n            );\r\n        }\r\n        if (shouldWrapHTMLElement) {\r\n            Object.defineProperty(\r\n                Element.prototype,\r\n                \"getElementsByTagName\",\r\n                __assign(__assign({}, getElementsByTagNameDescriptor), {\r\n                    value: proxyGetElementsByTagName\r\n                })\r\n            );\r\n        }\r\n        if (shouldProxyChildNodes) {\r\n            Object.defineProperty(\r\n                Node.prototype,\r\n                \"childNodes\",\r\n                __assign(__assign({}, childNodesDescriptor), {\r\n                    get: proxyChildNodes\r\n                })\r\n            );\r\n        }\r\n    }\r\n\r\n    var documentVisibilityListener = null;\r\n    var documentIsVisible_ = !document.hidden;\r\n    var listenerOptions = {\r\n        capture: true,\r\n        passive: true\r\n    };\r\n    function watchForDocumentVisibility() {\r\n        document.addEventListener(\r\n            \"visibilitychange\",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.addEventListener(\r\n            \"pageshow\",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.addEventListener(\r\n            \"focus\",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n    }\r\n    function stopWatchingForDocumentVisibility() {\r\n        document.removeEventListener(\r\n            \"visibilitychange\",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.removeEventListener(\r\n            \"pageshow\",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.removeEventListener(\r\n            \"focus\",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n    }\r\n    function setDocumentVisibilityListener(callback) {\r\n        var alreadyWatching = Boolean(documentVisibilityListener);\r\n        documentVisibilityListener = function () {\r\n            if (!document.hidden) {\r\n                removeDocumentVisibilityListener();\r\n                callback();\r\n                documentIsVisible_ = true;\r\n            }\r\n        };\r\n        if (!alreadyWatching) {\r\n            watchForDocumentVisibility();\r\n        }\r\n    }\r\n    function removeDocumentVisibilityListener() {\r\n        stopWatchingForDocumentVisibility();\r\n        documentVisibilityListener = null;\r\n    }\r\n    function documentIsVisible() {\r\n        return documentIsVisible_;\r\n    }\r\n\r\n    var INSTANCE_ID = generateUID();\r\n    var styleManagers = new Map();\r\n    var adoptedStyleManagers = [];\r\n    var adoptedStyleFallbacks = new Map();\r\n    var adoptedStyleNodeIds = new WeakMap();\r\n    var adoptedStyleChangeTokens = new WeakMap();\r\n    var filter = null;\r\n    var fixes = null;\r\n    var isIFrame$1 = null;\r\n    var ignoredImageAnalysisSelectors = [];\r\n    var ignoredInlineSelectors = [];\r\n    function createOrUpdateStyle(className, root) {\r\n        if (root === void 0) {\r\n            root = document.head || document;\r\n        }\r\n        var element = root.querySelector(\".\".concat(className));\r\n        if (!element) {\r\n            element = document.createElement(\"style\");\r\n            element.classList.add(\"darkreader\");\r\n            element.classList.add(className);\r\n            element.media = \"screen\";\r\n            element.textContent = \"\";\r\n        }\r\n        return element;\r\n    }\r\n    function createOrUpdateScript(className, root) {\r\n        if (root === void 0) {\r\n            root = document.head || document;\r\n        }\r\n        var element = root.querySelector(\".\".concat(className));\r\n        if (!element) {\r\n            element = document.createElement(\"script\");\r\n            element.classList.add(\"darkreader\");\r\n            element.classList.add(className);\r\n        }\r\n        return element;\r\n    }\r\n    var nodePositionWatchers = new Map();\r\n    function setupNodePositionWatcher(node, alias) {\r\n        nodePositionWatchers.has(alias) &&\r\n            nodePositionWatchers.get(alias).stop();\r\n        nodePositionWatchers.set(alias, watchForNodePosition(node, \"head\"));\r\n    }\r\n    function stopStylePositionWatchers() {\r\n        forEach(nodePositionWatchers.values(), function (watcher) {\r\n            return watcher.stop();\r\n        });\r\n        nodePositionWatchers.clear();\r\n    }\r\n    function createStaticStyleOverrides() {\r\n        var fallbackStyle = createOrUpdateStyle(\r\n            \"darkreader--fallback\",\r\n            document\r\n        );\r\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\r\n            strict: true\r\n        });\r\n        document.head.insertBefore(fallbackStyle, document.head.firstChild);\r\n        setupNodePositionWatcher(fallbackStyle, \"fallback\");\r\n        var userAgentStyle = createOrUpdateStyle(\"darkreader--user-agent\");\r\n        userAgentStyle.textContent = getModifiedUserAgentStyle(\r\n            filter,\r\n            isIFrame$1,\r\n            filter.styleSystemControls\r\n        );\r\n        document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(userAgentStyle, \"user-agent\");\r\n        var textStyle = createOrUpdateStyle(\"darkreader--text\");\r\n        if (filter.useFont || filter.textStroke > 0) {\r\n            textStyle.textContent = createTextStyle(filter);\r\n        } else {\r\n            textStyle.textContent = \"\";\r\n        }\r\n        document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(textStyle, \"text\");\r\n        var invertStyle = createOrUpdateStyle(\"darkreader--invert\");\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                \"\".concat(fixes.invert.join(\", \"), \" {\"),\r\n                \"    filter: \".concat(\r\n                    getCSSFilterValue(\r\n                        __assign(__assign({}, filter), {\r\n                            contrast:\r\n                                filter.mode === 0\r\n                                    ? filter.contrast\r\n                                    : clamp(filter.contrast - 10, 0, 100)\r\n                        })\r\n                    ),\r\n                    \" !important;\"\r\n                ),\r\n                \"}\"\r\n            ].join(\"\\n\");\r\n        } else {\r\n            invertStyle.textContent = \"\";\r\n        }\r\n        document.head.insertBefore(invertStyle, textStyle.nextSibling);\r\n        setupNodePositionWatcher(invertStyle, \"invert\");\r\n        var inlineStyle = createOrUpdateStyle(\"darkreader--inline\");\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\r\n        setupNodePositionWatcher(inlineStyle, \"inline\");\r\n        var overrideStyle = createOrUpdateStyle(\"darkreader--override\");\r\n        overrideStyle.textContent =\r\n            fixes && fixes.css ? replaceCSSTemplates(fixes.css) : \"\";\r\n        document.head.appendChild(overrideStyle);\r\n        setupNodePositionWatcher(overrideStyle, \"override\");\r\n        var variableStyle = createOrUpdateStyle(\"darkreader--variables\");\r\n        var selectionColors = getSelectionColor(filter);\r\n        var _a = filter,\r\n            darkSchemeBackgroundColor = _a.darkSchemeBackgroundColor,\r\n            darkSchemeTextColor = _a.darkSchemeTextColor,\r\n            lightSchemeBackgroundColor = _a.lightSchemeBackgroundColor,\r\n            lightSchemeTextColor = _a.lightSchemeTextColor,\r\n            mode = _a.mode;\r\n        var schemeBackgroundColor =\r\n            mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\r\n        var schemeTextColor =\r\n            mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\r\n        schemeBackgroundColor = modifyBackgroundColor(\r\n            parseColorWithCache(schemeBackgroundColor),\r\n            filter\r\n        );\r\n        schemeTextColor = modifyForegroundColor(\r\n            parseColorWithCache(schemeTextColor),\r\n            filter\r\n        );\r\n        variableStyle.textContent = [\r\n            \":root {\",\r\n            \"   --darkreader-neutral-background: \".concat(\r\n                schemeBackgroundColor,\r\n                \";\"\r\n            ),\r\n            \"   --darkreader-neutral-text: \".concat(schemeTextColor, \";\"),\r\n            \"   --darkreader-selection-background: \".concat(\r\n                selectionColors.backgroundColorSelection,\r\n                \";\"\r\n            ),\r\n            \"   --darkreader-selection-text: \".concat(\r\n                selectionColors.foregroundColorSelection,\r\n                \";\"\r\n            ),\r\n            \"}\"\r\n        ].join(\"\\n\");\r\n        document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\r\n        setupNodePositionWatcher(variableStyle, \"variables\");\r\n        var rootVarsStyle = createOrUpdateStyle(\"darkreader--root-vars\");\r\n        document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\r\n        var enableStyleSheetsProxy = !(fixes && fixes.disableStyleSheetsProxy);\r\n        var enableCustomElementRegistryProxy = !(\r\n            fixes && fixes.disableCustomElementRegistryProxy\r\n        );\r\n        {\r\n            var proxyScript = createOrUpdateScript(\"darkreader--proxy\");\r\n            proxyScript.append(\r\n                \"(\"\r\n                    .concat(injectProxy, \")(\")\r\n                    .concat(enableStyleSheetsProxy, \", \")\r\n                    .concat(enableCustomElementRegistryProxy, \")\")\r\n            );\r\n            document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\r\n            proxyScript.remove();\r\n        }\r\n    }\r\n    var shadowRootsWithOverrides = new Set();\r\n    function createShadowStaticStyleOverridesInner(root) {\r\n        var inlineStyle = createOrUpdateStyle(\"darkreader--inline\", root);\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        root.insertBefore(inlineStyle, root.firstChild);\r\n        var overrideStyle = createOrUpdateStyle(\"darkreader--override\", root);\r\n        overrideStyle.textContent =\r\n            fixes && fixes.css ? replaceCSSTemplates(fixes.css) : \"\";\r\n        root.insertBefore(overrideStyle, inlineStyle.nextSibling);\r\n        var invertStyle = createOrUpdateStyle(\"darkreader--invert\", root);\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                \"\".concat(fixes.invert.join(\", \"), \" {\"),\r\n                \"    filter: \".concat(\r\n                    getCSSFilterValue(\r\n                        __assign(__assign({}, filter), {\r\n                            contrast:\r\n                                filter.mode === 0\r\n                                    ? filter.contrast\r\n                                    : clamp(filter.contrast - 10, 0, 100)\r\n                        })\r\n                    ),\r\n                    \" !important;\"\r\n                ),\r\n                \"}\"\r\n            ].join(\"\\n\");\r\n        } else {\r\n            invertStyle.textContent = \"\";\r\n        }\r\n        root.insertBefore(invertStyle, overrideStyle.nextSibling);\r\n        shadowRootsWithOverrides.add(root);\r\n    }\r\n    function delayedCreateShadowStaticStyleOverrides(root) {\r\n        var observer = new MutationObserver(function (mutations, observer) {\r\n            var e_1, _a, e_2, _b;\r\n            observer.disconnect();\r\n            try {\r\n                for (\r\n                    var mutations_1 = __values(mutations),\r\n                        mutations_1_1 = mutations_1.next();\r\n                    !mutations_1_1.done;\r\n                    mutations_1_1 = mutations_1.next()\r\n                ) {\r\n                    var _c = mutations_1_1.value,\r\n                        type = _c.type,\r\n                        removedNodes = _c.removedNodes;\r\n                    if (type === \"childList\") {\r\n                        try {\r\n                            for (\r\n                                var _d =\r\n                                        ((e_2 = void 0),\r\n                                        __values(removedNodes)),\r\n                                    _e = _d.next();\r\n                                !_e.done;\r\n                                _e = _d.next()\r\n                            ) {\r\n                                var _f = _e.value,\r\n                                    nodeName = _f.nodeName,\r\n                                    className = _f.className;\r\n                                if (\r\n                                    nodeName === \"STYLE\" &&\r\n                                    [\r\n                                        \"darkreader darkreader--inline\",\r\n                                        \"darkreader darkreader--override\",\r\n                                        \"darkreader darkreader--invert\"\r\n                                    ].includes(className)\r\n                                ) {\r\n                                    createShadowStaticStyleOverridesInner(root);\r\n                                    return;\r\n                                }\r\n                            }\r\n                        } catch (e_2_1) {\r\n                            e_2 = {error: e_2_1};\r\n                        } finally {\r\n                            try {\r\n                                if (_e && !_e.done && (_b = _d.return))\r\n                                    _b.call(_d);\r\n                            } finally {\r\n                                if (e_2) throw e_2.error;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } catch (e_1_1) {\r\n                e_1 = {error: e_1_1};\r\n            } finally {\r\n                try {\r\n                    if (\r\n                        mutations_1_1 &&\r\n                        !mutations_1_1.done &&\r\n                        (_a = mutations_1.return)\r\n                    )\r\n                        _a.call(mutations_1);\r\n                } finally {\r\n                    if (e_1) throw e_1.error;\r\n                }\r\n            }\r\n        });\r\n        observer.observe(root, {childList: true});\r\n    }\r\n    function createShadowStaticStyleOverrides(root) {\r\n        var uninit = root.firstChild === null;\r\n        createShadowStaticStyleOverridesInner(root);\r\n        if (uninit) {\r\n            delayedCreateShadowStaticStyleOverrides(root);\r\n        }\r\n    }\r\n    function replaceCSSTemplates($cssText) {\r\n        return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\r\n            var color = parseColorWithCache($color);\r\n            if (color) {\r\n                return modifyColor(color, filter);\r\n            }\r\n            return $color;\r\n        });\r\n    }\r\n    function cleanFallbackStyle() {\r\n        var fallback = document.querySelector(\".darkreader--fallback\");\r\n        if (fallback) {\r\n            fallback.textContent = \"\";\r\n        }\r\n    }\r\n    function createDynamicStyleOverrides() {\r\n        cancelRendering();\r\n        var allStyles = getManageableStyles(document);\r\n        var newManagers = allStyles\r\n            .filter(function (style) {\r\n                return !styleManagers.has(style);\r\n            })\r\n            .map(function (style) {\r\n                return createManager(style);\r\n            });\r\n        newManagers\r\n            .map(function (manager) {\r\n                return manager.details({secondRound: false});\r\n            })\r\n            .filter(function (detail) {\r\n                return detail && detail.rules.length > 0;\r\n            })\r\n            .forEach(function (detail) {\r\n                variablesStore.addRulesForMatching(detail.rules);\r\n            });\r\n        variablesStore.matchVariablesAndDependents();\r\n        variablesStore.setOnRootVariableChange(function () {\r\n            var rootVarsStyle = createOrUpdateStyle(\"darkreader--root-vars\");\r\n            variablesStore.putRootVars(rootVarsStyle, filter);\r\n        });\r\n        var rootVarsStyle = createOrUpdateStyle(\"darkreader--root-vars\");\r\n        variablesStore.putRootVars(rootVarsStyle, filter);\r\n        styleManagers.forEach(function (manager) {\r\n            return manager.render(filter, ignoredImageAnalysisSelectors);\r\n        });\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n        }\r\n        newManagers.forEach(function (manager) {\r\n            return manager.watch();\r\n        });\r\n        var inlineStyleElements = toArray(\r\n            document.querySelectorAll(INLINE_STYLE_SELECTOR)\r\n        );\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            createShadowStaticStyleOverrides(host.shadowRoot);\r\n            var elements = host.shadowRoot.querySelectorAll(\r\n                INLINE_STYLE_SELECTOR\r\n            );\r\n            if (elements.length > 0) {\r\n                push(inlineStyleElements, elements);\r\n            }\r\n        });\r\n        inlineStyleElements.forEach(function (el) {\r\n            return overrideInlineStyle(\r\n                el,\r\n                filter,\r\n                ignoredInlineSelectors,\r\n                ignoredImageAnalysisSelectors\r\n            );\r\n        });\r\n        handleAdoptedStyleSheets(document);\r\n        variablesStore.matchVariablesAndDependents();\r\n        if (isFirefox) {\r\n            var MATCH_VAR_1 = Symbol();\r\n            var onAdoptedCSSChange_1 = function (e) {\r\n                var _a = e.detail,\r\n                    node = _a.node,\r\n                    id = _a.id,\r\n                    cssRules = _a.cssRules,\r\n                    entries = _a.entries;\r\n                if (Array.isArray(entries)) {\r\n                    entries.forEach(function (e) {\r\n                        var cssRules = e[2];\r\n                        variablesStore.addRulesForMatching(cssRules);\r\n                    });\r\n                    variablesStore.matchVariablesAndDependents();\r\n                } else if (cssRules) {\r\n                    variablesStore.addRulesForMatching(cssRules);\r\n                    requestAnimationFrameOnce(MATCH_VAR_1, function () {\r\n                        return variablesStore.matchVariablesAndDependents();\r\n                    });\r\n                }\r\n                var tuples = Array.isArray(entries)\r\n                    ? entries\r\n                    : node && cssRules\r\n                      ? [[node, id, cssRules]]\r\n                      : [];\r\n                tuples.forEach(function (_a) {\r\n                    var _b = __read(_a, 3),\r\n                        node = _b[0],\r\n                        id = _b[1],\r\n                        cssRules = _b[2];\r\n                    adoptedStyleNodeIds.set(node, id);\r\n                    var fallback = getAdoptedStyleSheetFallback(node);\r\n                    fallback.updateCSS(cssRules);\r\n                });\r\n            };\r\n            document.addEventListener(\r\n                \"__darkreader__adoptedStyleSheetsChange\",\r\n                onAdoptedCSSChange_1\r\n            );\r\n            cleaners.push(function () {\r\n                return document.removeEventListener(\r\n                    \"__darkreader__adoptedStyleSheetsChange\",\r\n                    onAdoptedCSSChange_1\r\n                );\r\n            });\r\n            document.dispatchEvent(\r\n                new CustomEvent(\"__darkreader__startAdoptedStyleSheetsWatcher\")\r\n            );\r\n        }\r\n    }\r\n    var loadingStylesCounter = 0;\r\n    var loadingStyles = new Set();\r\n    function createManager(element) {\r\n        var loadingStyleId = ++loadingStylesCounter;\r\n        function loadingStart() {\r\n            if (!isDOMReady() || !documentIsVisible()) {\r\n                loadingStyles.add(loadingStyleId);\r\n                logInfo(\r\n                    \"Current amount of styles loading: \".concat(\r\n                        loadingStyles.size\r\n                    )\r\n                );\r\n                var fallbackStyle = document.querySelector(\r\n                    \".darkreader--fallback\"\r\n                );\r\n                if (!fallbackStyle.textContent) {\r\n                    fallbackStyle.textContent = getModifiedFallbackStyle(\r\n                        filter,\r\n                        {strict: false}\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        function loadingEnd() {\r\n            loadingStyles.delete(loadingStyleId);\r\n            logInfo(\r\n                \"Removed loadingStyle \"\r\n                    .concat(loadingStyleId, \", now awaiting: \")\r\n                    .concat(loadingStyles.size)\r\n            );\r\n            if (loadingStyles.size === 0 && isDOMReady()) {\r\n                cleanFallbackStyle();\r\n            }\r\n        }\r\n        function update() {\r\n            var details = manager.details({secondRound: true});\r\n            if (!details) {\r\n                return;\r\n            }\r\n            variablesStore.addRulesForMatching(details.rules);\r\n            variablesStore.matchVariablesAndDependents();\r\n            manager.render(filter, ignoredImageAnalysisSelectors);\r\n        }\r\n        var manager = manageStyle(element, {\r\n            update: update,\r\n            loadingStart: loadingStart,\r\n            loadingEnd: loadingEnd\r\n        });\r\n        styleManagers.set(element, manager);\r\n        return manager;\r\n    }\r\n    function removeManager(element) {\r\n        var manager = styleManagers.get(element);\r\n        if (manager) {\r\n            manager.destroy();\r\n            styleManagers.delete(element);\r\n        }\r\n    }\r\n    var throttledRenderAllStyles = throttle(function (callback) {\r\n        styleManagers.forEach(function (manager) {\r\n            return manager.render(filter, ignoredImageAnalysisSelectors);\r\n        });\r\n        adoptedStyleManagers.forEach(function (manager) {\r\n            return manager.render(filter, ignoredImageAnalysisSelectors);\r\n        });\r\n        callback && callback();\r\n    });\r\n    var cancelRendering = function () {\r\n        throttledRenderAllStyles.cancel();\r\n    };\r\n    function onDOMReady() {\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n            return;\r\n        }\r\n    }\r\n    function runDynamicStyle() {\r\n        createDynamicStyleOverrides();\r\n        watchForUpdates();\r\n    }\r\n    function createThemeAndWatchForUpdates() {\r\n        createStaticStyleOverrides();\r\n        if (!documentIsVisible() && !filter.immediateModify) {\r\n            setDocumentVisibilityListener(runDynamicStyle);\r\n        } else {\r\n            runDynamicStyle();\r\n        }\r\n        changeMetaThemeColorWhenAvailable(filter);\r\n    }\r\n    var pendingAdoptedVarMatch = false;\r\n    function handleAdoptedStyleSheets(node) {\r\n        var theme = filter;\r\n        if (isFirefox) {\r\n            var fallback = getAdoptedStyleSheetFallback(node);\r\n            fallback.render(theme, ignoredImageAnalysisSelectors);\r\n            return;\r\n        }\r\n        if (hasAdoptedStyleSheets(node)) {\r\n            node.adoptedStyleSheets.forEach(function (s) {\r\n                variablesStore.addRulesForMatching(s.cssRules);\r\n            });\r\n            var newManger_1 = createAdoptedStyleSheetOverride(node);\r\n            adoptedStyleManagers.push(newManger_1);\r\n            newManger_1.render(theme, ignoredImageAnalysisSelectors);\r\n            newManger_1.watch(function (sheets) {\r\n                sheets.forEach(function (s) {\r\n                    variablesStore.addRulesForMatching(s.cssRules);\r\n                });\r\n                newManger_1.render(theme, ignoredImageAnalysisSelectors);\r\n                pendingAdoptedVarMatch = true;\r\n            });\r\n            potentialAdoptedStyleNodes.delete(node);\r\n        } else if (!potentialAdoptedStyleNodes.has(node)) {\r\n            potentialAdoptedStyleNodes.add(node);\r\n        }\r\n    }\r\n    var potentialAdoptedStyleNodes = new Set();\r\n    var potentialAdoptedStyleFrameId = null;\r\n    function watchPotentialAdoptedStyleNodes() {\r\n        potentialAdoptedStyleFrameId = requestAnimationFrame(function () {\r\n            var changed = false;\r\n            potentialAdoptedStyleNodes.forEach(function (node) {\r\n                if (node.isConnected) {\r\n                    handleAdoptedStyleSheets(node);\r\n                    changed = true;\r\n                } else {\r\n                    potentialAdoptedStyleNodes.delete(node);\r\n                }\r\n            });\r\n            if (changed || pendingAdoptedVarMatch) {\r\n                variablesStore.matchVariablesAndDependents();\r\n                pendingAdoptedVarMatch = false;\r\n            }\r\n            watchPotentialAdoptedStyleNodes();\r\n        });\r\n    }\r\n    function stopWatchingPotentialAdoptedStyleNodes() {\r\n        potentialAdoptedStyleFrameId &&\r\n            cancelAnimationFrame(potentialAdoptedStyleFrameId);\r\n        potentialAdoptedStyleNodes.clear();\r\n        if (isFirefox) {\r\n            document.dispatchEvent(\r\n                new CustomEvent(\"__darkreader__stopAdoptedStyleSheetsWatcher\")\r\n            );\r\n        }\r\n    }\r\n    function getAdoptedStyleChangeToken(node) {\r\n        if (adoptedStyleChangeTokens.has(node)) {\r\n            return adoptedStyleChangeTokens.get(node);\r\n        }\r\n        var token = Symbol();\r\n        adoptedStyleChangeTokens.set(node, token);\r\n        return token;\r\n    }\r\n    function getAdoptedStyleSheetFallback(node) {\r\n        var fallback = adoptedStyleFallbacks.get(node);\r\n        if (!fallback) {\r\n            fallback = createAdoptedStyleSheetFallback(function () {\r\n                var token = getAdoptedStyleChangeToken(node);\r\n                requestAnimationFrameOnce(token, function () {\r\n                    var id = adoptedStyleNodeIds.get(node);\r\n                    var commands =\r\n                        fallback === null || fallback === void 0\r\n                            ? void 0\r\n                            : fallback.commands();\r\n                    var data = {id: id, commands: commands};\r\n                    document.dispatchEvent(\r\n                        new CustomEvent(\r\n                            \"__darkreader__adoptedStyleSheetCommands\",\r\n                            {detail: JSON.stringify(data)}\r\n                        )\r\n                    );\r\n                });\r\n            });\r\n            adoptedStyleFallbacks.set(node, fallback);\r\n        }\r\n        return fallback;\r\n    }\r\n    function watchForUpdates() {\r\n        var managedStyles = Array.from(styleManagers.keys());\r\n        watchForStyleChanges(\r\n            managedStyles,\r\n            function (_a) {\r\n                var created = _a.created,\r\n                    updated = _a.updated,\r\n                    removed = _a.removed,\r\n                    moved = _a.moved;\r\n                var stylesToRemove = removed;\r\n                var stylesToManage = created\r\n                    .concat(updated)\r\n                    .concat(moved)\r\n                    .filter(function (style) {\r\n                        return !styleManagers.has(style);\r\n                    });\r\n                var stylesToRestore = moved.filter(function (style) {\r\n                    return styleManagers.has(style);\r\n                });\r\n                stylesToRemove.forEach(function (style) {\r\n                    return removeManager(style);\r\n                });\r\n                var newManagers = stylesToManage.map(function (style) {\r\n                    return createManager(style);\r\n                });\r\n                newManagers\r\n                    .map(function (manager) {\r\n                        return manager.details({secondRound: false});\r\n                    })\r\n                    .filter(function (detail) {\r\n                        return detail && detail.rules.length > 0;\r\n                    })\r\n                    .forEach(function (detail) {\r\n                        variablesStore.addRulesForMatching(detail.rules);\r\n                    });\r\n                variablesStore.matchVariablesAndDependents();\r\n                newManagers.forEach(function (manager) {\r\n                    return manager.render(\r\n                        filter,\r\n                        ignoredImageAnalysisSelectors\r\n                    );\r\n                });\r\n                newManagers.forEach(function (manager) {\r\n                    return manager.watch();\r\n                });\r\n                stylesToRestore.forEach(function (style) {\r\n                    return styleManagers.get(style).restore();\r\n                });\r\n            },\r\n            function (shadowRoot) {\r\n                createShadowStaticStyleOverrides(shadowRoot);\r\n                handleAdoptedStyleSheets(shadowRoot);\r\n            }\r\n        );\r\n        watchPotentialAdoptedStyleNodes();\r\n        watchForInlineStyles(\r\n            function (element) {\r\n                overrideInlineStyle(\r\n                    element,\r\n                    filter,\r\n                    ignoredInlineSelectors,\r\n                    ignoredImageAnalysisSelectors\r\n                );\r\n                if (element === document.documentElement) {\r\n                    var styleAttr = element.getAttribute(\"style\") || \"\";\r\n                    if (styleAttr.includes(\"--\")) {\r\n                        variablesStore.matchVariablesAndDependents();\r\n                        var rootVarsStyle = createOrUpdateStyle(\r\n                            \"darkreader--root-vars\"\r\n                        );\r\n                        variablesStore.putRootVars(rootVarsStyle, filter);\r\n                    }\r\n                }\r\n            },\r\n            function (root) {\r\n                createShadowStaticStyleOverrides(root);\r\n                var inlineStyleElements = root.querySelectorAll(\r\n                    INLINE_STYLE_SELECTOR\r\n                );\r\n                if (inlineStyleElements.length > 0) {\r\n                    forEach(inlineStyleElements, function (el) {\r\n                        return overrideInlineStyle(\r\n                            el,\r\n                            filter,\r\n                            ignoredInlineSelectors,\r\n                            ignoredImageAnalysisSelectors\r\n                        );\r\n                    });\r\n                }\r\n            }\r\n        );\r\n        addDOMReadyListener(onDOMReady);\r\n    }\r\n    function stopWatchingForUpdates() {\r\n        styleManagers.forEach(function (manager) {\r\n            return manager.pause();\r\n        });\r\n        stopStylePositionWatchers();\r\n        stopWatchingForStyleChanges();\r\n        stopWatchingForInlineStyles();\r\n        removeDOMReadyListener(onDOMReady);\r\n        cleanReadyStateCompleteListeners();\r\n    }\r\n    var metaObserver;\r\n    function addMetaListener() {\r\n        metaObserver = new MutationObserver(function () {\r\n            if (document.querySelector('meta[name=\"darkreader-lock\"]')) {\r\n                metaObserver.disconnect();\r\n                removeDynamicTheme();\r\n            }\r\n        });\r\n        metaObserver.observe(document.head, {childList: true, subtree: true});\r\n    }\r\n    function createDarkReaderInstanceMarker() {\r\n        var metaElement = document.createElement(\"meta\");\r\n        metaElement.name = \"darkreader\";\r\n        metaElement.content = INSTANCE_ID;\r\n        document.head.appendChild(metaElement);\r\n    }\r\n    function isAnotherDarkReaderInstanceActive() {\r\n        if (document.querySelector('meta[name=\"darkreader-lock\"]')) {\r\n            return true;\r\n        }\r\n        var meta = document.querySelector('meta[name=\"darkreader\"]');\r\n        if (meta) {\r\n            if (meta.content !== INSTANCE_ID) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        createDarkReaderInstanceMarker();\r\n        addMetaListener();\r\n        return false;\r\n    }\r\n    function createOrUpdateDynamicThemeInternal(\r\n        filterConfig,\r\n        dynamicThemeFixes,\r\n        iframe\r\n    ) {\r\n        filter = filterConfig;\r\n        fixes = dynamicThemeFixes;\r\n        if (fixes) {\r\n            ignoredImageAnalysisSelectors = Array.isArray(\r\n                fixes.ignoreImageAnalysis\r\n            )\r\n                ? fixes.ignoreImageAnalysis\r\n                : [];\r\n            ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle)\r\n                ? fixes.ignoreInlineStyle\r\n                : [];\r\n        } else {\r\n            ignoredImageAnalysisSelectors = [];\r\n            ignoredInlineSelectors = [];\r\n        }\r\n        if (filter.immediateModify) {\r\n            setIsDOMReady(function () {\r\n                return true;\r\n            });\r\n        }\r\n        isIFrame$1 = iframe;\r\n        if (document.head) {\r\n            if (isAnotherDarkReaderInstanceActive()) {\r\n                removeDynamicTheme();\r\n                return;\r\n            }\r\n            document.documentElement.setAttribute(\r\n                \"data-darkreader-mode\",\r\n                \"dynamic\"\r\n            );\r\n            document.documentElement.setAttribute(\r\n                \"data-darkreader-scheme\",\r\n                filter.mode ? \"dark\" : \"dimmed\"\r\n            );\r\n            createThemeAndWatchForUpdates();\r\n        } else {\r\n            if (!isFirefox) {\r\n                var fallbackStyle = createOrUpdateStyle(\"darkreader--fallback\");\r\n                document.documentElement.appendChild(fallbackStyle);\r\n                fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\r\n                    strict: true\r\n                });\r\n            }\r\n            var headObserver_1 = new MutationObserver(function () {\r\n                if (document.head) {\r\n                    headObserver_1.disconnect();\r\n                    if (isAnotherDarkReaderInstanceActive()) {\r\n                        removeDynamicTheme();\r\n                        return;\r\n                    }\r\n                    createThemeAndWatchForUpdates();\r\n                }\r\n            });\r\n            headObserver_1.observe(document, {childList: true, subtree: true});\r\n        }\r\n    }\r\n    function removeProxy() {\r\n        document.dispatchEvent(new CustomEvent(\"__darkreader__cleanUp\"));\r\n        removeNode(document.head.querySelector(\".darkreader--proxy\"));\r\n    }\r\n    var cleaners = [];\r\n    function removeDynamicTheme() {\r\n        document.documentElement.removeAttribute(\"data-darkreader-mode\");\r\n        document.documentElement.removeAttribute(\"data-darkreader-scheme\");\r\n        cleanDynamicThemeCache();\r\n        removeNode(document.querySelector(\".darkreader--fallback\"));\r\n        if (document.head) {\r\n            restoreMetaThemeColor();\r\n            removeNode(document.head.querySelector(\".darkreader--user-agent\"));\r\n            removeNode(document.head.querySelector(\".darkreader--text\"));\r\n            removeNode(document.head.querySelector(\".darkreader--invert\"));\r\n            removeNode(document.head.querySelector(\".darkreader--inline\"));\r\n            removeNode(document.head.querySelector(\".darkreader--override\"));\r\n            removeNode(document.head.querySelector(\".darkreader--variables\"));\r\n            removeNode(document.head.querySelector(\".darkreader--root-vars\"));\r\n            removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\r\n            removeProxy();\r\n        }\r\n        shadowRootsWithOverrides.forEach(function (root) {\r\n            removeNode(root.querySelector(\".darkreader--inline\"));\r\n            removeNode(root.querySelector(\".darkreader--override\"));\r\n        });\r\n        shadowRootsWithOverrides.clear();\r\n        forEach(styleManagers.keys(), function (el) {\r\n            return removeManager(el);\r\n        });\r\n        loadingStyles.clear();\r\n        cleanLoadingLinks();\r\n        forEach(document.querySelectorAll(\".darkreader\"), removeNode);\r\n        adoptedStyleManagers.forEach(function (manager) {\r\n            return manager.destroy();\r\n        });\r\n        adoptedStyleManagers.splice(0);\r\n        adoptedStyleFallbacks.forEach(function (fallback) {\r\n            return fallback.destroy();\r\n        });\r\n        adoptedStyleFallbacks.clear();\r\n        stopWatchingPotentialAdoptedStyleNodes();\r\n        metaObserver && metaObserver.disconnect();\r\n        cleaners.forEach(function (clean) {\r\n            return clean();\r\n        });\r\n        cleaners.splice(0);\r\n    }\r\n    function cleanDynamicThemeCache() {\r\n        variablesStore.clear();\r\n        parsedURLCache.clear();\r\n        removeDocumentVisibilityListener();\r\n        cancelRendering();\r\n        stopWatchingForUpdates();\r\n        cleanModificationCache();\r\n        clearColorCache();\r\n    }\r\n\r\n    var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\r\n    function replaceBlobs(text) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises, data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        getMatches(blobRegex, text, 1).forEach(function (url) {\r\n                            var promise = loadAsDataURL(url);\r\n                            promises.push(promise);\r\n                        });\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        return [\r\n                            2,\r\n                            text.replace(blobRegex, function () {\r\n                                return 'url(\"'.concat(data.shift(), '\")');\r\n                            })\r\n                        ];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var banner =\r\n        '/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \"==\"    \"==\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/main/LICENSE */\\n';\r\n    function collectCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            function addStaticCSS(selector, comment) {\r\n                var staticStyle = document.querySelector(selector);\r\n                if (staticStyle && staticStyle.textContent) {\r\n                    css.push(\"/* \".concat(comment, \" */\"));\r\n                    css.push(staticStyle.textContent);\r\n                    css.push(\"\");\r\n                }\r\n            }\r\n            var css, modifiedCSS, formattedCSS, _a, _b;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        css = [banner];\r\n                        addStaticCSS(\".darkreader--fallback\", \"Fallback Style\");\r\n                        addStaticCSS(\r\n                            \".darkreader--user-agent\",\r\n                            \"User-Agent Style\"\r\n                        );\r\n                        addStaticCSS(\".darkreader--text\", \"Text Style\");\r\n                        addStaticCSS(\".darkreader--invert\", \"Invert Style\");\r\n                        addStaticCSS(\r\n                            \".darkreader--variables\",\r\n                            \"Variables Style\"\r\n                        );\r\n                        modifiedCSS = [];\r\n                        document\r\n                            .querySelectorAll(\".darkreader--sync\")\r\n                            .forEach(function (element) {\r\n                                forEach(\r\n                                    element.sheet.cssRules,\r\n                                    function (rule) {\r\n                                        rule &&\r\n                                            rule.cssText &&\r\n                                            modifiedCSS.push(rule.cssText);\r\n                                    }\r\n                                );\r\n                            });\r\n                        if (!modifiedCSS.length) return [3, 2];\r\n                        formattedCSS = formatCSS(modifiedCSS.join(\"\\n\"));\r\n                        css.push(\"/* Modified CSS */\");\r\n                        _b = (_a = css).push;\r\n                        return [4, replaceBlobs(formattedCSS)];\r\n                    case 1:\r\n                        _b.apply(_a, [_c.sent()]);\r\n                        css.push(\"\");\r\n                        _c.label = 2;\r\n                    case 2:\r\n                        addStaticCSS(\".darkreader--override\", \"Override Style\");\r\n                        return [2, css.join(\"\\n\")];\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    var isDarkReaderEnabled = false;\r\n    var isIFrame = (function () {\r\n        try {\r\n            return window.self !== window.top;\r\n        } catch (err) {\r\n            console.warn(err);\r\n            return true;\r\n        }\r\n    })();\r\n    function enable(themeOptions, fixes) {\r\n        if (themeOptions === void 0) {\r\n            themeOptions = {};\r\n        }\r\n        if (fixes === void 0) {\r\n            fixes = null;\r\n        }\r\n        var theme = __assign(__assign({}, DEFAULT_THEME), themeOptions);\r\n        if (theme.engine !== ThemeEngine.dynamicTheme) {\r\n            throw new Error(\"Theme engine is not supported.\");\r\n        }\r\n        createOrUpdateDynamicThemeInternal(theme, fixes, isIFrame);\r\n        isDarkReaderEnabled = true;\r\n    }\r\n    function isEnabled() {\r\n        return isDarkReaderEnabled;\r\n    }\r\n    function disable() {\r\n        removeDynamicTheme();\r\n        isDarkReaderEnabled = false;\r\n    }\r\n    var darkScheme = matchMedia(\"(prefers-color-scheme: dark)\");\r\n    var store = {\r\n        themeOptions: null,\r\n        fixes: null\r\n    };\r\n    function handleColorScheme() {\r\n        if (darkScheme.matches) {\r\n            enable(store.themeOptions, store.fixes);\r\n        } else {\r\n            disable();\r\n        }\r\n    }\r\n    function auto(themeOptions, fixes) {\r\n        if (themeOptions === void 0) {\r\n            themeOptions = {};\r\n        }\r\n        if (fixes === void 0) {\r\n            fixes = null;\r\n        }\r\n        if (themeOptions) {\r\n            store = {themeOptions: themeOptions, fixes: fixes};\r\n            handleColorScheme();\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.addEventListener(\"change\", handleColorScheme);\r\n            } else {\r\n                darkScheme.addListener(handleColorScheme);\r\n            }\r\n        } else {\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.removeEventListener(\"change\", handleColorScheme);\r\n            } else {\r\n                darkScheme.removeListener(handleColorScheme);\r\n            }\r\n            disable();\r\n        }\r\n    }\r\n    function exportGeneratedCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        return [4, collectCSS()];\r\n                    case 1:\r\n                        return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var setFetchMethod = setFetchMethod$1;\r\n\r\n    exports.auto = auto;\r\n    exports.disable = disable;\r\n    exports.enable = enable;\r\n    exports.exportGeneratedCSS = exportGeneratedCSS;\r\n    exports.isEnabled = isEnabled;\r\n    exports.setFetchMethod = setFetchMethod;\r\n\r\n    Object.defineProperty(exports, \"__esModule\", {value: true});\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZGFya3JlYWRlci9kYXJrcmVhZGVyLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksS0FBNEQ7QUFDaEU7QUFDQSxVQUFVLENBTW9DO0FBQzlDLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxPQUFPO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsK0NBQStDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLGlCQUFpQjtBQUNqQixVQUFVO0FBQ1Y7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELE9BQU87QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLDhDQUE4QztBQUNuRDtBQUNBO0FBQ0E7QUFDQSxLQUFLLDhDQUE4QztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssd0RBQXdEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssOENBQThDO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLEtBQUssd0RBQXdEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLDhDQUE4QztBQUNuRDtBQUNBO0FBQ0E7QUFDQSxLQUFLLHdEQUF3RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQSxLQUFLLDhDQUE4QztBQUNuRDtBQUNBO0FBQ0E7QUFDQSxLQUFLLDhDQUE4QztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Q3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0Esc0NBQXNDLGdCQUFnQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLFNBQVM7QUFDbEQ7QUFDQSxpREFBaUQsVUFBVTtBQUMzRDtBQUNBLHFEQUFxRCxVQUFVO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtB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QUNBLHFDQUFxQyxpQkFBaUI7QUFDdEQsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSx5Q0FBeUMsdUJBQXVCO0FBQ2hFLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekIscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsY0FBYztBQUNkO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZCx1QkFBdUI7QUFDdkIsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0U7QUFDdEU7QUFDQTtBQUNBLGNBQWM7QUFDZCx1QkFBdUI7QUFDdkIsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixJQUFJLE1BQU0sSUFBSSxNQUFNLElBQUk7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQSwwREFBMEQ7QUFDMUQsc0JBQXNCO0FBQ3RCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsNkRBQTZELFFBQVE7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsNkJBQTZCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msa0NBQWtDO0FBQ2xFO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQyxxQkFBcUI7QUFDckI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLGtCQUFrQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELFlBQVk7QUFDOUQsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvZGFya3JlYWRlci9kYXJrcmVhZGVyLmpzPzAwN2YiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIERhcmsgUmVhZGVyIHY0LjkuNzVcclxuICogaHR0cHM6Ly9kYXJrcmVhZGVyLm9yZy9cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xyXG4gICAgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgID8gZmFjdG9yeShleHBvcnRzKVxyXG4gICAgICAgIDogdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWRcclxuICAgICAgICAgID8gZGVmaW5lKFtcImV4cG9ydHNcIl0sIGZhY3RvcnkpXHJcbiAgICAgICAgICA6ICgoZ2xvYmFsID1cclxuICAgICAgICAgICAgICAgIHR5cGVvZiBnbG9iYWxUaGlzICE9PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgPyBnbG9iYWxUaGlzXHJcbiAgICAgICAgICAgICAgICAgICAgOiBnbG9iYWwgfHwgc2VsZiksXHJcbiAgICAgICAgICAgIGZhY3RvcnkoKGdsb2JhbC5EYXJrUmVhZGVyID0ge30pKSk7XHJcbn0pKHRoaXMsIGZ1bmN0aW9uIChleHBvcnRzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAgICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcbiAgICBQZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxuICAgIHB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcbiAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcbiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuICAgIEFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuICAgIElORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG4gICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuICAgIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuICAgIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4gICAgLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UsIFN1cHByZXNzZWRFcnJvciwgU3ltYm9sICovXHJcblxyXG4gICAgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIF9fYXNzaWduID1cclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbiB8fFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQXHJcbiAgICAgICAgICAgICAgICA/IHZhbHVlXHJcbiAgICAgICAgICAgICAgICA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQuZG9uZVxyXG4gICAgICAgICAgICAgICAgICAgID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3RlcChcclxuICAgICAgICAgICAgICAgIChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgICAgICB2YXIgXyA9IHtcclxuICAgICAgICAgICAgICAgIGxhYmVsOiAwLFxyXG4gICAgICAgICAgICAgICAgc2VudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFsxXTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0cnlzOiBbXSxcclxuICAgICAgICAgICAgICAgIG9wczogW11cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZixcclxuICAgICAgICAgICAgeSxcclxuICAgICAgICAgICAgdCxcclxuICAgICAgICAgICAgZztcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAoZyA9IHtuZXh0OiB2ZXJiKDApLCB0aHJvdzogdmVyYigxKSwgcmV0dXJuOiB2ZXJiKDIpfSksXHJcbiAgICAgICAgICAgIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG4gICAgICAgICAgICAgICAgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBnXHJcbiAgICAgICAgKTtcclxuICAgICAgICBmdW5jdGlvbiB2ZXJiKG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RlcChbbiwgdl0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICAgICAgd2hpbGUgKChnICYmICgoZyA9IDApLCBvcFswXSAmJiAoXyA9IDApKSwgXykpXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgKChmID0gMSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0ID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcFswXSAmIDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB5W1wicmV0dXJuXCJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogb3BbMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHlbXCJ0aHJvd1wiXSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogeS5uZXh0KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSlcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgoKHkgPSAwKSwgdCkpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmxhYmVsKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2V9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmxhYmVsKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gb3BbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcCA9IFswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcCA9IF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgISgodCA9IF8udHJ5cyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSkgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcFswXSA9PT0gMyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmxhYmVsID0gb3BbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmxhYmVsID0gdFsxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ID0gb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwgPSB0WzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8ub3BzLnB1c2gob3ApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wID0gWzYsIGVdO1xyXG4gICAgICAgICAgICAgICAgICAgIHkgPSAwO1xyXG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gdCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdO1xyXG4gICAgICAgICAgICByZXR1cm4ge3ZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvcixcclxuICAgICAgICAgICAgbSA9IHMgJiYgb1tzXSxcclxuICAgICAgICAgICAgaSA9IDA7XHJcbiAgICAgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICAgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKVxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxyXG4gICAgICAgICAgICBzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCJcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICAgICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICAgICAgdmFyIGkgPSBtLmNhbGwobyksXHJcbiAgICAgICAgICAgIHIsXHJcbiAgICAgICAgICAgIGFyID0gW10sXHJcbiAgICAgICAgICAgIGU7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpXHJcbiAgICAgICAgICAgICAgICBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGUgPSB7ZXJyb3I6IGVycm9yfTtcclxuICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkgdGhyb3cgZS5lcnJvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXI7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICBhcltpXSA9IGZyb21baV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxuICAgIH1cclxuXHJcbiAgICB0eXBlb2YgU3VwcHJlc3NlZEVycm9yID09PSBcImZ1bmN0aW9uXCJcclxuICAgICAgICA/IFN1cHByZXNzZWRFcnJvclxyXG4gICAgICAgIDogZnVuY3Rpb24gKGVycm9yLCBzdXBwcmVzc2VkLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGUgPSBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgKGUubmFtZSA9IFwiU3VwcHJlc3NlZEVycm9yXCIpLFxyXG4gICAgICAgICAgICAgICAgICAoZS5lcnJvciA9IGVycm9yKSxcclxuICAgICAgICAgICAgICAgICAgKGUuc3VwcHJlc3NlZCA9IHN1cHByZXNzZWQpLFxyXG4gICAgICAgICAgICAgICAgICBlXHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgdmFyIE1lc3NhZ2VUeXBlVUl0b0JHO1xyXG4gICAgKGZ1bmN0aW9uIChNZXNzYWdlVHlwZVVJdG9CRykge1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlVUl0b0JHW1wiR0VUX0RBVEFcIl0gPSBcInVpLWJnLWdldC1kYXRhXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVVSXRvQkdbXCJHRVRfREVWVE9PTFNfREFUQVwiXSA9IFwidWktYmctZ2V0LWRldnRvb2xzLWRhdGFcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIlNVQlNDUklCRV9UT19DSEFOR0VTXCJdID1cclxuICAgICAgICAgICAgXCJ1aS1iZy1zdWJzY3JpYmUtdG8tY2hhbmdlc1wiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlVUl0b0JHW1wiVU5TVUJTQ1JJQkVfRlJPTV9DSEFOR0VTXCJdID1cclxuICAgICAgICAgICAgXCJ1aS1iZy11bnN1YnNjcmliZS1mcm9tLWNoYW5nZXNcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIkNIQU5HRV9TRVRUSU5HU1wiXSA9IFwidWktYmctY2hhbmdlLXNldHRpbmdzXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVVSXRvQkdbXCJTRVRfVEhFTUVcIl0gPSBcInVpLWJnLXNldC10aGVtZVwiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlVUl0b0JHW1wiVE9HR0xFX0FDVElWRV9UQUJcIl0gPSBcInVpLWJnLXRvZ2dsZS1hY3RpdmUtdGFiXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVVSXRvQkdbXCJNQVJLX05FV1NfQVNfUkVBRFwiXSA9IFwidWktYmctbWFyay1uZXdzLWFzLXJlYWRcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIk1BUktfTkVXU19BU19ESVNQTEFZRURcIl0gPVxyXG4gICAgICAgICAgICBcInVpLWJnLW1hcmstbmV3cy1hcy1kaXNwbGF5ZWRcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIkxPQURfQ09ORklHXCJdID0gXCJ1aS1iZy1sb2FkLWNvbmZpZ1wiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlVUl0b0JHW1wiQVBQTFlfREVWX0RZTkFNSUNfVEhFTUVfRklYRVNcIl0gPVxyXG4gICAgICAgICAgICBcInVpLWJnLWFwcGx5LWRldi1keW5hbWljLXRoZW1lLWZpeGVzXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVVSXRvQkdbXCJSRVNFVF9ERVZfRFlOQU1JQ19USEVNRV9GSVhFU1wiXSA9XHJcbiAgICAgICAgICAgIFwidWktYmctcmVzZXQtZGV2LWR5bmFtaWMtdGhlbWUtZml4ZXNcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIkFQUExZX0RFVl9JTlZFUlNJT05fRklYRVNcIl0gPVxyXG4gICAgICAgICAgICBcInVpLWJnLWFwcGx5LWRldi1pbnZlcnNpb24tZml4ZXNcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIlJFU0VUX0RFVl9JTlZFUlNJT05fRklYRVNcIl0gPVxyXG4gICAgICAgICAgICBcInVpLWJnLXJlc2V0LWRldi1pbnZlcnNpb24tZml4ZXNcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9CR1tcIkFQUExZX0RFVl9TVEFUSUNfVEhFTUVTXCJdID1cclxuICAgICAgICAgICAgXCJ1aS1iZy1hcHBseS1kZXYtc3RhdGljLXRoZW1lc1wiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlVUl0b0JHW1wiUkVTRVRfREVWX1NUQVRJQ19USEVNRVNcIl0gPVxyXG4gICAgICAgICAgICBcInVpLWJnLXJlc2V0LWRldi1zdGF0aWMtdGhlbWVzXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVVSXRvQkdbXCJDT0xPUl9TQ0hFTUVfQ0hBTkdFXCJdID0gXCJ1aS1iZy1jb2xvci1zY2hlbWUtY2hhbmdlXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVVSXRvQkdbXCJISURFX0hJR0hMSUdIVFNcIl0gPSBcInVpLWJnLWhpZGUtaGlnaGxpZ2h0c1wiO1xyXG4gICAgfSkoTWVzc2FnZVR5cGVVSXRvQkcgfHwgKE1lc3NhZ2VUeXBlVUl0b0JHID0ge30pKTtcclxuICAgIHZhciBNZXNzYWdlVHlwZUJHdG9VSTtcclxuICAgIChmdW5jdGlvbiAoTWVzc2FnZVR5cGVCR3RvVUkpIHtcclxuICAgICAgICBNZXNzYWdlVHlwZUJHdG9VSVtcIkNIQU5HRVNcIl0gPSBcImJnLXVpLWNoYW5nZXNcIjtcclxuICAgIH0pKE1lc3NhZ2VUeXBlQkd0b1VJIHx8IChNZXNzYWdlVHlwZUJHdG9VSSA9IHt9KSk7XHJcbiAgICB2YXIgRGVidWdNZXNzYWdlVHlwZUJHdG9VSTtcclxuICAgIChmdW5jdGlvbiAoRGVidWdNZXNzYWdlVHlwZUJHdG9VSSkge1xyXG4gICAgICAgIERlYnVnTWVzc2FnZVR5cGVCR3RvVUlbXCJDU1NfVVBEQVRFXCJdID0gXCJkZWJ1Zy1iZy11aS1jc3MtdXBkYXRlXCI7XHJcbiAgICAgICAgRGVidWdNZXNzYWdlVHlwZUJHdG9VSVtcIlVQREFURVwiXSA9IFwiZGVidWctYmctdWktdXBkYXRlXCI7XHJcbiAgICB9KShEZWJ1Z01lc3NhZ2VUeXBlQkd0b1VJIHx8IChEZWJ1Z01lc3NhZ2VUeXBlQkd0b1VJID0ge30pKTtcclxuICAgIHZhciBNZXNzYWdlVHlwZUJHdG9DUztcclxuICAgIChmdW5jdGlvbiAoTWVzc2FnZVR5cGVCR3RvQ1MpIHtcclxuICAgICAgICBNZXNzYWdlVHlwZUJHdG9DU1tcIkFERF9DU1NfRklMVEVSXCJdID0gXCJiZy1jcy1hZGQtY3NzLWZpbHRlclwiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlQkd0b0NTW1wiQUREX0RZTkFNSUNfVEhFTUVcIl0gPSBcImJnLWNzLWFkZC1keW5hbWljLXRoZW1lXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVCR3RvQ1NbXCJBRERfU1RBVElDX1RIRU1FXCJdID0gXCJiZy1jcy1hZGQtc3RhdGljLXRoZW1lXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVCR3RvQ1NbXCJBRERfU1ZHX0ZJTFRFUlwiXSA9IFwiYmctY3MtYWRkLXN2Zy1maWx0ZXJcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZUJHdG9DU1tcIkNMRUFOX1VQXCJdID0gXCJiZy1jcy1jbGVhbi11cFwiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlQkd0b0NTW1wiRkVUQ0hfUkVTUE9OU0VcIl0gPSBcImJnLWNzLWZldGNoLXJlc3BvbnNlXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVCR3RvQ1NbXCJVTlNVUFBPUlRFRF9TRU5ERVJcIl0gPSBcImJnLWNzLXVuc3VwcG9ydGVkLXNlbmRlclwiO1xyXG4gICAgfSkoTWVzc2FnZVR5cGVCR3RvQ1MgfHwgKE1lc3NhZ2VUeXBlQkd0b0NTID0ge30pKTtcclxuICAgIHZhciBEZWJ1Z01lc3NhZ2VUeXBlQkd0b0NTO1xyXG4gICAgKGZ1bmN0aW9uIChEZWJ1Z01lc3NhZ2VUeXBlQkd0b0NTKSB7XHJcbiAgICAgICAgRGVidWdNZXNzYWdlVHlwZUJHdG9DU1tcIlJFTE9BRFwiXSA9IFwiZGVidWctYmctY3MtcmVsb2FkXCI7XHJcbiAgICB9KShEZWJ1Z01lc3NhZ2VUeXBlQkd0b0NTIHx8IChEZWJ1Z01lc3NhZ2VUeXBlQkd0b0NTID0ge30pKTtcclxuICAgIHZhciBNZXNzYWdlVHlwZUNTdG9CRztcclxuICAgIChmdW5jdGlvbiAoTWVzc2FnZVR5cGVDU3RvQkcpIHtcclxuICAgICAgICBNZXNzYWdlVHlwZUNTdG9CR1tcIkNPTE9SX1NDSEVNRV9DSEFOR0VcIl0gPSBcImNzLWJnLWNvbG9yLXNjaGVtZS1jaGFuZ2VcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZUNTdG9CR1tcIkRBUktfVEhFTUVfREVURUNURURcIl0gPSBcImNzLWJnLWRhcmstdGhlbWUtZGV0ZWN0ZWRcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZUNTdG9CR1tcIkRBUktfVEhFTUVfTk9UX0RFVEVDVEVEXCJdID1cclxuICAgICAgICAgICAgXCJjcy1iZy1kYXJrLXRoZW1lLW5vdC1kZXRlY3RlZFwiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlQ1N0b0JHW1wiRkVUQ0hcIl0gPSBcImNzLWJnLWZldGNoXCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVDU3RvQkdbXCJET0NVTUVOVF9DT05ORUNUXCJdID0gXCJjcy1iZy1kb2N1bWVudC1jb25uZWN0XCI7XHJcbiAgICAgICAgTWVzc2FnZVR5cGVDU3RvQkdbXCJET0NVTUVOVF9GT1JHRVRcIl0gPSBcImNzLWJnLWRvY3VtZW50LWZvcmdldFwiO1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlQ1N0b0JHW1wiRE9DVU1FTlRfRlJFRVpFXCJdID0gXCJjcy1iZy1kb2N1bWVudC1mcmVlemVcIjtcclxuICAgICAgICBNZXNzYWdlVHlwZUNTdG9CR1tcIkRPQ1VNRU5UX1JFU1VNRVwiXSA9IFwiY3MtYmctZG9jdW1lbnQtcmVzdW1lXCI7XHJcbiAgICB9KShNZXNzYWdlVHlwZUNTdG9CRyB8fCAoTWVzc2FnZVR5cGVDU3RvQkcgPSB7fSkpO1xyXG4gICAgdmFyIERlYnVnTWVzc2FnZVR5cGVDU3RvQkc7XHJcbiAgICAoZnVuY3Rpb24gKERlYnVnTWVzc2FnZVR5cGVDU3RvQkcpIHtcclxuICAgICAgICBEZWJ1Z01lc3NhZ2VUeXBlQ1N0b0JHW1wiTE9HXCJdID0gXCJkZWJ1Zy1jcy1iZy1sb2dcIjtcclxuICAgIH0pKERlYnVnTWVzc2FnZVR5cGVDU3RvQkcgfHwgKERlYnVnTWVzc2FnZVR5cGVDU3RvQkcgPSB7fSkpO1xyXG4gICAgdmFyIE1lc3NhZ2VUeXBlQ1N0b1VJO1xyXG4gICAgKGZ1bmN0aW9uIChNZXNzYWdlVHlwZUNTdG9VSSkge1xyXG4gICAgICAgIE1lc3NhZ2VUeXBlQ1N0b1VJW1wiRVhQT1JUX0NTU19SRVNQT05TRVwiXSA9IFwiY3MtdWktZXhwb3J0LWNzcy1yZXNwb25zZVwiO1xyXG4gICAgfSkoTWVzc2FnZVR5cGVDU3RvVUkgfHwgKE1lc3NhZ2VUeXBlQ1N0b1VJID0ge30pKTtcclxuICAgIHZhciBNZXNzYWdlVHlwZVVJdG9DUztcclxuICAgIChmdW5jdGlvbiAoTWVzc2FnZVR5cGVVSXRvQ1MpIHtcclxuICAgICAgICBNZXNzYWdlVHlwZVVJdG9DU1tcIkVYUE9SVF9DU1NcIl0gPSBcInVpLWNzLWV4cG9ydC1jc3NcIjtcclxuICAgIH0pKE1lc3NhZ2VUeXBlVUl0b0NTIHx8IChNZXNzYWdlVHlwZVVJdG9DUyA9IHt9KSk7XHJcblxyXG4gICAgdmFyIGlzTmF2aWdhdG9yRGVmaW5lZCA9IHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCI7XHJcbiAgICB2YXIgdXNlckFnZW50ID0gaXNOYXZpZ2F0b3JEZWZpbmVkXHJcbiAgICAgICAgPyBuYXZpZ2F0b3IudXNlckFnZW50RGF0YSAmJlxyXG4gICAgICAgICAgQXJyYXkuaXNBcnJheShuYXZpZ2F0b3IudXNlckFnZW50RGF0YS5icmFuZHMpXHJcbiAgICAgICAgICAgID8gbmF2aWdhdG9yLnVzZXJBZ2VudERhdGEuYnJhbmRzXHJcbiAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGJyYW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoYnJhbmQuYnJhbmQudG9Mb3dlckNhc2UoKSwgXCIgXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChicmFuZC52ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgLmpvaW4oXCIgXCIpXHJcbiAgICAgICAgICAgIDogbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgOiBcInNvbWUgdXNlcmFnZW50XCI7XHJcbiAgICB2YXIgcGxhdGZvcm0gPSBpc05hdmlnYXRvckRlZmluZWRcclxuICAgICAgICA/IG5hdmlnYXRvci51c2VyQWdlbnREYXRhICYmXHJcbiAgICAgICAgICB0eXBlb2YgbmF2aWdhdG9yLnVzZXJBZ2VudERhdGEucGxhdGZvcm0gPT09IFwic3RyaW5nXCJcclxuICAgICAgICAgICAgPyBuYXZpZ2F0b3IudXNlckFnZW50RGF0YS5wbGF0Zm9ybS50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgICAgIDogbmF2aWdhdG9yLnBsYXRmb3JtLnRvTG93ZXJDYXNlKClcclxuICAgICAgICA6IFwic29tZSBwbGF0Zm9ybVwiO1xyXG4gICAgdmFyIGlzQ2hyb21pdW0gPVxyXG4gICAgICAgIHVzZXJBZ2VudC5pbmNsdWRlcyhcImNocm9tZVwiKSB8fCB1c2VyQWdlbnQuaW5jbHVkZXMoXCJjaHJvbWl1bVwiKTtcclxuICAgIHZhciBpc0ZpcmVmb3ggPVxyXG4gICAgICAgIHVzZXJBZ2VudC5pbmNsdWRlcyhcImZpcmVmb3hcIikgfHxcclxuICAgICAgICB1c2VyQWdlbnQuaW5jbHVkZXMoXCJ0aHVuZGVyYmlyZFwiKSB8fFxyXG4gICAgICAgIHVzZXJBZ2VudC5pbmNsdWRlcyhcImxpYnJld29sZlwiKTtcclxuICAgIHZhciBpc1NhZmFyaSA9IHVzZXJBZ2VudC5pbmNsdWRlcyhcInNhZmFyaVwiKSAmJiAhaXNDaHJvbWl1bTtcclxuICAgIHZhciBpc1dpbmRvd3MgPSBwbGF0Zm9ybS5zdGFydHNXaXRoKFwid2luXCIpO1xyXG4gICAgdmFyIGlzTWFjT1MgPSBwbGF0Zm9ybS5zdGFydHNXaXRoKFwibWFjXCIpO1xyXG4gICAgaXNOYXZpZ2F0b3JEZWZpbmVkICYmIG5hdmlnYXRvci51c2VyQWdlbnREYXRhXHJcbiAgICAgICAgPyBuYXZpZ2F0b3IudXNlckFnZW50RGF0YS5tb2JpbGVcclxuICAgICAgICA6IHVzZXJBZ2VudC5pbmNsdWRlcyhcIm1vYmlsZVwiKTtcclxuICAgIHZhciBpc1NoYWRvd0RvbVN1cHBvcnRlZCA9IHR5cGVvZiBTaGFkb3dSb290ID09PSBcImZ1bmN0aW9uXCI7XHJcbiAgICB2YXIgaXNNYXRjaE1lZGlhQ2hhbmdlRXZlbnRMaXN0ZW5lclN1cHBvcnRlZCA9XHJcbiAgICAgICAgdHlwZW9mIE1lZGlhUXVlcnlMaXN0ID09PSBcImZ1bmN0aW9uXCIgJiZcclxuICAgICAgICB0eXBlb2YgTWVkaWFRdWVyeUxpc3QucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIjtcclxuICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG0gPSB1c2VyQWdlbnQubWF0Y2goL2Nocm9tKD86ZXxpdW0pKD86XFwvfCApKFteIF0rKS8pO1xyXG4gICAgICAgIGlmIChtICYmIG1bMV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1bMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfSkoKTtcclxuICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG0gPSB1c2VyQWdlbnQubWF0Y2goLyg/OmZpcmVmb3h8bGlicmV3b2xmKSg/OlxcL3wgKShbXiBdKykvKTtcclxuICAgICAgICBpZiAobSAmJiBtWzFdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtWzFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH0pKCk7XHJcbiAgICB2YXIgaXNEZWZpbmVkU2VsZWN0b3JTdXBwb3J0ZWQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCI6ZGVmaW5lZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9KSgpO1xyXG4gICAgdmFyIGlzQ1NTQ29sb3JTY2hlbWVQcm9wU3VwcG9ydGVkID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgaWYgKCFlbCB8fCB0eXBlb2YgZWwuc3R5bGUgIT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGVsLnN0eWxlLmNvbG9yU2NoZW1lID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImNvbG9yLXNjaGVtZTogZGFya1wiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVsLnN0eWxlLmNvbG9yU2NoZW1lID09PSBcImRhcmtcIjtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9KSgpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGdldE9LUmVzcG9uc2UodXJsLCBtaW1lVHlwZSwgb3JpZ2luKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2U7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2godXJsLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGU6IFwiZm9yY2UtY2FjaGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFsczogXCJvbWl0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJyZXI6IG9yaWdpblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0ZpcmVmb3ggJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlID09PSBcInRleHQvY3NzXCIgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybC5zdGFydHNXaXRoKFwibW96LWV4dGVuc2lvbjovL1wiKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLmVuZHNXaXRoKFwiLmNzc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhcmVzcG9uc2UuaGVhZGVyc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoXCJDb250ZW50LVR5cGVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RhcnRzV2l0aChtaW1lVHlwZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJNaW1lIHR5cGUgbWlzbWF0Y2ggd2hlbiBsb2FkaW5nIFwiLmNvbmNhdCh1cmwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlVuYWJsZSB0byBsb2FkIFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQodXJsLCBcIiBcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChyZXNwb25zZS5zdGF0dXMsIFwiIFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHJlc3BvbnNlLnN0YXR1c1RleHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGxvYWRBc0RhdGFVUkwodXJsLCBtaW1lVHlwZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlO1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGdldE9LUmVzcG9uc2UodXJsLCBtaW1lVHlwZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgcmVhZFJlc3BvbnNlQXNEYXRhVVJMKHJlc3BvbnNlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbG9hZEFzQmxvYih1cmwsIG1pbWVUeXBlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2U7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgZ2V0T0tSZXNwb25zZSh1cmwsIG1pbWVUeXBlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCByZXNwb25zZS5ibG9iKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBfYS5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlYWRSZXNwb25zZUFzRGF0YVVSTChyZXNwb25zZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGJsb2IsIGRhdGFVUkw7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgcmVzcG9uc2UuYmxvYigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2IgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFVUkwgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgZGF0YVVSTF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciB0aHJvd0NPUlNFcnJvciA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAyLFxyXG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVqZWN0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJFbWJlZGRlZCBEYXJrIFJlYWRlciBjYW5ub3QgYWNjZXNzIGEgY3Jvc3Mtb3JpZ2luIHJlc291cmNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiT3ZlcnZpZXcgeW91ciBVUkxzIGFuZCBDT1JTIHBvbGljaWVzIG9yIHVzZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYERhcmtSZWFkZXIuc2V0RmV0Y2hNZXRob2QoZmV0Y2g6ICh1cmwpID0+IFByb21pc2U8UmVzcG9uc2U+KSlgLlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiU2VlIGlmIHVzaW5nIGBEYXJrUmVhZGVyLnNldEZldGNoTWV0aG9kKHdpbmRvdy5mZXRjaClgXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiZWZvcmUgYERhcmtSZWFkZXIuZW5hYmxlKClgIHdvcmtzLlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCIgXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZmV0Y2hlciA9IHRocm93Q09SU0Vycm9yO1xyXG4gICAgZnVuY3Rpb24gc2V0RmV0Y2hNZXRob2QkMShmZXRjaCkge1xyXG4gICAgICAgIGlmIChmZXRjaCkge1xyXG4gICAgICAgICAgICBmZXRjaGVyID0gZmV0Y2g7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmV0Y2hlciA9IHRocm93Q09SU0Vycm9yO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNhbGxGZXRjaE1ldGhvZCh1cmwpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgZmV0Y2hlcih1cmwpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgX2Euc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF3aW5kb3cuY2hyb21lKSB7XHJcbiAgICAgICAgd2luZG93LmNocm9tZSA9IHt9O1xyXG4gICAgfVxyXG4gICAgaWYgKCFjaHJvbWUucnVudGltZSkge1xyXG4gICAgICAgIGNocm9tZS5ydW50aW1lID0ge307XHJcbiAgICB9XHJcbiAgICB2YXIgbWVzc2FnZUxpc3RlbmVycyA9IG5ldyBTZXQoKTtcclxuICAgIGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBpZF8xLCBfYSwgdXJsLCByZXNwb25zZVR5cGUsIHJlc3BvbnNlLCB0ZXh0XzEsIGVycm9yXzE7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnc1swXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3NbMF0udHlwZSA9PT0gTWVzc2FnZVR5cGVDU3RvQkcuRkVUQ0hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWRfMSA9IGFyZ3NbMF0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgNywgLCA4XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChfYSA9IGFyZ3NbMF0uZGF0YSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodXJsID0gX2EudXJsKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXNwb25zZVR5cGUgPSBfYS5yZXNwb25zZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGNhbGxGZXRjaE1ldGhvZCh1cmwpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXNwb25zZVR5cGUgPT09IFwiZGF0YS11cmxcIikpIHJldHVybiBbMywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgcmVhZFJlc3BvbnNlQXNEYXRhVVJMKHJlc3BvbnNlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0XzEgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgNl07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIHJlc3BvbnNlLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0XzEgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoY2IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogTWVzc2FnZVR5cGVCR3RvQ1MuRkVUQ0hfUkVTUE9OU0UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogdGV4dF8xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZF8xXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgOF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yXzEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2Ioe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IE1lc3NhZ2VUeXBlQkd0b0NTLkZFVENIX1JFU1BPTlNFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yXzEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkXzFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYWRkTWVzc2FnZUxpc3RlbmVyKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgbWVzc2FnZUxpc3RlbmVycy5hZGQoY2FsbGJhY2spO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgdmFyIG5hdGl2ZVNlbmRNZXNzYWdlXzEgPSBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZTtcclxuICAgICAgICBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZW5kTWVzc2FnZS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW10sIF9fcmVhZChhcmdzKSwgZmFsc2UpKTtcclxuICAgICAgICAgICAgbmF0aXZlU2VuZE1lc3NhZ2VfMS5hcHBseShjaHJvbWUucnVudGltZSwgYXJncyk7XHJcbiAgICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UgPSBzZW5kTWVzc2FnZTtcclxuICAgIH1cclxuICAgIGlmICghY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlKSB7XHJcbiAgICAgICAgY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlID0ge307XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgdmFyIG5hdGl2ZUFkZExpc3RlbmVyXzEgPSBjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXI7XHJcbiAgICAgICAgY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFkZE1lc3NhZ2VMaXN0ZW5lcihhcmdzWzBdKTtcclxuICAgICAgICAgICAgbmF0aXZlQWRkTGlzdGVuZXJfMS5hcHBseShjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UsIGFyZ3MpO1xyXG4gICAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYWRkTWVzc2FnZUxpc3RlbmVyKGFyZ3NbMF0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIFRoZW1lRW5naW5lO1xyXG4gICAgKGZ1bmN0aW9uIChUaGVtZUVuZ2luZSkge1xyXG4gICAgICAgIFRoZW1lRW5naW5lW1wiY3NzRmlsdGVyXCJdID0gXCJjc3NGaWx0ZXJcIjtcclxuICAgICAgICBUaGVtZUVuZ2luZVtcInN2Z0ZpbHRlclwiXSA9IFwic3ZnRmlsdGVyXCI7XHJcbiAgICAgICAgVGhlbWVFbmdpbmVbXCJzdGF0aWNUaGVtZVwiXSA9IFwic3RhdGljVGhlbWVcIjtcclxuICAgICAgICBUaGVtZUVuZ2luZVtcImR5bmFtaWNUaGVtZVwiXSA9IFwiZHluYW1pY1RoZW1lXCI7XHJcbiAgICB9KShUaGVtZUVuZ2luZSB8fCAoVGhlbWVFbmdpbmUgPSB7fSkpO1xyXG5cclxuICAgIHZhciBBdXRvbWF0aW9uTW9kZTtcclxuICAgIChmdW5jdGlvbiAoQXV0b21hdGlvbk1vZGUpIHtcclxuICAgICAgICBBdXRvbWF0aW9uTW9kZVtcIk5PTkVcIl0gPSBcIlwiO1xyXG4gICAgICAgIEF1dG9tYXRpb25Nb2RlW1wiVElNRVwiXSA9IFwidGltZVwiO1xyXG4gICAgICAgIEF1dG9tYXRpb25Nb2RlW1wiU1lTVEVNXCJdID0gXCJzeXN0ZW1cIjtcclxuICAgICAgICBBdXRvbWF0aW9uTW9kZVtcIkxPQ0FUSU9OXCJdID0gXCJsb2NhdGlvblwiO1xyXG4gICAgfSkoQXV0b21hdGlvbk1vZGUgfHwgKEF1dG9tYXRpb25Nb2RlID0ge30pKTtcclxuXHJcbiAgICB2YXIgREVGQVVMVF9DT0xPUlMgPSB7XHJcbiAgICAgICAgZGFya1NjaGVtZToge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiBcIiMxODFhMWJcIixcclxuICAgICAgICAgICAgdGV4dDogXCIjZThlNmUzXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxpZ2h0U2NoZW1lOiB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IFwiI2RjZGFkN1wiLFxyXG4gICAgICAgICAgICB0ZXh0OiBcIiMxODFhMWJcIlxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB2YXIgREVGQVVMVF9USEVNRSA9IHtcclxuICAgICAgICBtb2RlOiAxLFxyXG4gICAgICAgIGJyaWdodG5lc3M6IDEwMCxcclxuICAgICAgICBjb250cmFzdDogMTAwLFxyXG4gICAgICAgIGdyYXlzY2FsZTogMCxcclxuICAgICAgICBzZXBpYTogMCxcclxuICAgICAgICB1c2VGb250OiBmYWxzZSxcclxuICAgICAgICBmb250RmFtaWx5OiBpc01hY09TXHJcbiAgICAgICAgICAgID8gXCJIZWx2ZXRpY2EgTmV1ZVwiXHJcbiAgICAgICAgICAgIDogaXNXaW5kb3dzXHJcbiAgICAgICAgICAgICAgPyBcIlNlZ29lIFVJXCJcclxuICAgICAgICAgICAgICA6IFwiT3BlbiBTYW5zXCIsXHJcbiAgICAgICAgdGV4dFN0cm9rZTogMCxcclxuICAgICAgICBlbmdpbmU6IFRoZW1lRW5naW5lLmR5bmFtaWNUaGVtZSxcclxuICAgICAgICBzdHlsZXNoZWV0OiBcIlwiLFxyXG4gICAgICAgIGRhcmtTY2hlbWVCYWNrZ3JvdW5kQ29sb3I6IERFRkFVTFRfQ09MT1JTLmRhcmtTY2hlbWUuYmFja2dyb3VuZCxcclxuICAgICAgICBkYXJrU2NoZW1lVGV4dENvbG9yOiBERUZBVUxUX0NPTE9SUy5kYXJrU2NoZW1lLnRleHQsXHJcbiAgICAgICAgbGlnaHRTY2hlbWVCYWNrZ3JvdW5kQ29sb3I6IERFRkFVTFRfQ09MT1JTLmxpZ2h0U2NoZW1lLmJhY2tncm91bmQsXHJcbiAgICAgICAgbGlnaHRTY2hlbWVUZXh0Q29sb3I6IERFRkFVTFRfQ09MT1JTLmxpZ2h0U2NoZW1lLnRleHQsXHJcbiAgICAgICAgc2Nyb2xsYmFyQ29sb3I6IGlzTWFjT1MgPyBcIlwiIDogXCJhdXRvXCIsXHJcbiAgICAgICAgc2VsZWN0aW9uQ29sb3I6IFwiYXV0b1wiLFxyXG4gICAgICAgIHN0eWxlU3lzdGVtQ29udHJvbHM6ICFpc0NTU0NvbG9yU2NoZW1lUHJvcFN1cHBvcnRlZCxcclxuICAgICAgICBsaWdodENvbG9yU2NoZW1lOiBcIkRlZmF1bHRcIixcclxuICAgICAgICBkYXJrQ29sb3JTY2hlbWU6IFwiRGVmYXVsdFwiLFxyXG4gICAgICAgIGltbWVkaWF0ZU1vZGlmeTogZmFsc2VcclxuICAgIH07XHJcbiAgICAoe1xyXG4gICAgICAgIHNjaGVtZVZlcnNpb246IDAsXHJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICBmZXRjaE5ld3M6IHRydWUsXHJcbiAgICAgICAgdGhlbWU6IERFRkFVTFRfVEhFTUUsXHJcbiAgICAgICAgcHJlc2V0czogW10sXHJcbiAgICAgICAgY3VzdG9tVGhlbWVzOiBbXSxcclxuICAgICAgICBlbmFibGVkQnlEZWZhdWx0OiB0cnVlLFxyXG4gICAgICAgIGVuYWJsZWRGb3I6IFtdLFxyXG4gICAgICAgIGRpc2FibGVkRm9yOiBbXSxcclxuICAgICAgICBjaGFuZ2VCcm93c2VyVGhlbWU6IGZhbHNlLFxyXG4gICAgICAgIHN5bmNTZXR0aW5nczogdHJ1ZSxcclxuICAgICAgICBzeW5jU2l0ZXNGaXhlczogZmFsc2UsXHJcbiAgICAgICAgYXV0b21hdGlvbjoge1xyXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgbW9kZTogQXV0b21hdGlvbk1vZGUuTk9ORSxcclxuICAgICAgICAgICAgYmVoYXZpb3I6IFwiT25PZmZcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGltZToge1xyXG4gICAgICAgICAgICBhY3RpdmF0aW9uOiBcIjE4OjAwXCIsXHJcbiAgICAgICAgICAgIGRlYWN0aXZhdGlvbjogXCI5OjAwXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxvY2F0aW9uOiB7XHJcbiAgICAgICAgICAgIGxhdGl0dWRlOiBudWxsLFxyXG4gICAgICAgICAgICBsb25naXR1ZGU6IG51bGxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHByZXZpZXdOZXdEZXNpZ246IGZhbHNlLFxyXG4gICAgICAgIGVuYWJsZUZvclBERjogdHJ1ZSxcclxuICAgICAgICBlbmFibGVGb3JQcm90ZWN0ZWRQYWdlczogZmFsc2UsXHJcbiAgICAgICAgZW5hYmxlQ29udGV4dE1lbnVzOiBmYWxzZSxcclxuICAgICAgICBkZXRlY3REYXJrVGhlbWU6IGZhbHNlXHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBpc0FycmF5TGlrZShpdGVtcykge1xyXG4gICAgICAgIHJldHVybiBpdGVtcy5sZW5ndGggIT0gbnVsbDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGZvckVhY2goaXRlbXMsIGl0ZXJhdG9yKSB7XHJcbiAgICAgICAgdmFyIGVfMSwgX2E7XHJcbiAgICAgICAgaWYgKGlzQXJyYXlMaWtlKGl0ZW1zKSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gaXRlbXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGl0ZXJhdG9yKGl0ZW1zW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtc18xID0gX192YWx1ZXMoaXRlbXMpLCBpdGVtc18xXzEgPSBpdGVtc18xLm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAhaXRlbXNfMV8xLmRvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbXNfMV8xID0gaXRlbXNfMS5uZXh0KClcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNfMV8xLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGNhdGNoIChlXzFfMSkge1xyXG4gICAgICAgICAgICAgICAgZV8xID0ge2Vycm9yOiBlXzFfMX07XHJcbiAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc18xXzEgJiYgIWl0ZW1zXzFfMS5kb25lICYmIChfYSA9IGl0ZW1zXzEucmV0dXJuKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EuY2FsbChpdGVtc18xKTtcclxuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcHVzaChhcnJheSwgYWRkaXRpb24pIHtcclxuICAgICAgICBmb3JFYWNoKGFkZGl0aW9uLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXJyYXkucHVzaChhKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHRvQXJyYXkoaXRlbXMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBpdGVtcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICByZXN1bHRzLnB1c2goaXRlbXNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsb2dJbmZvKCkge31cclxuICAgIGZ1bmN0aW9uIGxvZ1dhcm4oKSB7fVxyXG5cclxuICAgIGZ1bmN0aW9uIHRocm90dGxlKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHBlbmRpbmcgPSBmYWxzZTtcclxuICAgICAgICB2YXIgZnJhbWVJZCA9IG51bGw7XHJcbiAgICAgICAgdmFyIGxhc3RBcmdzO1xyXG4gICAgICAgIHZhciB0aHJvdHRsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGFzdEFyZ3MgPSBhcmdzO1xyXG4gICAgICAgICAgICBpZiAoZnJhbWVJZCkge1xyXG4gICAgICAgICAgICAgICAgcGVuZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShcclxuICAgICAgICAgICAgICAgICAgICB2b2lkIDAsXHJcbiAgICAgICAgICAgICAgICAgICAgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGxhc3RBcmdzKSwgZmFsc2UpXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgZnJhbWVJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJhbWVJZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQobGFzdEFyZ3MpLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShmcmFtZUlkKTtcclxuICAgICAgICAgICAgcGVuZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmcmFtZUlkID0gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRocm90dGxlZCwge2NhbmNlbDogY2FuY2VsfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVBc3luY1Rhc2tzUXVldWUoKSB7XHJcbiAgICAgICAgdmFyIHRhc2tzID0gW107XHJcbiAgICAgICAgdmFyIGZyYW1lSWQgPSBudWxsO1xyXG4gICAgICAgIGZ1bmN0aW9uIHJ1blRhc2tzKCkge1xyXG4gICAgICAgICAgICB2YXIgdGFzaztcclxuICAgICAgICAgICAgd2hpbGUgKCh0YXNrID0gdGFza3Muc2hpZnQoKSkpIHtcclxuICAgICAgICAgICAgICAgIHRhc2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmcmFtZUlkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gYWRkKHRhc2spIHtcclxuICAgICAgICAgICAgdGFza3MucHVzaCh0YXNrKTtcclxuICAgICAgICAgICAgaWYgKCFmcmFtZUlkKSB7XHJcbiAgICAgICAgICAgICAgICBmcmFtZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJ1blRhc2tzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBjYW5jZWwoKSB7XHJcbiAgICAgICAgICAgIHRhc2tzLnNwbGljZSgwKTtcclxuICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoZnJhbWVJZCk7XHJcbiAgICAgICAgICAgIGZyYW1lSWQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge2FkZDogYWRkLCBjYW5jZWw6IGNhbmNlbH07XHJcbiAgICB9XHJcbiAgICB2YXIgZGVsYXlUb2tlbnMgPSBuZXcgU2V0KCk7XHJcbiAgICBmdW5jdGlvbiByZXF1ZXN0QW5pbWF0aW9uRnJhbWVPbmNlKHRva2VuLCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmIChkZWxheVRva2Vucy5oYXModG9rZW4pKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsYXlUb2tlbnMuYWRkKHRva2VuKTtcclxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkZWxheVRva2Vucy5kZWxldGUodG9rZW4pO1xyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldER1cmF0aW9uKHRpbWUpIHtcclxuICAgICAgICB2YXIgZHVyYXRpb24gPSAwO1xyXG4gICAgICAgIGlmICh0aW1lLnNlY29uZHMpIHtcclxuICAgICAgICAgICAgZHVyYXRpb24gKz0gdGltZS5zZWNvbmRzICogMTAwMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRpbWUubWludXRlcykge1xyXG4gICAgICAgICAgICBkdXJhdGlvbiArPSB0aW1lLm1pbnV0ZXMgKiA2MCAqIDEwMDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aW1lLmhvdXJzKSB7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uICs9IHRpbWUuaG91cnMgKiA2MCAqIDYwICogMTAwMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRpbWUuZGF5cykge1xyXG4gICAgICAgICAgICBkdXJhdGlvbiArPSB0aW1lLmRheXMgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZHVyYXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlKSB7XHJcbiAgICAgICAgbm9kZSAmJiBub2RlLnBhcmVudE5vZGUgJiYgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gd2F0Y2hGb3JOb2RlUG9zaXRpb24obm9kZSwgbW9kZSwgb25SZXN0b3JlKSB7XHJcbiAgICAgICAgaWYgKG9uUmVzdG9yZSA9PT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIG9uUmVzdG9yZSA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIE1BWF9BVFRFTVBUU19DT1VOVCA9IDEwO1xyXG4gICAgICAgIHZhciBSRVRSWV9USU1FT1VUID0gZ2V0RHVyYXRpb24oe3NlY29uZHM6IDJ9KTtcclxuICAgICAgICB2YXIgQVRURU1QVFNfSU5URVJWQUwgPSBnZXREdXJhdGlvbih7c2Vjb25kczogMTB9KTtcclxuICAgICAgICB2YXIgcHJldlNpYmxpbmcgPSBub2RlLnByZXZpb3VzU2libGluZztcclxuICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgIGlmICghcGFyZW50KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgIFwiVW5hYmxlIHRvIHdhdGNoIGZvciBub2RlIHBvc2l0aW9uOiBwYXJlbnQgZWxlbWVudCBub3QgZm91bmRcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobW9kZSA9PT0gXCJwcmV2LXNpYmxpbmdcIiAmJiAhcHJldlNpYmxpbmcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgXCJVbmFibGUgdG8gd2F0Y2ggZm9yIG5vZGUgcG9zaXRpb246IHRoZXJlIGlzIG5vIHByZXZpb3VzIHNpYmxpbmdcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXR0ZW1wdHMgPSAwO1xyXG4gICAgICAgIHZhciBzdGFydCA9IG51bGw7XHJcbiAgICAgICAgdmFyIHRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICAgICAgdmFyIHJlc3RvcmUgPSB0aHJvdHRsZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aW1lb3V0SWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhdHRlbXB0cysrO1xyXG4gICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgaWYgKHN0YXJ0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0ID0gbm93O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGF0dGVtcHRzID49IE1BWF9BVFRFTVBUU19DT1VOVCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vdyAtIHN0YXJ0IDwgQVRURU1QVFNfSU5URVJWQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRlbXB0cyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBSRVRSWV9USU1FT1VUKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzdGFydCA9IG5vdztcclxuICAgICAgICAgICAgICAgIGF0dGVtcHRzID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobW9kZSA9PT0gXCJoZWFkXCIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcmV2U2libGluZyAmJiBwcmV2U2libGluZy5wYXJlbnROb2RlICE9PSBwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChtb2RlID09PSBcInByZXYtc2libGluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldlNpYmxpbmcucGFyZW50Tm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChwcmV2U2libGluZy5wYXJlbnROb2RlICE9PSBwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVQYXJlbnQocHJldlNpYmxpbmcucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG1vZGUgPT09IFwiaGVhZFwiICYmICFwYXJlbnQuaXNDb25uZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudCA9IGRvY3VtZW50LmhlYWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShcclxuICAgICAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgICAgICBwcmV2U2libGluZyAmJiBwcmV2U2libGluZy5pc0Nvbm5lY3RlZFxyXG4gICAgICAgICAgICAgICAgICAgID8gcHJldlNpYmxpbmcubmV4dFNpYmxpbmdcclxuICAgICAgICAgICAgICAgICAgICA6IHBhcmVudC5maXJzdENoaWxkXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLnRha2VSZWNvcmRzKCk7XHJcbiAgICAgICAgICAgIG9uUmVzdG9yZSAmJiBvblJlc3RvcmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIChtb2RlID09PSBcImhlYWRcIiAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChub2RlLnBhcmVudE5vZGUgIT09IHBhcmVudCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhbm9kZS5wYXJlbnROb2RlLmlzQ29ubmVjdGVkKSkgfHxcclxuICAgICAgICAgICAgICAgIChtb2RlID09PSBcInByZXYtc2libGluZ1wiICYmXHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5wcmV2aW91c1NpYmxpbmcgIT09IHByZXZTaWJsaW5nKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHJlc3RvcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUocGFyZW50LCB7Y2hpbGRMaXN0OiB0cnVlfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc3RvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICAgICAgcmVzdG9yZS5jYW5jZWwoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBza2lwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci50YWtlUmVjb3JkcygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHVwZGF0ZVBhcmVudCA9IGZ1bmN0aW9uIChwYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIHN0b3AoKTtcclxuICAgICAgICAgICAgcnVuKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBydW4oKTtcclxuICAgICAgICByZXR1cm4ge3J1bjogcnVuLCBzdG9wOiBzdG9wLCBza2lwOiBza2lwfTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGl0ZXJhdGVTaGFkb3dIb3N0cyhyb290LCBpdGVyYXRvcikge1xyXG4gICAgICAgIGlmIChyb290ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihyb290LCBOb2RlRmlsdGVyLlNIT1dfRUxFTUVOVCwge1xyXG4gICAgICAgICAgICBhY2NlcHROb2RlOiBmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuc2hhZG93Um9vdCA9PSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgPyBOb2RlRmlsdGVyLkZJTFRFUl9TS0lQXHJcbiAgICAgICAgICAgICAgICAgICAgOiBOb2RlRmlsdGVyLkZJTFRFUl9BQ0NFUFQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKFxyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IHJvb3Quc2hhZG93Um9vdCA/IHdhbGtlci5jdXJyZW50Tm9kZSA6IHdhbGtlci5uZXh0Tm9kZSgpO1xyXG4gICAgICAgICAgICBub2RlICE9IG51bGw7XHJcbiAgICAgICAgICAgIG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBpZiAobm9kZS5jbGFzc0xpc3QuY29udGFpbnMoXCJzdXJmaW5na2V5c19oaW50c19ob3N0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdGVyYXRvcihub2RlKTtcclxuICAgICAgICAgICAgaXRlcmF0ZVNoYWRvd0hvc3RzKG5vZGUuc2hhZG93Um9vdCwgaXRlcmF0b3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciBpc0RPTVJlYWR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlYWR5U3RhdGUgPT09IFwiY29tcGxldGVcIiB8fFxyXG4gICAgICAgICAgICBkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImludGVyYWN0aXZlXCJcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIHNldElzRE9NUmVhZHkobmV3RnVuYykge1xyXG4gICAgICAgIGlzRE9NUmVhZHkgPSBuZXdGdW5jO1xyXG4gICAgfVxyXG4gICAgdmFyIHJlYWR5U3RhdGVMaXN0ZW5lcnMgPSBuZXcgU2V0KCk7XHJcbiAgICBmdW5jdGlvbiBhZGRET01SZWFkeUxpc3RlbmVyKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgaXNET01SZWFkeSgpID8gbGlzdGVuZXIoKSA6IHJlYWR5U3RhdGVMaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlbW92ZURPTVJlYWR5TGlzdGVuZXIobGlzdGVuZXIpIHtcclxuICAgICAgICByZWFkeVN0YXRlTGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpc1JlYWR5U3RhdGVDb21wbGV0ZSgpIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJjb21wbGV0ZVwiO1xyXG4gICAgfVxyXG4gICAgdmFyIHJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVycyA9IG5ldyBTZXQoKTtcclxuICAgIGZ1bmN0aW9uIGFkZFJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVyKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgaXNSZWFkeVN0YXRlQ29tcGxldGUoKVxyXG4gICAgICAgICAgICA/IGxpc3RlbmVyKClcclxuICAgICAgICAgICAgOiByZWFkeVN0YXRlQ29tcGxldGVMaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNsZWFuUmVhZHlTdGF0ZUNvbXBsZXRlTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVycy5jbGVhcigpO1xyXG4gICAgfVxyXG4gICAgaWYgKCFpc0RPTVJlYWR5KCkpIHtcclxuICAgICAgICB2YXIgb25SZWFkeVN0YXRlQ2hhbmdlXzEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChpc0RPTVJlYWR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHJlYWR5U3RhdGVMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdGVuZXIoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVhZHlTdGF0ZUxpc3RlbmVycy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVhZHlTdGF0ZUNvbXBsZXRlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlYWR5c3RhdGVjaGFuZ2VcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25SZWFkeVN0YXRlQ2hhbmdlXzFcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdGVuZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZWFkeVN0YXRlQ29tcGxldGVMaXN0ZW5lcnMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5c3RhdGVjaGFuZ2VcIiwgb25SZWFkeVN0YXRlQ2hhbmdlXzEpO1xyXG4gICAgfVxyXG4gICAgdmFyIEhVR0VfTVVUQVRJT05TX0NPVU5UID0gMTAwMDtcclxuICAgIGZ1bmN0aW9uIGlzSHVnZU11dGF0aW9uKG11dGF0aW9ucykge1xyXG4gICAgICAgIGlmIChtdXRhdGlvbnMubGVuZ3RoID4gSFVHRV9NVVRBVElPTlNfQ09VTlQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhZGRlZE5vZGVzQ291bnQgPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbXV0YXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGFkZGVkTm9kZXNDb3VudCArPSBtdXRhdGlvbnNbaV0uYWRkZWROb2Rlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIGlmIChhZGRlZE5vZGVzQ291bnQgPiBIVUdFX01VVEFUSU9OU19DT1VOVCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0RWxlbWVudHNUcmVlT3BlcmF0aW9ucyhtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgYWRkaXRpb25zID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHZhciBkZWxldGlvbnMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgdmFyIG1vdmVzID0gbmV3IFNldCgpO1xyXG4gICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIGZvckVhY2gobS5hZGRlZE5vZGVzLCBmdW5jdGlvbiAobikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG4uaXNDb25uZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbnMuYWRkKG4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZm9yRWFjaChtLnJlbW92ZWROb2RlcywgZnVuY3Rpb24gKG4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChuIGluc3RhbmNlb2YgRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuLmlzQ29ubmVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVzLmFkZChuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25zLmRlbGV0ZShuKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGlvbnMuYWRkKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGR1cGxpY2F0ZUFkZGl0aW9ucyA9IFtdO1xyXG4gICAgICAgIHZhciBkdXBsaWNhdGVEZWxldGlvbnMgPSBbXTtcclxuICAgICAgICBhZGRpdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICBpZiAoYWRkaXRpb25zLmhhcyhub2RlLnBhcmVudEVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBkdXBsaWNhdGVBZGRpdGlvbnMucHVzaChub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRlbGV0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGlvbnMuaGFzKG5vZGUucGFyZW50RWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgIGR1cGxpY2F0ZURlbGV0aW9ucy5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZHVwbGljYXRlQWRkaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFkZGl0aW9ucy5kZWxldGUobm9kZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZHVwbGljYXRlRGVsZXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRlbGV0aW9ucy5kZWxldGUobm9kZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHthZGRpdGlvbnM6IGFkZGl0aW9ucywgbW92ZXM6IG1vdmVzLCBkZWxldGlvbnM6IGRlbGV0aW9uc307XHJcbiAgICB9XHJcbiAgICB2YXIgb3B0aW1pemVkVHJlZU9ic2VydmVycyA9IG5ldyBNYXAoKTtcclxuICAgIHZhciBvcHRpbWl6ZWRUcmVlQ2FsbGJhY2tzID0gbmV3IFdlYWtNYXAoKTtcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU9wdGltaXplZFRyZWVPYnNlcnZlcihyb290LCBjYWxsYmFja3MpIHtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXI7XHJcbiAgICAgICAgdmFyIG9ic2VydmVyQ2FsbGJhY2tzO1xyXG4gICAgICAgIHZhciBkb21SZWFkeUxpc3RlbmVyO1xyXG4gICAgICAgIGlmIChvcHRpbWl6ZWRUcmVlT2JzZXJ2ZXJzLmhhcyhyb290KSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IG9wdGltaXplZFRyZWVPYnNlcnZlcnMuZ2V0KHJvb3QpO1xyXG4gICAgICAgICAgICBvYnNlcnZlckNhbGxiYWNrcyA9IG9wdGltaXplZFRyZWVDYWxsYmFja3MuZ2V0KG9ic2VydmVyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgaGFkSHVnZU11dGF0aW9uc0JlZm9yZV8xID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpYmVkRm9yUmVhZHlTdGF0ZV8xID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzSHVnZU11dGF0aW9uKG11dGF0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWhhZEh1Z2VNdXRhdGlvbnNCZWZvcmVfMSB8fCBpc0RPTVJlYWR5KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXJDYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbkh1Z2VNdXRhdGlvbnMgPSBfYS5vbkh1Z2VNdXRhdGlvbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb25IdWdlTXV0YXRpb25zKHJvb3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFzdWJzY3JpYmVkRm9yUmVhZHlTdGF0ZV8xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVJlYWR5TGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXJDYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25IdWdlTXV0YXRpb25zID0gX2Eub25IdWdlTXV0YXRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvbkh1Z2VNdXRhdGlvbnMocm9vdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkRE9NUmVhZHlMaXN0ZW5lcihkb21SZWFkeUxpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlZEZvclJlYWR5U3RhdGVfMSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGhhZEh1Z2VNdXRhdGlvbnNCZWZvcmVfMSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50c09wZXJhdGlvbnNfMSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEVsZW1lbnRzVHJlZU9wZXJhdGlvbnMobXV0YXRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlckNhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25NaW5vck11dGF0aW9ucyA9IF9hLm9uTWlub3JNdXRhdGlvbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvbk1pbm9yTXV0YXRpb25zKGVsZW1lbnRzT3BlcmF0aW9uc18xKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUocm9vdCwge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICBvcHRpbWl6ZWRUcmVlT2JzZXJ2ZXJzLnNldChyb290LCBvYnNlcnZlcik7XHJcbiAgICAgICAgICAgIG9ic2VydmVyQ2FsbGJhY2tzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICBvcHRpbWl6ZWRUcmVlQ2FsbGJhY2tzLnNldChvYnNlcnZlciwgb2JzZXJ2ZXJDYWxsYmFja3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBvYnNlcnZlckNhbGxiYWNrcy5hZGQoY2FsbGJhY2tzKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkaXNjb25uZWN0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlckNhbGxiYWNrcy5kZWxldGUoY2FsbGJhY2tzKTtcclxuICAgICAgICAgICAgICAgIGlmIChkb21SZWFkeUxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRE9NUmVhZHlMaXN0ZW5lcihkb21SZWFkeUxpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlckNhbGxiYWNrcy5zaXplID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGltaXplZFRyZWVDYWxsYmFja3MuZGVsZXRlKG9ic2VydmVyKTtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpbWl6ZWRUcmVlT2JzZXJ2ZXJzLmRlbGV0ZShyb290KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGFuY2hvcjtcclxuICAgIHZhciBwYXJzZWRVUkxDYWNoZSA9IG5ldyBNYXAoKTtcclxuICAgIGZ1bmN0aW9uIGZpeEJhc2VVUkwoJHVybCkge1xyXG4gICAgICAgIGlmICghYW5jaG9yKSB7XHJcbiAgICAgICAgICAgIGFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhbmNob3IuaHJlZiA9ICR1cmw7XHJcbiAgICAgICAgcmV0dXJuIGFuY2hvci5ocmVmO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcGFyc2VVUkwoJHVybCwgJGJhc2UpIHtcclxuICAgICAgICBpZiAoJGJhc2UgPT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICAkYmFzZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBrZXkgPSBcIlwiLmNvbmNhdCgkdXJsKS5jb25jYXQoJGJhc2UgPyBcIjtcIi5jb25jYXQoJGJhc2UpIDogXCJcIik7XHJcbiAgICAgICAgaWYgKHBhcnNlZFVSTENhY2hlLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZWRVUkxDYWNoZS5nZXQoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCRiYXNlKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJzZWRVUkxfMSA9IG5ldyBVUkwoJHVybCwgZml4QmFzZVVSTCgkYmFzZSkpO1xyXG4gICAgICAgICAgICBwYXJzZWRVUkxDYWNoZS5zZXQoa2V5LCBwYXJzZWRVUkxfMSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZWRVUkxfMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBhcnNlZFVSTCA9IG5ldyBVUkwoZml4QmFzZVVSTCgkdXJsKSk7XHJcbiAgICAgICAgcGFyc2VkVVJMQ2FjaGUuc2V0KCR1cmwsIHBhcnNlZFVSTCk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlZFVSTDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldEFic29sdXRlVVJMKCRiYXNlLCAkcmVsYXRpdmUpIHtcclxuICAgICAgICBpZiAoJHJlbGF0aXZlLm1hdGNoKC9eZGF0YVxcXFw/XFw6LykpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRyZWxhdGl2ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKC9eXFwvXFwvLy50ZXN0KCRyZWxhdGl2ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KGxvY2F0aW9uLnByb3RvY29sKS5jb25jYXQoJHJlbGF0aXZlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGIgPSBwYXJzZVVSTCgkYmFzZSk7XHJcbiAgICAgICAgdmFyIGEgPSBwYXJzZVVSTCgkcmVsYXRpdmUsIGIuaHJlZik7XHJcbiAgICAgICAgcmV0dXJuIGEuaHJlZjtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGlzUmVsYXRpdmVIcmVmT25BYnNvbHV0ZVBhdGgoaHJlZikge1xyXG4gICAgICAgIGlmIChocmVmLnN0YXJ0c1dpdGgoXCJkYXRhOlwiKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVybCA9IHBhcnNlVVJMKGhyZWYpO1xyXG4gICAgICAgIGlmICh1cmwucHJvdG9jb2wgIT09IGxvY2F0aW9uLnByb3RvY29sKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHVybC5ob3N0bmFtZSAhPT0gbG9jYXRpb24uaG9zdG5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodXJsLnBvcnQgIT09IGxvY2F0aW9uLnBvcnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXJsLnBhdGhuYW1lID09PSBsb2NhdGlvbi5wYXRobmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpdGVyYXRlQ1NTUnVsZXMocnVsZXMsIGl0ZXJhdGUsIG9uTWVkaWFSdWxlRXJyb3IpIHtcclxuICAgICAgICBmb3JFYWNoKHJ1bGVzLCBmdW5jdGlvbiAocnVsZSkge1xyXG4gICAgICAgICAgICBpZiAocnVsZS5zZWxlY3RvclRleHQpIHtcclxuICAgICAgICAgICAgICAgIGl0ZXJhdGUocnVsZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocnVsZS5ocmVmKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdGVDU1NSdWxlcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5zdHlsZVNoZWV0LmNzc1J1bGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbk1lZGlhUnVsZUVycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZ0luZm8oXCJGb3VuZCBhIG5vbi1sb2FkZWQgbGluay5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgb25NZWRpYVJ1bGVFcnJvciAmJiBvbk1lZGlhUnVsZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocnVsZS5tZWRpYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1lZGlhID0gQXJyYXkuZnJvbShydWxlLm1lZGlhKTtcclxuICAgICAgICAgICAgICAgIHZhciBpc1NjcmVlbk9yQWxsT3JRdWVyeSA9IG1lZGlhLnNvbWUoZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtLnN0YXJ0c1dpdGgoXCJzY3JlZW5cIikgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbS5zdGFydHNXaXRoKFwiYWxsXCIpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG0uc3RhcnRzV2l0aChcIihcIilcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNQcmludE9yU3BlZWNoID0gbWVkaWEuc29tZShmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtLnN0YXJ0c1dpdGgoXCJwcmludFwiKSB8fCBtLnN0YXJ0c1dpdGgoXCJzcGVlY2hcIik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChpc1NjcmVlbk9yQWxsT3JRdWVyeSB8fCAhaXNQcmludE9yU3BlZWNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlcmF0ZUNTU1J1bGVzKHJ1bGUuY3NzUnVsZXMsIGl0ZXJhdGUsIG9uTWVkaWFSdWxlRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJ1bGUuY29uZGl0aW9uVGV4dCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKENTUy5zdXBwb3J0cyhydWxlLmNvbmRpdGlvblRleHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlcmF0ZUNTU1J1bGVzKHJ1bGUuY3NzUnVsZXMsIGl0ZXJhdGUsIG9uTWVkaWFSdWxlRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG9nV2FybihcIkNTU1J1bGUgdHlwZSBub3Qgc3VwcG9ydGVkXCIsIHJ1bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICB2YXIgc2hvcnRoYW5kVmFyRGVwZW5kYW50UHJvcGVydGllcyA9IFtcclxuICAgICAgICBcImJhY2tncm91bmRcIixcclxuICAgICAgICBcImJvcmRlclwiLFxyXG4gICAgICAgIFwiYm9yZGVyLWNvbG9yXCIsXHJcbiAgICAgICAgXCJib3JkZXItYm90dG9tXCIsXHJcbiAgICAgICAgXCJib3JkZXItbGVmdFwiLFxyXG4gICAgICAgIFwiYm9yZGVyLXJpZ2h0XCIsXHJcbiAgICAgICAgXCJib3JkZXItdG9wXCIsXHJcbiAgICAgICAgXCJvdXRsaW5lXCIsXHJcbiAgICAgICAgXCJvdXRsaW5lLWNvbG9yXCJcclxuICAgIF07XHJcbiAgICB2YXIgc2hvcnRoYW5kVmFyRGVwUHJvcFJlZ2V4cHMgPSBpc1NhZmFyaVxyXG4gICAgICAgID8gc2hvcnRoYW5kVmFyRGVwZW5kYW50UHJvcGVydGllcy5tYXAoZnVuY3Rpb24gKHByb3ApIHtcclxuICAgICAgICAgICAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cChcIlwiLmNvbmNhdChwcm9wLCBcIjpcXFxccyooLio/KVxcXFxzKjtcIikpO1xyXG4gICAgICAgICAgICAgIHJldHVybiBbcHJvcCwgcmVnZXhwXTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgOiBudWxsO1xyXG4gICAgZnVuY3Rpb24gaXRlcmF0ZUNTU0RlY2xhcmF0aW9ucyhzdHlsZSwgaXRlcmF0ZSkge1xyXG4gICAgICAgIGZvckVhY2goc3R5bGUsIGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHByb3BlcnR5KS50cmltKCk7XHJcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdGVyYXRlKHByb3BlcnR5LCB2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGNzc1RleHQgPSBzdHlsZS5jc3NUZXh0O1xyXG4gICAgICAgIGlmIChjc3NUZXh0LmluY2x1ZGVzKFwidmFyKFwiKSkge1xyXG4gICAgICAgICAgICBpZiAoaXNTYWZhcmkpIHtcclxuICAgICAgICAgICAgICAgIHNob3J0aGFuZFZhckRlcFByb3BSZWdleHBzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAyKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcCA9IF9iWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdleHAgPSBfYlsxXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBjc3NUZXh0Lm1hdGNoKHJlZ2V4cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWwgPSBtYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGUocHJvcCwgdmFsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNob3J0aGFuZFZhckRlcGVuZGFudFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWwgPSBzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHByb3ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWwgJiYgdmFsLmluY2x1ZGVzKFwidmFyKFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRlKHByb3AsIHZhbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgY3NzVVJMUmVnZXggPSAvdXJsXFwoKCgnLio/Jyl8KFwiLio/XCIpfChbXlxcKV0qPykpXFwpL2c7XHJcbiAgICB2YXIgY3NzSW1wb3J0UmVnZXggPVxyXG4gICAgICAgIC9AaW1wb3J0XFxzKih1cmxcXCgpPygoJy4rPycpfChcIi4rP1wiKXwoW15cXCldKj8pKVxcKT8gPyhzY3JlZW4pPzs/L2dpO1xyXG4gICAgZnVuY3Rpb24gZ2V0Q1NTVVJMVmFsdWUoY3NzVVJMKSB7XHJcbiAgICAgICAgcmV0dXJuIGNzc1VSTFxyXG4gICAgICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9bXFxuXFxyXFxcXF0rL2csIFwiXCIpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9edXJsXFwoKC4qKVxcKSQvLCBcIiQxXCIpXHJcbiAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgLnJlcGxhY2UoL15cIiguKilcIiQvLCBcIiQxXCIpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9eJyguKiknJC8sIFwiJDFcIilcclxuICAgICAgICAgICAgLnJlcGxhY2UoLyg/OlxcXFwoLikpL2csIFwiJDFcIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRDU1NCYXNlQmF0aCh1cmwpIHtcclxuICAgICAgICB2YXIgY3NzVVJMID0gcGFyc2VVUkwodXJsKTtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICAuY29uY2F0KGNzc1VSTC5vcmlnaW4pXHJcbiAgICAgICAgICAgIC5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBjc3NVUkwucGF0aG5hbWVcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFw/LiokLywgXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvKFxcLykoW15cXC9dKykkL2ksIFwiJDFcIilcclxuICAgICAgICAgICAgKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlcGxhY2VDU1NSZWxhdGl2ZVVSTHNXaXRoQWJzb2x1dGUoJGNzcywgY3NzQmFzZVBhdGgpIHtcclxuICAgICAgICByZXR1cm4gJGNzcy5yZXBsYWNlKGNzc1VSTFJlZ2V4LCBmdW5jdGlvbiAobWF0Y2gpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGhWYWx1ZSA9IGdldENTU1VSTFZhbHVlKG1hdGNoKTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcInVybCgnXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgIGdldEFic29sdXRlVVJMKGNzc0Jhc2VQYXRoLCBwYXRoVmFsdWUpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiJylcIlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2g7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHZhciBjc3NDb21tZW50c1JlZ2V4ID0gL1xcL1xcKltcXHNcXFNdKj9cXCpcXC8vZztcclxuICAgIGZ1bmN0aW9uIHJlbW92ZUNTU0NvbW1lbnRzKCRjc3MpIHtcclxuICAgICAgICByZXR1cm4gJGNzcy5yZXBsYWNlKGNzc0NvbW1lbnRzUmVnZXgsIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgdmFyIGZvbnRGYWNlUmVnZXggPSAvQGZvbnQtZmFjZVxccyp7W159XSp9L2c7XHJcbiAgICBmdW5jdGlvbiByZXBsYWNlQ1NTRm9udEZhY2UoJGNzcykge1xyXG4gICAgICAgIHJldHVybiAkY3NzLnJlcGxhY2UoZm9udEZhY2VSZWdleCwgXCJcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZXZhbE1hdGgoZXhwcmVzc2lvbikge1xyXG4gICAgICAgIHZhciBycG5TdGFjayA9IFtdO1xyXG4gICAgICAgIHZhciB3b3JraW5nU3RhY2sgPSBbXTtcclxuICAgICAgICB2YXIgbGFzdFRva2VuO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBleHByZXNzaW9uLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IGV4cHJlc3Npb25baV07XHJcbiAgICAgICAgICAgIGlmICghdG9rZW4gfHwgdG9rZW4gPT09IFwiIFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3BlcmF0b3JzLmhhcyh0b2tlbikpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvcCA9IG9wZXJhdG9ycy5nZXQodG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHdvcmtpbmdTdGFjay5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudE9wID0gb3BlcmF0b3JzLmdldCh3b3JraW5nU3RhY2tbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudE9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3AubGVzc09yRXF1YWxUaGFuKGN1cnJlbnRPcCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnBuU3RhY2sucHVzaCh3b3JraW5nU3RhY2suc2hpZnQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgd29ya2luZ1N0YWNrLnVuc2hpZnQodG9rZW4pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFsYXN0VG9rZW4gfHwgb3BlcmF0b3JzLmhhcyhsYXN0VG9rZW4pKSB7XHJcbiAgICAgICAgICAgICAgICBycG5TdGFjay5wdXNoKHRva2VuKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJwblN0YWNrW3JwblN0YWNrLmxlbmd0aCAtIDFdICs9IHRva2VuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxhc3RUb2tlbiA9IHRva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBycG5TdGFjay5wdXNoLmFwcGx5KFxyXG4gICAgICAgICAgICBycG5TdGFjayxcclxuICAgICAgICAgICAgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKHdvcmtpbmdTdGFjayksIGZhbHNlKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyIHN0YWNrID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJwblN0YWNrLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcCA9IG9wZXJhdG9ycy5nZXQocnBuU3RhY2tbaV0pO1xyXG4gICAgICAgICAgICBpZiAob3ApIHtcclxuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gc3RhY2suc3BsaWNlKDAsIDIpO1xyXG4gICAgICAgICAgICAgICAgc3RhY2sucHVzaChvcC5leGVjKGFyZ3NbMV0sIGFyZ3NbMF0pKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN0YWNrLnVuc2hpZnQocGFyc2VGbG9hdChycG5TdGFja1tpXSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdGFja1swXTtcclxuICAgIH1cclxuICAgIHZhciBPcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gT3BlcmF0b3IocHJlY2VkZW5jZSwgbWV0aG9kKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJlY2VuZGNlID0gcHJlY2VkZW5jZTtcclxuICAgICAgICAgICAgdGhpcy5leGVjTWV0aG9kID0gbWV0aG9kO1xyXG4gICAgICAgIH1cclxuICAgICAgICBPcGVyYXRvci5wcm90b3R5cGUuZXhlYyA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leGVjTWV0aG9kKGxlZnQsIHJpZ2h0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIE9wZXJhdG9yLnByb3RvdHlwZS5sZXNzT3JFcXVhbFRoYW4gPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJlY2VuZGNlIDw9IG9wLnByZWNlbmRjZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBPcGVyYXRvcjtcclxuICAgIH0pKCk7XHJcbiAgICB2YXIgb3BlcmF0b3JzID0gbmV3IE1hcChbXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICBcIitcIixcclxuICAgICAgICAgICAgbmV3IE9wZXJhdG9yKDEsIGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQgKyByaWdodDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICBdLFxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgXCItXCIsXHJcbiAgICAgICAgICAgIG5ldyBPcGVyYXRvcigxLCBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsZWZ0IC0gcmlnaHQ7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgXSxcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgIFwiKlwiLFxyXG4gICAgICAgICAgICBuZXcgT3BlcmF0b3IoMiwgZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGVmdCAqIHJpZ2h0O1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICBcIi9cIixcclxuICAgICAgICAgICAgbmV3IE9wZXJhdG9yKDIsIGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQgLyByaWdodDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICBdXHJcbiAgICBdKTtcclxuXHJcbiAgICBmdW5jdGlvbiBnZXRNYXRjaGVzKHJlZ2V4LCBpbnB1dCwgZ3JvdXApIHtcclxuICAgICAgICBpZiAoZ3JvdXAgPT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICBncm91cCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXRjaGVzID0gW107XHJcbiAgICAgICAgdmFyIG07XHJcbiAgICAgICAgd2hpbGUgKChtID0gcmVnZXguZXhlYyhpbnB1dCkpKSB7XHJcbiAgICAgICAgICAgIG1hdGNoZXMucHVzaChtW2dyb3VwXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtYXRjaGVzO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZm9ybWF0Q1NTKHRleHQpIHtcclxuICAgICAgICBmdW5jdGlvbiB0cmltTGVmdCh0ZXh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoL15cXHMrLywgXCJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEluZGVudChkZXB0aCkge1xyXG4gICAgICAgICAgICBpZiAoZGVwdGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBcIiBcIi5yZXBlYXQoNCAqIGRlcHRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRleHQubGVuZ3RoIDwgNTAwMDApIHtcclxuICAgICAgICAgICAgdmFyIGVtcHR5UnVsZVJlZ2V4cCA9IC9bXnt9XSt7XFxzKn0vO1xyXG4gICAgICAgICAgICB3aGlsZSAoZW1wdHlSdWxlUmVnZXhwLnRlc3QodGV4dCkpIHtcclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoZW1wdHlSdWxlUmVnZXhwLCBcIlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY3NzID0gdGV4dFxyXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxzezIsfS9nLCBcIiBcIilcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcey9nLCBcIntcXG5cIilcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcfS9nLCBcIlxcbn1cXG5cIilcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcOyg/IVteXFwofFxcXCJdKihcXCl8XFxcIikpL2csIFwiO1xcblwiKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvXFwsKD8hW15cXCh8XFxcIl0qKFxcKXxcXFwiKSkvZywgXCIsXFxuXCIpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXG5cXHMqXFxuL2csIFwiXFxuXCIpXHJcbiAgICAgICAgICAgIC5zcGxpdChcIlxcblwiKTtcclxuICAgICAgICB2YXIgZGVwdGggPSAwO1xyXG4gICAgICAgIHZhciBmb3JtYXR0ZWQgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciB4ID0gMCwgbGVuID0gY3NzLmxlbmd0aDsgeCA8IGxlbjsgeCsrKSB7XHJcbiAgICAgICAgICAgIHZhciBsaW5lID0gXCJcIi5jb25jYXQoY3NzW3hdLCBcIlxcblwiKTtcclxuICAgICAgICAgICAgaWYgKGxpbmUuaW5jbHVkZXMoXCJ7XCIpKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWQucHVzaChnZXRJbmRlbnQoZGVwdGgrKykgKyB0cmltTGVmdChsaW5lKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZS5pbmNsdWRlcyhcIn1cIikpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZC5wdXNoKGdldEluZGVudCgtLWRlcHRoKSArIHRyaW1MZWZ0KGxpbmUpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZC5wdXNoKGdldEluZGVudChkZXB0aCkgKyB0cmltTGVmdChsaW5lKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZC5qb2luKFwiXCIpLnRyaW0oKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldFBhcmVudGhlc2VzUmFuZ2UoaW5wdXQsIHNlYXJjaFN0YXJ0SW5kZXgpIHtcclxuICAgICAgICBpZiAoc2VhcmNoU3RhcnRJbmRleCA9PT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIHNlYXJjaFN0YXJ0SW5kZXggPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgIHZhciBkZXB0aCA9IDA7XHJcbiAgICAgICAgdmFyIGZpcnN0T3BlbkluZGV4ID0gLTE7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHNlYXJjaFN0YXJ0SW5kZXg7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZGVwdGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBvcGVuSW5kZXggPSBpbnB1dC5pbmRleE9mKFwiKFwiLCBpKTtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuSW5kZXggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmaXJzdE9wZW5JbmRleCA9IG9wZW5JbmRleDtcclxuICAgICAgICAgICAgICAgIGRlcHRoKys7XHJcbiAgICAgICAgICAgICAgICBpID0gb3BlbkluZGV4O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNsb3NpbmdJbmRleCA9IGlucHV0LmluZGV4T2YoXCIpXCIsIGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNsb3NpbmdJbmRleCA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBvcGVuSW5kZXggPSBpbnB1dC5pbmRleE9mKFwiKFwiLCBpKTtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuSW5kZXggPCAwIHx8IGNsb3NpbmdJbmRleCA8IG9wZW5JbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHRoLS07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlcHRoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7c3RhcnQ6IGZpcnN0T3BlbkluZGV4LCBlbmQ6IGNsb3NpbmdJbmRleCArIDF9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpID0gY2xvc2luZ0luZGV4O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXB0aCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBvcGVuSW5kZXg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGhzbGFQYXJzZUNhY2hlID0gbmV3IE1hcCgpO1xyXG4gICAgdmFyIHJnYmFQYXJzZUNhY2hlID0gbmV3IE1hcCgpO1xyXG4gICAgZnVuY3Rpb24gcGFyc2VDb2xvcldpdGhDYWNoZSgkY29sb3IpIHtcclxuICAgICAgICAkY29sb3IgPSAkY29sb3IudHJpbSgpO1xyXG4gICAgICAgIGlmIChyZ2JhUGFyc2VDYWNoZS5oYXMoJGNvbG9yKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmdiYVBhcnNlQ2FjaGUuZ2V0KCRjb2xvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgkY29sb3IuaW5jbHVkZXMoXCJjYWxjKFwiKSkge1xyXG4gICAgICAgICAgICAkY29sb3IgPSBsb3dlckNhbGNFeHByZXNzaW9uKCRjb2xvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb2xvciA9IHBhcnNlKCRjb2xvcik7XHJcbiAgICAgICAgY29sb3IgJiYgcmdiYVBhcnNlQ2FjaGUuc2V0KCRjb2xvciwgY29sb3IpO1xyXG4gICAgICAgIHJldHVybiBjb2xvcjtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHBhcnNlVG9IU0xXaXRoQ2FjaGUoY29sb3IpIHtcclxuICAgICAgICBpZiAoaHNsYVBhcnNlQ2FjaGUuaGFzKGNvbG9yKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaHNsYVBhcnNlQ2FjaGUuZ2V0KGNvbG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJnYiA9IHBhcnNlQ29sb3JXaXRoQ2FjaGUoY29sb3IpO1xyXG4gICAgICAgIGlmICghcmdiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaHNsID0gcmdiVG9IU0wocmdiKTtcclxuICAgICAgICBoc2xhUGFyc2VDYWNoZS5zZXQoY29sb3IsIGhzbCk7XHJcbiAgICAgICAgcmV0dXJuIGhzbDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNsZWFyQ29sb3JDYWNoZSgpIHtcclxuICAgICAgICBoc2xhUGFyc2VDYWNoZS5jbGVhcigpO1xyXG4gICAgICAgIHJnYmFQYXJzZUNhY2hlLmNsZWFyKCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBoc2xUb1JHQihfYSkge1xyXG4gICAgICAgIHZhciBoID0gX2EuaCxcclxuICAgICAgICAgICAgcyA9IF9hLnMsXHJcbiAgICAgICAgICAgIGwgPSBfYS5sLFxyXG4gICAgICAgICAgICBfYiA9IF9hLmEsXHJcbiAgICAgICAgICAgIGEgPSBfYiA9PT0gdm9pZCAwID8gMSA6IF9iO1xyXG4gICAgICAgIGlmIChzID09PSAwKSB7XHJcbiAgICAgICAgICAgIHZhciBfYyA9IF9fcmVhZChcclxuICAgICAgICAgICAgICAgICAgICBbbCwgbCwgbF0ubWFwKGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHggKiAyNTUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgIDNcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICByXzEgPSBfY1swXSxcclxuICAgICAgICAgICAgICAgIGJfMSA9IF9jWzFdLFxyXG4gICAgICAgICAgICAgICAgZ18xID0gX2NbMl07XHJcbiAgICAgICAgICAgIHJldHVybiB7cjogcl8xLCBnOiBnXzEsIGI6IGJfMSwgYTogYX07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjID0gKDEgLSBNYXRoLmFicygyICogbCAtIDEpKSAqIHM7XHJcbiAgICAgICAgdmFyIHggPSBjICogKDEgLSBNYXRoLmFicygoKGggLyA2MCkgJSAyKSAtIDEpKTtcclxuICAgICAgICB2YXIgbSA9IGwgLSBjIC8gMjtcclxuICAgICAgICB2YXIgX2QgPSBfX3JlYWQoXHJcbiAgICAgICAgICAgICAgICAoaCA8IDYwXHJcbiAgICAgICAgICAgICAgICAgICAgPyBbYywgeCwgMF1cclxuICAgICAgICAgICAgICAgICAgICA6IGggPCAxMjBcclxuICAgICAgICAgICAgICAgICAgICAgID8gW3gsIGMsIDBdXHJcbiAgICAgICAgICAgICAgICAgICAgICA6IGggPCAxODBcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBbMCwgYywgeF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBoIDwgMjQwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPyBbMCwgeCwgY11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA6IGggPCAzMDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gW3gsIDAsIGNdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFtjLCAwLCB4XVxyXG4gICAgICAgICAgICAgICAgKS5tYXAoZnVuY3Rpb24gKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCgobiArIG0pICogMjU1KTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgM1xyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICByID0gX2RbMF0sXHJcbiAgICAgICAgICAgIGcgPSBfZFsxXSxcclxuICAgICAgICAgICAgYiA9IF9kWzJdO1xyXG4gICAgICAgIHJldHVybiB7cjogciwgZzogZywgYjogYiwgYTogYX07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZ2JUb0hTTChfYSkge1xyXG4gICAgICAgIHZhciByMjU1ID0gX2EucixcclxuICAgICAgICAgICAgZzI1NSA9IF9hLmcsXHJcbiAgICAgICAgICAgIGIyNTUgPSBfYS5iLFxyXG4gICAgICAgICAgICBfYiA9IF9hLmEsXHJcbiAgICAgICAgICAgIGEgPSBfYiA9PT0gdm9pZCAwID8gMSA6IF9iO1xyXG4gICAgICAgIHZhciByID0gcjI1NSAvIDI1NTtcclxuICAgICAgICB2YXIgZyA9IGcyNTUgLyAyNTU7XHJcbiAgICAgICAgdmFyIGIgPSBiMjU1IC8gMjU1O1xyXG4gICAgICAgIHZhciBtYXggPSBNYXRoLm1heChyLCBnLCBiKTtcclxuICAgICAgICB2YXIgbWluID0gTWF0aC5taW4ociwgZywgYik7XHJcbiAgICAgICAgdmFyIGMgPSBtYXggLSBtaW47XHJcbiAgICAgICAgdmFyIGwgPSAobWF4ICsgbWluKSAvIDI7XHJcbiAgICAgICAgaWYgKGMgPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtoOiAwLCBzOiAwLCBsOiBsLCBhOiBhfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGggPVxyXG4gICAgICAgICAgICAobWF4ID09PSByXHJcbiAgICAgICAgICAgICAgICA/ICgoZyAtIGIpIC8gYykgJSA2XHJcbiAgICAgICAgICAgICAgICA6IG1heCA9PT0gZ1xyXG4gICAgICAgICAgICAgICAgICA/IChiIC0gcikgLyBjICsgMlxyXG4gICAgICAgICAgICAgICAgICA6IChyIC0gZykgLyBjICsgNCkgKiA2MDtcclxuICAgICAgICBpZiAoaCA8IDApIHtcclxuICAgICAgICAgICAgaCArPSAzNjA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzID0gYyAvICgxIC0gTWF0aC5hYnMoMiAqIGwgLSAxKSk7XHJcbiAgICAgICAgcmV0dXJuIHtoOiBoLCBzOiBzLCBsOiBsLCBhOiBhfTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHRvRml4ZWQobiwgZGlnaXRzKSB7XHJcbiAgICAgICAgaWYgKGRpZ2l0cyA9PT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIGRpZ2l0cyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmaXhlZCA9IG4udG9GaXhlZChkaWdpdHMpO1xyXG4gICAgICAgIGlmIChkaWdpdHMgPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpeGVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZG90ID0gZml4ZWQuaW5kZXhPZihcIi5cIik7XHJcbiAgICAgICAgaWYgKGRvdCA+PSAwKSB7XHJcbiAgICAgICAgICAgIHZhciB6ZXJvc01hdGNoID0gZml4ZWQubWF0Y2goLzArJC8pO1xyXG4gICAgICAgICAgICBpZiAoemVyb3NNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHplcm9zTWF0Y2guaW5kZXggPT09IGRvdCArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZml4ZWQuc3Vic3RyaW5nKDAsIGRvdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZml4ZWQuc3Vic3RyaW5nKDAsIHplcm9zTWF0Y2guaW5kZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmaXhlZDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJnYlRvU3RyaW5nKHJnYikge1xyXG4gICAgICAgIHZhciByID0gcmdiLnIsXHJcbiAgICAgICAgICAgIGcgPSByZ2IuZyxcclxuICAgICAgICAgICAgYiA9IHJnYi5iLFxyXG4gICAgICAgICAgICBhID0gcmdiLmE7XHJcbiAgICAgICAgaWYgKGEgIT0gbnVsbCAmJiBhIDwgMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gXCJyZ2JhKFwiXHJcbiAgICAgICAgICAgICAgICAuY29uY2F0KHRvRml4ZWQociksIFwiLCBcIilcclxuICAgICAgICAgICAgICAgIC5jb25jYXQodG9GaXhlZChnKSwgXCIsIFwiKVxyXG4gICAgICAgICAgICAgICAgLmNvbmNhdCh0b0ZpeGVkKGIpLCBcIiwgXCIpXHJcbiAgICAgICAgICAgICAgICAuY29uY2F0KHRvRml4ZWQoYSwgMiksIFwiKVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFwicmdiKFwiXHJcbiAgICAgICAgICAgIC5jb25jYXQodG9GaXhlZChyKSwgXCIsIFwiKVxyXG4gICAgICAgICAgICAuY29uY2F0KHRvRml4ZWQoZyksIFwiLCBcIilcclxuICAgICAgICAgICAgLmNvbmNhdCh0b0ZpeGVkKGIpLCBcIilcIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZ2JUb0hleFN0cmluZyhfYSkge1xyXG4gICAgICAgIHZhciByID0gX2EucixcclxuICAgICAgICAgICAgZyA9IF9hLmcsXHJcbiAgICAgICAgICAgIGIgPSBfYS5iLFxyXG4gICAgICAgICAgICBhID0gX2EuYTtcclxuICAgICAgICByZXR1cm4gXCIjXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAoYSAhPSBudWxsICYmIGEgPCAxID8gW3IsIGcsIGIsIE1hdGgucm91bmQoYSAqIDI1NSldIDogW3IsIGcsIGJdKVxyXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiLmNvbmNhdCh4IDwgMTYgPyBcIjBcIiA6IFwiXCIpLmNvbmNhdCh4LnRvU3RyaW5nKDE2KSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmpvaW4oXCJcIilcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaHNsVG9TdHJpbmcoaHNsKSB7XHJcbiAgICAgICAgdmFyIGggPSBoc2wuaCxcclxuICAgICAgICAgICAgcyA9IGhzbC5zLFxyXG4gICAgICAgICAgICBsID0gaHNsLmwsXHJcbiAgICAgICAgICAgIGEgPSBoc2wuYTtcclxuICAgICAgICBpZiAoYSAhPSBudWxsICYmIGEgPCAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcImhzbGEoXCJcclxuICAgICAgICAgICAgICAgIC5jb25jYXQodG9GaXhlZChoKSwgXCIsIFwiKVxyXG4gICAgICAgICAgICAgICAgLmNvbmNhdCh0b0ZpeGVkKHMgKiAxMDApLCBcIiUsIFwiKVxyXG4gICAgICAgICAgICAgICAgLmNvbmNhdCh0b0ZpeGVkKGwgKiAxMDApLCBcIiUsIFwiKVxyXG4gICAgICAgICAgICAgICAgLmNvbmNhdCh0b0ZpeGVkKGEsIDIpLCBcIilcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcImhzbChcIlxyXG4gICAgICAgICAgICAuY29uY2F0KHRvRml4ZWQoaCksIFwiLCBcIilcclxuICAgICAgICAgICAgLmNvbmNhdCh0b0ZpeGVkKHMgKiAxMDApLCBcIiUsIFwiKVxyXG4gICAgICAgICAgICAuY29uY2F0KHRvRml4ZWQobCAqIDEwMCksIFwiJSlcIik7XHJcbiAgICB9XHJcbiAgICB2YXIgcmdiTWF0Y2ggPSAvXnJnYmE/XFwoW15cXChcXCldK1xcKSQvO1xyXG4gICAgdmFyIGhzbE1hdGNoID0gL15oc2xhP1xcKFteXFwoXFwpXStcXCkkLztcclxuICAgIHZhciBoZXhNYXRjaCA9IC9eI1swLTlhLWZdKyQvaTtcclxuICAgIGZ1bmN0aW9uIHBhcnNlKCRjb2xvcikge1xyXG4gICAgICAgIHZhciBjID0gJGNvbG9yLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChjLm1hdGNoKHJnYk1hdGNoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VSR0IoYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjLm1hdGNoKGhzbE1hdGNoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VIU0woYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjLm1hdGNoKGhleE1hdGNoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VIZXgoYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChrbm93bkNvbG9ycy5oYXMoYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGdldENvbG9yQnlOYW1lKGMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3lzdGVtQ29sb3JzLmhhcyhjKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0U3lzdGVtQ29sb3IoYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgkY29sb3IgPT09IFwidHJhbnNwYXJlbnRcIikge1xyXG4gICAgICAgICAgICByZXR1cm4ge3I6IDAsIGc6IDAsIGI6IDAsIGE6IDB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldE51bWJlcnMoJGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIG51bWJlcnMgPSBbXTtcclxuICAgICAgICB2YXIgcHJldlBvcyA9IDA7XHJcbiAgICAgICAgdmFyIGlzTWluaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHN0YXJ0SW5kZXggPSAkY29sb3IuaW5kZXhPZihcIihcIik7XHJcbiAgICAgICAgJGNvbG9yID0gJGNvbG9yLnN1YnN0cmluZyhzdGFydEluZGV4ICsgMSwgJGNvbG9yLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJGNvbG9yLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gJGNvbG9yW2ldO1xyXG4gICAgICAgICAgICBpZiAoKGMgPj0gXCIwXCIgJiYgYyA8PSBcIjlcIikgfHwgYyA9PT0gXCIuXCIgfHwgYyA9PT0gXCIrXCIgfHwgYyA9PT0gXCItXCIpIHtcclxuICAgICAgICAgICAgICAgIGlzTWluaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc01pbmluZyAmJiAoYyA9PT0gXCIgXCIgfHwgYyA9PT0gXCIsXCIgfHwgYyA9PT0gXCIvXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBudW1iZXJzLnB1c2goJGNvbG9yLnN1YnN0cmluZyhwcmV2UG9zLCBpKSk7XHJcbiAgICAgICAgICAgICAgICBpc01pbmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgcHJldlBvcyA9IGkgKyAxO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFpc01pbmluZykge1xyXG4gICAgICAgICAgICAgICAgcHJldlBvcyA9IGkgKyAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc01pbmluZykge1xyXG4gICAgICAgICAgICBudW1iZXJzLnB1c2goJGNvbG9yLnN1YnN0cmluZyhwcmV2UG9zLCAkY29sb3IubGVuZ3RoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudW1iZXJzO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0TnVtYmVyc0Zyb21TdHJpbmcoc3RyLCByYW5nZSwgdW5pdHMpIHtcclxuICAgICAgICB2YXIgcmF3ID0gZ2V0TnVtYmVycyhzdHIpO1xyXG4gICAgICAgIHZhciB1bml0c0xpc3QgPSBPYmplY3QuZW50cmllcyh1bml0cyk7XHJcbiAgICAgICAgdmFyIG51bWJlcnMgPSByYXdcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIudHJpbSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChyLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbjtcclxuICAgICAgICAgICAgICAgIHZhciB1bml0ID0gdW5pdHNMaXN0LmZpbmQoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAxKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdSA9IF9iWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByLmVuZHNXaXRoKHUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodW5pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAocGFyc2VGbG9hdChyLnN1YnN0cmluZygwLCByLmxlbmd0aCAtIHVuaXRbMF0ubGVuZ3RoKSkgL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdFsxXSkgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByYW5nZVtpXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHBhcnNlRmxvYXQocik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2VbaV0gPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG51bWJlcnM7XHJcbiAgICB9XHJcbiAgICB2YXIgcmdiUmFuZ2UgPSBbMjU1LCAyNTUsIDI1NSwgMV07XHJcbiAgICB2YXIgcmdiVW5pdHMgPSB7XCIlXCI6IDEwMH07XHJcbiAgICBmdW5jdGlvbiBwYXJzZVJHQigkcmdiKSB7XHJcbiAgICAgICAgdmFyIF9hID0gX19yZWFkKGdldE51bWJlcnNGcm9tU3RyaW5nKCRyZ2IsIHJnYlJhbmdlLCByZ2JVbml0cyksIDQpLFxyXG4gICAgICAgICAgICByID0gX2FbMF0sXHJcbiAgICAgICAgICAgIGcgPSBfYVsxXSxcclxuICAgICAgICAgICAgYiA9IF9hWzJdLFxyXG4gICAgICAgICAgICBfYiA9IF9hWzNdLFxyXG4gICAgICAgICAgICBhID0gX2IgPT09IHZvaWQgMCA/IDEgOiBfYjtcclxuICAgICAgICByZXR1cm4ge3I6IHIsIGc6IGcsIGI6IGIsIGE6IGF9O1xyXG4gICAgfVxyXG4gICAgdmFyIGhzbFJhbmdlID0gWzM2MCwgMSwgMSwgMV07XHJcbiAgICB2YXIgaHNsVW5pdHMgPSB7XCIlXCI6IDEwMCwgXCJkZWdcIjogMzYwLCBcInJhZFwiOiAyICogTWF0aC5QSSwgXCJ0dXJuXCI6IDF9O1xyXG4gICAgZnVuY3Rpb24gcGFyc2VIU0woJGhzbCkge1xyXG4gICAgICAgIHZhciBfYSA9IF9fcmVhZChnZXROdW1iZXJzRnJvbVN0cmluZygkaHNsLCBoc2xSYW5nZSwgaHNsVW5pdHMpLCA0KSxcclxuICAgICAgICAgICAgaCA9IF9hWzBdLFxyXG4gICAgICAgICAgICBzID0gX2FbMV0sXHJcbiAgICAgICAgICAgIGwgPSBfYVsyXSxcclxuICAgICAgICAgICAgX2IgPSBfYVszXSxcclxuICAgICAgICAgICAgYSA9IF9iID09PSB2b2lkIDAgPyAxIDogX2I7XHJcbiAgICAgICAgcmV0dXJuIGhzbFRvUkdCKHtoOiBoLCBzOiBzLCBsOiBsLCBhOiBhfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBwYXJzZUhleCgkaGV4KSB7XHJcbiAgICAgICAgdmFyIGggPSAkaGV4LnN1YnN0cmluZygxKTtcclxuICAgICAgICBzd2l0Y2ggKGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgY2FzZSA0OiB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBfX3JlYWQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFswLCAxLCAyXS5tYXAoZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludChcIlwiLmNvbmNhdChoW2ldKS5jb25jYXQoaFtpXSksIDE2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDNcclxuICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICAgIHIgPSBfYVswXSxcclxuICAgICAgICAgICAgICAgICAgICBnID0gX2FbMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgYiA9IF9hWzJdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPVxyXG4gICAgICAgICAgICAgICAgICAgIGgubGVuZ3RoID09PSAzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHBhcnNlSW50KFwiXCIuY29uY2F0KGhbM10pLmNvbmNhdChoWzNdKSwgMTYpIC8gMjU1O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtyOiByLCBnOiBnLCBiOiBiLCBhOiBhfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgIGNhc2UgODoge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBbMCwgMiwgNF0ubWFwKGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoaC5zdWJzdHJpbmcoaSwgaSArIDIpLCAxNik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAzXHJcbiAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgICByID0gX2JbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgZyA9IF9iWzFdLFxyXG4gICAgICAgICAgICAgICAgICAgIGIgPSBfYlsyXTtcclxuICAgICAgICAgICAgICAgIHZhciBhID1cclxuICAgICAgICAgICAgICAgICAgICBoLmxlbmd0aCA9PT0gNiA/IDEgOiBwYXJzZUludChoLnN1YnN0cmluZyg2LCA4KSwgMTYpIC8gMjU1O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtyOiByLCBnOiBnLCBiOiBiLCBhOiBhfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldENvbG9yQnlOYW1lKCRjb2xvcikge1xyXG4gICAgICAgIHZhciBuID0ga25vd25Db2xvcnMuZ2V0KCRjb2xvcik7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcjogKG4gPj4gMTYpICYgMjU1LFxyXG4gICAgICAgICAgICBnOiAobiA+PiA4KSAmIDI1NSxcclxuICAgICAgICAgICAgYjogKG4gPj4gMCkgJiAyNTUsXHJcbiAgICAgICAgICAgIGE6IDFcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0U3lzdGVtQ29sb3IoJGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIG4gPSBzeXN0ZW1Db2xvcnMuZ2V0KCRjb2xvcik7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcjogKG4gPj4gMTYpICYgMjU1LFxyXG4gICAgICAgICAgICBnOiAobiA+PiA4KSAmIDI1NSxcclxuICAgICAgICAgICAgYjogKG4gPj4gMCkgJiAyNTUsXHJcbiAgICAgICAgICAgIGE6IDFcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbG93ZXJDYWxjRXhwcmVzc2lvbihjb2xvcikge1xyXG4gICAgICAgIHZhciBzZWFyY2hJbmRleCA9IDA7XHJcbiAgICAgICAgdmFyIHJlcGxhY2VCZXR3ZWVuSW5kaWNlcyA9IGZ1bmN0aW9uIChzdGFydCwgZW5kLCByZXBsYWNlbWVudCkge1xyXG4gICAgICAgICAgICBjb2xvciA9XHJcbiAgICAgICAgICAgICAgICBjb2xvci5zdWJzdHJpbmcoMCwgc3RhcnQpICsgcmVwbGFjZW1lbnQgKyBjb2xvci5zdWJzdHJpbmcoZW5kKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHdoaWxlICgoc2VhcmNoSW5kZXggPSBjb2xvci5pbmRleE9mKFwiY2FsYyhcIikpICE9PSAtMSkge1xyXG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBnZXRQYXJlbnRoZXNlc1JhbmdlKGNvbG9yLCBzZWFyY2hJbmRleCk7XHJcbiAgICAgICAgICAgIGlmICghcmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzbGljZSA9IGNvbG9yLnNsaWNlKHJhbmdlLnN0YXJ0ICsgMSwgcmFuZ2UuZW5kIC0gMSk7XHJcbiAgICAgICAgICAgIHZhciBpbmNsdWRlc1BlcmNlbnRhZ2UgPSBzbGljZS5pbmNsdWRlcyhcIiVcIik7XHJcbiAgICAgICAgICAgIHNsaWNlID0gc2xpY2Uuc3BsaXQoXCIlXCIpLmpvaW4oXCJcIik7XHJcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBNYXRoLnJvdW5kKGV2YWxNYXRoKHNsaWNlKSk7XHJcbiAgICAgICAgICAgIHJlcGxhY2VCZXR3ZWVuSW5kaWNlcyhcclxuICAgICAgICAgICAgICAgIHJhbmdlLnN0YXJ0IC0gNCxcclxuICAgICAgICAgICAgICAgIHJhbmdlLmVuZCxcclxuICAgICAgICAgICAgICAgIG91dHB1dCArIChpbmNsdWRlc1BlcmNlbnRhZ2UgPyBcIiVcIiA6IFwiXCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb2xvcjtcclxuICAgIH1cclxuICAgIHZhciBrbm93bkNvbG9ycyA9IG5ldyBNYXAoXHJcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoe1xyXG4gICAgICAgICAgICBhbGljZWJsdWU6IDB4ZjBmOGZmLFxyXG4gICAgICAgICAgICBhbnRpcXVld2hpdGU6IDB4ZmFlYmQ3LFxyXG4gICAgICAgICAgICBhcXVhOiAweDAwZmZmZixcclxuICAgICAgICAgICAgYXF1YW1hcmluZTogMHg3ZmZmZDQsXHJcbiAgICAgICAgICAgIGF6dXJlOiAweGYwZmZmZixcclxuICAgICAgICAgICAgYmVpZ2U6IDB4ZjVmNWRjLFxyXG4gICAgICAgICAgICBiaXNxdWU6IDB4ZmZlNGM0LFxyXG4gICAgICAgICAgICBibGFjazogMHgwMDAwMDAsXHJcbiAgICAgICAgICAgIGJsYW5jaGVkYWxtb25kOiAweGZmZWJjZCxcclxuICAgICAgICAgICAgYmx1ZTogMHgwMDAwZmYsXHJcbiAgICAgICAgICAgIGJsdWV2aW9sZXQ6IDB4OGEyYmUyLFxyXG4gICAgICAgICAgICBicm93bjogMHhhNTJhMmEsXHJcbiAgICAgICAgICAgIGJ1cmx5d29vZDogMHhkZWI4ODcsXHJcbiAgICAgICAgICAgIGNhZGV0Ymx1ZTogMHg1ZjllYTAsXHJcbiAgICAgICAgICAgIGNoYXJ0cmV1c2U6IDB4N2ZmZjAwLFxyXG4gICAgICAgICAgICBjaG9jb2xhdGU6IDB4ZDI2OTFlLFxyXG4gICAgICAgICAgICBjb3JhbDogMHhmZjdmNTAsXHJcbiAgICAgICAgICAgIGNvcm5mbG93ZXJibHVlOiAweDY0OTVlZCxcclxuICAgICAgICAgICAgY29ybnNpbGs6IDB4ZmZmOGRjLFxyXG4gICAgICAgICAgICBjcmltc29uOiAweGRjMTQzYyxcclxuICAgICAgICAgICAgY3lhbjogMHgwMGZmZmYsXHJcbiAgICAgICAgICAgIGRhcmtibHVlOiAweDAwMDA4YixcclxuICAgICAgICAgICAgZGFya2N5YW46IDB4MDA4YjhiLFxyXG4gICAgICAgICAgICBkYXJrZ29sZGVucm9kOiAweGI4ODYwYixcclxuICAgICAgICAgICAgZGFya2dyYXk6IDB4YTlhOWE5LFxyXG4gICAgICAgICAgICBkYXJrZ3JleTogMHhhOWE5YTksXHJcbiAgICAgICAgICAgIGRhcmtncmVlbjogMHgwMDY0MDAsXHJcbiAgICAgICAgICAgIGRhcmtraGFraTogMHhiZGI3NmIsXHJcbiAgICAgICAgICAgIGRhcmttYWdlbnRhOiAweDhiMDA4YixcclxuICAgICAgICAgICAgZGFya29saXZlZ3JlZW46IDB4NTU2YjJmLFxyXG4gICAgICAgICAgICBkYXJrb3JhbmdlOiAweGZmOGMwMCxcclxuICAgICAgICAgICAgZGFya29yY2hpZDogMHg5OTMyY2MsXHJcbiAgICAgICAgICAgIGRhcmtyZWQ6IDB4OGIwMDAwLFxyXG4gICAgICAgICAgICBkYXJrc2FsbW9uOiAweGU5OTY3YSxcclxuICAgICAgICAgICAgZGFya3NlYWdyZWVuOiAweDhmYmM4ZixcclxuICAgICAgICAgICAgZGFya3NsYXRlYmx1ZTogMHg0ODNkOGIsXHJcbiAgICAgICAgICAgIGRhcmtzbGF0ZWdyYXk6IDB4MmY0ZjRmLFxyXG4gICAgICAgICAgICBkYXJrc2xhdGVncmV5OiAweDJmNGY0ZixcclxuICAgICAgICAgICAgZGFya3R1cnF1b2lzZTogMHgwMGNlZDEsXHJcbiAgICAgICAgICAgIGRhcmt2aW9sZXQ6IDB4OTQwMGQzLFxyXG4gICAgICAgICAgICBkZWVwcGluazogMHhmZjE0OTMsXHJcbiAgICAgICAgICAgIGRlZXBza3libHVlOiAweDAwYmZmZixcclxuICAgICAgICAgICAgZGltZ3JheTogMHg2OTY5NjksXHJcbiAgICAgICAgICAgIGRpbWdyZXk6IDB4Njk2OTY5LFxyXG4gICAgICAgICAgICBkb2RnZXJibHVlOiAweDFlOTBmZixcclxuICAgICAgICAgICAgZmlyZWJyaWNrOiAweGIyMjIyMixcclxuICAgICAgICAgICAgZmxvcmFsd2hpdGU6IDB4ZmZmYWYwLFxyXG4gICAgICAgICAgICBmb3Jlc3RncmVlbjogMHgyMjhiMjIsXHJcbiAgICAgICAgICAgIGZ1Y2hzaWE6IDB4ZmYwMGZmLFxyXG4gICAgICAgICAgICBnYWluc2Jvcm86IDB4ZGNkY2RjLFxyXG4gICAgICAgICAgICBnaG9zdHdoaXRlOiAweGY4ZjhmZixcclxuICAgICAgICAgICAgZ29sZDogMHhmZmQ3MDAsXHJcbiAgICAgICAgICAgIGdvbGRlbnJvZDogMHhkYWE1MjAsXHJcbiAgICAgICAgICAgIGdyYXk6IDB4ODA4MDgwLFxyXG4gICAgICAgICAgICBncmV5OiAweDgwODA4MCxcclxuICAgICAgICAgICAgZ3JlZW46IDB4MDA4MDAwLFxyXG4gICAgICAgICAgICBncmVlbnllbGxvdzogMHhhZGZmMmYsXHJcbiAgICAgICAgICAgIGhvbmV5ZGV3OiAweGYwZmZmMCxcclxuICAgICAgICAgICAgaG90cGluazogMHhmZjY5YjQsXHJcbiAgICAgICAgICAgIGluZGlhbnJlZDogMHhjZDVjNWMsXHJcbiAgICAgICAgICAgIGluZGlnbzogMHg0YjAwODIsXHJcbiAgICAgICAgICAgIGl2b3J5OiAweGZmZmZmMCxcclxuICAgICAgICAgICAga2hha2k6IDB4ZjBlNjhjLFxyXG4gICAgICAgICAgICBsYXZlbmRlcjogMHhlNmU2ZmEsXHJcbiAgICAgICAgICAgIGxhdmVuZGVyYmx1c2g6IDB4ZmZmMGY1LFxyXG4gICAgICAgICAgICBsYXduZ3JlZW46IDB4N2NmYzAwLFxyXG4gICAgICAgICAgICBsZW1vbmNoaWZmb246IDB4ZmZmYWNkLFxyXG4gICAgICAgICAgICBsaWdodGJsdWU6IDB4YWRkOGU2LFxyXG4gICAgICAgICAgICBsaWdodGNvcmFsOiAweGYwODA4MCxcclxuICAgICAgICAgICAgbGlnaHRjeWFuOiAweGUwZmZmZixcclxuICAgICAgICAgICAgbGlnaHRnb2xkZW5yb2R5ZWxsb3c6IDB4ZmFmYWQyLFxyXG4gICAgICAgICAgICBsaWdodGdyYXk6IDB4ZDNkM2QzLFxyXG4gICAgICAgICAgICBsaWdodGdyZXk6IDB4ZDNkM2QzLFxyXG4gICAgICAgICAgICBsaWdodGdyZWVuOiAweDkwZWU5MCxcclxuICAgICAgICAgICAgbGlnaHRwaW5rOiAweGZmYjZjMSxcclxuICAgICAgICAgICAgbGlnaHRzYWxtb246IDB4ZmZhMDdhLFxyXG4gICAgICAgICAgICBsaWdodHNlYWdyZWVuOiAweDIwYjJhYSxcclxuICAgICAgICAgICAgbGlnaHRza3libHVlOiAweDg3Y2VmYSxcclxuICAgICAgICAgICAgbGlnaHRzbGF0ZWdyYXk6IDB4Nzc4ODk5LFxyXG4gICAgICAgICAgICBsaWdodHNsYXRlZ3JleTogMHg3Nzg4OTksXHJcbiAgICAgICAgICAgIGxpZ2h0c3RlZWxibHVlOiAweGIwYzRkZSxcclxuICAgICAgICAgICAgbGlnaHR5ZWxsb3c6IDB4ZmZmZmUwLFxyXG4gICAgICAgICAgICBsaW1lOiAweDAwZmYwMCxcclxuICAgICAgICAgICAgbGltZWdyZWVuOiAweDMyY2QzMixcclxuICAgICAgICAgICAgbGluZW46IDB4ZmFmMGU2LFxyXG4gICAgICAgICAgICBtYWdlbnRhOiAweGZmMDBmZixcclxuICAgICAgICAgICAgbWFyb29uOiAweDgwMDAwMCxcclxuICAgICAgICAgICAgbWVkaXVtYXF1YW1hcmluZTogMHg2NmNkYWEsXHJcbiAgICAgICAgICAgIG1lZGl1bWJsdWU6IDB4MDAwMGNkLFxyXG4gICAgICAgICAgICBtZWRpdW1vcmNoaWQ6IDB4YmE1NWQzLFxyXG4gICAgICAgICAgICBtZWRpdW1wdXJwbGU6IDB4OTM3MGRiLFxyXG4gICAgICAgICAgICBtZWRpdW1zZWFncmVlbjogMHgzY2IzNzEsXHJcbiAgICAgICAgICAgIG1lZGl1bXNsYXRlYmx1ZTogMHg3YjY4ZWUsXHJcbiAgICAgICAgICAgIG1lZGl1bXNwcmluZ2dyZWVuOiAweDAwZmE5YSxcclxuICAgICAgICAgICAgbWVkaXVtdHVycXVvaXNlOiAweDQ4ZDFjYyxcclxuICAgICAgICAgICAgbWVkaXVtdmlvbGV0cmVkOiAweGM3MTU4NSxcclxuICAgICAgICAgICAgbWlkbmlnaHRibHVlOiAweDE5MTk3MCxcclxuICAgICAgICAgICAgbWludGNyZWFtOiAweGY1ZmZmYSxcclxuICAgICAgICAgICAgbWlzdHlyb3NlOiAweGZmZTRlMSxcclxuICAgICAgICAgICAgbW9jY2FzaW46IDB4ZmZlNGI1LFxyXG4gICAgICAgICAgICBuYXZham93aGl0ZTogMHhmZmRlYWQsXHJcbiAgICAgICAgICAgIG5hdnk6IDB4MDAwMDgwLFxyXG4gICAgICAgICAgICBvbGRsYWNlOiAweGZkZjVlNixcclxuICAgICAgICAgICAgb2xpdmU6IDB4ODA4MDAwLFxyXG4gICAgICAgICAgICBvbGl2ZWRyYWI6IDB4NmI4ZTIzLFxyXG4gICAgICAgICAgICBvcmFuZ2U6IDB4ZmZhNTAwLFxyXG4gICAgICAgICAgICBvcmFuZ2VyZWQ6IDB4ZmY0NTAwLFxyXG4gICAgICAgICAgICBvcmNoaWQ6IDB4ZGE3MGQ2LFxyXG4gICAgICAgICAgICBwYWxlZ29sZGVucm9kOiAweGVlZThhYSxcclxuICAgICAgICAgICAgcGFsZWdyZWVuOiAweDk4ZmI5OCxcclxuICAgICAgICAgICAgcGFsZXR1cnF1b2lzZTogMHhhZmVlZWUsXHJcbiAgICAgICAgICAgIHBhbGV2aW9sZXRyZWQ6IDB4ZGI3MDkzLFxyXG4gICAgICAgICAgICBwYXBheWF3aGlwOiAweGZmZWZkNSxcclxuICAgICAgICAgICAgcGVhY2hwdWZmOiAweGZmZGFiOSxcclxuICAgICAgICAgICAgcGVydTogMHhjZDg1M2YsXHJcbiAgICAgICAgICAgIHBpbms6IDB4ZmZjMGNiLFxyXG4gICAgICAgICAgICBwbHVtOiAweGRkYTBkZCxcclxuICAgICAgICAgICAgcG93ZGVyYmx1ZTogMHhiMGUwZTYsXHJcbiAgICAgICAgICAgIHB1cnBsZTogMHg4MDAwODAsXHJcbiAgICAgICAgICAgIHJlYmVjY2FwdXJwbGU6IDB4NjYzMzk5LFxyXG4gICAgICAgICAgICByZWQ6IDB4ZmYwMDAwLFxyXG4gICAgICAgICAgICByb3N5YnJvd246IDB4YmM4ZjhmLFxyXG4gICAgICAgICAgICByb3lhbGJsdWU6IDB4NDE2OWUxLFxyXG4gICAgICAgICAgICBzYWRkbGVicm93bjogMHg4YjQ1MTMsXHJcbiAgICAgICAgICAgIHNhbG1vbjogMHhmYTgwNzIsXHJcbiAgICAgICAgICAgIHNhbmR5YnJvd246IDB4ZjRhNDYwLFxyXG4gICAgICAgICAgICBzZWFncmVlbjogMHgyZThiNTcsXHJcbiAgICAgICAgICAgIHNlYXNoZWxsOiAweGZmZjVlZSxcclxuICAgICAgICAgICAgc2llbm5hOiAweGEwNTIyZCxcclxuICAgICAgICAgICAgc2lsdmVyOiAweGMwYzBjMCxcclxuICAgICAgICAgICAgc2t5Ymx1ZTogMHg4N2NlZWIsXHJcbiAgICAgICAgICAgIHNsYXRlYmx1ZTogMHg2YTVhY2QsXHJcbiAgICAgICAgICAgIHNsYXRlZ3JheTogMHg3MDgwOTAsXHJcbiAgICAgICAgICAgIHNsYXRlZ3JleTogMHg3MDgwOTAsXHJcbiAgICAgICAgICAgIHNub3c6IDB4ZmZmYWZhLFxyXG4gICAgICAgICAgICBzcHJpbmdncmVlbjogMHgwMGZmN2YsXHJcbiAgICAgICAgICAgIHN0ZWVsYmx1ZTogMHg0NjgyYjQsXHJcbiAgICAgICAgICAgIHRhbjogMHhkMmI0OGMsXHJcbiAgICAgICAgICAgIHRlYWw6IDB4MDA4MDgwLFxyXG4gICAgICAgICAgICB0aGlzdGxlOiAweGQ4YmZkOCxcclxuICAgICAgICAgICAgdG9tYXRvOiAweGZmNjM0NyxcclxuICAgICAgICAgICAgdHVycXVvaXNlOiAweDQwZTBkMCxcclxuICAgICAgICAgICAgdmlvbGV0OiAweGVlODJlZSxcclxuICAgICAgICAgICAgd2hlYXQ6IDB4ZjVkZWIzLFxyXG4gICAgICAgICAgICB3aGl0ZTogMHhmZmZmZmYsXHJcbiAgICAgICAgICAgIHdoaXRlc21va2U6IDB4ZjVmNWY1LFxyXG4gICAgICAgICAgICB5ZWxsb3c6IDB4ZmZmZjAwLFxyXG4gICAgICAgICAgICB5ZWxsb3dncmVlbjogMHg5YWNkMzJcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuICAgIHZhciBzeXN0ZW1Db2xvcnMgPSBuZXcgTWFwKFxyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHtcclxuICAgICAgICAgICAgXCJBY3RpdmVCb3JkZXJcIjogMHgzYjk5ZmMsXHJcbiAgICAgICAgICAgIFwiQWN0aXZlQ2FwdGlvblwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJBcHBXb3Jrc3BhY2VcIjogMHhhYWFhYWEsXHJcbiAgICAgICAgICAgIFwiQmFja2dyb3VuZFwiOiAweDYzNjNjZSxcclxuICAgICAgICAgICAgXCJCdXR0b25GYWNlXCI6IDB4ZmZmZmZmLFxyXG4gICAgICAgICAgICBcIkJ1dHRvbkhpZ2hsaWdodFwiOiAweGU5ZTllOSxcclxuICAgICAgICAgICAgXCJCdXR0b25TaGFkb3dcIjogMHg5ZmEwOWYsXHJcbiAgICAgICAgICAgIFwiQnV0dG9uVGV4dFwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJDYXB0aW9uVGV4dFwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJHcmF5VGV4dFwiOiAweDdmN2Y3ZixcclxuICAgICAgICAgICAgXCJIaWdobGlnaHRcIjogMHhiMmQ3ZmYsXHJcbiAgICAgICAgICAgIFwiSGlnaGxpZ2h0VGV4dFwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJJbmFjdGl2ZUJvcmRlclwiOiAweGZmZmZmZixcclxuICAgICAgICAgICAgXCJJbmFjdGl2ZUNhcHRpb25cIjogMHhmZmZmZmYsXHJcbiAgICAgICAgICAgIFwiSW5hY3RpdmVDYXB0aW9uVGV4dFwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJJbmZvQmFja2dyb3VuZFwiOiAweGZiZmNjNSxcclxuICAgICAgICAgICAgXCJJbmZvVGV4dFwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJNZW51XCI6IDB4ZjZmNmY2LFxyXG4gICAgICAgICAgICBcIk1lbnVUZXh0XCI6IDB4ZmZmZmZmLFxyXG4gICAgICAgICAgICBcIlNjcm9sbGJhclwiOiAweGFhYWFhYSxcclxuICAgICAgICAgICAgXCJUaHJlZUREYXJrU2hhZG93XCI6IDB4MDAwMDAwLFxyXG4gICAgICAgICAgICBcIlRocmVlREZhY2VcIjogMHhjMGMwYzAsXHJcbiAgICAgICAgICAgIFwiVGhyZWVESGlnaGxpZ2h0XCI6IDB4ZmZmZmZmLFxyXG4gICAgICAgICAgICBcIlRocmVlRExpZ2h0U2hhZG93XCI6IDB4ZmZmZmZmLFxyXG4gICAgICAgICAgICBcIlRocmVlRFNoYWRvd1wiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCJXaW5kb3dcIjogMHhlY2VjZWMsXHJcbiAgICAgICAgICAgIFwiV2luZG93RnJhbWVcIjogMHhhYWFhYWEsXHJcbiAgICAgICAgICAgIFwiV2luZG93VGV4dFwiOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgXCItd2Via2l0LWZvY3VzLXJpbmctY29sb3JcIjogMHhlNTk3MDBcclxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMiksXHJcbiAgICAgICAgICAgICAgICBrZXkgPSBfYlswXSxcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gX2JbMV07XHJcbiAgICAgICAgICAgIHJldHVybiBba2V5LnRvTG93ZXJDYXNlKCksIHZhbHVlXTtcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuICAgIGZ1bmN0aW9uIGdldFNSR0JMaWdodG5lc3MociwgZywgYikge1xyXG4gICAgICAgIHJldHVybiAoMC4yMTI2ICogciArIDAuNzE1MiAqIGcgKyAwLjA3MjIgKiBiKSAvIDI1NTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzY2FsZSh4LCBpbkxvdywgaW5IaWdoLCBvdXRMb3csIG91dEhpZ2gpIHtcclxuICAgICAgICByZXR1cm4gKCh4IC0gaW5Mb3cpICogKG91dEhpZ2ggLSBvdXRMb3cpKSAvIChpbkhpZ2ggLSBpbkxvdykgKyBvdXRMb3c7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjbGFtcCh4LCBtaW4sIG1heCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLm1pbihtYXgsIE1hdGgubWF4KG1pbiwgeCkpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbXVsdGlwbHlNYXRyaWNlcyhtMSwgbTIpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG0xLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtpXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuMiA9IG0yWzBdLmxlbmd0aDsgaiA8IGxlbjI7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbGVuMyA9IG0xWzBdLmxlbmd0aDsgayA8IGxlbjM7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1bSArPSBtMVtpXVtrXSAqIG0yW2tdW2pdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2ldW2pdID0gc3VtO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyTWF0cml4KGNvbmZpZykge1xyXG4gICAgICAgIHZhciBtID0gTWF0cml4LmlkZW50aXR5KCk7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5zZXBpYSAhPT0gMCkge1xyXG4gICAgICAgICAgICBtID0gbXVsdGlwbHlNYXRyaWNlcyhtLCBNYXRyaXguc2VwaWEoY29uZmlnLnNlcGlhIC8gMTAwKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb25maWcuZ3JheXNjYWxlICE9PSAwKSB7XHJcbiAgICAgICAgICAgIG0gPSBtdWx0aXBseU1hdHJpY2VzKG0sIE1hdHJpeC5ncmF5c2NhbGUoY29uZmlnLmdyYXlzY2FsZSAvIDEwMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmlnLmNvbnRyYXN0ICE9PSAxMDApIHtcclxuICAgICAgICAgICAgbSA9IG11bHRpcGx5TWF0cmljZXMobSwgTWF0cml4LmNvbnRyYXN0KGNvbmZpZy5jb250cmFzdCAvIDEwMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmlnLmJyaWdodG5lc3MgIT09IDEwMCkge1xyXG4gICAgICAgICAgICBtID0gbXVsdGlwbHlNYXRyaWNlcyhtLCBNYXRyaXguYnJpZ2h0bmVzcyhjb25maWcuYnJpZ2h0bmVzcyAvIDEwMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmlnLm1vZGUgPT09IDEpIHtcclxuICAgICAgICAgICAgbSA9IG11bHRpcGx5TWF0cmljZXMobSwgTWF0cml4LmludmVydE5IdWUoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYXBwbHlDb2xvck1hdHJpeChfYSwgbWF0cml4KSB7XHJcbiAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAzKSxcclxuICAgICAgICAgICAgciA9IF9iWzBdLFxyXG4gICAgICAgICAgICBnID0gX2JbMV0sXHJcbiAgICAgICAgICAgIGIgPSBfYlsyXTtcclxuICAgICAgICB2YXIgcmdiID0gW1tyIC8gMjU1XSwgW2cgLyAyNTVdLCBbYiAvIDI1NV0sIFsxXSwgWzFdXTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gbXVsdGlwbHlNYXRyaWNlcyhtYXRyaXgsIHJnYik7XHJcbiAgICAgICAgcmV0dXJuIFswLCAxLCAyXS5tYXAoZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNsYW1wKE1hdGgucm91bmQocmVzdWx0W2ldWzBdICogMjU1KSwgMCwgMjU1KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHZhciBNYXRyaXggPSB7XHJcbiAgICAgICAgaWRlbnRpdHk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgIFsxLCAwLCAwLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIFswLCAxLCAwLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAxLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAwLCAxLCAwXSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAwLCAwLCAxXVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW52ZXJ0Tkh1ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgWzAuMzMzLCAtMC42NjcsIC0wLjY2NywgMCwgMV0sXHJcbiAgICAgICAgICAgICAgICBbLTAuNjY3LCAwLjMzMywgLTAuNjY3LCAwLCAxXSxcclxuICAgICAgICAgICAgICAgIFstMC42NjcsIC0wLjY2NywgMC4zMzMsIDAsIDFdLFxyXG4gICAgICAgICAgICAgICAgWzAsIDAsIDAsIDEsIDBdLFxyXG4gICAgICAgICAgICAgICAgWzAsIDAsIDAsIDAsIDFdXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBicmlnaHRuZXNzOiBmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgW3YsIDAsIDAsIDAsIDBdLFxyXG4gICAgICAgICAgICAgICAgWzAsIHYsIDAsIDAsIDBdLFxyXG4gICAgICAgICAgICAgICAgWzAsIDAsIHYsIDAsIDBdLFxyXG4gICAgICAgICAgICAgICAgWzAsIDAsIDAsIDEsIDBdLFxyXG4gICAgICAgICAgICAgICAgWzAsIDAsIDAsIDAsIDFdXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb250cmFzdDogZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSAoMSAtIHYpIC8gMjtcclxuICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgIFt2LCAwLCAwLCAwLCB0XSxcclxuICAgICAgICAgICAgICAgIFswLCB2LCAwLCAwLCB0XSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCB2LCAwLCB0XSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAwLCAxLCAwXSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAwLCAwLCAxXVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2VwaWE6IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgMC4zOTMgKyAwLjYwNyAqICgxIC0gdiksXHJcbiAgICAgICAgICAgICAgICAgICAgMC43NjkgLSAwLjc2OSAqICgxIC0gdiksXHJcbiAgICAgICAgICAgICAgICAgICAgMC4xODkgLSAwLjE4OSAqICgxIC0gdiksXHJcbiAgICAgICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgIDAuMzQ5IC0gMC4zNDkgKiAoMSAtIHYpLFxyXG4gICAgICAgICAgICAgICAgICAgIDAuNjg2ICsgMC4zMTQgKiAoMSAtIHYpLFxyXG4gICAgICAgICAgICAgICAgICAgIDAuMTY4IC0gMC4xNjggKiAoMSAtIHYpLFxyXG4gICAgICAgICAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgICAgICAgICAgMFxyXG4gICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAwLjI3MiAtIDAuMjcyICogKDEgLSB2KSxcclxuICAgICAgICAgICAgICAgICAgICAwLjUzNCAtIDAuNTM0ICogKDEgLSB2KSxcclxuICAgICAgICAgICAgICAgICAgICAwLjEzMSArIDAuODY5ICogKDEgLSB2KSxcclxuICAgICAgICAgICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICAgICAgICAgIDBcclxuICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICBbMCwgMCwgMCwgMSwgMF0sXHJcbiAgICAgICAgICAgICAgICBbMCwgMCwgMCwgMCwgMV1cclxuICAgICAgICAgICAgXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyYXlzY2FsZTogZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAwLjIxMjYgKyAwLjc4NzQgKiAoMSAtIHYpLFxyXG4gICAgICAgICAgICAgICAgICAgIDAuNzE1MiAtIDAuNzE1MiAqICgxIC0gdiksXHJcbiAgICAgICAgICAgICAgICAgICAgMC4wNzIyIC0gMC4wNzIyICogKDEgLSB2KSxcclxuICAgICAgICAgICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICAgICAgICAgIDBcclxuICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgMC4yMTI2IC0gMC4yMTI2ICogKDEgLSB2KSxcclxuICAgICAgICAgICAgICAgICAgICAwLjcxNTIgKyAwLjI4NDggKiAoMSAtIHYpLFxyXG4gICAgICAgICAgICAgICAgICAgIDAuMDcyMiAtIDAuMDcyMiAqICgxIC0gdiksXHJcbiAgICAgICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgIDAuMjEyNiAtIDAuMjEyNiAqICgxIC0gdiksXHJcbiAgICAgICAgICAgICAgICAgICAgMC43MTUyIC0gMC43MTUyICogKDEgLSB2KSxcclxuICAgICAgICAgICAgICAgICAgICAwLjA3MjIgKyAwLjkyNzggKiAoMSAtIHYpLFxyXG4gICAgICAgICAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgICAgICAgICAgMFxyXG4gICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAwLCAxLCAwXSxcclxuICAgICAgICAgICAgICAgIFswLCAwLCAwLCAwLCAxXVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0QmdQb2xlKHRoZW1lKSB7XHJcbiAgICAgICAgdmFyIGlzRGFya1NjaGVtZSA9IHRoZW1lLm1vZGUgPT09IDE7XHJcbiAgICAgICAgdmFyIHByb3AgPSBpc0RhcmtTY2hlbWVcclxuICAgICAgICAgICAgPyBcImRhcmtTY2hlbWVCYWNrZ3JvdW5kQ29sb3JcIlxyXG4gICAgICAgICAgICA6IFwibGlnaHRTY2hlbWVCYWNrZ3JvdW5kQ29sb3JcIjtcclxuICAgICAgICByZXR1cm4gdGhlbWVbcHJvcF07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRGZ1BvbGUodGhlbWUpIHtcclxuICAgICAgICB2YXIgaXNEYXJrU2NoZW1lID0gdGhlbWUubW9kZSA9PT0gMTtcclxuICAgICAgICB2YXIgcHJvcCA9IGlzRGFya1NjaGVtZVxyXG4gICAgICAgICAgICA/IFwiZGFya1NjaGVtZVRleHRDb2xvclwiXHJcbiAgICAgICAgICAgIDogXCJsaWdodFNjaGVtZVRleHRDb2xvclwiO1xyXG4gICAgICAgIHJldHVybiB0aGVtZVtwcm9wXTtcclxuICAgIH1cclxuICAgIHZhciBjb2xvck1vZGlmaWNhdGlvbkNhY2hlID0gbmV3IE1hcCgpO1xyXG4gICAgZnVuY3Rpb24gY2xlYXJDb2xvck1vZGlmaWNhdGlvbkNhY2hlKCkge1xyXG4gICAgICAgIGNvbG9yTW9kaWZpY2F0aW9uQ2FjaGUuY2xlYXIoKTtcclxuICAgIH1cclxuICAgIHZhciByZ2JDYWNoZUtleXMgPSBbXCJyXCIsIFwiZ1wiLCBcImJcIiwgXCJhXCJdO1xyXG4gICAgdmFyIHRoZW1lQ2FjaGVLZXlzJDEgPSBbXHJcbiAgICAgICAgXCJtb2RlXCIsXHJcbiAgICAgICAgXCJicmlnaHRuZXNzXCIsXHJcbiAgICAgICAgXCJjb250cmFzdFwiLFxyXG4gICAgICAgIFwiZ3JheXNjYWxlXCIsXHJcbiAgICAgICAgXCJzZXBpYVwiLFxyXG4gICAgICAgIFwiZGFya1NjaGVtZUJhY2tncm91bmRDb2xvclwiLFxyXG4gICAgICAgIFwiZGFya1NjaGVtZVRleHRDb2xvclwiLFxyXG4gICAgICAgIFwibGlnaHRTY2hlbWVCYWNrZ3JvdW5kQ29sb3JcIixcclxuICAgICAgICBcImxpZ2h0U2NoZW1lVGV4dENvbG9yXCJcclxuICAgIF07XHJcbiAgICBmdW5jdGlvbiBnZXRDYWNoZUlkKHJnYiwgdGhlbWUpIHtcclxuICAgICAgICB2YXIgcmVzdWx0SWQgPSBcIlwiO1xyXG4gICAgICAgIHJnYkNhY2hlS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgcmVzdWx0SWQgKz0gXCJcIi5jb25jYXQocmdiW2tleV0sIFwiO1wiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGVtZUNhY2hlS2V5cyQxLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICByZXN1bHRJZCArPSBcIlwiLmNvbmNhdCh0aGVtZVtrZXldLCBcIjtcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdElkO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbW9kaWZ5Q29sb3JXaXRoQ2FjaGUoXHJcbiAgICAgICAgcmdiLFxyXG4gICAgICAgIHRoZW1lLFxyXG4gICAgICAgIG1vZGlmeUhTTCxcclxuICAgICAgICBwb2xlQ29sb3IsXHJcbiAgICAgICAgYW5vdGhlclBvbGVDb2xvclxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGZuQ2FjaGU7XHJcbiAgICAgICAgaWYgKGNvbG9yTW9kaWZpY2F0aW9uQ2FjaGUuaGFzKG1vZGlmeUhTTCkpIHtcclxuICAgICAgICAgICAgZm5DYWNoZSA9IGNvbG9yTW9kaWZpY2F0aW9uQ2FjaGUuZ2V0KG1vZGlmeUhTTCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm5DYWNoZSA9IG5ldyBNYXAoKTtcclxuICAgICAgICAgICAgY29sb3JNb2RpZmljYXRpb25DYWNoZS5zZXQobW9kaWZ5SFNMLCBmbkNhY2hlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkID0gZ2V0Q2FjaGVJZChyZ2IsIHRoZW1lKTtcclxuICAgICAgICBpZiAoZm5DYWNoZS5oYXMoaWQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmbkNhY2hlLmdldChpZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBoc2wgPSByZ2JUb0hTTChyZ2IpO1xyXG4gICAgICAgIHZhciBwb2xlID0gcG9sZUNvbG9yID09IG51bGwgPyBudWxsIDogcGFyc2VUb0hTTFdpdGhDYWNoZShwb2xlQ29sb3IpO1xyXG4gICAgICAgIHZhciBhbm90aGVyUG9sZSA9XHJcbiAgICAgICAgICAgIGFub3RoZXJQb2xlQ29sb3IgPT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgICAgICA6IHBhcnNlVG9IU0xXaXRoQ2FjaGUoYW5vdGhlclBvbGVDb2xvcik7XHJcbiAgICAgICAgdmFyIG1vZGlmaWVkID0gbW9kaWZ5SFNMKGhzbCwgcG9sZSwgYW5vdGhlclBvbGUpO1xyXG4gICAgICAgIHZhciBfYSA9IGhzbFRvUkdCKG1vZGlmaWVkKSxcclxuICAgICAgICAgICAgciA9IF9hLnIsXHJcbiAgICAgICAgICAgIGcgPSBfYS5nLFxyXG4gICAgICAgICAgICBiID0gX2EuYixcclxuICAgICAgICAgICAgYSA9IF9hLmE7XHJcbiAgICAgICAgdmFyIG1hdHJpeCA9IGNyZWF0ZUZpbHRlck1hdHJpeCh0aGVtZSk7XHJcbiAgICAgICAgdmFyIF9iID0gX19yZWFkKGFwcGx5Q29sb3JNYXRyaXgoW3IsIGcsIGJdLCBtYXRyaXgpLCAzKSxcclxuICAgICAgICAgICAgcmYgPSBfYlswXSxcclxuICAgICAgICAgICAgZ2YgPSBfYlsxXSxcclxuICAgICAgICAgICAgYmYgPSBfYlsyXTtcclxuICAgICAgICB2YXIgY29sb3IgPVxyXG4gICAgICAgICAgICBhID09PSAxXHJcbiAgICAgICAgICAgICAgICA/IHJnYlRvSGV4U3RyaW5nKHtyOiByZiwgZzogZ2YsIGI6IGJmfSlcclxuICAgICAgICAgICAgICAgIDogcmdiVG9TdHJpbmcoe3I6IHJmLCBnOiBnZiwgYjogYmYsIGE6IGF9KTtcclxuICAgICAgICBmbkNhY2hlLnNldChpZCwgY29sb3IpO1xyXG4gICAgICAgIHJldHVybiBjb2xvcjtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG5vb3BIU0woaHNsKSB7XHJcbiAgICAgICAgcmV0dXJuIGhzbDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG1vZGlmeUNvbG9yKHJnYiwgdGhlbWUpIHtcclxuICAgICAgICByZXR1cm4gbW9kaWZ5Q29sb3JXaXRoQ2FjaGUocmdiLCB0aGVtZSwgbm9vcEhTTCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBtb2RpZnlMaWdodFNjaGVtZUNvbG9yKHJnYiwgdGhlbWUpIHtcclxuICAgICAgICB2YXIgcG9sZUJnID0gZ2V0QmdQb2xlKHRoZW1lKTtcclxuICAgICAgICB2YXIgcG9sZUZnID0gZ2V0RmdQb2xlKHRoZW1lKTtcclxuICAgICAgICByZXR1cm4gbW9kaWZ5Q29sb3JXaXRoQ2FjaGUoXHJcbiAgICAgICAgICAgIHJnYixcclxuICAgICAgICAgICAgdGhlbWUsXHJcbiAgICAgICAgICAgIG1vZGlmeUxpZ2h0TW9kZUhTTCxcclxuICAgICAgICAgICAgcG9sZUZnLFxyXG4gICAgICAgICAgICBwb2xlQmdcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbW9kaWZ5TGlnaHRNb2RlSFNMKF9hLCBwb2xlRmcsIHBvbGVCZykge1xyXG4gICAgICAgIHZhciBoID0gX2EuaCxcclxuICAgICAgICAgICAgcyA9IF9hLnMsXHJcbiAgICAgICAgICAgIGwgPSBfYS5sLFxyXG4gICAgICAgICAgICBhID0gX2EuYTtcclxuICAgICAgICB2YXIgaXNEYXJrID0gbCA8IDAuNTtcclxuICAgICAgICB2YXIgaXNOZXV0cmFsO1xyXG4gICAgICAgIGlmIChpc0RhcmspIHtcclxuICAgICAgICAgICAgaXNOZXV0cmFsID0gbCA8IDAuMiB8fCBzIDwgMC4xMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgaXNCbHVlID0gaCA+IDIwMCAmJiBoIDwgMjgwO1xyXG4gICAgICAgICAgICBpc05ldXRyYWwgPSBzIDwgMC4yNCB8fCAobCA+IDAuOCAmJiBpc0JsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaHggPSBoO1xyXG4gICAgICAgIHZhciBzeCA9IGw7XHJcbiAgICAgICAgaWYgKGlzTmV1dHJhbCkge1xyXG4gICAgICAgICAgICBpZiAoaXNEYXJrKSB7XHJcbiAgICAgICAgICAgICAgICBoeCA9IHBvbGVGZy5oO1xyXG4gICAgICAgICAgICAgICAgc3ggPSBwb2xlRmcucztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGh4ID0gcG9sZUJnLmg7XHJcbiAgICAgICAgICAgICAgICBzeCA9IHBvbGVCZy5zO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBseCA9IHNjYWxlKGwsIDAsIDEsIHBvbGVGZy5sLCBwb2xlQmcubCk7XHJcbiAgICAgICAgcmV0dXJuIHtoOiBoeCwgczogc3gsIGw6IGx4LCBhOiBhfTtcclxuICAgIH1cclxuICAgIHZhciBNQVhfQkdfTElHSFRORVNTID0gMC40O1xyXG4gICAgZnVuY3Rpb24gbW9kaWZ5QmdIU0woX2EsIHBvbGUpIHtcclxuICAgICAgICB2YXIgaCA9IF9hLmgsXHJcbiAgICAgICAgICAgIHMgPSBfYS5zLFxyXG4gICAgICAgICAgICBsID0gX2EubCxcclxuICAgICAgICAgICAgYSA9IF9hLmE7XHJcbiAgICAgICAgdmFyIGlzRGFyayA9IGwgPCAwLjU7XHJcbiAgICAgICAgdmFyIGlzQmx1ZSA9IGggPiAyMDAgJiYgaCA8IDI4MDtcclxuICAgICAgICB2YXIgaXNOZXV0cmFsID0gcyA8IDAuMTIgfHwgKGwgPiAwLjggJiYgaXNCbHVlKTtcclxuICAgICAgICBpZiAoaXNEYXJrKSB7XHJcbiAgICAgICAgICAgIHZhciBseF8xID0gc2NhbGUobCwgMCwgMC41LCAwLCBNQVhfQkdfTElHSFRORVNTKTtcclxuICAgICAgICAgICAgaWYgKGlzTmV1dHJhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGh4XzEgPSBwb2xlLmg7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3ggPSBwb2xlLnM7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge2g6IGh4XzEsIHM6IHN4LCBsOiBseF8xLCBhOiBhfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge2g6IGgsIHM6IHMsIGw6IGx4XzEsIGE6IGF9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbHggPSBzY2FsZShsLCAwLjUsIDEsIE1BWF9CR19MSUdIVE5FU1MsIHBvbGUubCk7XHJcbiAgICAgICAgaWYgKGlzTmV1dHJhbCkge1xyXG4gICAgICAgICAgICB2YXIgaHhfMiA9IHBvbGUuaDtcclxuICAgICAgICAgICAgdmFyIHN4ID0gcG9sZS5zO1xyXG4gICAgICAgICAgICByZXR1cm4ge2g6IGh4XzIsIHM6IHN4LCBsOiBseCwgYTogYX07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBoeCA9IGg7XHJcbiAgICAgICAgdmFyIGlzWWVsbG93ID0gaCA+IDYwICYmIGggPCAxODA7XHJcbiAgICAgICAgaWYgKGlzWWVsbG93KSB7XHJcbiAgICAgICAgICAgIHZhciBpc0Nsb3NlclRvR3JlZW4gPSBoID4gMTIwO1xyXG4gICAgICAgICAgICBpZiAoaXNDbG9zZXJUb0dyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBoeCA9IHNjYWxlKGgsIDEyMCwgMTgwLCAxMzUsIDE4MCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBoeCA9IHNjYWxlKGgsIDYwLCAxMjAsIDYwLCAxMDUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoeCA+IDQwICYmIGh4IDwgODApIHtcclxuICAgICAgICAgICAgbHggKj0gMC43NTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtoOiBoeCwgczogcywgbDogbHgsIGE6IGF9O1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbW9kaWZ5QmFja2dyb3VuZENvbG9yKHJnYiwgdGhlbWUpIHtcclxuICAgICAgICBpZiAodGhlbWUubW9kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbW9kaWZ5TGlnaHRTY2hlbWVDb2xvcihyZ2IsIHRoZW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBvbGUgPSBnZXRCZ1BvbGUodGhlbWUpO1xyXG4gICAgICAgIHJldHVybiBtb2RpZnlDb2xvcldpdGhDYWNoZShcclxuICAgICAgICAgICAgcmdiLFxyXG4gICAgICAgICAgICBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgdGhlbWUpLCB7bW9kZTogMH0pLFxyXG4gICAgICAgICAgICBtb2RpZnlCZ0hTTCxcclxuICAgICAgICAgICAgcG9sZVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICB2YXIgTUlOX0ZHX0xJR0hUTkVTUyA9IDAuNTU7XHJcbiAgICBmdW5jdGlvbiBtb2RpZnlCbHVlRmdIdWUoaHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHNjYWxlKGh1ZSwgMjA1LCAyNDUsIDIwNSwgMjIwKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG1vZGlmeUZnSFNMKF9hLCBwb2xlKSB7XHJcbiAgICAgICAgdmFyIGggPSBfYS5oLFxyXG4gICAgICAgICAgICBzID0gX2EucyxcclxuICAgICAgICAgICAgbCA9IF9hLmwsXHJcbiAgICAgICAgICAgIGEgPSBfYS5hO1xyXG4gICAgICAgIHZhciBpc0xpZ2h0ID0gbCA+IDAuNTtcclxuICAgICAgICB2YXIgaXNOZXV0cmFsID0gbCA8IDAuMiB8fCBzIDwgMC4yNDtcclxuICAgICAgICB2YXIgaXNCbHVlID0gIWlzTmV1dHJhbCAmJiBoID4gMjA1ICYmIGggPCAyNDU7XHJcbiAgICAgICAgaWYgKGlzTGlnaHQpIHtcclxuICAgICAgICAgICAgdmFyIGx4XzIgPSBzY2FsZShsLCAwLjUsIDEsIE1JTl9GR19MSUdIVE5FU1MsIHBvbGUubCk7XHJcbiAgICAgICAgICAgIGlmIChpc05ldXRyYWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoeF8zID0gcG9sZS5oO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN4ID0gcG9sZS5zO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtoOiBoeF8zLCBzOiBzeCwgbDogbHhfMiwgYTogYX07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGh4XzQgPSBoO1xyXG4gICAgICAgICAgICBpZiAoaXNCbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBoeF80ID0gbW9kaWZ5Qmx1ZUZnSHVlKGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB7aDogaHhfNCwgczogcywgbDogbHhfMiwgYTogYX07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc05ldXRyYWwpIHtcclxuICAgICAgICAgICAgdmFyIGh4XzUgPSBwb2xlLmg7XHJcbiAgICAgICAgICAgIHZhciBzeCA9IHBvbGUucztcclxuICAgICAgICAgICAgdmFyIGx4XzMgPSBzY2FsZShsLCAwLCAwLjUsIHBvbGUubCwgTUlOX0ZHX0xJR0hUTkVTUyk7XHJcbiAgICAgICAgICAgIHJldHVybiB7aDogaHhfNSwgczogc3gsIGw6IGx4XzMsIGE6IGF9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaHggPSBoO1xyXG4gICAgICAgIHZhciBseDtcclxuICAgICAgICBpZiAoaXNCbHVlKSB7XHJcbiAgICAgICAgICAgIGh4ID0gbW9kaWZ5Qmx1ZUZnSHVlKGgpO1xyXG4gICAgICAgICAgICBseCA9IHNjYWxlKGwsIDAsIDAuNSwgcG9sZS5sLCBNYXRoLm1pbigxLCBNSU5fRkdfTElHSFRORVNTICsgMC4wNSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGx4ID0gc2NhbGUobCwgMCwgMC41LCBwb2xlLmwsIE1JTl9GR19MSUdIVE5FU1MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge2g6IGh4LCBzOiBzLCBsOiBseCwgYTogYX07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBtb2RpZnlGb3JlZ3JvdW5kQ29sb3IocmdiLCB0aGVtZSkge1xyXG4gICAgICAgIGlmICh0aGVtZS5tb2RlID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtb2RpZnlMaWdodFNjaGVtZUNvbG9yKHJnYiwgdGhlbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcG9sZSA9IGdldEZnUG9sZSh0aGVtZSk7XHJcbiAgICAgICAgcmV0dXJuIG1vZGlmeUNvbG9yV2l0aENhY2hlKFxyXG4gICAgICAgICAgICByZ2IsXHJcbiAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCB0aGVtZSksIHttb2RlOiAwfSksXHJcbiAgICAgICAgICAgIG1vZGlmeUZnSFNMLFxyXG4gICAgICAgICAgICBwb2xlXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG1vZGlmeUJvcmRlckhTTChfYSwgcG9sZUZnLCBwb2xlQmcpIHtcclxuICAgICAgICB2YXIgaCA9IF9hLmgsXHJcbiAgICAgICAgICAgIHMgPSBfYS5zLFxyXG4gICAgICAgICAgICBsID0gX2EubCxcclxuICAgICAgICAgICAgYSA9IF9hLmE7XHJcbiAgICAgICAgdmFyIGlzRGFyayA9IGwgPCAwLjU7XHJcbiAgICAgICAgdmFyIGlzTmV1dHJhbCA9IGwgPCAwLjIgfHwgcyA8IDAuMjQ7XHJcbiAgICAgICAgdmFyIGh4ID0gaDtcclxuICAgICAgICB2YXIgc3ggPSBzO1xyXG4gICAgICAgIGlmIChpc05ldXRyYWwpIHtcclxuICAgICAgICAgICAgaWYgKGlzRGFyaykge1xyXG4gICAgICAgICAgICAgICAgaHggPSBwb2xlRmcuaDtcclxuICAgICAgICAgICAgICAgIHN4ID0gcG9sZUZnLnM7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBoeCA9IHBvbGVCZy5oO1xyXG4gICAgICAgICAgICAgICAgc3ggPSBwb2xlQmcucztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbHggPSBzY2FsZShsLCAwLCAxLCAwLjUsIDAuMik7XHJcbiAgICAgICAgcmV0dXJuIHtoOiBoeCwgczogc3gsIGw6IGx4LCBhOiBhfTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG1vZGlmeUJvcmRlckNvbG9yKHJnYiwgdGhlbWUpIHtcclxuICAgICAgICBpZiAodGhlbWUubW9kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbW9kaWZ5TGlnaHRTY2hlbWVDb2xvcihyZ2IsIHRoZW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBvbGVGZyA9IGdldEZnUG9sZSh0aGVtZSk7XHJcbiAgICAgICAgdmFyIHBvbGVCZyA9IGdldEJnUG9sZSh0aGVtZSk7XHJcbiAgICAgICAgcmV0dXJuIG1vZGlmeUNvbG9yV2l0aENhY2hlKFxyXG4gICAgICAgICAgICByZ2IsXHJcbiAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCB0aGVtZSksIHttb2RlOiAwfSksXHJcbiAgICAgICAgICAgIG1vZGlmeUJvcmRlckhTTCxcclxuICAgICAgICAgICAgcG9sZUZnLFxyXG4gICAgICAgICAgICBwb2xlQmdcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbW9kaWZ5U2hhZG93Q29sb3IocmdiLCBmaWx0ZXIpIHtcclxuICAgICAgICByZXR1cm4gbW9kaWZ5QmFja2dyb3VuZENvbG9yKHJnYiwgZmlsdGVyKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG1vZGlmeUdyYWRpZW50Q29sb3IocmdiLCBmaWx0ZXIpIHtcclxuICAgICAgICByZXR1cm4gbW9kaWZ5QmFja2dyb3VuZENvbG9yKHJnYiwgZmlsdGVyKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVUZXh0U3R5bGUoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIGxpbmVzID0gW107XHJcbiAgICAgICAgbGluZXMucHVzaChcclxuICAgICAgICAgICAgJyo6bm90KHByZSwgcHJlICosIGNvZGUsIC5mYXIsIC5mYSwgLmdseXBoaWNvbiwgW2NsYXNzKj1cInZqcy1cIl0sIC5mYWIsIC5mYS1naXRodWIsIC5mYXMsIC5tYXRlcmlhbC1pY29ucywgLmljb2ZvbnQsIC50eXBjbiwgbXUsIFtjbGFzcyo9XCJtdS1cIl0sIC5nbHlwaGljb24sIC5pY29uKSB7J1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYgKGNvbmZpZy51c2VGb250ICYmIGNvbmZpZy5mb250RmFtaWx5KSB7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBcIiAgZm9udC1mYW1pbHk6IFwiLmNvbmNhdChjb25maWcuZm9udEZhbWlseSwgXCIgIWltcG9ydGFudDtcIilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbmZpZy50ZXh0U3Ryb2tlID4gMCkge1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgXCIgIC13ZWJraXQtdGV4dC1zdHJva2U6IFwiLmNvbmNhdChcclxuICAgICAgICAgICAgICAgICAgICBjb25maWcudGV4dFN0cm9rZSxcclxuICAgICAgICAgICAgICAgICAgICBcInB4ICFpbXBvcnRhbnQ7XCJcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbGluZXMucHVzaChcclxuICAgICAgICAgICAgICAgIFwiICB0ZXh0LXN0cm9rZTogXCIuY29uY2F0KGNvbmZpZy50ZXh0U3Ryb2tlLCBcInB4ICFpbXBvcnRhbnQ7XCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIHJldHVybiBsaW5lcy5qb2luKFwiXFxuXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBGaWx0ZXJNb2RlO1xyXG4gICAgKGZ1bmN0aW9uIChGaWx0ZXJNb2RlKSB7XHJcbiAgICAgICAgRmlsdGVyTW9kZVsoRmlsdGVyTW9kZVtcImxpZ2h0XCJdID0gMCldID0gXCJsaWdodFwiO1xyXG4gICAgICAgIEZpbHRlck1vZGVbKEZpbHRlck1vZGVbXCJkYXJrXCJdID0gMSldID0gXCJkYXJrXCI7XHJcbiAgICB9KShGaWx0ZXJNb2RlIHx8IChGaWx0ZXJNb2RlID0ge30pKTtcclxuICAgIGZ1bmN0aW9uIGdldENTU0ZpbHRlclZhbHVlKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBmaWx0ZXJzID0gW107XHJcbiAgICAgICAgaWYgKGNvbmZpZy5tb2RlID09PSBGaWx0ZXJNb2RlLmRhcmspIHtcclxuICAgICAgICAgICAgZmlsdGVycy5wdXNoKFwiaW52ZXJ0KDEwMCUpIGh1ZS1yb3RhdGUoMTgwZGVnKVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbmZpZy5icmlnaHRuZXNzICE9PSAxMDApIHtcclxuICAgICAgICAgICAgZmlsdGVycy5wdXNoKFwiYnJpZ2h0bmVzcyhcIi5jb25jYXQoY29uZmlnLmJyaWdodG5lc3MsIFwiJSlcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmlnLmNvbnRyYXN0ICE9PSAxMDApIHtcclxuICAgICAgICAgICAgZmlsdGVycy5wdXNoKFwiY29udHJhc3QoXCIuY29uY2F0KGNvbmZpZy5jb250cmFzdCwgXCIlKVwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb25maWcuZ3JheXNjYWxlICE9PSAwKSB7XHJcbiAgICAgICAgICAgIGZpbHRlcnMucHVzaChcImdyYXlzY2FsZShcIi5jb25jYXQoY29uZmlnLmdyYXlzY2FsZSwgXCIlKVwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb25maWcuc2VwaWEgIT09IDApIHtcclxuICAgICAgICAgICAgZmlsdGVycy5wdXNoKFwic2VwaWEoXCIuY29uY2F0KGNvbmZpZy5zZXBpYSwgXCIlKVwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmaWx0ZXJzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZpbHRlcnMuam9pbihcIiBcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdG9TVkdNYXRyaXgobWF0cml4KSB7XHJcbiAgICAgICAgcmV0dXJuIG1hdHJpeFxyXG4gICAgICAgICAgICAuc2xpY2UoMCwgNClcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1cclxuICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtLnRvRml4ZWQoMyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuam9pbihcIiBcIik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5qb2luKFwiIFwiKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldFNWR0ZpbHRlck1hdHJpeFZhbHVlKGNvbmZpZykge1xyXG4gICAgICAgIHJldHVybiB0b1NWR01hdHJpeChjcmVhdGVGaWx0ZXJNYXRyaXgoY29uZmlnKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGV4aWZ5KG51bWJlcikge1xyXG4gICAgICAgIHJldHVybiAobnVtYmVyIDwgMTYgPyBcIjBcIiA6IFwiXCIpICsgbnVtYmVyLnRvU3RyaW5nKDE2KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdlbmVyYXRlVUlEKCkge1xyXG4gICAgICAgIGlmIChcInJhbmRvbVVVSURcIiBpbiBjcnlwdG8pIHtcclxuICAgICAgICAgICAgdmFyIHV1aWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgdXVpZC5zdWJzdHJpbmcoMCwgOCkgK1xyXG4gICAgICAgICAgICAgICAgdXVpZC5zdWJzdHJpbmcoOSwgMTMpICtcclxuICAgICAgICAgICAgICAgIHV1aWQuc3Vic3RyaW5nKDE0LCAxOCkgK1xyXG4gICAgICAgICAgICAgICAgdXVpZC5zdWJzdHJpbmcoMTksIDIzKSArXHJcbiAgICAgICAgICAgICAgICB1dWlkLnN1YnN0cmluZygyNClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFwiZ2V0UmFuZG9tVmFsdWVzXCIgaW4gY3J5cHRvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTYpKSlcclxuICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaGV4aWZ5KHgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogTWF0aC5wb3coMiwgNTUpKS50b1N0cmluZygzNik7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHJlc29sdmVycyQxID0gbmV3IE1hcCgpO1xyXG4gICAgdmFyIHJlamVjdG9ycyA9IG5ldyBNYXAoKTtcclxuICAgIGZ1bmN0aW9uIGJnRmV0Y2gocmVxdWVzdCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAyLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gZ2VuZXJhdGVVSUQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXJzJDEuc2V0KGlkLCByZXNvbHZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0b3JzLnNldChpZCwgcmVqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogTWVzc2FnZVR5cGVDU3RvQkcuRkVUQ0gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByZXF1ZXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICB2YXIgdHlwZSA9IF9hLnR5cGUsXHJcbiAgICAgICAgICAgIGRhdGEgPSBfYS5kYXRhLFxyXG4gICAgICAgICAgICBlcnJvciA9IF9hLmVycm9yLFxyXG4gICAgICAgICAgICBpZCA9IF9hLmlkO1xyXG4gICAgICAgIGlmICh0eXBlID09PSBNZXNzYWdlVHlwZUJHdG9DUy5GRVRDSF9SRVNQT05TRSkge1xyXG4gICAgICAgICAgICB2YXIgcmVzb2x2ZSA9IHJlc29sdmVycyQxLmdldChpZCk7XHJcbiAgICAgICAgICAgIHZhciByZWplY3QgPSByZWplY3RvcnMuZ2V0KGlkKTtcclxuICAgICAgICAgICAgcmVzb2x2ZXJzJDEuZGVsZXRlKGlkKTtcclxuICAgICAgICAgICAgcmVqZWN0b3JzLmRlbGV0ZShpZCk7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0ICYmIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlICYmIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgTUFYX0ZSQU1FX0RVUkFUSU9OID0gMTAwMCAvIDYwO1xyXG4gICAgdmFyIEFzeW5jUXVldWUgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIEFzeW5jUXVldWUoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucXVldWUgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUuYWRkVGFzayA9IGZ1bmN0aW9uICh0YXNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMucXVldWUucHVzaCh0YXNrKTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZUZyYW1lKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lcklkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnRpbWVySWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnF1ZXVlID0gW107XHJcbiAgICAgICAgfTtcclxuICAgICAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5zY2hlZHVsZUZyYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnRpbWVySWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgIHZhciBjYjtcclxuICAgICAgICAgICAgICAgIHdoaWxlICgoY2IgPSBfdGhpcy5xdWV1ZS5zaGlmdCgpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydCA+PSBNQVhfRlJBTUVfRFVSQVRJT04pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2NoZWR1bGVGcmFtZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIEFzeW5jUXVldWU7XHJcbiAgICB9KSgpO1xyXG5cclxuICAgIHZhciBpbWFnZU1hbmFnZXIgPSBuZXcgQXN5bmNRdWV1ZSgpO1xyXG4gICAgZnVuY3Rpb24gZ2V0SW1hZ2VEZXRhaWxzKHVybCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAyLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhVVJMXzEsIF9hLCBibG9iXzEsIF9iLCBpbWFnZV8xLCBfYywgZXJyb3JfMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfZCwgX2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9mKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfZi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZi50cnlzLnB1c2goWzAsIDE0LCAsIDE1XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVybC5zdGFydHNXaXRoKFwiZGF0YTpcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBnZXREYXRhVVJMKHVybCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IF9mLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVVSTF8xID0gX2E7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9kID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeUNvbnZlcnREYXRhVVJMVG9CbG9iU3luYyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVVJMXzFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpICE9PSBudWxsICYmIF9kICE9PSB2b2lkIDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gX2Q7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGxvYWRBc0Jsb2IodXJsKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gX2Yuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2YubGFiZWwgPSA2O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9iXzEgPSBfYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZGF0YVVSTF8xLnN0YXJ0c1dpdGgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YTppbWFnZS9zdmcreG1sXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgbG9hZEltYWdlKGRhdGFVUkxfMSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZV8xID0gX2Yuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlDcmVhdGVJbWFnZUJpdG1hcChibG9iXzEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9lID0gX2Yuc2VudCgpKSAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZSAhPT0gdm9pZCAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgMTBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MgPSBfZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgMTJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBsb2FkSW1hZ2UoZGF0YVVSTF8xKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYyA9IF9mLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLmxhYmVsID0gMTI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZV8xID0gX2M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZi5sYWJlbCA9IDEzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VNYW5hZ2VyLmFkZFRhc2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbmFseXNpcyA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuYWx5emVJbWFnZShpbWFnZV8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Fzc2lnbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHVybCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9iOiBibG9iXzEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVVSTDogZGF0YVVSTF8xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBpbWFnZV8xLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogaW1hZ2VfMS5oZWlnaHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmFseXNpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Yuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yXzEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXREYXRhVVJMKHVybCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhcnNlZFVSTDtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkVVJMID0gbmV3IFVSTCh1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShwYXJzZWRVUkwub3JpZ2luID09PSBsb2NhdGlvbi5vcmlnaW4pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBsb2FkQXNEYXRhVVJMKHVybCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBfYS5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZldGNoKHt1cmw6IHVybCwgcmVzcG9uc2VUeXBlOiBcImRhdGEtdXJsXCJ9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBfYS5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHRyeUNyZWF0ZUltYWdlQml0bWFwKGJsb2IpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBlcnJfMTtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFswLCAyLCAsIDNdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBjcmVhdGVJbWFnZUJpdG1hcChibG9iKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nV2FybihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVW5hYmxlIHRvIGNyZWF0ZSBpbWFnZSBiaXRtYXAgZm9yIHR5cGUgXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KGJsb2IudHlwZSwgXCI6IFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoU3RyaW5nKGVycl8xKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBudWxsXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdmFyIElOQ09NUExFVEVfRE9DX0xPQURJTkdfSU1BR0VfTElNSVQgPSAyNTY7XHJcbiAgICB2YXIgbG9hZGluZ0ltYWdlc0NvdW50ID0gMDtcclxuICAgIGZ1bmN0aW9uIGxvYWRJbWFnZSh1cmwpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgMixcclxuICAgICAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KFwiVW5hYmxlIHRvIGxvYWQgaW1hZ2UgXCIuY29uY2F0KHVybCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2xvYWRpbmdJbWFnZXNDb3VudCA8PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOQ09NUExFVEVfRE9DX0xPQURJTkdfSU1BR0VfTElNSVQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmVhZHlTdGF0ZUNvbXBsZXRlKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5zcmMgPSB1cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRSZWFkeVN0YXRlQ29tcGxldGVMaXN0ZW5lcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbWFnZS5zcmMgPSB1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICB2YXIgTUFYX0FOQUxZU0lTX1BJWEVMU19DT1VOVCA9IDMyICogMzI7XHJcbiAgICB2YXIgY2FudmFzO1xyXG4gICAgdmFyIGNvbnRleHQ7XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVDYW52YXMoKSB7XHJcbiAgICAgICAgdmFyIG1heFdpZHRoID0gTUFYX0FOQUxZU0lTX1BJWEVMU19DT1VOVDtcclxuICAgICAgICB2YXIgbWF4SGVpZ2h0ID0gTUFYX0FOQUxZU0lTX1BJWEVMU19DT1VOVDtcclxuICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IG1heFdpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBtYXhIZWlnaHQ7XHJcbiAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiwge3dpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZX0pO1xyXG4gICAgICAgIGNvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZW1vdmVDYW52YXMoKSB7XHJcbiAgICAgICAgY2FudmFzID0gbnVsbDtcclxuICAgICAgICBjb250ZXh0ID0gbnVsbDtcclxuICAgIH1cclxuICAgIHZhciBMQVJHRV9JTUFHRV9QSVhFTFNfQ09VTlQgPSA1MTIgKiA1MTI7XHJcbiAgICBmdW5jdGlvbiBhbmFseXplSW1hZ2UoaW1hZ2UpIHtcclxuICAgICAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICAgICAgICBjcmVhdGVDYW52YXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHN3O1xyXG4gICAgICAgIHZhciBzaDtcclxuICAgICAgICBpZiAoaW1hZ2UgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHN3ID0gaW1hZ2UubmF0dXJhbFdpZHRoO1xyXG4gICAgICAgICAgICBzaCA9IGltYWdlLm5hdHVyYWxIZWlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3cgPSBpbWFnZS53aWR0aDtcclxuICAgICAgICAgICAgc2ggPSBpbWFnZS5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzdyA9PT0gMCB8fCBzaCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaXNEYXJrOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGlzTGlnaHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaXNUcmFuc3BhcmVudDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBpc0xhcmdlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGlzVG9vTGFyZ2U6IGZhbHNlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzdyAqIHNoID4gTEFSR0VfSU1BR0VfUElYRUxTX0NPVU5UKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc0Rhcms6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaXNMaWdodDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBpc1RyYW5zcGFyZW50OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGlzTGFyZ2U6IHRydWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNvdXJjZVBpeGVsc0NvdW50ID0gc3cgKiBzaDtcclxuICAgICAgICB2YXIgayA9IE1hdGgubWluKFxyXG4gICAgICAgICAgICAxLFxyXG4gICAgICAgICAgICBNYXRoLnNxcnQoTUFYX0FOQUxZU0lTX1BJWEVMU19DT1VOVCAvIHNvdXJjZVBpeGVsc0NvdW50KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gTWF0aC5jZWlsKHN3ICogayk7XHJcbiAgICAgICAgdmFyIGhlaWdodCA9IE1hdGguY2VpbChzaCAqIGspO1xyXG4gICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCAwLCAwLCBzdywgc2gsIDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgIHZhciBpbWFnZURhdGEgPSBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICB2YXIgZCA9IGltYWdlRGF0YS5kYXRhO1xyXG4gICAgICAgIHZhciBUUkFOU1BBUkVOVF9BTFBIQV9USFJFU0hPTEQgPSAwLjA1O1xyXG4gICAgICAgIHZhciBEQVJLX0xJR0hUTkVTU19USFJFU0hPTEQgPSAwLjQ7XHJcbiAgICAgICAgdmFyIExJR0hUX0xJR0hUTkVTU19USFJFU0hPTEQgPSAwLjc7XHJcbiAgICAgICAgdmFyIHRyYW5zcGFyZW50UGl4ZWxzQ291bnQgPSAwO1xyXG4gICAgICAgIHZhciBkYXJrUGl4ZWxzQ291bnQgPSAwO1xyXG4gICAgICAgIHZhciBsaWdodFBpeGVsc0NvdW50ID0gMDtcclxuICAgICAgICB2YXIgaSwgeCwgeTtcclxuICAgICAgICB2YXIgciwgZywgYiwgYTtcclxuICAgICAgICB2YXIgbDtcclxuICAgICAgICBmb3IgKHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcclxuICAgICAgICAgICAgZm9yICh4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHtcclxuICAgICAgICAgICAgICAgIGkgPSA0ICogKHkgKiB3aWR0aCArIHgpO1xyXG4gICAgICAgICAgICAgICAgciA9IGRbaSArIDBdO1xyXG4gICAgICAgICAgICAgICAgZyA9IGRbaSArIDFdO1xyXG4gICAgICAgICAgICAgICAgYiA9IGRbaSArIDJdO1xyXG4gICAgICAgICAgICAgICAgYSA9IGRbaSArIDNdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEgLyAyNTUgPCBUUkFOU1BBUkVOVF9BTFBIQV9USFJFU0hPTEQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc3BhcmVudFBpeGVsc0NvdW50Kys7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGwgPSBnZXRTUkdCTGlnaHRuZXNzKHIsIGcsIGIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsIDwgREFSS19MSUdIVE5FU1NfVEhSRVNIT0xEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhcmtQaXhlbHNDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobCA+IExJR0hUX0xJR0hUTkVTU19USFJFU0hPTEQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHRQaXhlbHNDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdG90YWxQaXhlbHNDb3VudCA9IHdpZHRoICogaGVpZ2h0O1xyXG4gICAgICAgIHZhciBvcGFxdWVQaXhlbHNDb3VudCA9IHRvdGFsUGl4ZWxzQ291bnQgLSB0cmFuc3BhcmVudFBpeGVsc0NvdW50O1xyXG4gICAgICAgIHZhciBEQVJLX0lNQUdFX1RIUkVTSE9MRCA9IDAuNztcclxuICAgICAgICB2YXIgTElHSFRfSU1BR0VfVEhSRVNIT0xEID0gMC43O1xyXG4gICAgICAgIHZhciBUUkFOU1BBUkVOVF9JTUFHRV9USFJFU0hPTEQgPSAwLjE7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaXNEYXJrOiBkYXJrUGl4ZWxzQ291bnQgLyBvcGFxdWVQaXhlbHNDb3VudCA+PSBEQVJLX0lNQUdFX1RIUkVTSE9MRCxcclxuICAgICAgICAgICAgaXNMaWdodDpcclxuICAgICAgICAgICAgICAgIGxpZ2h0UGl4ZWxzQ291bnQgLyBvcGFxdWVQaXhlbHNDb3VudCA+PSBMSUdIVF9JTUFHRV9USFJFU0hPTEQsXHJcbiAgICAgICAgICAgIGlzVHJhbnNwYXJlbnQ6XHJcbiAgICAgICAgICAgICAgICB0cmFuc3BhcmVudFBpeGVsc0NvdW50IC8gdG90YWxQaXhlbHNDb3VudCA+PVxyXG4gICAgICAgICAgICAgICAgVFJBTlNQQVJFTlRfSU1BR0VfVEhSRVNIT0xELFxyXG4gICAgICAgICAgICBpc0xhcmdlOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICB2YXIgaXNCbG9iVVJMU3VwcG9ydGVkID0gbnVsbDtcclxuICAgIHZhciBjYW5Vc2VQcm94eSA9IGZhbHNlO1xyXG4gICAgdmFyIGJsb2JVUkxDaGVja1JlcXVlc3RlZCA9IGZhbHNlO1xyXG4gICAgdmFyIGJsb2JVUkxDaGVja0F3YWl0ZXJzID0gW107XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgIFwiX19kYXJrcmVhZGVyX19pbmxpbmVTY3JpcHRzQWxsb3dlZFwiLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChjYW5Vc2VQcm94eSA9IHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge29uY2U6IHRydWV9XHJcbiAgICApO1xyXG4gICAgZnVuY3Rpb24gcmVxdWVzdEJsb2JVUkxDaGVjaygpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2FuVXNlUHJveHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFibG9iVVJMQ2hlY2tSZXF1ZXN0ZWQpIHJldHVybiBbMywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmxvYlVSTENoZWNrQXdhaXRlcnMucHVzaChyZXNvbHZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBibG9iVVJMQ2hlY2tSZXF1ZXN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfX2RhcmtyZWFkZXJfX2Jsb2JVUkxDaGVja1Jlc3BvbnNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0Jsb2JVUkxTdXBwb3J0ZWQgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuZGV0YWlsLmJsb2JVUkxBbGxvd2VkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYlVSTENoZWNrQXdhaXRlcnMuZm9yRWFjaChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9iVVJMQ2hlY2tBd2FpdGVycy5zcGxpY2UoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtvbmNlOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfX2RhcmtyZWFkZXJfX2Jsb2JVUkxDaGVja1JlcXVlc3RcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaXNCbG9iVVJMQ2hlY2tSZXN1bHRSZWFkeSgpIHtcclxuICAgICAgICByZXR1cm4gaXNCbG9iVVJMU3VwcG9ydGVkICE9IG51bGwgfHwgIWNhblVzZVByb3h5O1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gb25DU1BFcnJvcihlcnIpIHtcclxuICAgICAgICBpZiAoZXJyLmJsb2NrZWRVUkkgPT09IFwiYmxvYlwiKSB7XHJcbiAgICAgICAgICAgIGlzQmxvYlVSTFN1cHBvcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwic2VjdXJpdHlwb2xpY3l2aW9sYXRpb25cIiwgb25DU1BFcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNlY3VyaXR5cG9saWN5dmlvbGF0aW9uXCIsIG9uQ1NQRXJyb3IpO1xyXG4gICAgdmFyIG9iamVjdFVSTHMgPSBuZXcgU2V0KCk7XHJcbiAgICBmdW5jdGlvbiBnZXRGaWx0ZXJlZEltYWdlVVJMKF9hLCB0aGVtZSkge1xyXG4gICAgICAgIHZhciBkYXRhVVJMID0gX2EuZGF0YVVSTCxcclxuICAgICAgICAgICAgd2lkdGggPSBfYS53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0ID0gX2EuaGVpZ2h0O1xyXG4gICAgICAgIGlmIChkYXRhVVJMLnN0YXJ0c1dpdGgoXCJkYXRhOmltYWdlL3N2Zyt4bWxcIikpIHtcclxuICAgICAgICAgICAgZGF0YVVSTCA9IGVzY2FwZVhNTChkYXRhVVJMKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1hdHJpeCA9IGdldFNWR0ZpbHRlck1hdHJpeFZhbHVlKHRoZW1lKTtcclxuICAgICAgICB2YXIgc3ZnID0gW1xyXG4gICAgICAgICAgICAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIgd2lkdGg9XCInXHJcbiAgICAgICAgICAgICAgICAuY29uY2F0KHdpZHRoLCAnXCIgaGVpZ2h0PVwiJylcclxuICAgICAgICAgICAgICAgIC5jb25jYXQoaGVpZ2h0LCAnXCI+JyksXHJcbiAgICAgICAgICAgIFwiPGRlZnM+XCIsXHJcbiAgICAgICAgICAgICc8ZmlsdGVyIGlkPVwiZGFya3JlYWRlci1pbWFnZS1maWx0ZXJcIj4nLFxyXG4gICAgICAgICAgICAnPGZlQ29sb3JNYXRyaXggdHlwZT1cIm1hdHJpeFwiIHZhbHVlcz1cIicuY29uY2F0KG1hdHJpeCwgJ1wiIC8+JyksXHJcbiAgICAgICAgICAgIFwiPC9maWx0ZXI+XCIsXHJcbiAgICAgICAgICAgIFwiPC9kZWZzPlwiLFxyXG4gICAgICAgICAgICAnPGltYWdlIHdpZHRoPVwiJ1xyXG4gICAgICAgICAgICAgICAgLmNvbmNhdCh3aWR0aCwgJ1wiIGhlaWdodD1cIicpXHJcbiAgICAgICAgICAgICAgICAuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAnXCIgZmlsdGVyPVwidXJsKCNkYXJrcmVhZGVyLWltYWdlLWZpbHRlcilcIiB4bGluazpocmVmPVwiJ1xyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLmNvbmNhdChkYXRhVVJMLCAnXCIgLz4nKSxcclxuICAgICAgICAgICAgXCI8L3N2Zz5cIlxyXG4gICAgICAgIF0uam9pbihcIlwiKTtcclxuICAgICAgICBpZiAoIWlzQmxvYlVSTFN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gXCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFwiLmNvbmNhdChidG9hKHN2ZykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYnl0ZXMgPSBuZXcgVWludDhBcnJheShzdmcubGVuZ3RoKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN2Zy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBieXRlc1tpXSA9IHN2Zy5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtieXRlc10sIHt0eXBlOiBcImltYWdlL3N2Zyt4bWxcIn0pO1xyXG4gICAgICAgIHZhciBvYmplY3RVUkwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gICAgICAgIG9iamVjdFVSTHMuYWRkKG9iamVjdFVSTCk7XHJcbiAgICAgICAgcmV0dXJuIG9iamVjdFVSTDtcclxuICAgIH1cclxuICAgIHZhciB4bWxFc2NhcGVDaGFycyA9IHtcclxuICAgICAgICBcIjxcIjogXCImbHQ7XCIsXHJcbiAgICAgICAgXCI+XCI6IFwiJmd0O1wiLFxyXG4gICAgICAgIFwiJlwiOiBcIiZhbXA7XCIsXHJcbiAgICAgICAgXCInXCI6IFwiJmFwb3M7XCIsXHJcbiAgICAgICAgJ1wiJzogXCImcXVvdDtcIlxyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIGVzY2FwZVhNTChzdHIpIHtcclxuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1s8PiYnXCJdL2csIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgcmV0dXJuIChfYSA9IHhtbEVzY2FwZUNoYXJzW2NdKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBjO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdmFyIGRhdGFVUkxCbG9iVVJMcyA9IG5ldyBNYXAoKTtcclxuICAgIGZ1bmN0aW9uIHRyeUNvbnZlcnREYXRhVVJMVG9CbG9iU3luYyhkYXRhVVJMKSB7XHJcbiAgICAgICAgdmFyIGNvbG9uSW5kZXggPSBkYXRhVVJMLmluZGV4T2YoXCI6XCIpO1xyXG4gICAgICAgIHZhciBzZW1pY29sb25JbmRleCA9IGRhdGFVUkwuaW5kZXhPZihcIjtcIiwgY29sb25JbmRleCArIDEpO1xyXG4gICAgICAgIHZhciBjb21tYUluZGV4ID0gZGF0YVVSTC5pbmRleE9mKFwiLFwiLCBzZW1pY29sb25JbmRleCArIDEpO1xyXG4gICAgICAgIHZhciBlbmNvZGluZyA9IGRhdGFVUkxcclxuICAgICAgICAgICAgLnN1YnN0cmluZyhzZW1pY29sb25JbmRleCArIDEsIGNvbW1hSW5kZXgpXHJcbiAgICAgICAgICAgIC50b0xvY2FsZUxvd2VyQ2FzZSgpO1xyXG4gICAgICAgIHZhciBtZWRpYVR5cGUgPSBkYXRhVVJMLnN1YnN0cmluZyhjb2xvbkluZGV4ICsgMSwgc2VtaWNvbG9uSW5kZXgpO1xyXG4gICAgICAgIGlmIChlbmNvZGluZyAhPT0gXCJiYXNlNjRcIiB8fCAhbWVkaWFUeXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY2hhcmFjdGVycyA9IGF0b2IoZGF0YVVSTC5zdWJzdHJpbmcoY29tbWFJbmRleCArIDEpKTtcclxuICAgICAgICB2YXIgYnl0ZXMgPSBuZXcgVWludDhBcnJheShjaGFyYWN0ZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFyYWN0ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGJ5dGVzW2ldID0gY2hhcmFjdGVycy5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEJsb2IoW2J5dGVzXSwge3R5cGU6IG1lZGlhVHlwZX0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdHJ5Q29udmVydERhdGFVUkxUb0Jsb2JVUkwoZGF0YVVSTCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGJsb2JVUkwsIGJsb2IsIHJlc3BvbnNlO1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzQmxvYlVSTFN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBudWxsXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBibG9iVVJMID0gZGF0YVVSTEJsb2JVUkxzLmdldChkYXRhVVJMKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2JVUkwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgYmxvYlVSTF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYmxvYiA9IHRyeUNvbnZlcnREYXRhVVJMVG9CbG9iU3luYyhkYXRhVVJMKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhYmxvYikgcmV0dXJuIFszLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBmZXRjaChkYXRhVVJMKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCByZXNwb25zZS5ibG9iKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmxvYiA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmxvYlVSTCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFVUkxCbG9iVVJMcy5zZXQoZGF0YVVSTCwgYmxvYlVSTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgYmxvYlVSTF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY2xlYW5JbWFnZVByb2Nlc3NpbmdDYWNoZSgpIHtcclxuICAgICAgICBpbWFnZU1hbmFnZXIgJiYgaW1hZ2VNYW5hZ2VyLnN0b3AoKTtcclxuICAgICAgICByZW1vdmVDYW52YXMoKTtcclxuICAgICAgICBvYmplY3RVUkxzLmZvckVhY2goZnVuY3Rpb24gKHUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFVSTC5yZXZva2VPYmplY3RVUkwodSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgb2JqZWN0VVJMcy5jbGVhcigpO1xyXG4gICAgICAgIGRhdGFVUkxCbG9iVVJMcy5mb3JFYWNoKGZ1bmN0aW9uICh1KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBVUkwucmV2b2tlT2JqZWN0VVJMKHUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRhdGFVUkxCbG9iVVJMcy5jbGVhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBncmFkaWVudExlbmd0aCA9IFwiZ3JhZGllbnRcIi5sZW5ndGg7XHJcbiAgICB2YXIgY29uaWNHcmFkaWVudCA9IFwiY29uaWMtXCI7XHJcbiAgICB2YXIgY29uaWNHcmFkaWVudExlbmd0aCA9IGNvbmljR3JhZGllbnQubGVuZ3RoO1xyXG4gICAgdmFyIHJhZGlhbEdyYWRpZW50ID0gXCJyYWRpYWwtXCI7XHJcbiAgICB2YXIgbGluZWFyR3JhZGllbnQgPSBcImxpbmVhci1cIjtcclxuICAgIGZ1bmN0aW9uIHBhcnNlR3JhZGllbnQodmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICB2YXIgc3RhcnRJbmRleCA9IGNvbmljR3JhZGllbnQubGVuZ3RoO1xyXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZUdyYWRpZW50O1xyXG4gICAgICAgICAgICBbbGluZWFyR3JhZGllbnQsIHJhZGlhbEdyYWRpZW50LCBjb25pY0dyYWRpZW50XS5maW5kKFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHBvc3NpYmxlVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCAtIHBvc3NpYmxlVHlwZS5sZW5ndGggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVHcmFkaWVudCA9IHZhbHVlLnN1YnN0cmluZyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4IC0gcG9zc2libGVUeXBlLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZUdyYWRpZW50ID09PSBwb3NzaWJsZVR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5zbGljZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggLSBwb3NzaWJsZVR5cGUubGVuZ3RoIC0gMTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4IC0gcG9zc2libGVUeXBlLmxlbmd0aCAtIDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApID09PSBcInJlcGVhdGluZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlR3JhZGllbnQgPSBcInJlcGVhdGluZy1cIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJncmFkaWVudFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5zbGljZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggLSBwb3NzaWJsZVR5cGUubGVuZ3RoIC0gOCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggLSBwb3NzaWJsZVR5cGUubGVuZ3RoIC0gMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT09IFwiLXdlYmtpdFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlR3JhZGllbnQgPSBcIi13ZWJraXQtXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZVR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZ3JhZGllbnRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlR3JhZGllbnQgPSBcIlwiLmNvbmNhdChwb3NzaWJsZVR5cGUsIFwiZ3JhZGllbnRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKCF0eXBlR3JhZGllbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImJyZWFrXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIF9hID0gZ2V0UGFyZW50aGVzZXNSYW5nZSh2YWx1ZSwgaW5kZXggKyBncmFkaWVudExlbmd0aCksXHJcbiAgICAgICAgICAgICAgICBzdGFydCA9IF9hLnN0YXJ0LFxyXG4gICAgICAgICAgICAgICAgZW5kID0gX2EuZW5kO1xyXG4gICAgICAgICAgICB2YXIgbWF0Y2ggPSB2YWx1ZS5zdWJzdHJpbmcoc3RhcnQgKyAxLCBlbmQgLSAxKTtcclxuICAgICAgICAgICAgc3RhcnRJbmRleCA9IGVuZCArIDEgKyBjb25pY0dyYWRpZW50TGVuZ3RoO1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlR3JhZGllbnQ6IHR5cGVHcmFkaWVudCxcclxuICAgICAgICAgICAgICAgIG1hdGNoOiBtYXRjaCxcclxuICAgICAgICAgICAgICAgIG9mZnNldDogdHlwZUdyYWRpZW50Lmxlbmd0aCArIDIsXHJcbiAgICAgICAgICAgICAgICBpbmRleDogaW5kZXggLSB0eXBlR3JhZGllbnQubGVuZ3RoICsgZ3JhZGllbnRMZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBoYXNDb21tYTogdHJ1ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHdoaWxlICgoaW5kZXggPSB2YWx1ZS5pbmRleE9mKFwiZ3JhZGllbnRcIiwgc3RhcnRJbmRleCkpICE9PSAtMSkge1xyXG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEoKTtcclxuICAgICAgICAgICAgaWYgKHN0YXRlXzEgPT09IFwiYnJlYWtcIikgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0uaGFzQ29tbWEgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRQcmlvcml0eShydWxlU3R5bGUsIHByb3BlcnR5KSB7XHJcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4ocnVsZVN0eWxlICYmIHJ1bGVTdHlsZS5nZXRQcm9wZXJ0eVByaW9yaXR5KHByb3BlcnR5KSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRNb2RpZmlhYmxlQ1NTRGVjbGFyYXRpb24oXHJcbiAgICAgICAgcHJvcGVydHksXHJcbiAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgcnVsZSxcclxuICAgICAgICB2YXJpYWJsZXNTdG9yZSxcclxuICAgICAgICBpZ25vcmVJbWFnZVNlbGVjdG9ycyxcclxuICAgICAgICBpc0NhbmNlbGxlZFxyXG4gICAgKSB7XHJcbiAgICAgICAgaWYgKHByb3BlcnR5LnN0YXJ0c1dpdGgoXCItLVwiKSkge1xyXG4gICAgICAgICAgICB2YXIgbW9kaWZpZXIgPSBnZXRWYXJpYWJsZU1vZGlmaWVyKFxyXG4gICAgICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUsXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgIHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgcnVsZSxcclxuICAgICAgICAgICAgICAgIGlnbm9yZUltYWdlU2VsZWN0b3JzLFxyXG4gICAgICAgICAgICAgICAgaXNDYW5jZWxsZWRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKG1vZGlmaWVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbW9kaWZpZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0YW50OiBnZXRQcmlvcml0eShydWxlLnN0eWxlLCBwcm9wZXJ0eSksXHJcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWU6IHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZS5pbmNsdWRlcyhcInZhcihcIikpIHtcclxuICAgICAgICAgICAgdmFyIG1vZGlmaWVyID0gZ2V0VmFyaWFibGVEZXBlbmRhbnRNb2RpZmllcihcclxuICAgICAgICAgICAgICAgIHZhcmlhYmxlc1N0b3JlLFxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICB2YWx1ZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAobW9kaWZpZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtb2RpZmllcixcclxuICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQ6IGdldFByaW9yaXR5KHJ1bGUuc3R5bGUsIHByb3BlcnR5KSxcclxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZTogdmFsdWVcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHByb3BlcnR5ID09PSBcImNvbG9yLXNjaGVtZVwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgIChwcm9wZXJ0eS5pbmNsdWRlcyhcImNvbG9yXCIpICYmXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSAhPT0gXCItd2Via2l0LXByaW50LWNvbG9yLWFkanVzdFwiKSB8fFxyXG4gICAgICAgICAgICBwcm9wZXJ0eSA9PT0gXCJmaWxsXCIgfHxcclxuICAgICAgICAgICAgcHJvcGVydHkgPT09IFwic3Ryb2tlXCIgfHxcclxuICAgICAgICAgICAgcHJvcGVydHkgPT09IFwic3RvcC1jb2xvclwiXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHZhciBtb2RpZmllciA9IGdldENvbG9yTW9kaWZpZXIocHJvcGVydHksIHZhbHVlLCBydWxlKTtcclxuICAgICAgICAgICAgaWYgKG1vZGlmaWVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbW9kaWZpZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0YW50OiBnZXRQcmlvcml0eShydWxlLnN0eWxlLCBwcm9wZXJ0eSksXHJcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWU6IHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgcHJvcGVydHkgPT09IFwiYmFja2dyb3VuZC1pbWFnZVwiIHx8XHJcbiAgICAgICAgICAgIHByb3BlcnR5ID09PSBcImxpc3Qtc3R5bGUtaW1hZ2VcIlxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB2YXIgbW9kaWZpZXIgPSBnZXRCZ0ltYWdlTW9kaWZpZXIoXHJcbiAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgIHJ1bGUsXHJcbiAgICAgICAgICAgICAgICBpZ25vcmVJbWFnZVNlbGVjdG9ycyxcclxuICAgICAgICAgICAgICAgIGlzQ2FuY2VsbGVkXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmIChtb2RpZmllcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG1vZGlmaWVyLFxyXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydGFudDogZ2V0UHJpb3JpdHkocnVsZS5zdHlsZSwgcHJvcGVydHkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlOiB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAocHJvcGVydHkuaW5jbHVkZXMoXCJzaGFkb3dcIikpIHtcclxuICAgICAgICAgICAgdmFyIG1vZGlmaWVyID0gZ2V0U2hhZG93TW9kaWZpZXIodmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAobW9kaWZpZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtb2RpZmllcixcclxuICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQ6IGdldFByaW9yaXR5KHJ1bGUuc3R5bGUsIHByb3BlcnR5KSxcclxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZTogdmFsdWVcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBqb2luU2VsZWN0b3JzKCkge1xyXG4gICAgICAgIHZhciBzZWxlY3RvcnMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBzZWxlY3RvcnNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9ycy5maWx0ZXIoQm9vbGVhbikuam9pbihcIiwgXCIpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0TW9kaWZpZWRVc2VyQWdlbnRTdHlsZSh0aGVtZSwgaXNJRnJhbWUsIHN0eWxlU3lzdGVtQ29udHJvbHMpIHtcclxuICAgICAgICB2YXIgbGluZXMgPSBbXTtcclxuICAgICAgICBpZiAoIWlzSUZyYW1lKSB7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goXCJodG1sIHtcIik7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBcIiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZ5QmFja2dyb3VuZENvbG9yKHtyOiAyNTUsIGc6IDI1NSwgYjogMjU1fSwgdGhlbWUpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiICFpbXBvcnRhbnQ7XCJcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbGluZXMucHVzaChcIn1cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0NTU0NvbG9yU2NoZW1lUHJvcFN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFwiaHRtbCB7XCIpO1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgXCIgICAgY29sb3Itc2NoZW1lOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWUubW9kZSA9PT0gMSA/IFwiZGFya1wiIDogXCJkYXJrIGxpZ2h0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCIgIWltcG9ydGFudDtcIlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJnU2VsZWN0b3JzID0gam9pblNlbGVjdG9ycyhcclxuICAgICAgICAgICAgaXNJRnJhbWUgPyBcIlwiIDogXCJodG1sLCBib2R5XCIsXHJcbiAgICAgICAgICAgIHN0eWxlU3lzdGVtQ29udHJvbHMgPyBcImlucHV0LCB0ZXh0YXJlYSwgc2VsZWN0LCBidXR0b24sIGRpYWxvZ1wiIDogXCJcIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYgKGJnU2VsZWN0b3JzKSB7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goXCJcIi5jb25jYXQoYmdTZWxlY3RvcnMsIFwiIHtcIikpO1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgXCIgICAgYmFja2dyb3VuZC1jb2xvcjogXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmeUJhY2tncm91bmRDb2xvcih7cjogMjU1LCBnOiAyNTUsIGI6IDI1NX0sIHRoZW1lKSxcclxuICAgICAgICAgICAgICAgICAgICBcIjtcIlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGluZXMucHVzaChcclxuICAgICAgICAgICAgXCJcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBqb2luU2VsZWN0b3JzKFxyXG4gICAgICAgICAgICAgICAgICAgIFwiaHRtbCwgYm9keVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlU3lzdGVtQ29udHJvbHMgPyBcImlucHV0LCB0ZXh0YXJlYSwgc2VsZWN0LCBidXR0b25cIiA6IFwiXCJcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBcIiB7XCJcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbGluZXMucHVzaChcclxuICAgICAgICAgICAgXCIgICAgYm9yZGVyLWNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBtb2RpZnlCb3JkZXJDb2xvcih7cjogNzYsIGc6IDc2LCBiOiA3Nn0sIHRoZW1lKSxcclxuICAgICAgICAgICAgICAgIFwiO1wiXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgIFwiICAgIGNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBtb2RpZnlGb3JlZ3JvdW5kQ29sb3Ioe3I6IDAsIGc6IDAsIGI6IDB9LCB0aGVtZSksXHJcbiAgICAgICAgICAgICAgICBcIjtcIlxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwiYSB7XCIpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgIFwiICAgIGNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBtb2RpZnlGb3JlZ3JvdW5kQ29sb3Ioe3I6IDAsIGc6IDY0LCBiOiAyNTV9LCB0aGVtZSksXHJcbiAgICAgICAgICAgICAgICBcIjtcIlxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwidGFibGUge1wiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICBcIiAgICBib3JkZXItY29sb3I6IFwiLmNvbmNhdChcclxuICAgICAgICAgICAgICAgIG1vZGlmeUJvcmRlckNvbG9yKHtyOiAxMjgsIGc6IDEyOCwgYjogMTI4fSwgdGhlbWUpLFxyXG4gICAgICAgICAgICAgICAgXCI7XCJcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbGluZXMucHVzaChcIn1cIik7XHJcbiAgICAgICAgbGluZXMucHVzaChcIjo6cGxhY2Vob2xkZXIge1wiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICBcIiAgICBjb2xvcjogXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgbW9kaWZ5Rm9yZWdyb3VuZENvbG9yKHtyOiAxNjksIGc6IDE2OSwgYjogMTY5fSwgdGhlbWUpLFxyXG4gICAgICAgICAgICAgICAgXCI7XCJcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbGluZXMucHVzaChcIn1cIik7XHJcbiAgICAgICAgbGluZXMucHVzaChcImlucHV0Oi13ZWJraXQtYXV0b2ZpbGwsXCIpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ0ZXh0YXJlYTotd2Via2l0LWF1dG9maWxsLFwiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwic2VsZWN0Oi13ZWJraXQtYXV0b2ZpbGwge1wiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICBcIiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBtb2RpZnlCYWNrZ3JvdW5kQ29sb3Ioe3I6IDI1MCwgZzogMjU1LCBiOiAxODl9LCB0aGVtZSksXHJcbiAgICAgICAgICAgICAgICBcIiAhaW1wb3J0YW50O1wiXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgIFwiICAgIGNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBtb2RpZnlGb3JlZ3JvdW5kQ29sb3Ioe3I6IDAsIGc6IDAsIGI6IDB9LCB0aGVtZSksXHJcbiAgICAgICAgICAgICAgICBcIiAhaW1wb3J0YW50O1wiXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIGlmICh0aGVtZS5zY3JvbGxiYXJDb2xvcikge1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKGdldE1vZGlmaWVkU2Nyb2xsYmFyU3R5bGUodGhlbWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoZW1lLnNlbGVjdGlvbkNvbG9yKSB7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goZ2V0TW9kaWZpZWRTZWxlY3Rpb25TdHlsZSh0aGVtZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGluZXMuam9pbihcIlxcblwiKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldFNlbGVjdGlvbkNvbG9yKHRoZW1lKSB7XHJcbiAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvclNlbGVjdGlvbjtcclxuICAgICAgICB2YXIgZm9yZWdyb3VuZENvbG9yU2VsZWN0aW9uO1xyXG4gICAgICAgIGlmICh0aGVtZS5zZWxlY3Rpb25Db2xvciA9PT0gXCJhdXRvXCIpIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yU2VsZWN0aW9uID0gbW9kaWZ5QmFja2dyb3VuZENvbG9yKFxyXG4gICAgICAgICAgICAgICAge3I6IDAsIGc6IDk2LCBiOiAyMTJ9LFxyXG4gICAgICAgICAgICAgICAgX19hc3NpZ24oX19hc3NpZ24oe30sIHRoZW1lKSwge2dyYXlzY2FsZTogMH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGZvcmVncm91bmRDb2xvclNlbGVjdGlvbiA9IG1vZGlmeUZvcmVncm91bmRDb2xvcihcclxuICAgICAgICAgICAgICAgIHtyOiAyNTUsIGc6IDI1NSwgYjogMjU1fSxcclxuICAgICAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCB0aGVtZSksIHtncmF5c2NhbGU6IDB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciByZ2IgPSBwYXJzZUNvbG9yV2l0aENhY2hlKHRoZW1lLnNlbGVjdGlvbkNvbG9yKTtcclxuICAgICAgICAgICAgdmFyIGhzbCA9IHJnYlRvSFNMKHJnYik7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvclNlbGVjdGlvbiA9IHRoZW1lLnNlbGVjdGlvbkNvbG9yO1xyXG4gICAgICAgICAgICBpZiAoaHNsLmwgPCAwLjUpIHtcclxuICAgICAgICAgICAgICAgIGZvcmVncm91bmRDb2xvclNlbGVjdGlvbiA9IFwiI0ZGRlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm9yZWdyb3VuZENvbG9yU2VsZWN0aW9uID0gXCIjMDAwXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yU2VsZWN0aW9uOiBiYWNrZ3JvdW5kQ29sb3JTZWxlY3Rpb24sXHJcbiAgICAgICAgICAgIGZvcmVncm91bmRDb2xvclNlbGVjdGlvbjogZm9yZWdyb3VuZENvbG9yU2VsZWN0aW9uXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldE1vZGlmaWVkU2VsZWN0aW9uU3R5bGUodGhlbWUpIHtcclxuICAgICAgICB2YXIgbGluZXMgPSBbXTtcclxuICAgICAgICB2YXIgbW9kaWZpZWRTZWxlY3Rpb25Db2xvciA9IGdldFNlbGVjdGlvbkNvbG9yKHRoZW1lKTtcclxuICAgICAgICB2YXIgYmFja2dyb3VuZENvbG9yU2VsZWN0aW9uID1cclxuICAgICAgICAgICAgbW9kaWZpZWRTZWxlY3Rpb25Db2xvci5iYWNrZ3JvdW5kQ29sb3JTZWxlY3Rpb247XHJcbiAgICAgICAgdmFyIGZvcmVncm91bmRDb2xvclNlbGVjdGlvbiA9XHJcbiAgICAgICAgICAgIG1vZGlmaWVkU2VsZWN0aW9uQ29sb3IuZm9yZWdyb3VuZENvbG9yU2VsZWN0aW9uO1xyXG4gICAgICAgIFtcIjo6c2VsZWN0aW9uXCIsIFwiOjotbW96LXNlbGVjdGlvblwiXS5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3Rpb24pIHtcclxuICAgICAgICAgICAgbGluZXMucHVzaChcIlwiLmNvbmNhdChzZWxlY3Rpb24sIFwiIHtcIikpO1xyXG4gICAgICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgXCIgICAgYmFja2dyb3VuZC1jb2xvcjogXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvclNlbGVjdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBcIiAhaW1wb3J0YW50O1wiXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBcIiAgICBjb2xvcjogXCIuY29uY2F0KGZvcmVncm91bmRDb2xvclNlbGVjdGlvbiwgXCIgIWltcG9ydGFudDtcIilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbGluZXMucHVzaChcIn1cIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGxpbmVzLmpvaW4oXCJcXG5cIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRNb2RpZmllZFNjcm9sbGJhclN0eWxlKHRoZW1lKSB7XHJcbiAgICAgICAgdmFyIGxpbmVzID0gW107XHJcbiAgICAgICAgdmFyIGNvbG9yVHJhY2s7XHJcbiAgICAgICAgdmFyIGNvbG9ySWNvbnM7XHJcbiAgICAgICAgdmFyIGNvbG9yVGh1bWI7XHJcbiAgICAgICAgdmFyIGNvbG9yVGh1bWJIb3ZlcjtcclxuICAgICAgICB2YXIgY29sb3JUaHVtYkFjdGl2ZTtcclxuICAgICAgICB2YXIgY29sb3JDb3JuZXI7XHJcbiAgICAgICAgaWYgKHRoZW1lLnNjcm9sbGJhckNvbG9yID09PSBcImF1dG9cIikge1xyXG4gICAgICAgICAgICBjb2xvclRyYWNrID0gbW9kaWZ5QmFja2dyb3VuZENvbG9yKHtyOiAyNDEsIGc6IDI0MSwgYjogMjQxfSwgdGhlbWUpO1xyXG4gICAgICAgICAgICBjb2xvckljb25zID0gbW9kaWZ5Rm9yZWdyb3VuZENvbG9yKHtyOiA5NiwgZzogOTYsIGI6IDk2fSwgdGhlbWUpO1xyXG4gICAgICAgICAgICBjb2xvclRodW1iID0gbW9kaWZ5QmFja2dyb3VuZENvbG9yKHtyOiAxNzYsIGc6IDE3NiwgYjogMTc2fSwgdGhlbWUpO1xyXG4gICAgICAgICAgICBjb2xvclRodW1iSG92ZXIgPSBtb2RpZnlCYWNrZ3JvdW5kQ29sb3IoXHJcbiAgICAgICAgICAgICAgICB7cjogMTQ0LCBnOiAxNDQsIGI6IDE0NH0sXHJcbiAgICAgICAgICAgICAgICB0aGVtZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb2xvclRodW1iQWN0aXZlID0gbW9kaWZ5QmFja2dyb3VuZENvbG9yKFxyXG4gICAgICAgICAgICAgICAge3I6IDk2LCBnOiA5NiwgYjogOTZ9LFxyXG4gICAgICAgICAgICAgICAgdGhlbWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgY29sb3JDb3JuZXIgPSBtb2RpZnlCYWNrZ3JvdW5kQ29sb3IoXHJcbiAgICAgICAgICAgICAgICB7cjogMjU1LCBnOiAyNTUsIGI6IDI1NX0sXHJcbiAgICAgICAgICAgICAgICB0aGVtZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciByZ2IgPSBwYXJzZUNvbG9yV2l0aENhY2hlKHRoZW1lLnNjcm9sbGJhckNvbG9yKTtcclxuICAgICAgICAgICAgdmFyIGhzbF8xID0gcmdiVG9IU0wocmdiKTtcclxuICAgICAgICAgICAgdmFyIGlzTGlnaHQgPSBoc2xfMS5sID4gMC41O1xyXG4gICAgICAgICAgICB2YXIgbGlnaHRlbiA9IGZ1bmN0aW9uIChsaWdodGVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sIGhzbF8xKSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGw6IGNsYW1wKGhzbF8xLmwgKyBsaWdodGVyLCAwLCAxKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBkYXJrZW4gPSBmdW5jdGlvbiAoZGFya2VyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sIGhzbF8xKSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGw6IGNsYW1wKGhzbF8xLmwgLSBkYXJrZXIsIDAsIDEpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29sb3JUcmFjayA9IGhzbFRvU3RyaW5nKGRhcmtlbigwLjQpKTtcclxuICAgICAgICAgICAgY29sb3JJY29ucyA9IGhzbFRvU3RyaW5nKGlzTGlnaHQgPyBkYXJrZW4oMC40KSA6IGxpZ2h0ZW4oMC40KSk7XHJcbiAgICAgICAgICAgIGNvbG9yVGh1bWIgPSBoc2xUb1N0cmluZyhoc2xfMSk7XHJcbiAgICAgICAgICAgIGNvbG9yVGh1bWJIb3ZlciA9IGhzbFRvU3RyaW5nKGxpZ2h0ZW4oMC4xKSk7XHJcbiAgICAgICAgICAgIGNvbG9yVGh1bWJBY3RpdmUgPSBoc2xUb1N0cmluZyhsaWdodGVuKDAuMikpO1xyXG4gICAgICAgICAgICBjb2xvckNvcm5lciA9IGhzbFRvU3RyaW5nKGRhcmtlbigwLjUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGluZXMucHVzaChcIjo6LXdlYmtpdC1zY3JvbGxiYXIge1wiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwiICAgIGJhY2tncm91bmQtY29sb3I6IFwiLmNvbmNhdChjb2xvclRyYWNrLCBcIjtcIikpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCIgICAgY29sb3I6IFwiLmNvbmNhdChjb2xvckljb25zLCBcIjtcIikpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCI6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcIik7XHJcbiAgICAgICAgbGluZXMucHVzaChcIiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBcIi5jb25jYXQoY29sb3JUaHVtYiwgXCI7XCIpKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwiOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciB7XCIpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCIgICAgYmFja2dyb3VuZC1jb2xvcjogXCIuY29uY2F0KGNvbG9yVGh1bWJIb3ZlciwgXCI7XCIpKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwiOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjphY3RpdmUge1wiKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFwiICAgIGJhY2tncm91bmQtY29sb3I6IFwiLmNvbmNhdChjb2xvclRodW1iQWN0aXZlLCBcIjtcIikpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCI6Oi13ZWJraXQtc2Nyb2xsYmFyLWNvcm5lciB7XCIpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCIgICAgYmFja2dyb3VuZC1jb2xvcjogXCIuY29uY2F0KGNvbG9yQ29ybmVyLCBcIjtcIikpO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIGlmIChpc0ZpcmVmb3gpIHtcclxuICAgICAgICAgICAgbGluZXMucHVzaChcIioge1wiKTtcclxuICAgICAgICAgICAgbGluZXMucHVzaChcclxuICAgICAgICAgICAgICAgIFwiICAgIHNjcm9sbGJhci1jb2xvcjogXCJcclxuICAgICAgICAgICAgICAgICAgICAuY29uY2F0KGNvbG9yVGh1bWIsIFwiIFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQoY29sb3JUcmFjaywgXCI7XCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGluZXMuam9pbihcIlxcblwiKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldE1vZGlmaWVkRmFsbGJhY2tTdHlsZShmaWx0ZXIsIF9hKSB7XHJcbiAgICAgICAgdmFyIHN0cmljdCA9IF9hLnN0cmljdDtcclxuICAgICAgICB2YXIgZmFjdG9yeSA9IGRlZmF1bHRGYWxsYmFja0ZhY3Rvcnk7XHJcbiAgICAgICAgcmV0dXJuIGZhY3RvcnkoZmlsdGVyLCB7c3RyaWN0OiBzdHJpY3R9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGRlZmF1bHRGYWxsYmFja0ZhY3RvcnkoZmlsdGVyLCBfYSkge1xyXG4gICAgICAgIHZhciBzdHJpY3QgPSBfYS5zdHJpY3Q7XHJcbiAgICAgICAgdmFyIGxpbmVzID0gW107XHJcbiAgICAgICAgdmFyIGlzTWljcm9zb2Z0ID0gW1wibWljcm9zb2Z0LmNvbVwiLCBcImRvY3MubWljcm9zb2Z0LmNvbVwiXS5pbmNsdWRlcyhcclxuICAgICAgICAgICAgbG9jYXRpb24uaG9zdG5hbWVcclxuICAgICAgICApO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXHJcbiAgICAgICAgICAgIFwiaHRtbCwgYm9keSwgXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgc3RyaWN0XHJcbiAgICAgICAgICAgICAgICAgICAgPyBcImJvZHkgOm5vdChpZnJhbWUpXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlzTWljcm9zb2Z0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJzpub3QoZGl2W3N0eWxlXj1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6LVwiXSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgOiBcImJvZHkgPiA6bm90KGlmcmFtZSlcIixcclxuICAgICAgICAgICAgICAgIFwiIHtcIlxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICBcIiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBtb2RpZnlCYWNrZ3JvdW5kQ29sb3Ioe3I6IDI1NSwgZzogMjU1LCBiOiAyNTV9LCBmaWx0ZXIpLFxyXG4gICAgICAgICAgICAgICAgXCIgIWltcG9ydGFudDtcIlxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsaW5lcy5wdXNoKFxyXG4gICAgICAgICAgICBcIiAgICBib3JkZXItY29sb3I6IFwiLmNvbmNhdChcclxuICAgICAgICAgICAgICAgIG1vZGlmeUJvcmRlckNvbG9yKHtyOiA2NCwgZzogNjQsIGI6IDY0fSwgZmlsdGVyKSxcclxuICAgICAgICAgICAgICAgIFwiICFpbXBvcnRhbnQ7XCJcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbGluZXMucHVzaChcclxuICAgICAgICAgICAgXCIgICAgY29sb3I6IFwiLmNvbmNhdChcclxuICAgICAgICAgICAgICAgIG1vZGlmeUZvcmVncm91bmRDb2xvcih7cjogMCwgZzogMCwgYjogMH0sIGZpbHRlciksXHJcbiAgICAgICAgICAgICAgICBcIiAhaW1wb3J0YW50O1wiXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgICAgIGxpbmVzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgIHJldHVybiBsaW5lcy5qb2luKFwiXFxuXCIpO1xyXG4gICAgfVxyXG4gICAgdmFyIHVucGFyc2FibGVDb2xvcnMgPSBuZXcgU2V0KFtcclxuICAgICAgICBcImluaGVyaXRcIixcclxuICAgICAgICBcInRyYW5zcGFyZW50XCIsXHJcbiAgICAgICAgXCJpbml0aWFsXCIsXHJcbiAgICAgICAgXCJjdXJyZW50Y29sb3JcIixcclxuICAgICAgICBcIm5vbmVcIixcclxuICAgICAgICBcInVuc2V0XCJcclxuICAgIF0pO1xyXG4gICAgZnVuY3Rpb24gZ2V0Q29sb3JNb2RpZmllcihwcm9wLCB2YWx1ZSwgcnVsZSkge1xyXG4gICAgICAgIGlmICh1bnBhcnNhYmxlQ29sb3JzLmhhcyh2YWx1ZS50b0xvd2VyQ2FzZSgpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZ2IgPSBwYXJzZUNvbG9yV2l0aENhY2hlKHZhbHVlKTtcclxuICAgICAgICBpZiAoIXJnYikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3AuaW5jbHVkZXMoXCJiYWNrZ3JvdW5kXCIpKSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIChydWxlLnN0eWxlLndlYmtpdE1hc2tJbWFnZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUuc3R5bGUud2Via2l0TWFza0ltYWdlICE9PSBcIm5vbmVcIikgfHxcclxuICAgICAgICAgICAgICAgIChydWxlLnN0eWxlLndlYmtpdE1hc2sgJiZcclxuICAgICAgICAgICAgICAgICAgICAhcnVsZS5zdHlsZS53ZWJraXRNYXNrLnN0YXJ0c1dpdGgoXCJub25lXCIpKSB8fFxyXG4gICAgICAgICAgICAgICAgKHJ1bGUuc3R5bGUubWFzayAmJiBydWxlLnN0eWxlLm1hc2sgIT09IFwibm9uZVwiKSB8fFxyXG4gICAgICAgICAgICAgICAgKHJ1bGUuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcIm1hc2staW1hZ2VcIikgJiZcclxuICAgICAgICAgICAgICAgICAgICBydWxlLnN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJtYXNrLWltYWdlXCIpICE9PSBcIm5vbmVcIilcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZnlGb3JlZ3JvdW5kQ29sb3IocmdiLCBmaWx0ZXIpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZGlmeUJhY2tncm91bmRDb2xvcihyZ2IsIGZpbHRlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwcm9wLmluY2x1ZGVzKFwiYm9yZGVyXCIpIHx8IHByb3AuaW5jbHVkZXMoXCJvdXRsaW5lXCIpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZ5Qm9yZGVyQ29sb3IocmdiLCBmaWx0ZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbW9kaWZ5Rm9yZWdyb3VuZENvbG9yKHJnYiwgZmlsdGVyKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgdmFyIGltYWdlRGV0YWlsc0NhY2hlID0gbmV3IE1hcCgpO1xyXG4gICAgdmFyIGF3YWl0aW5nRm9ySW1hZ2VMb2FkaW5nID0gbmV3IE1hcCgpO1xyXG4gICAgZnVuY3Rpb24gc2hvdWxkSWdub3JlSW1hZ2Uoc2VsZWN0b3JUZXh0LCBzZWxlY3RvcnMpIHtcclxuICAgICAgICBpZiAoIXNlbGVjdG9yVGV4dCB8fCBzZWxlY3RvcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHMgPT09IFwiKlwiO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJ1bGVTZWxlY3RvcnMgPSBzZWxlY3RvclRleHQuc3BsaXQoLyxcXHMqL2cpO1xyXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgdmFyIGlnbm9yZWRTZWxlY3RvciA9IHNlbGVjdG9yc1tpXTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgcnVsZVNlbGVjdG9ycy5zb21lKGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHMgPT09IGlnbm9yZWRTZWxlY3RvcjtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZTogdHJ1ZX07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0b3JzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBzdGF0ZV8xID0gX2xvb3BfMShpKTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdGF0ZV8xID09PSBcIm9iamVjdFwiKSByZXR1cm4gc3RhdGVfMS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0QmdJbWFnZU1vZGlmaWVyKFxyXG4gICAgICAgIHZhbHVlLFxyXG4gICAgICAgIHJ1bGUsXHJcbiAgICAgICAgaWdub3JlSW1hZ2VTZWxlY3RvcnMsXHJcbiAgICAgICAgaXNDYW5jZWxsZWRcclxuICAgICkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGdyYWRpZW50cyA9IHBhcnNlR3JhZGllbnQodmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgdXJscyA9IGdldE1hdGNoZXMoY3NzVVJMUmVnZXgsIHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHVybHMubGVuZ3RoID09PSAwICYmIGdyYWRpZW50cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZ2V0SW5kaWNlcyA9IGZ1bmN0aW9uIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMubWFwKGZ1bmN0aW9uIChtYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZUluZGV4ID0gdmFsdWUuaW5kZXhPZihtYXRjaCwgaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdmFsdWVJbmRleCArIG1hdGNoLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge21hdGNoOiBtYXRjaCwgaW5kZXg6IHZhbHVlSW5kZXh9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBtYXRjaGVzXzEgPSBncmFkaWVudHNcclxuICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19hc3NpZ24oe3R5cGU6IFwiZ3JhZGllbnRcIn0sIGkpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0SW5kaWNlcyh1cmxzKS5tYXAoZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKHt0eXBlOiBcInVybFwiLCBvZmZzZXQ6IDB9LCBpKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5pbmRleCA+IGIuaW5kZXggPyAxIDogLTE7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIGdldEdyYWRpZW50TW9kaWZpZXJfMSA9IGZ1bmN0aW9uIChncmFkaWVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHR5cGVHcmFkaWVudCA9IGdyYWRpZW50LnR5cGVHcmFkaWVudCxcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IGdyYWRpZW50Lm1hdGNoLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc0NvbW1hID0gZ3JhZGllbnQuaGFzQ29tbWE7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFydHNSZWdleCA9XHJcbiAgICAgICAgICAgICAgICAgICAgLyhbXlxcKFxcKSxdKyhcXChbXlxcKFxcKV0qKFxcKFteXFwoXFwpXSpcXCkqW15cXChcXCldKik/XFwpKT8oW15cXChcXCksIF18KCAoPyFjYWxjKSkpKiksPy9nO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbG9yU3RvcFJlZ2V4ID1cclxuICAgICAgICAgICAgICAgICAgICAvXihmcm9tfGNvbG9yLXN0b3B8dG8pXFwoKFteXFwoXFwpXSo/LFxccyopPyguKj8pXFwpJC87XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSBnZXRNYXRjaGVzKHBhcnRzUmVnZXgsIG1hdGNoLCAxKS5tYXAoXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHBhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFydCA9IHBhcnQudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmdiID0gcGFyc2VDb2xvcldpdGhDYWNoZShwYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJnYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZ5R3JhZGllbnRDb2xvcihyZ2IsIGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcGFjZSA9IHBhcnQubGFzdEluZGV4T2YoXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZ2IgPSBwYXJzZUNvbG9yV2l0aENhY2hlKHBhcnQuc3Vic3RyaW5nKDAsIHNwYWNlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZ2IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmeUdyYWRpZW50Q29sb3IocmdiLCBmaWx0ZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHBhcnQuc3Vic3RyaW5nKHNwYWNlICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JTdG9wTWF0Y2ggPSBwYXJ0Lm1hdGNoKGNvbG9yU3RvcFJlZ2V4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbG9yU3RvcE1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZ2IgPSBwYXJzZUNvbG9yV2l0aENhY2hlKGNvbG9yU3RvcE1hdGNoWzNdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZ2IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChjb2xvclN0b3BNYXRjaFsxXSwgXCIoXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yU3RvcE1hdGNoWzJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yU3RvcE1hdGNoWzJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiwgXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZnlHcmFkaWVudENvbG9yKHJnYiwgZmlsdGVyKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIilcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHR5cGVHcmFkaWVudCwgXCIoXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKG1vZGlmeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZ5KGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbihcIiwgXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIpXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KGhhc0NvbW1hID8gXCIsIFwiIDogXCJcIik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgZ2V0VVJMTW9kaWZpZXJfMSA9IGZ1bmN0aW9uICh1cmxWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3VsZElnbm9yZUltYWdlKHJ1bGUuc2VsZWN0b3JUZXh0LCBpZ25vcmVJbWFnZVNlbGVjdG9ycylcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGdldENTU1VSTFZhbHVlKHVybFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHZhciBpc1VSTEVtcHR5ID0gdXJsLmxlbmd0aCA9PT0gMDtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRTdHlsZVNoZWV0ID0gcnVsZS5wYXJlbnRTdHlsZVNoZWV0O1xyXG4gICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPVxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudFN0eWxlU2hlZXQgJiYgcGFyZW50U3R5bGVTaGVldC5ocmVmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gZ2V0Q1NTQmFzZUJhdGgocGFyZW50U3R5bGVTaGVldC5ocmVmKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICgoX2EgPSBwYXJlbnRTdHlsZVNoZWV0Lm93bmVyTm9kZSkgPT09IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9PT0gdm9pZCAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdm9pZCAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX2EuYmFzZVVSSSkgfHwgbG9jYXRpb24ub3JpZ2luO1xyXG4gICAgICAgICAgICAgICAgdXJsID0gZ2V0QWJzb2x1dGVVUkwoYmFzZVVSTCwgdXJsKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlRGV0YWlscyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0ZXJzXzEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnSW1hZ2VWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2JVUkw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1VSTEVtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIFwidXJsKCcnKVwiXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZURldGFpbHMgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWltYWdlRGV0YWlsc0NhY2hlLmhhcyh1cmwpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEZXRhaWxzID0gaW1hZ2VEZXRhaWxzQ2FjaGUuZ2V0KHVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgOV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDgsICwgOV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFpc0Jsb2JVUkxDaGVja1Jlc3VsdFJlYWR5KCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIHJlcXVlc3RCbG9iVVJMQ2hlY2soKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXdhaXRpbmdGb3JJbWFnZUxvYWRpbmcuaGFzKHVybCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdGVyc18xID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0aW5nRm9ySW1hZ2VMb2FkaW5nLmdldCh1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0ZXJzXzEucHVzaChyZXNvbHZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZURldGFpbHMgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW1hZ2VEZXRhaWxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdGluZ0ZvckltYWdlTG9hZGluZy5zZXQodXJsLCBbXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgZ2V0SW1hZ2VEZXRhaWxzKHVybCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEZXRhaWxzID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZURldGFpbHNDYWNoZS5zZXQodXJsLCBpbWFnZURldGFpbHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdGluZ0ZvckltYWdlTG9hZGluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh1cmwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGltYWdlRGV0YWlscyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXRpbmdGb3JJbWFnZUxvYWRpbmcuZGVsZXRlKHVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgOV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nV2FybihlcnJfMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhd2FpdGluZ0ZvckltYWdlTG9hZGluZy5oYXModXJsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXRpbmdGb3JJbWFnZUxvYWRpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KHVybClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0aW5nRm9ySW1hZ2VMb2FkaW5nLmRlbGV0ZSh1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgOV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2VEZXRhaWxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ltYWdlVmFsdWUgPSBnZXRCZ0ltYWdlVmFsdWVfMShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZURldGFpbHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJnSW1hZ2VWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgYmdJbWFnZVZhbHVlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVybC5zdGFydHNXaXRoKFwiZGF0YTpcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDExXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCB0cnlDb252ZXJ0RGF0YVVSTFRvQmxvYlVSTCh1cmwpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9iVVJMID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmxvYlVSTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1cmwoXCInLmNvbmNhdChibG9iVVJMLCAnXCIpJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsICd1cmwoXCInLmNvbmNhdCh1cmwsICdcIiknKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIGdldEJnSW1hZ2VWYWx1ZV8xID0gZnVuY3Rpb24gKGltYWdlRGV0YWlscywgZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNEYXJrID0gaW1hZ2VEZXRhaWxzLmlzRGFyayxcclxuICAgICAgICAgICAgICAgICAgICBpc0xpZ2h0ID0gaW1hZ2VEZXRhaWxzLmlzTGlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNUcmFuc3BhcmVudCA9IGltYWdlRGV0YWlscy5pc1RyYW5zcGFyZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTGFyZ2UgPSBpbWFnZURldGFpbHMuaXNMYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IGltYWdlRGV0YWlscy53aWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgbG9nU3JjID0gaW1hZ2VEZXRhaWxzLnNyYy5zdGFydHNXaXRoKFwiZGF0YTpcIilcclxuICAgICAgICAgICAgICAgICAgICA/IFwiZGF0YTpcIlxyXG4gICAgICAgICAgICAgICAgICAgIDogaW1hZ2VEZXRhaWxzLnNyYztcclxuICAgICAgICAgICAgICAgIGlmIChpc0xhcmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nSW5mbyhcIk5vdCBtb2RpZnlpbmcgdG9vIGxhcmdlIGltYWdlIFwiLmNvbmNhdChsb2dTcmMpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICAgICAgICBpc0RhcmsgJiZcclxuICAgICAgICAgICAgICAgICAgICBpc1RyYW5zcGFyZW50ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyLm1vZGUgPT09IDEgJiZcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA+IDJcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZ0luZm8oXCJJbnZlcnRpbmcgZGFyayBpbWFnZSBcIi5jb25jYXQobG9nU3JjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGludmVydGVkID0gZ2V0RmlsdGVyZWRJbWFnZVVSTChcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEZXRhaWxzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmlsdGVyKSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwaWE6IGNsYW1wKGZpbHRlci5zZXBpYSArIDEwLCAwLCAxMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSAndXJsKFwiJy5jb25jYXQoaW52ZXJ0ZWQsICdcIiknKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNMaWdodCAmJiAhaXNUcmFuc3BhcmVudCAmJiBmaWx0ZXIubW9kZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZ0luZm8oXCJEaW1taW5nIGxpZ2h0IGltYWdlIFwiLmNvbmNhdChsb2dTcmMpKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGltbWVkID0gZ2V0RmlsdGVyZWRJbWFnZVVSTChpbWFnZURldGFpbHMsIGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gJ3VybChcIicuY29uY2F0KGRpbW1lZCwgJ1wiKScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIubW9kZSA9PT0gMCAmJiBpc0xpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nSW5mbyhcIkFwcGx5aW5nIGZpbHRlciB0byBpbWFnZSBcIi5jb25jYXQobG9nU3JjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gZ2V0RmlsdGVyZWRJbWFnZVVSTChcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEZXRhaWxzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmlsdGVyKSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZ2h0bmVzczogY2xhbXAoZmlsdGVyLmJyaWdodG5lc3MgLSAxMCwgNSwgMjAwKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcGlhOiBjbGFtcChmaWx0ZXIuc2VwaWEgKyAxMCwgMCwgMTAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gJ3VybChcIicuY29uY2F0KGZpbHRlcmVkLCAnXCIpJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZ0luZm8oXCJOb3QgbW9kaWZ5aW5nIHRoZSBpbWFnZSBcIi5jb25jYXQobG9nU3JjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBtb2RpZmllcnNfMSA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgbWF0Y2hJbmRleF8xID0gMDtcclxuICAgICAgICAgICAgdmFyIHByZXZIYXNDb21tYV8xID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG1hdGNoZXNfMS5mb3JFYWNoKGZ1bmN0aW9uIChfYSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBfYS50eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoID0gX2EubWF0Y2gsXHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBfYS5pbmRleCxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlR3JhZGllbnQgPSBfYS50eXBlR3JhZGllbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFzQ29tbWEgPSBfYS5oYXNDb21tYSxcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfYS5vZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWF0Y2hTdGFydCA9IGluZGV4O1xyXG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeFN0YXJ0ID0gbWF0Y2hJbmRleF8xO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1hdGNoRW5kID0gbWF0Y2hTdGFydCArIG1hdGNoLmxlbmd0aCArIG9mZnNldDtcclxuICAgICAgICAgICAgICAgIG1hdGNoSW5kZXhfMSA9IG1hdGNoRW5kO1xyXG4gICAgICAgICAgICAgICAgaWYgKHByZWZpeFN0YXJ0ICE9PSBtYXRjaFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZIYXNDb21tYV8xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyc18xLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJldHdlZW5WYWx1ZSA9IHZhbHVlLnN1YnN0cmluZyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXhTdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaFN0YXJ0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJldHdlZW5WYWx1ZVswXSA9PT0gXCIsXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXR3ZWVuVmFsdWUgPSBiZXR3ZWVuVmFsdWUuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJldHdlZW5WYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzXzEucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUuc3Vic3RyaW5nKHByZWZpeFN0YXJ0LCBtYXRjaFN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcHJldkhhc0NvbW1hXzEgPSBoYXNDb21tYSB8fCBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcInVybFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzXzEucHVzaChnZXRVUkxNb2RpZmllcl8xKG1hdGNoKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZ3JhZGllbnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyc18xLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEdyYWRpZW50TW9kaWZpZXJfMSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaDogbWF0Y2gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlR3JhZGllbnQ6IHR5cGVHcmFkaWVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0NvbW1hOiBoYXNDb21tYSB8fCBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpID09PSBtYXRjaGVzXzEubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyc18xLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUuc3Vic3RyaW5nKG1hdGNoRW5kKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IG1vZGlmaWVyc18xXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKG1vZGlmeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZ5KGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5zb21lKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByIGluc3RhbmNlb2YgUHJvbWlzZTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHJlc3VsdHMpLnRoZW4oZnVuY3Rpb24gKGFzeW5jUmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXN5bmNSZXN1bHRzLmZpbHRlcihCb29sZWFuKS5qb2luKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGNvbWJpbmVkUmVzdWx0ID0gcmVzdWx0cy5qb2luKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbWJpbmVkUmVzdWx0LmVuZHNXaXRoKFwiLCBpbml0aWFsXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbWJpbmVkUmVzdWx0LnNsaWNlKDAsIC05KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21iaW5lZFJlc3VsdDtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0U2hhZG93TW9kaWZpZXJXaXRoSW5mbyh2YWx1ZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleF8xID0gMDtcclxuICAgICAgICAgICAgdmFyIGNvbG9yTWF0Y2hlc18xID0gZ2V0TWF0Y2hlcyhcclxuICAgICAgICAgICAgICAgIC8oXnxcXHMpKD8hY2FsYykoW2Etel0rXFwoLis/XFwpfCNbMC05YS1mXSt8W2Etel0rKSguKj8oaW5zZXR8b3V0c2V0KT8oJHwsKSkvZ2ksXHJcbiAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgIDJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdmFyIG5vdFBhcnNlZF8xID0gMDtcclxuICAgICAgICAgICAgdmFyIG1vZGlmaWVyc18yID0gY29sb3JNYXRjaGVzXzEubWFwKGZ1bmN0aW9uIChtYXRjaCwgaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeEluZGV4ID0gaW5kZXhfMTtcclxuICAgICAgICAgICAgICAgIHZhciBtYXRjaEluZGV4ID0gdmFsdWUuaW5kZXhPZihtYXRjaCwgaW5kZXhfMSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWF0Y2hFbmQgPSBtYXRjaEluZGV4ICsgbWF0Y2gubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgaW5kZXhfMSA9IG1hdGNoRW5kO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJnYiA9IHBhcnNlQ29sb3JXaXRoQ2FjaGUobWF0Y2gpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyZ2IpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RQYXJzZWRfMSsrO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5zdWJzdHJpbmcocHJlZml4SW5kZXgsIG1hdGNoRW5kKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHZhbHVlLnN1YnN0cmluZyhwcmVmaXhJbmRleCwgbWF0Y2hJbmRleCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQobW9kaWZ5U2hhZG93Q29sb3IocmdiLCBmaWx0ZXIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9PT0gY29sb3JNYXRjaGVzXzEubGVuZ3RoIC0gMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdmFsdWUuc3Vic3RyaW5nKG1hdGNoRW5kKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kaWZpZWQgPSBtb2RpZmllcnNfMlxyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKG1vZGlmeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZ5KGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuam9pbihcIlwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc0xlbmd0aDogY29sb3JNYXRjaGVzXzEubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIHVucGFyc2VhYmxlTWF0Y2hlc0xlbmd0aDogbm90UGFyc2VkXzEsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBtb2RpZmllZFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0U2hhZG93TW9kaWZpZXIodmFsdWUpIHtcclxuICAgICAgICB2YXIgc2hhZG93TW9kaWZpZXIgPSBnZXRTaGFkb3dNb2RpZmllcldpdGhJbmZvKHZhbHVlKTtcclxuICAgICAgICBpZiAoIXNoYWRvd01vZGlmaWVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRoZW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzaGFkb3dNb2RpZmllcih0aGVtZSkucmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRWYXJpYWJsZU1vZGlmaWVyKFxyXG4gICAgICAgIHZhcmlhYmxlc1N0b3JlLFxyXG4gICAgICAgIHByb3AsXHJcbiAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgcnVsZSxcclxuICAgICAgICBpZ25vcmVkSW1nU2VsZWN0b3JzLFxyXG4gICAgICAgIGlzQ2FuY2VsbGVkXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4gdmFyaWFibGVzU3RvcmUuZ2V0TW9kaWZpZXJGb3JWYXJpYWJsZSh7XHJcbiAgICAgICAgICAgIHZhck5hbWU6IHByb3AsXHJcbiAgICAgICAgICAgIHNvdXJjZVZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgcnVsZTogcnVsZSxcclxuICAgICAgICAgICAgaWdub3JlZEltZ1NlbGVjdG9yczogaWdub3JlZEltZ1NlbGVjdG9ycyxcclxuICAgICAgICAgICAgaXNDYW5jZWxsZWQ6IGlzQ2FuY2VsbGVkXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRWYXJpYWJsZURlcGVuZGFudE1vZGlmaWVyKHZhcmlhYmxlc1N0b3JlLCBwcm9wLCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB2YXJpYWJsZXNTdG9yZS5nZXRNb2RpZmllckZvclZhckRlcGVuZGFudChwcm9wLCB2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjbGVhbk1vZGlmaWNhdGlvbkNhY2hlKCkge1xyXG4gICAgICAgIGNsZWFyQ29sb3JNb2RpZmljYXRpb25DYWNoZSgpO1xyXG4gICAgICAgIGltYWdlRGV0YWlsc0NhY2hlLmNsZWFyKCk7XHJcbiAgICAgICAgY2xlYW5JbWFnZVByb2Nlc3NpbmdDYWNoZSgpO1xyXG4gICAgICAgIGF3YWl0aW5nRm9ySW1hZ2VMb2FkaW5nLmNsZWFyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIFZBUl9UWVBFX0JHQ09MT1IgPSAxIDw8IDA7XHJcbiAgICB2YXIgVkFSX1RZUEVfVEVYVENPTE9SID0gMSA8PCAxO1xyXG4gICAgdmFyIFZBUl9UWVBFX0JPUkRFUkNPTE9SID0gMSA8PCAyO1xyXG4gICAgdmFyIFZBUl9UWVBFX0JHSU1HID0gMSA8PCAzO1xyXG4gICAgdmFyIFZhcmlhYmxlc1N0b3JlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmdW5jdGlvbiBWYXJpYWJsZXNTdG9yZSgpIHtcclxuICAgICAgICAgICAgdGhpcy52YXJUeXBlcyA9IG5ldyBNYXAoKTtcclxuICAgICAgICAgICAgdGhpcy5ydWxlc1F1ZXVlID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuaW5saW5lU3R5bGVRdWV1ZSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmRlZmluZWRWYXJzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICB0aGlzLnZhclJlZnMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgICAgIHRoaXMudW5rbm93bkNvbG9yVmFycyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgdGhpcy51bmtub3duQmdWYXJzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICB0aGlzLnVuZGVmaW5lZFZhcnMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFZhclR5cGVzID0gbmV3IE1hcCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZWRUeXBlVmFycyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgdGhpcy50eXBlQ2hhbmdlU3Vic2NyaXB0aW9ucyA9IG5ldyBNYXAoKTtcclxuICAgICAgICAgICAgdGhpcy51bnN0YWJsZVZhclZhbHVlcyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgVmFyaWFibGVzU3RvcmUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnZhclR5cGVzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMucnVsZXNRdWV1ZS5zcGxpY2UoMCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5saW5lU3R5bGVRdWV1ZS5zcGxpY2UoMCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGVmaW5lZFZhcnMuY2xlYXIoKTtcclxuICAgICAgICAgICAgdGhpcy52YXJSZWZzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMudW5rbm93bkNvbG9yVmFycy5jbGVhcigpO1xyXG4gICAgICAgICAgICB0aGlzLnVua25vd25CZ1ZhcnMuY2xlYXIoKTtcclxuICAgICAgICAgICAgdGhpcy51bmRlZmluZWRWYXJzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFZhclR5cGVzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlZFR5cGVWYXJzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZUNoYW5nZVN1YnNjcmlwdGlvbnMuY2xlYXIoKTtcclxuICAgICAgICAgICAgdGhpcy51bnN0YWJsZVZhclZhbHVlcy5jbGVhcigpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVmFyaWFibGVzU3RvcmUucHJvdG90eXBlLmlzVmFyVHlwZSA9IGZ1bmN0aW9uICh2YXJOYW1lLCB0eXBlTnVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhclR5cGVzLmhhcyh2YXJOYW1lKSAmJlxyXG4gICAgICAgICAgICAgICAgKHRoaXMudmFyVHlwZXMuZ2V0KHZhck5hbWUpICYgdHlwZU51bSkgPiAwXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuYWRkUnVsZXNGb3JNYXRjaGluZyA9IGZ1bmN0aW9uIChydWxlcykge1xyXG4gICAgICAgICAgICB0aGlzLnJ1bGVzUXVldWUucHVzaChydWxlcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuYWRkSW5saW5lU3R5bGVGb3JNYXRjaGluZyA9IGZ1bmN0aW9uIChzdHlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmlubGluZVN0eWxlUXVldWUucHVzaChzdHlsZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUubWF0Y2hWYXJpYWJsZXNBbmREZXBlbmRlbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJ1bGVzUXVldWUubGVuZ3RoID09PSAwICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmlubGluZVN0eWxlUXVldWUubGVuZ3RoID09PSAwXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlZFR5cGVWYXJzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFZhclR5cGVzID0gbmV3IE1hcCh0aGlzLnZhclR5cGVzKTtcclxuICAgICAgICAgICAgdGhpcy5jb2xsZWN0Um9vdFZhcmlhYmxlcygpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3RWYXJpYWJsZXNBbmRWYXJEZXAoKTtcclxuICAgICAgICAgICAgdGhpcy5jb2xsZWN0Um9vdFZhckRlcGVuZGVudHMoKTtcclxuICAgICAgICAgICAgdGhpcy52YXJSZWZzLmZvckVhY2goZnVuY3Rpb24gKHJlZnMsIHYpIHtcclxuICAgICAgICAgICAgICAgIHJlZnMuZm9yRWFjaChmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy52YXJUeXBlcy5oYXModikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVzb2x2ZVZhcmlhYmxlVHlwZShyLCBfdGhpcy52YXJUeXBlcy5nZXQodikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy51bmtub3duQ29sb3JWYXJzLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy51bmtub3duQmdWYXJzLmhhcyh2KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnVua25vd25Db2xvclZhcnMuZGVsZXRlKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnVua25vd25CZ1ZhcnMuZGVsZXRlKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmVWYXJpYWJsZVR5cGUodiwgVkFSX1RZUEVfQkdDT0xPUik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzVmFyVHlwZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgdixcclxuICAgICAgICAgICAgICAgICAgICAgICAgVkFSX1RZUEVfQkdDT0xPUiB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWQVJfVFlQRV9URVhUQ09MT1IgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVkFSX1RZUEVfQk9SREVSQ09MT1JcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy51bmtub3duQ29sb3JWYXJzLmRlbGV0ZSh2KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudW5kZWZpbmVkVmFycy5hZGQodik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnVua25vd25CZ1ZhcnMuZm9yRWFjaChmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhc0NvbG9yID1cclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5maW5kVmFyUmVmKHYsIGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnVua25vd25Db2xvclZhcnMuaGFzKHJlZikgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzVmFyVHlwZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVkFSX1RZUEVfVEVYVENPTE9SIHwgVkFSX1RZUEVfQk9SREVSQ09MT1JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSAhPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0NvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXRlcmF0ZVZhclJlZnModiwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZXNvbHZlVmFyaWFibGVUeXBlKHJlZiwgVkFSX1RZUEVfQkdDT0xPUik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzVmFyVHlwZSh2LCBWQVJfVFlQRV9CR0NPTE9SIHwgVkFSX1RZUEVfQkdJTUcpXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy51bmtub3duQmdWYXJzLmRlbGV0ZSh2KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudW5kZWZpbmVkVmFycy5hZGQodik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZWRUeXBlVmFycy5mb3JFYWNoKGZ1bmN0aW9uICh2YXJOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMudHlwZUNoYW5nZVN1YnNjcmlwdGlvbnMuaGFzKHZhck5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudHlwZUNoYW5nZVN1YnNjcmlwdGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh2YXJOYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VkVHlwZVZhcnMuY2xlYXIoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5nZXRNb2RpZmllckZvclZhcmlhYmxlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0aGVtZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhck5hbWUgPSBvcHRpb25zLnZhck5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWUgPSBvcHRpb25zLnNvdXJjZVZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUgPSBvcHRpb25zLnJ1bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWdub3JlZEltZ1NlbGVjdG9ycyA9IG9wdGlvbnMuaWdub3JlZEltZ1NlbGVjdG9ycyxcclxuICAgICAgICAgICAgICAgICAgICBpc0NhbmNlbGxlZCA9IG9wdGlvbnMuaXNDYW5jZWxsZWQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0RGVjbGFyYXRpb25zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWNsYXJhdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWRkTW9kaWZpZWRWYWx1ZSA9IGZ1bmN0aW9uIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZU51bSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyTmFtZVdyYXBwZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yTW9kaWZpZXJcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5pc1ZhclR5cGUodmFyTmFtZSwgdHlwZU51bSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHkgPSB2YXJOYW1lV3JhcHBlcih2YXJOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGlmaWVkVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1ZhckRlcGVuZGFudChzb3VyY2VWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbnN0cnVjdGVkQ29sb3JWYXIoc291cmNlVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5zZXJ0VmFyVmFsdWVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudW5zdGFibGVWYXJWYWx1ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZU51bSA9PT0gVkFSX1RZUEVfQkdDT0xPUlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCIjZmZmZmZmXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiIzAwMDAwMFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZFZhbHVlID0gY29sb3JNb2RpZmllcih2YWx1ZSwgdGhlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZFZhbHVlID0gcmVwbGFjZUNTU1ZhcmlhYmxlc05hbWVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YXJOYW1lV3JhcHBlcih2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JNb2RpZmllcihmYWxsYmFjaywgdGhlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkVmFsdWUgPSBjb2xvck1vZGlmaWVyKHNvdXJjZVZhbHVlLCB0aGVtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG1vZGlmaWVkVmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBhZGRNb2RpZmllZFZhbHVlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBWQVJfVFlQRV9CR0NPTE9SLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwQmdDb2xvclZhcmlhYmxlTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5TW9kaWZ5QmdDb2xvclxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkTW9kaWZpZWRWYWx1ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgVkFSX1RZUEVfVEVYVENPTE9SLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwVGV4dENvbG9yVmFyaWFibGVOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnlNb2RpZnlUZXh0Q29sb3JcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGFkZE1vZGlmaWVkVmFsdWUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFZBUl9UWVBFX0JPUkRFUkNPTE9SLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwQm9yZGVyQ29sb3JWYXJpYWJsZU5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeU1vZGlmeUJvcmRlckNvbG9yXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNWYXJUeXBlKHZhck5hbWUsIFZBUl9UWVBFX0JHSU1HKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHkgPSB3cmFwQmdJbWdWYXJpYWJsZU5hbWUodmFyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RpZmllZFZhbHVlID0gc291cmNlVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1ZhckRlcGVuZGFudChzb3VyY2VWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkVmFsdWUgPSByZXBsYWNlQ1NTVmFyaWFibGVzTmFtZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdyYXBCZ0NvbG9yVmFyaWFibGVOYW1lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnlNb2RpZnlCZ0NvbG9yKGZhbGxiYWNrLCB0aGVtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmdNb2RpZmllciA9IGdldEJnSW1hZ2VNb2RpZmllcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlZEltZ1NlbGVjdG9ycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2FuY2VsbGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkVmFsdWUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGJnTW9kaWZpZXIgPT09IFwiZnVuY3Rpb25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYmdNb2RpZmllcih0aGVtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGJnTW9kaWZpZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtb2RpZmllZFZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVjbGFyYXRpb25zO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBjYWxsYmFja3MgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWRkTGlzdGVuZXIgPSBmdW5jdGlvbiAob25UeXBlQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVjcyA9IGdldERlY2xhcmF0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvblR5cGVDaGFuZ2UoZGVjcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3MuYWRkKGNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVGb3JWYXJUeXBlQ2hhbmdlKHZhck5hbWUsIGNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51bnN1YnNjcmliZUZyb21WYXJpYWJsZVR5cGVDaGFuZ2VzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnM6IGdldERlY2xhcmF0aW9ucygpLFxyXG4gICAgICAgICAgICAgICAgICAgIG9uVHlwZUNoYW5nZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lcjogYWRkTGlzdGVuZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUxpc3RlbmVyczogcmVtb3ZlTGlzdGVuZXJzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5nZXRNb2RpZmllckZvclZhckRlcGVuZGFudCA9IGZ1bmN0aW9uIChcclxuICAgICAgICAgICAgcHJvcGVydHksXHJcbiAgICAgICAgICAgIHNvdXJjZVZhbHVlXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmIChzb3VyY2VWYWx1ZS5tYXRjaCgvXlxccyoocmdifGhzbClhP1xcKC8pKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNCZ18xID0gcHJvcGVydHkuc3RhcnRzV2l0aChcImJhY2tncm91bmRcIik7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNUZXh0XzEgPSBpc1RleHRDb2xvclByb3BlcnR5KHByb3BlcnR5KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodGhlbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBpbnNlcnRWYXJWYWx1ZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51bnN0YWJsZVZhclZhbHVlc1xyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGlzQmdfMSA/IFwiI2ZmZmZmZlwiIDogXCIjMDAwMDAwXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2RpZmllciA9IGlzQmdfMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRyeU1vZGlmeUJnQ29sb3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBpc1RleHRfMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gdHJ5TW9kaWZ5VGV4dENvbG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0cnlNb2RpZnlCb3JkZXJDb2xvcjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZXIodmFsdWUsIHRoZW1lKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBcImJhY2tncm91bmQtY29sb3JcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0aGVtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXBsYWNlQ1NTVmFyaWFibGVzTmFtZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdyYXBCZ0NvbG9yVmFyaWFibGVOYW1lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZmFsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnlNb2RpZnlCZ0NvbG9yKGZhbGxiYWNrLCB0aGVtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNUZXh0Q29sb3JQcm9wZXJ0eShwcm9wZXJ0eSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodGhlbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVwbGFjZUNTU1ZhcmlhYmxlc05hbWVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3cmFwVGV4dENvbG9yVmFyaWFibGVOYW1lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZmFsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnlNb2RpZnlUZXh0Q29sb3IoZmFsbGJhY2ssIHRoZW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5ID09PSBcImJhY2tncm91bmRcIiB8fFxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHkgPT09IFwiYmFja2dyb3VuZC1pbWFnZVwiIHx8XHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9PT0gXCJib3gtc2hhZG93XCJcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVua25vd25WYXJzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2RpZnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZVJlcGxhY2VkID0gcmVwbGFjZUNTU1ZhcmlhYmxlc05hbWVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc1ZhclR5cGUodiwgVkFSX1RZUEVfQkdDT0xPUikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdyYXBCZ0NvbG9yVmFyaWFibGVOYW1lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNWYXJUeXBlKHYsIFZBUl9UWVBFX0JHSU1HKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd3JhcEJnSW1nVmFyaWFibGVOYW1lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmtub3duVmFycy5hZGQodik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyeU1vZGlmeUJnQ29sb3IoZmFsbGJhY2ssIHRoZW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBcImJveC1zaGFkb3dcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYWRvd01vZGlmaWVyID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTaGFkb3dNb2RpZmllcldpdGhJbmZvKHZhcmlhYmxlUmVwbGFjZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGlmaWVkU2hhZG93ID0gc2hhZG93TW9kaWZpZXIodGhlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkU2hhZG93LnVucGFyc2VhYmxlTWF0Y2hlc0xlbmd0aCAhPT1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZFNoYWRvdy5tYXRjaGVzTGVuZ3RoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZWRTaGFkb3cucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YXJpYWJsZVJlcGxhY2VkO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGlmaWVkID0gbW9kaWZ5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVua25vd25WYXJzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0VW5rbm93blZhciA9IHVua25vd25WYXJzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlcygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm5leHQoKS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51bnN1YnNjcmliZUZyb21WYXJpYWJsZVR5cGVDaGFuZ2VzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFVua25vd25WYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBtb2RpZnkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVGb3JWYXJUeXBlQ2hhbmdlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0VW5rbm93blZhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllZDtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHkuc3RhcnRzV2l0aChcImJvcmRlclwiKSB8fFxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHkuc3RhcnRzV2l0aChcIm91dGxpbmVcIilcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VDU1NWYXJpYWJsZXNOYW1lcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd3JhcEJvcmRlckNvbG9yVmFyaWFibGVOYW1lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZmFsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnlNb2RpZnlCb3JkZXJDb2xvcihmYWxsYmFjaywgdGhlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuc3Vic2NyaWJlRm9yVmFyVHlwZUNoYW5nZSA9IGZ1bmN0aW9uIChcclxuICAgICAgICAgICAgdmFyTmFtZSxcclxuICAgICAgICAgICAgY2FsbGJhY2tcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnR5cGVDaGFuZ2VTdWJzY3JpcHRpb25zLmhhcyh2YXJOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50eXBlQ2hhbmdlU3Vic2NyaXB0aW9ucy5zZXQodmFyTmFtZSwgbmV3IFNldCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcm9vdFN0b3JlID0gdGhpcy50eXBlQ2hhbmdlU3Vic2NyaXB0aW9ucy5nZXQodmFyTmFtZSk7XHJcbiAgICAgICAgICAgIGlmICghcm9vdFN0b3JlLmhhcyhjYWxsYmFjaykpIHtcclxuICAgICAgICAgICAgICAgIHJvb3RTdG9yZS5hZGQoY2FsbGJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUudW5zdWJzY3JpYmVGcm9tVmFyaWFibGVUeXBlQ2hhbmdlcyA9IGZ1bmN0aW9uIChcclxuICAgICAgICAgICAgdmFyTmFtZSxcclxuICAgICAgICAgICAgY2FsbGJhY2tcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudHlwZUNoYW5nZVN1YnNjcmlwdGlvbnMuaGFzKHZhck5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGVDaGFuZ2VTdWJzY3JpcHRpb25zLmdldCh2YXJOYW1lKS5kZWxldGUoY2FsbGJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuY29sbGVjdFZhcmlhYmxlc0FuZFZhckRlcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5ydWxlc1F1ZXVlLmZvckVhY2goZnVuY3Rpb24gKHJ1bGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVyYXRlQ1NTUnVsZXMocnVsZXMsIGZ1bmN0aW9uIChydWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUuc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29sbGVjdFZhcnNGcm9tQ1NTRGVjbGFyYXRpb25zKHJ1bGUuc3R5bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5pbmxpbmVTdHlsZVF1ZXVlLmZvckVhY2goZnVuY3Rpb24gKHN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jb2xsZWN0VmFyc0Zyb21DU1NEZWNsYXJhdGlvbnMoc3R5bGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5ydWxlc1F1ZXVlLnNwbGljZSgwKTtcclxuICAgICAgICAgICAgdGhpcy5pbmxpbmVTdHlsZVF1ZXVlLnNwbGljZSgwKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5jb2xsZWN0VmFyc0Zyb21DU1NEZWNsYXJhdGlvbnMgPSBmdW5jdGlvbiAoXHJcbiAgICAgICAgICAgIHN0eWxlXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIGl0ZXJhdGVDU1NEZWNsYXJhdGlvbnMoc3R5bGUsIGZ1bmN0aW9uIChwcm9wZXJ0eSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc1ZhcmlhYmxlKHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmluc3BlY3RWYXJpYWJsZShwcm9wZXJ0eSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGlzVmFyRGVwZW5kYW50KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmluc3BlY3RWYXJEZXBlbmRhbnQocHJvcGVydHksIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuc2hvdWxkUHJvY2Vzc1Jvb3RWYXJpYWJsZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgIHRoaXMucnVsZXNRdWV1ZS5sZW5ndGggPiAwICYmXHJcbiAgICAgICAgICAgICAgICAoKF9hID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZShcInN0eWxlXCIpKSA9PT1cclxuICAgICAgICAgICAgICAgICAgICBudWxsIHx8IF9hID09PSB2b2lkIDBcclxuICAgICAgICAgICAgICAgICAgICA/IHZvaWQgMFxyXG4gICAgICAgICAgICAgICAgICAgIDogX2EuaW5jbHVkZXMoXCItLVwiKSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5jb2xsZWN0Um9vdFZhcmlhYmxlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNob3VsZFByb2Nlc3NSb290VmFyaWFibGVzKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdGVyYXRlQ1NTRGVjbGFyYXRpb25zKFxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1ZhcmlhYmxlKHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbnNwZWN0VmFyaWFibGUocHJvcGVydHksIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuaW5zcGVjdFZhcmlhYmxlID0gZnVuY3Rpb24gKHZhck5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMudW5zdGFibGVWYXJWYWx1ZXMuc2V0KHZhck5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKGlzVmFyRGVwZW5kYW50KHZhbHVlKSAmJiBpc0NvbnN0cnVjdGVkQ29sb3JWYXIodmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVua25vd25Db2xvclZhcnMuYWRkKHZhck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWZpbmVkVmFycy5hZGQodmFyTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGVmaW5lZFZhcnMuaGFzKHZhck5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZWZpbmVkVmFycy5hZGQodmFyTmFtZSk7XHJcbiAgICAgICAgICAgIHZhciBpc0NvbG9yID1cclxuICAgICAgICAgICAgICAgIHJhd1ZhbHVlUmVnZXgudGVzdCh2YWx1ZSkgfHwgcGFyc2VDb2xvcldpdGhDYWNoZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIGlmIChpc0NvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVua25vd25Db2xvclZhcnMuYWRkKHZhck5hbWUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgdmFsdWUuaW5jbHVkZXMoXCJ1cmwoXCIpIHx8XHJcbiAgICAgICAgICAgICAgICB2YWx1ZS5pbmNsdWRlcyhcImxpbmVhci1ncmFkaWVudChcIikgfHxcclxuICAgICAgICAgICAgICAgIHZhbHVlLmluY2x1ZGVzKFwicmFkaWFsLWdyYWRpZW50KFwiKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZVZhcmlhYmxlVHlwZSh2YXJOYW1lLCBWQVJfVFlQRV9CR0lNRyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5yZXNvbHZlVmFyaWFibGVUeXBlID0gZnVuY3Rpb24gKFxyXG4gICAgICAgICAgICB2YXJOYW1lLFxyXG4gICAgICAgICAgICB0eXBlTnVtXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHZhciBpbml0aWFsVHlwZSA9IHRoaXMuaW5pdGlhbFZhclR5cGVzLmdldCh2YXJOYW1lKSB8fCAwO1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudFR5cGUgPSB0aGlzLnZhclR5cGVzLmdldCh2YXJOYW1lKSB8fCAwO1xyXG4gICAgICAgICAgICB2YXIgbmV3VHlwZSA9IGN1cnJlbnRUeXBlIHwgdHlwZU51bTtcclxuICAgICAgICAgICAgdGhpcy52YXJUeXBlcy5zZXQodmFyTmFtZSwgbmV3VHlwZSk7XHJcbiAgICAgICAgICAgIGlmIChuZXdUeXBlICE9PSBpbml0aWFsVHlwZSB8fCB0aGlzLnVuZGVmaW5lZFZhcnMuaGFzKHZhck5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZWRUeXBlVmFycy5hZGQodmFyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVuZGVmaW5lZFZhcnMuZGVsZXRlKHZhck5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudW5rbm93bkNvbG9yVmFycy5kZWxldGUodmFyTmFtZSk7XHJcbiAgICAgICAgICAgIHRoaXMudW5rbm93bkJnVmFycy5kZWxldGUodmFyTmFtZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuY29sbGVjdFJvb3RWYXJEZXBlbmRlbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2hvdWxkUHJvY2Vzc1Jvb3RWYXJpYWJsZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGl0ZXJhdGVDU1NEZWNsYXJhdGlvbnMoXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUsXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAocHJvcGVydHksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFyRGVwZW5kYW50KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbnNwZWN0VmFyRGVwZW5kYW50KHByb3BlcnR5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVmFyaWFibGVzU3RvcmUucHJvdG90eXBlLmluc3BlY3RWYXJEZXBlbmRhbnQgPSBmdW5jdGlvbiAoXHJcbiAgICAgICAgICAgIHByb3BlcnR5LFxyXG4gICAgICAgICAgICB2YWx1ZVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoaXNWYXJpYWJsZShwcm9wZXJ0eSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlcmF0ZVZhckRlcHModmFsdWUsIGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIV90aGlzLnZhclJlZnMuaGFzKHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy52YXJSZWZzLnNldChwcm9wZXJ0eSwgbmV3IFNldCgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmFyUmVmcy5nZXQocHJvcGVydHkpLmFkZChyZWYpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9PT0gXCJiYWNrZ3JvdW5kLWNvbG9yXCIgfHxcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5ID09PSBcImJveC1zaGFkb3dcIlxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlcmF0ZVZhckRlcHModmFsdWUsIGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlc29sdmVWYXJpYWJsZVR5cGUodiwgVkFSX1RZUEVfQkdDT0xPUik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1RleHRDb2xvclByb3BlcnR5KHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVyYXRlVmFyRGVwcyh2YWx1ZSwgZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVzb2x2ZVZhcmlhYmxlVHlwZSh2LCBWQVJfVFlQRV9URVhUQ09MT1IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eS5zdGFydHNXaXRoKFwiYm9yZGVyXCIpIHx8XHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eS5zdGFydHNXaXRoKFwib3V0bGluZVwiKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlcmF0ZVZhckRlcHModmFsdWUsIGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlc29sdmVWYXJpYWJsZVR5cGUodiwgVkFSX1RZUEVfQk9SREVSQ09MT1IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9PT0gXCJiYWNrZ3JvdW5kXCIgfHxcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5ID09PSBcImJhY2tncm91bmQtaW1hZ2VcIlxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlcmF0ZVZhckRlcHModmFsdWUsIGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzVmFyVHlwZSh2LCBWQVJfVFlQRV9CR0NPTE9SIHwgVkFSX1RZUEVfQkdJTUcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzQmdDb2xvciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbmRWYXJSZWYodiwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51bmtub3duQ29sb3JWYXJzLmhhcyhyZWYpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNWYXJUeXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZBUl9UWVBFX1RFWFRDT0xPUiB8IFZBUl9UWVBFX0JPUkRFUkNPTE9SXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkgIT0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pdGVyYXRlVmFyUmVmcyh2LCBmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0JnQ29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmVWYXJpYWJsZVR5cGUocmVmLCBWQVJfVFlQRV9CR0NPTE9SKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnVua25vd25CZ1ZhcnMuYWRkKHJlZik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuaXRlcmF0ZVZhckRlcHMgPSBmdW5jdGlvbiAodmFsdWUsIGl0ZXJhdG9yKSB7XHJcbiAgICAgICAgICAgIHZhciB2YXJEZXBzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICBpdGVyYXRlVmFyRGVwZW5kZW5jaWVzKHZhbHVlLCBmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhckRlcHMuYWRkKHYpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyRGVwcy5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlcmF0b3Iodik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVmFyaWFibGVzU3RvcmUucHJvdG90eXBlLmZpbmRWYXJSZWYgPSBmdW5jdGlvbiAoXHJcbiAgICAgICAgICAgIHZhck5hbWUsXHJcbiAgICAgICAgICAgIGl0ZXJhdG9yLFxyXG4gICAgICAgICAgICBzdGFja1xyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB2YXIgZV8xLCBfYTtcclxuICAgICAgICAgICAgaWYgKHN0YWNrID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgICAgIHN0YWNrID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzdGFjay5oYXModmFyTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN0YWNrLmFkZCh2YXJOYW1lKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGl0ZXJhdG9yKHZhck5hbWUpO1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFyTmFtZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcmVmcyA9IHRoaXMudmFyUmVmcy5nZXQodmFyTmFtZSk7XHJcbiAgICAgICAgICAgIGlmICghcmVmcyB8fCByZWZzLnNpemUgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWZzXzEgPSBfX3ZhbHVlcyhyZWZzKSwgcmVmc18xXzEgPSByZWZzXzEubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICFyZWZzXzFfMS5kb25lO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZnNfMV8xID0gcmVmc18xLm5leHQoKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZiA9IHJlZnNfMV8xLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IHRoaXMuZmluZFZhclJlZihyZWYsIGl0ZXJhdG9yLCBzdGFjayk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3VuZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVfMV8xKSB7XHJcbiAgICAgICAgICAgICAgICBlXzEgPSB7ZXJyb3I6IGVfMV8xfTtcclxuICAgICAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZnNfMV8xICYmICFyZWZzXzFfMS5kb25lICYmIChfYSA9IHJlZnNfMS5yZXR1cm4pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5jYWxsKHJlZnNfMSk7XHJcbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5pdGVyYXRlVmFyUmVmcyA9IGZ1bmN0aW9uICh2YXJOYW1lLCBpdGVyYXRvcikge1xyXG4gICAgICAgICAgICB0aGlzLmZpbmRWYXJSZWYodmFyTmFtZSwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICAgICAgaXRlcmF0b3IocmVmKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBWYXJpYWJsZXNTdG9yZS5wcm90b3R5cGUuc2V0T25Sb290VmFyaWFibGVDaGFuZ2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5vblJvb3RWYXJpYWJsZURlZmluZWQgPSBjYWxsYmFjaztcclxuICAgICAgICB9O1xyXG4gICAgICAgIFZhcmlhYmxlc1N0b3JlLnByb3RvdHlwZS5wdXRSb290VmFycyA9IGZ1bmN0aW9uIChzdHlsZUVsZW1lbnQsIHRoZW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBlXzIsIF9hO1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgc2hlZXQgPSBzdHlsZUVsZW1lbnQuc2hlZXQ7XHJcbiAgICAgICAgICAgIGlmIChzaGVldC5jc3NSdWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzaGVldC5kZWxldGVSdWxlKDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBkZWNsYXJhdGlvbnMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgICAgIGl0ZXJhdGVDU1NEZWNsYXJhdGlvbnMoXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUsXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAocHJvcGVydHksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFyaWFibGUocHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc1ZhclR5cGUocHJvcGVydHksIFZBUl9UWVBFX0JHQ09MT1IpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnMuc2V0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBCZ0NvbG9yVmFyaWFibGVOYW1lKHByb3BlcnR5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlNb2RpZnlCZ0NvbG9yKHZhbHVlLCB0aGVtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzVmFyVHlwZShwcm9wZXJ0eSwgVkFSX1RZUEVfVEVYVENPTE9SKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zLnNldChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cmFwVGV4dENvbG9yVmFyaWFibGVOYW1lKHByb3BlcnR5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlNb2RpZnlUZXh0Q29sb3IodmFsdWUsIHRoZW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNWYXJUeXBlKHByb3BlcnR5LCBWQVJfVFlQRV9CT1JERVJDT0xPUikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5zZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcEJvcmRlckNvbG9yVmFyaWFibGVOYW1lKHByb3BlcnR5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlNb2RpZnlCb3JkZXJDb2xvcih2YWx1ZSwgdGhlbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZUZvclZhclR5cGVDaGFuZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm9uUm9vdFZhcmlhYmxlRGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdmFyIGNzc0xpbmVzID0gW107XHJcbiAgICAgICAgICAgIGNzc0xpbmVzLnB1c2goXCI6cm9vdCB7XCIpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVjbGFyYXRpb25zXzEgPSBfX3ZhbHVlcyhkZWNsYXJhdGlvbnMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnNfMV8xID0gZGVjbGFyYXRpb25zXzEubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICFkZWNsYXJhdGlvbnNfMV8xLmRvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zXzFfMSA9IGRlY2xhcmF0aW9uc18xLm5leHQoKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKGRlY2xhcmF0aW9uc18xXzEudmFsdWUsIDIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IF9iWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IF9iWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNzc0xpbmVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgIFwiLmNvbmNhdChwcm9wZXJ0eSwgXCI6IFwiKS5jb25jYXQodmFsdWUsIFwiO1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVfMl8xKSB7XHJcbiAgICAgICAgICAgICAgICBlXzIgPSB7ZXJyb3I6IGVfMl8xfTtcclxuICAgICAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnNfMV8xICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICFkZWNsYXJhdGlvbnNfMV8xLmRvbmUgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKF9hID0gZGVjbGFyYXRpb25zXzEucmV0dXJuKVxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EuY2FsbChkZWNsYXJhdGlvbnNfMSk7XHJcbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjc3NMaW5lcy5wdXNoKFwifVwiKTtcclxuICAgICAgICAgICAgdmFyIGNzc1RleHQgPSBjc3NMaW5lcy5qb2luKFwiXFxuXCIpO1xyXG4gICAgICAgICAgICBzaGVldC5pbnNlcnRSdWxlKGNzc1RleHQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIFZhcmlhYmxlc1N0b3JlO1xyXG4gICAgfSkoKTtcclxuICAgIHZhciB2YXJpYWJsZXNTdG9yZSA9IG5ldyBWYXJpYWJsZXNTdG9yZSgpO1xyXG4gICAgZnVuY3Rpb24gZ2V0VmFyaWFibGVSYW5nZShpbnB1dCwgc2VhcmNoU3RhcnQpIHtcclxuICAgICAgICBpZiAoc2VhcmNoU3RhcnQgPT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICBzZWFyY2hTdGFydCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdGFydCA9IGlucHV0LmluZGV4T2YoXCJ2YXIoXCIsIHNlYXJjaFN0YXJ0KTtcclxuICAgICAgICBpZiAoc3RhcnQgPj0gMCkge1xyXG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBnZXRQYXJlbnRoZXNlc1JhbmdlKGlucHV0LCBzdGFydCArIDMpO1xyXG4gICAgICAgICAgICBpZiAocmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7c3RhcnQ6IHN0YXJ0LCBlbmQ6IHJhbmdlLmVuZH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRWYXJpYWJsZXNNYXRjaGVzKGlucHV0KSB7XHJcbiAgICAgICAgdmFyIHJhbmdlcyA9IFtdO1xyXG4gICAgICAgIHZhciBpID0gMDtcclxuICAgICAgICB2YXIgcmFuZ2U7XHJcbiAgICAgICAgd2hpbGUgKChyYW5nZSA9IGdldFZhcmlhYmxlUmFuZ2UoaW5wdXQsIGkpKSkge1xyXG4gICAgICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydCxcclxuICAgICAgICAgICAgICAgIGVuZCA9IHJhbmdlLmVuZDtcclxuICAgICAgICAgICAgcmFuZ2VzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxyXG4gICAgICAgICAgICAgICAgZW5kOiBlbmQsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogaW5wdXQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpID0gcmFuZ2UuZW5kICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJhbmdlcztcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlcGxhY2VWYXJpYWJsZXNNYXRjaGVzKGlucHV0LCByZXBsYWNlcikge1xyXG4gICAgICAgIHZhciBtYXRjaGVzID0gZ2V0VmFyaWFibGVzTWF0Y2hlcyhpbnB1dCk7XHJcbiAgICAgICAgdmFyIG1hdGNoZXNDb3VudCA9IG1hdGNoZXMubGVuZ3RoO1xyXG4gICAgICAgIGlmIChtYXRjaGVzQ291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgdmFyIHJlcGxhY2VtZW50cyA9IG1hdGNoZXMubWFwKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXBsYWNlcihtLnZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgcGFydHMgPSBbXTtcclxuICAgICAgICBwYXJ0cy5wdXNoKGlucHV0LnN1YnN0cmluZygwLCBtYXRjaGVzWzBdLnN0YXJ0KSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRjaGVzQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICBwYXJ0cy5wdXNoKHJlcGxhY2VtZW50c1tpXSk7XHJcbiAgICAgICAgICAgIHZhciBzdGFydCA9IG1hdGNoZXNbaV0uZW5kO1xyXG4gICAgICAgICAgICB2YXIgZW5kID0gaSA8IG1hdGNoZXNDb3VudCAtIDEgPyBtYXRjaGVzW2kgKyAxXS5zdGFydCA6IGlucHV0TGVuZ3RoO1xyXG4gICAgICAgICAgICBwYXJ0cy5wdXNoKGlucHV0LnN1YnN0cmluZyhzdGFydCwgZW5kKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKFwiXCIpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0VmFyaWFibGVOYW1lQW5kRmFsbGJhY2sobWF0Y2gpIHtcclxuICAgICAgICB2YXIgY29tbWFJbmRleCA9IG1hdGNoLmluZGV4T2YoXCIsXCIpO1xyXG4gICAgICAgIHZhciBuYW1lO1xyXG4gICAgICAgIHZhciBmYWxsYmFjaztcclxuICAgICAgICBpZiAoY29tbWFJbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBtYXRjaC5zdWJzdHJpbmcoNCwgY29tbWFJbmRleCkudHJpbSgpO1xyXG4gICAgICAgICAgICBmYWxsYmFjayA9IG1hdGNoLnN1YnN0cmluZyhjb21tYUluZGV4ICsgMSwgbWF0Y2gubGVuZ3RoIC0gMSkudHJpbSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBtYXRjaC5zdWJzdHJpbmcoNCwgbWF0Y2gubGVuZ3RoIC0gMSkudHJpbSgpO1xyXG4gICAgICAgICAgICBmYWxsYmFjayA9IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7bmFtZTogbmFtZSwgZmFsbGJhY2s6IGZhbGxiYWNrfTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlcGxhY2VDU1NWYXJpYWJsZXNOYW1lcyh2YWx1ZSwgbmFtZVJlcGxhY2VyLCBmYWxsYmFja1JlcGxhY2VyKSB7XHJcbiAgICAgICAgdmFyIG1hdGNoUmVwbGFjZXIgPSBmdW5jdGlvbiAobWF0Y2gpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gZ2V0VmFyaWFibGVOYW1lQW5kRmFsbGJhY2sobWF0Y2gpLFxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IF9hLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBmYWxsYmFjayA9IF9hLmZhbGxiYWNrO1xyXG4gICAgICAgICAgICB2YXIgbmV3TmFtZSA9IG5hbWVSZXBsYWNlcihuYW1lKTtcclxuICAgICAgICAgICAgaWYgKCFmYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidmFyKFwiLmNvbmNhdChuZXdOYW1lLCBcIilcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG5ld0ZhbGxiYWNrO1xyXG4gICAgICAgICAgICBpZiAoaXNWYXJEZXBlbmRhbnQoZmFsbGJhY2spKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdGYWxsYmFjayA9IHJlcGxhY2VDU1NWYXJpYWJsZXNOYW1lcyhcclxuICAgICAgICAgICAgICAgICAgICBmYWxsYmFjayxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lUmVwbGFjZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgZmFsbGJhY2tSZXBsYWNlclxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmYWxsYmFja1JlcGxhY2VyKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdGYWxsYmFjayA9IGZhbGxiYWNrUmVwbGFjZXIoZmFsbGJhY2spO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3RmFsbGJhY2sgPSBmYWxsYmFjaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gXCJ2YXIoXCIuY29uY2F0KG5ld05hbWUsIFwiLCBcIikuY29uY2F0KG5ld0ZhbGxiYWNrLCBcIilcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gcmVwbGFjZVZhcmlhYmxlc01hdGNoZXModmFsdWUsIG1hdGNoUmVwbGFjZXIpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaXRlcmF0ZVZhckRlcGVuZGVuY2llcyh2YWx1ZSwgaXRlcmF0b3IpIHtcclxuICAgICAgICByZXBsYWNlQ1NTVmFyaWFibGVzTmFtZXModmFsdWUsIGZ1bmN0aW9uICh2YXJOYW1lKSB7XHJcbiAgICAgICAgICAgIGl0ZXJhdG9yKHZhck5hbWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmFyTmFtZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHdyYXBCZ0NvbG9yVmFyaWFibGVOYW1lKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gXCItLWRhcmtyZWFkZXItYmdcIi5jb25jYXQobmFtZSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB3cmFwVGV4dENvbG9yVmFyaWFibGVOYW1lKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gXCItLWRhcmtyZWFkZXItdGV4dFwiLmNvbmNhdChuYW1lKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHdyYXBCb3JkZXJDb2xvclZhcmlhYmxlTmFtZShuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiLS1kYXJrcmVhZGVyLWJvcmRlclwiLmNvbmNhdChuYW1lKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHdyYXBCZ0ltZ1ZhcmlhYmxlTmFtZShuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiLS1kYXJrcmVhZGVyLWJnaW1nXCIuY29uY2F0KG5hbWUpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaXNWYXJpYWJsZShwcm9wZXJ0eSkge1xyXG4gICAgICAgIHJldHVybiBwcm9wZXJ0eS5zdGFydHNXaXRoKFwiLS1cIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpc1ZhckRlcGVuZGFudCh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZS5pbmNsdWRlcyhcInZhcihcIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpc0NvbnN0cnVjdGVkQ29sb3JWYXIodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUubWF0Y2goL15cXHMqKHJnYnxoc2wpYT9cXCgvKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGlzVGV4dENvbG9yUHJvcGVydHkocHJvcGVydHkpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICBwcm9wZXJ0eSA9PT0gXCJjb2xvclwiIHx8XHJcbiAgICAgICAgICAgIHByb3BlcnR5ID09PSBcImNhcmV0LWNvbG9yXCIgfHxcclxuICAgICAgICAgICAgcHJvcGVydHkgPT09IFwiLXdlYmtpdC10ZXh0LWZpbGwtY29sb3JcIlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICB2YXIgcmF3VmFsdWVSZWdleCA9IC9eXFxkezEsM30sID9cXGR7MSwzfSwgP1xcZHsxLDN9JC87XHJcbiAgICBmdW5jdGlvbiBwYXJzZVJhd1ZhbHVlKGNvbG9yKSB7XHJcbiAgICAgICAgaWYgKHJhd1ZhbHVlUmVnZXgudGVzdChjb2xvcikpIHtcclxuICAgICAgICAgICAgdmFyIHNwbGl0dGVkID0gY29sb3Iuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0SW5SR0JfMSA9IFwicmdiKFwiO1xyXG4gICAgICAgICAgICBzcGxpdHRlZC5mb3JFYWNoKGZ1bmN0aW9uIChudW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdEluUkdCXzEgKz0gXCJcIi5jb25jYXQobnVtYmVyLnRyaW0oKSwgXCIsIFwiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc3VsdEluUkdCXzEgPSByZXN1bHRJblJHQl8xLnN1YnN0cmluZyhcclxuICAgICAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgICAgICByZXN1bHRJblJHQl8xLmxlbmd0aCAtIDJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmVzdWx0SW5SR0JfMSArPSBcIilcIjtcclxuICAgICAgICAgICAgcmV0dXJuIHtpc1JhdzogdHJ1ZSwgY29sb3I6IHJlc3VsdEluUkdCXzF9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge2lzUmF3OiBmYWxzZSwgY29sb3I6IGNvbG9yfTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGhhbmRsZVJhd1ZhbHVlKGNvbG9yLCB0aGVtZSwgbW9kaWZ5RnVuY3Rpb24pIHtcclxuICAgICAgICB2YXIgX2EgPSBwYXJzZVJhd1ZhbHVlKGNvbG9yKSxcclxuICAgICAgICAgICAgaXNSYXcgPSBfYS5pc1JhdyxcclxuICAgICAgICAgICAgbmV3Q29sb3IgPSBfYS5jb2xvcjtcclxuICAgICAgICB2YXIgcmdiID0gcGFyc2VDb2xvcldpdGhDYWNoZShuZXdDb2xvcik7XHJcbiAgICAgICAgaWYgKHJnYikge1xyXG4gICAgICAgICAgICB2YXIgb3V0cHV0Q29sb3IgPSBtb2RpZnlGdW5jdGlvbihyZ2IsIHRoZW1lKTtcclxuICAgICAgICAgICAgaWYgKGlzUmF3KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0SW5SR0IgPSBwYXJzZUNvbG9yV2l0aENhY2hlKG91dHB1dENvbG9yKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXRJblJHQlxyXG4gICAgICAgICAgICAgICAgICAgID8gXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQob3V0cHV0SW5SR0IuciwgXCIsIFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQob3V0cHV0SW5SR0IuZywgXCIsIFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQob3V0cHV0SW5SR0IuYilcclxuICAgICAgICAgICAgICAgICAgICA6IG91dHB1dENvbG9yO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvdXRwdXRDb2xvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ld0NvbG9yO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdHJ5TW9kaWZ5QmdDb2xvcihjb2xvciwgdGhlbWUpIHtcclxuICAgICAgICByZXR1cm4gaGFuZGxlUmF3VmFsdWUoY29sb3IsIHRoZW1lLCBtb2RpZnlCYWNrZ3JvdW5kQ29sb3IpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdHJ5TW9kaWZ5VGV4dENvbG9yKGNvbG9yLCB0aGVtZSkge1xyXG4gICAgICAgIHJldHVybiBoYW5kbGVSYXdWYWx1ZShjb2xvciwgdGhlbWUsIG1vZGlmeUZvcmVncm91bmRDb2xvcik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB0cnlNb2RpZnlCb3JkZXJDb2xvcihjb2xvciwgdGhlbWUpIHtcclxuICAgICAgICByZXR1cm4gaGFuZGxlUmF3VmFsdWUoY29sb3IsIHRoZW1lLCBtb2RpZnlCb3JkZXJDb2xvcik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpbnNlcnRWYXJWYWx1ZXMoc291cmNlLCB2YXJWYWx1ZXMsIHN0YWNrKSB7XHJcbiAgICAgICAgaWYgKHN0YWNrID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgc3RhY2sgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb250YWluc1VucmVzb2x2ZWRWYXIgPSBmYWxzZTtcclxuICAgICAgICB2YXIgbWF0Y2hSZXBsYWNlciA9IGZ1bmN0aW9uIChtYXRjaCkge1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBnZXRWYXJpYWJsZU5hbWVBbmRGYWxsYmFjayhtYXRjaCksXHJcbiAgICAgICAgICAgICAgICBuYW1lID0gX2EubmFtZSxcclxuICAgICAgICAgICAgICAgIGZhbGxiYWNrID0gX2EuZmFsbGJhY2s7XHJcbiAgICAgICAgICAgIGlmIChzdGFjay5oYXMobmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5zVW5yZXNvbHZlZFZhciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdGFjay5hZGQobmFtZSk7XHJcbiAgICAgICAgICAgIHZhciB2YXJWYWx1ZSA9IHZhclZhbHVlcy5nZXQobmFtZSkgfHwgZmFsbGJhY2s7XHJcbiAgICAgICAgICAgIHZhciBpbnNlcnRlZCA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh2YXJWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzVmFyRGVwZW5kYW50KHZhclZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc2VydGVkID0gaW5zZXJ0VmFyVmFsdWVzKHZhclZhbHVlLCB2YXJWYWx1ZXMsIHN0YWNrKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ZWQgPSB2YXJWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWluc2VydGVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluc1VucmVzb2x2ZWRWYXIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGluc2VydGVkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHJlcGxhY2VkID0gcmVwbGFjZVZhcmlhYmxlc01hdGNoZXMoc291cmNlLCBtYXRjaFJlcGxhY2VyKTtcclxuICAgICAgICBpZiAoY29udGFpbnNVbnJlc29sdmVkVmFyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVwbGFjZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG92ZXJyaWRlcyQxID0ge1xyXG4gICAgICAgIFwiYmFja2dyb3VuZC1jb2xvclwiOiB7XHJcbiAgICAgICAgICAgIGN1c3RvbVByb3A6IFwiLS1kYXJrcmVhZGVyLWlubGluZS1iZ2NvbG9yXCIsXHJcbiAgICAgICAgICAgIGNzc1Byb3A6IFwiYmFja2dyb3VuZC1jb2xvclwiLFxyXG4gICAgICAgICAgICBkYXRhQXR0cjogXCJkYXRhLWRhcmtyZWFkZXItaW5saW5lLWJnY29sb3JcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJiYWNrZ3JvdW5kLWltYWdlXCI6IHtcclxuICAgICAgICAgICAgY3VzdG9tUHJvcDogXCItLWRhcmtyZWFkZXItaW5saW5lLWJnaW1hZ2VcIixcclxuICAgICAgICAgICAgY3NzUHJvcDogXCJiYWNrZ3JvdW5kLWltYWdlXCIsXHJcbiAgICAgICAgICAgIGRhdGFBdHRyOiBcImRhdGEtZGFya3JlYWRlci1pbmxpbmUtYmdpbWFnZVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImJvcmRlci1jb2xvclwiOiB7XHJcbiAgICAgICAgICAgIGN1c3RvbVByb3A6IFwiLS1kYXJrcmVhZGVyLWlubGluZS1ib3JkZXJcIixcclxuICAgICAgICAgICAgY3NzUHJvcDogXCJib3JkZXItY29sb3JcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1ib3JkZXJcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJib3JkZXItYm90dG9tLWNvbG9yXCI6IHtcclxuICAgICAgICAgICAgY3VzdG9tUHJvcDogXCItLWRhcmtyZWFkZXItaW5saW5lLWJvcmRlci1ib3R0b21cIixcclxuICAgICAgICAgICAgY3NzUHJvcDogXCJib3JkZXItYm90dG9tLWNvbG9yXCIsXHJcbiAgICAgICAgICAgIGRhdGFBdHRyOiBcImRhdGEtZGFya3JlYWRlci1pbmxpbmUtYm9yZGVyLWJvdHRvbVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImJvcmRlci1sZWZ0LWNvbG9yXCI6IHtcclxuICAgICAgICAgICAgY3VzdG9tUHJvcDogXCItLWRhcmtyZWFkZXItaW5saW5lLWJvcmRlci1sZWZ0XCIsXHJcbiAgICAgICAgICAgIGNzc1Byb3A6IFwiYm9yZGVyLWxlZnQtY29sb3JcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1ib3JkZXItbGVmdFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImJvcmRlci1yaWdodC1jb2xvclwiOiB7XHJcbiAgICAgICAgICAgIGN1c3RvbVByb3A6IFwiLS1kYXJrcmVhZGVyLWlubGluZS1ib3JkZXItcmlnaHRcIixcclxuICAgICAgICAgICAgY3NzUHJvcDogXCJib3JkZXItcmlnaHQtY29sb3JcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1ib3JkZXItcmlnaHRcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJib3JkZXItdG9wLWNvbG9yXCI6IHtcclxuICAgICAgICAgICAgY3VzdG9tUHJvcDogXCItLWRhcmtyZWFkZXItaW5saW5lLWJvcmRlci10b3BcIixcclxuICAgICAgICAgICAgY3NzUHJvcDogXCJib3JkZXItdG9wLWNvbG9yXCIsXHJcbiAgICAgICAgICAgIGRhdGFBdHRyOiBcImRhdGEtZGFya3JlYWRlci1pbmxpbmUtYm9yZGVyLXRvcFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImJveC1zaGFkb3dcIjoge1xyXG4gICAgICAgICAgICBjdXN0b21Qcm9wOiBcIi0tZGFya3JlYWRlci1pbmxpbmUtYm94c2hhZG93XCIsXHJcbiAgICAgICAgICAgIGNzc1Byb3A6IFwiYm94LXNoYWRvd1wiLFxyXG4gICAgICAgICAgICBkYXRhQXR0cjogXCJkYXRhLWRhcmtyZWFkZXItaW5saW5lLWJveHNoYWRvd1wiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImNvbG9yXCI6IHtcclxuICAgICAgICAgICAgY3VzdG9tUHJvcDogXCItLWRhcmtyZWFkZXItaW5saW5lLWNvbG9yXCIsXHJcbiAgICAgICAgICAgIGNzc1Byb3A6IFwiY29sb3JcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1jb2xvclwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImZpbGxcIjoge1xyXG4gICAgICAgICAgICBjdXN0b21Qcm9wOiBcIi0tZGFya3JlYWRlci1pbmxpbmUtZmlsbFwiLFxyXG4gICAgICAgICAgICBjc3NQcm9wOiBcImZpbGxcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1maWxsXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic3Ryb2tlXCI6IHtcclxuICAgICAgICAgICAgY3VzdG9tUHJvcDogXCItLWRhcmtyZWFkZXItaW5saW5lLXN0cm9rZVwiLFxyXG4gICAgICAgICAgICBjc3NQcm9wOiBcInN0cm9rZVwiLFxyXG4gICAgICAgICAgICBkYXRhQXR0cjogXCJkYXRhLWRhcmtyZWFkZXItaW5saW5lLXN0cm9rZVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcIm91dGxpbmUtY29sb3JcIjoge1xyXG4gICAgICAgICAgICBjdXN0b21Qcm9wOiBcIi0tZGFya3JlYWRlci1pbmxpbmUtb3V0bGluZVwiLFxyXG4gICAgICAgICAgICBjc3NQcm9wOiBcIm91dGxpbmUtY29sb3JcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1vdXRsaW5lXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic3RvcC1jb2xvclwiOiB7XHJcbiAgICAgICAgICAgIGN1c3RvbVByb3A6IFwiLS1kYXJrcmVhZGVyLWlubGluZS1zdG9wY29sb3JcIixcclxuICAgICAgICAgICAgY3NzUHJvcDogXCJzdG9wLWNvbG9yXCIsXHJcbiAgICAgICAgICAgIGRhdGFBdHRyOiBcImRhdGEtZGFya3JlYWRlci1pbmxpbmUtc3RvcGNvbG9yXCJcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdmFyIHNob3J0aGFuZE92ZXJyaWRlcyA9IHtcclxuICAgICAgICBiYWNrZ3JvdW5kOiB7XHJcbiAgICAgICAgICAgIGN1c3RvbVByb3A6IFwiLS1kYXJrcmVhZGVyLWlubGluZS1iZ1wiLFxyXG4gICAgICAgICAgICBjc3NQcm9wOiBcImJhY2tncm91bmRcIixcclxuICAgICAgICAgICAgZGF0YUF0dHI6IFwiZGF0YS1kYXJrcmVhZGVyLWlubGluZS1iZ1wiXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHZhciBvdmVycmlkZXNMaXN0ID0gT2JqZWN0LnZhbHVlcyhvdmVycmlkZXMkMSk7XHJcbiAgICB2YXIgbm9ybWFsaXplZFByb3BMaXN0ID0ge307XHJcbiAgICBvdmVycmlkZXNMaXN0LmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgdmFyIGNzc1Byb3AgPSBfYS5jc3NQcm9wLFxyXG4gICAgICAgICAgICBjdXN0b21Qcm9wID0gX2EuY3VzdG9tUHJvcDtcclxuICAgICAgICByZXR1cm4gKG5vcm1hbGl6ZWRQcm9wTGlzdFtjdXN0b21Qcm9wXSA9IGNzc1Byb3ApO1xyXG4gICAgfSk7XHJcbiAgICB2YXIgSU5MSU5FX1NUWUxFX0FUVFJTID0gW1xyXG4gICAgICAgIFwic3R5bGVcIixcclxuICAgICAgICBcImZpbGxcIixcclxuICAgICAgICBcInN0b3AtY29sb3JcIixcclxuICAgICAgICBcInN0cm9rZVwiLFxyXG4gICAgICAgIFwiYmdjb2xvclwiLFxyXG4gICAgICAgIFwiY29sb3JcIlxyXG4gICAgXTtcclxuICAgIHZhciBJTkxJTkVfU1RZTEVfU0VMRUNUT1IgPSBJTkxJTkVfU1RZTEVfQVRUUlMubWFwKGZ1bmN0aW9uIChhdHRyKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiW1wiLmNvbmNhdChhdHRyLCBcIl1cIik7XHJcbiAgICB9KS5qb2luKFwiLCBcIik7XHJcbiAgICBmdW5jdGlvbiBnZXRJbmxpbmVPdmVycmlkZVN0eWxlKCkge1xyXG4gICAgICAgIHZhciBhbGxPdmVycmlkZXMgPSBvdmVycmlkZXNMaXN0LmNvbmNhdChcclxuICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhzaG9ydGhhbmRPdmVycmlkZXMpXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gYWxsT3ZlcnJpZGVzXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YUF0dHIgPSBfYS5kYXRhQXR0cixcclxuICAgICAgICAgICAgICAgICAgICBjdXN0b21Qcm9wID0gX2EuY3VzdG9tUHJvcCxcclxuICAgICAgICAgICAgICAgICAgICBjc3NQcm9wID0gX2EuY3NzUHJvcDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgXCJbXCIuY29uY2F0KGRhdGFBdHRyLCBcIl0ge1wiKSxcclxuICAgICAgICAgICAgICAgICAgICBcIiAgXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChjc3NQcm9wLCBcIjogdmFyKFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KGN1c3RvbVByb3AsIFwiKSAhaW1wb3J0YW50O1wiKSxcclxuICAgICAgICAgICAgICAgICAgICBcIn1cIlxyXG4gICAgICAgICAgICAgICAgXS5qb2luKFwiXFxuXCIpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbihcIlxcblwiKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldElubGluZVN0eWxlRWxlbWVudHMocm9vdCkge1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgaWYgKHJvb3QgaW5zdGFuY2VvZiBFbGVtZW50ICYmIHJvb3QubWF0Y2hlcyhJTkxJTkVfU1RZTEVfU0VMRUNUT1IpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChyb290KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICByb290IGluc3RhbmNlb2YgRWxlbWVudCB8fFxyXG4gICAgICAgICAgICAoaXNTaGFkb3dEb21TdXBwb3J0ZWQgJiYgcm9vdCBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QpIHx8XHJcbiAgICAgICAgICAgIHJvb3QgaW5zdGFuY2VvZiBEb2N1bWVudFxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBwdXNoKHJlc3VsdHMsIHJvb3QucXVlcnlTZWxlY3RvckFsbChJTkxJTkVfU1RZTEVfU0VMRUNUT1IpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9XHJcbiAgICB2YXIgdHJlZU9ic2VydmVycyA9IG5ldyBNYXAoKTtcclxuICAgIHZhciBhdHRyT2JzZXJ2ZXJzID0gbmV3IE1hcCgpO1xyXG4gICAgZnVuY3Rpb24gd2F0Y2hGb3JJbmxpbmVTdHlsZXMoZWxlbWVudFN0eWxlRGlkQ2hhbmdlLCBzaGFkb3dSb290RGlzY292ZXJlZCkge1xyXG4gICAgICAgIGRlZXBXYXRjaEZvcklubGluZVN0eWxlcyhcclxuICAgICAgICAgICAgZG9jdW1lbnQsXHJcbiAgICAgICAgICAgIGVsZW1lbnRTdHlsZURpZENoYW5nZSxcclxuICAgICAgICAgICAgc2hhZG93Um9vdERpc2NvdmVyZWRcclxuICAgICAgICApO1xyXG4gICAgICAgIGl0ZXJhdGVTaGFkb3dIb3N0cyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGZ1bmN0aW9uIChob3N0KSB7XHJcbiAgICAgICAgICAgIGRlZXBXYXRjaEZvcklubGluZVN0eWxlcyhcclxuICAgICAgICAgICAgICAgIGhvc3Quc2hhZG93Um9vdCxcclxuICAgICAgICAgICAgICAgIGVsZW1lbnRTdHlsZURpZENoYW5nZSxcclxuICAgICAgICAgICAgICAgIHNoYWRvd1Jvb3REaXNjb3ZlcmVkXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBkZWVwV2F0Y2hGb3JJbmxpbmVTdHlsZXMoXHJcbiAgICAgICAgcm9vdCxcclxuICAgICAgICBlbGVtZW50U3R5bGVEaWRDaGFuZ2UsXHJcbiAgICAgICAgc2hhZG93Um9vdERpc2NvdmVyZWRcclxuICAgICkge1xyXG4gICAgICAgIGlmICh0cmVlT2JzZXJ2ZXJzLmhhcyhyb290KSkge1xyXG4gICAgICAgICAgICB0cmVlT2JzZXJ2ZXJzLmdldChyb290KS5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIGF0dHJPYnNlcnZlcnMuZ2V0KHJvb3QpLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRpc2NvdmVyZWROb2RlcyA9IG5ldyBXZWFrU2V0KCk7XHJcbiAgICAgICAgZnVuY3Rpb24gZGlzY292ZXJOb2Rlcyhub2RlKSB7XHJcbiAgICAgICAgICAgIGdldElubGluZVN0eWxlRWxlbWVudHMobm9kZSkuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkaXNjb3ZlcmVkTm9kZXMuaGFzKGVsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRpc2NvdmVyZWROb2Rlcy5hZGQoZWwpO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudFN0eWxlRGlkQ2hhbmdlKGVsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGl0ZXJhdGVTaGFkb3dIb3N0cyhub2RlLCBmdW5jdGlvbiAobikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRpc2NvdmVyZWROb2Rlcy5oYXMobm9kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkaXNjb3ZlcmVkTm9kZXMuYWRkKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgc2hhZG93Um9vdERpc2NvdmVyZWQobi5zaGFkb3dSb290KTtcclxuICAgICAgICAgICAgICAgIGRlZXBXYXRjaEZvcklubGluZVN0eWxlcyhcclxuICAgICAgICAgICAgICAgICAgICBuLnNoYWRvd1Jvb3QsXHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudFN0eWxlRGlkQ2hhbmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNoYWRvd1Jvb3REaXNjb3ZlcmVkXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUubWF0Y2hWYXJpYWJsZXNBbmREZXBlbmRlbnRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0cmVlT2JzZXJ2ZXIgPSBjcmVhdGVPcHRpbWl6ZWRUcmVlT2JzZXJ2ZXIocm9vdCwge1xyXG4gICAgICAgICAgICBvbk1pbm9yTXV0YXRpb25zOiBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhZGRpdGlvbnMgPSBfYS5hZGRpdGlvbnM7XHJcbiAgICAgICAgICAgICAgICBhZGRpdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoYWRkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGlzY292ZXJOb2RlcyhhZGRlZCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25IdWdlTXV0YXRpb25zOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBkaXNjb3Zlck5vZGVzKHJvb3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdHJlZU9ic2VydmVycy5zZXQocm9vdCwgdHJlZU9ic2VydmVyKTtcclxuICAgICAgICB2YXIgYXR0ZW1wdENvdW50ID0gMDtcclxuICAgICAgICB2YXIgc3RhcnQgPSBudWxsO1xyXG4gICAgICAgIHZhciBBVFRFTVBUU19JTlRFUlZBTCA9IGdldER1cmF0aW9uKHtzZWNvbmRzOiAxMH0pO1xyXG4gICAgICAgIHZhciBSRVRSWV9USU1FT1VUID0gZ2V0RHVyYXRpb24oe3NlY29uZHM6IDJ9KTtcclxuICAgICAgICB2YXIgTUFYX0FUVEVNUFRTX0NPVU5UID0gNTA7XHJcbiAgICAgICAgdmFyIGNhY2hlID0gW107XHJcbiAgICAgICAgdmFyIHRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICAgICAgdmFyIGhhbmRsZUF0dHJpYnV0ZU11dGF0aW9ucyA9IHRocm90dGxlKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICAgICAgdmFyIGhhbmRsZWRUYXJnZXRzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IG0udGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhbmRsZWRUYXJnZXRzLmhhcyh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKElOTElORV9TVFlMRV9BVFRSUy5pbmNsdWRlcyhtLmF0dHJpYnV0ZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZFRhcmdldHMuYWRkKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudFN0eWxlRGlkQ2hhbmdlKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5tYXRjaFZhcmlhYmxlc0FuZERlcGVuZGVudHMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgYXR0ck9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgICAgICBpZiAodGltZW91dElkKSB7XHJcbiAgICAgICAgICAgICAgICBjYWNoZS5wdXNoLmFwcGx5KFxyXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlLFxyXG4gICAgICAgICAgICAgICAgICAgIF9fc3ByZWFkQXJyYXkoW10sIF9fcmVhZChtdXRhdGlvbnMpLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXR0ZW1wdENvdW50Kys7XHJcbiAgICAgICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICBpZiAoc3RhcnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgc3RhcnQgPSBub3c7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXR0ZW1wdENvdW50ID49IE1BWF9BVFRFTVBUU19DT1VOVCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vdyAtIHN0YXJ0IDwgQVRURU1QVFNfSU5URVJWQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRlbXB0Q291bnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlQ2FjaGUgPSBjYWNoZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGUgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlQXR0cmlidXRlTXV0YXRpb25zKGF0dHJpYnV0ZUNhY2hlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBSRVRSWV9USU1FT1VUKTtcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZS5wdXNoLmFwcGx5KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKG11dGF0aW9ucyksIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RhcnQgPSBub3c7XHJcbiAgICAgICAgICAgICAgICBhdHRlbXB0Q291bnQgPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGhhbmRsZUF0dHJpYnV0ZU11dGF0aW9ucyhtdXRhdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGF0dHJPYnNlcnZlci5vYnNlcnZlKHJvb3QsIHtcclxuICAgICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSxcclxuICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBJTkxJTkVfU1RZTEVfQVRUUlMuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgb3ZlcnJpZGVzTGlzdC5tYXAoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFBdHRyID0gX2EuZGF0YUF0dHI7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFBdHRyO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGF0dHJPYnNlcnZlcnMuc2V0KHJvb3QsIGF0dHJPYnNlcnZlcik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBzdG9wV2F0Y2hpbmdGb3JJbmxpbmVTdHlsZXMoKSB7XHJcbiAgICAgICAgdHJlZU9ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBhdHRyT2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKG8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG8uZGlzY29ubmVjdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRyZWVPYnNlcnZlcnMuY2xlYXIoKTtcclxuICAgICAgICBhdHRyT2JzZXJ2ZXJzLmNsZWFyKCk7XHJcbiAgICB9XHJcbiAgICB2YXIgaW5saW5lU3R5bGVDYWNoZSA9IG5ldyBXZWFrTWFwKCk7XHJcbiAgICB2YXIgZmlsdGVyUHJvcHMgPSBbXCJicmlnaHRuZXNzXCIsIFwiY29udHJhc3RcIiwgXCJncmF5c2NhbGVcIiwgXCJzZXBpYVwiLCBcIm1vZGVcIl07XHJcbiAgICBmdW5jdGlvbiBnZXRJbmxpbmVTdHlsZUNhY2hlS2V5KGVsLCB0aGVtZSkge1xyXG4gICAgICAgIHJldHVybiBJTkxJTkVfU1RZTEVfQVRUUlMubWFwKGZ1bmN0aW9uIChhdHRyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiLmNvbmNhdChhdHRyLCAnPVwiJykuY29uY2F0KGVsLmdldEF0dHJpYnV0ZShhdHRyKSwgJ1wiJyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNvbmNhdChcclxuICAgICAgICAgICAgICAgIGZpbHRlclByb3BzLm1hcChmdW5jdGlvbiAocHJvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiLmNvbmNhdChwcm9wLCAnPVwiJykuY29uY2F0KHRoZW1lW3Byb3BdLCAnXCInKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLmpvaW4oXCIgXCIpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc2hvdWxkSWdub3JlSW5saW5lU3R5bGUoZWxlbWVudCwgc2VsZWN0b3JzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHNlbGVjdG9ycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgaW5nbm9yZWRTZWxlY3RvciA9IHNlbGVjdG9yc1tpXTtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQubWF0Y2hlcyhpbmdub3JlZFNlbGVjdG9yKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gb3ZlcnJpZGVJbmxpbmVTdHlsZShcclxuICAgICAgICBlbGVtZW50LFxyXG4gICAgICAgIHRoZW1lLFxyXG4gICAgICAgIGlnbm9yZUlubGluZVNlbGVjdG9ycyxcclxuICAgICAgICBpZ25vcmVJbWFnZVNlbGVjdG9yc1xyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHZhciBjYWNoZUtleSA9IGdldElubGluZVN0eWxlQ2FjaGVLZXkoZWxlbWVudCwgdGhlbWUpO1xyXG4gICAgICAgIGlmIChjYWNoZUtleSA9PT0gaW5saW5lU3R5bGVDYWNoZS5nZXQoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdW5zZXRQcm9wcyA9IG5ldyBTZXQoT2JqZWN0LmtleXMob3ZlcnJpZGVzJDEpKTtcclxuICAgICAgICBmdW5jdGlvbiBzZXRDdXN0b21Qcm9wKHRhcmdldENTU1Byb3AsIG1vZGlmaWVyQ1NTUHJvcCwgY3NzVmFsKSB7XHJcbiAgICAgICAgICAgIHZhciBtb2QgPSBnZXRNb2RpZmlhYmxlQ1NTRGVjbGFyYXRpb24oXHJcbiAgICAgICAgICAgICAgICBtb2RpZmllckNTU1Byb3AsXHJcbiAgICAgICAgICAgICAgICBjc3NWYWwsXHJcbiAgICAgICAgICAgICAgICB7c3R5bGU6IGVsZW1lbnQuc3R5bGV9LFxyXG4gICAgICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUsXHJcbiAgICAgICAgICAgICAgICBpZ25vcmVJbWFnZVNlbGVjdG9ycyxcclxuICAgICAgICAgICAgICAgIG51bGxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKCFtb2QpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRTdGF0aWNWYWx1ZSh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgdmFyIF9iID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKF9hID0gb3ZlcnJpZGVzJDFbdGFyZ2V0Q1NTUHJvcF0pICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hICE9PSB2b2lkIDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX2FcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogc2hvcnRoYW5kT3ZlcnJpZGVzW3RhcmdldENTU1Byb3BdLFxyXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbVByb3AgPSBfYi5jdXN0b21Qcm9wLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFBdHRyID0gX2IuZGF0YUF0dHI7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KGN1c3RvbVByb3AsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGlmICghZWxlbWVudC5oYXNBdHRyaWJ1dGUoZGF0YUF0dHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoZGF0YUF0dHIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdW5zZXRQcm9wcy5kZWxldGUodGFyZ2V0Q1NTUHJvcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gc2V0VmFyRGVjbGFyYXRpb24obW9kKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJldkRlY2xhcmF0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2V0UHJvcHMoZGVjbGFyYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldkRlY2xhcmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBfYS5wcm9wZXJ0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5yZW1vdmVQcm9wZXJ0eShwcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IF9hLnByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfYS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShwcm9wZXJ0eSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldkRlY2xhcmF0aW9ucyA9IGRlY2xhcmF0aW9ucztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNldFByb3BzKG1vZC5kZWNsYXJhdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgbW9kLm9uVHlwZUNoYW5nZS5hZGRMaXN0ZW5lcihzZXRQcm9wcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gc2V0QXN5bmNWYWx1ZShwcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDU1NQcm9wID09PSBcImJhY2tncm91bmRcIiAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5zdGFydHNXaXRoKFwidmFyKC0tZGFya3JlYWRlci1iZy0tXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFN0YXRpY1ZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPVxyXG4gICAgICAgICAgICAgICAgdHlwZW9mIG1vZC52YWx1ZSA9PT0gXCJmdW5jdGlvblwiID8gbW9kLnZhbHVlKHRoZW1lKSA6IG1vZC52YWx1ZTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgc2V0U3RhdGljVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgc2V0QXN5bmNWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRWYXJEZWNsYXJhdGlvbih2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlnbm9yZUlubGluZVNlbGVjdG9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGlmIChzaG91bGRJZ25vcmVJbmxpbmVTdHlsZShlbGVtZW50LCBpZ25vcmVJbmxpbmVTZWxlY3RvcnMpKSB7XHJcbiAgICAgICAgICAgICAgICB1bnNldFByb3BzLmZvckVhY2goZnVuY3Rpb24gKGNzc1Byb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShvdmVycmlkZXMkMVtjc3NQcm9wXS5kYXRhQXR0cik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJiZ2NvbG9yXCIpKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiYmdjb2xvclwiKTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgdmFsdWUubWF0Y2goL15bMC05YS1mXXszfSQvaSkgfHxcclxuICAgICAgICAgICAgICAgIHZhbHVlLm1hdGNoKC9eWzAtOWEtZl17Nn0kL2kpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBcIiNcIi5jb25jYXQodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldEN1c3RvbVByb3AoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIFwiYmFja2dyb3VuZC1jb2xvclwiLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbGVtZW50Lmhhc0F0dHJpYnV0ZShcImNvbG9yXCIpICYmIGVsZW1lbnQucmVsICE9PSBcIm1hc2staWNvblwiKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiY29sb3JcIik7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIHZhbHVlLm1hdGNoKC9eWzAtOWEtZl17M30kL2kpIHx8XHJcbiAgICAgICAgICAgICAgICB2YWx1ZS5tYXRjaCgvXlswLTlhLWZdezZ9JC9pKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gXCIjXCIuY29uY2F0KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRDdXN0b21Qcm9wKFwiY29sb3JcIiwgXCJjb2xvclwiLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgU1ZHRWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJmaWxsXCIpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgU01BTExfU1ZHX0xJTUlUXzEgPSAzMjtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZV8xID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJmaWxsXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlXzEgIT09IFwibm9uZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIFNWR1RleHRFbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFuZGxlU1ZHRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYSA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBfYS53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBfYS5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNCZyA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPiBTTUFMTF9TVkdfTElNSVRfMSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA+IFNNQUxMX1NWR19MSU1JVF8xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VzdG9tUHJvcChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JnID8gXCJiYWNrZ3JvdW5kLWNvbG9yXCIgOiBcImNvbG9yXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVfMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUmVhZHlTdGF0ZUNvbXBsZXRlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVNWR0VsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVyKGhhbmRsZVNWR0VsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VzdG9tUHJvcChcImZpbGxcIiwgXCJjb2xvclwiLCB2YWx1ZV8xKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKFwic3RvcC1jb2xvclwiKSkge1xyXG4gICAgICAgICAgICAgICAgc2V0Q3VzdG9tUHJvcChcclxuICAgICAgICAgICAgICAgICAgICBcInN0b3AtY29sb3JcIixcclxuICAgICAgICAgICAgICAgICAgICBcImJhY2tncm91bmQtY29sb3JcIixcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmdldEF0dHJpYnV0ZShcInN0b3AtY29sb3JcIilcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKFwic3Ryb2tlXCIpKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic3Ryb2tlXCIpO1xyXG4gICAgICAgICAgICBzZXRDdXN0b21Qcm9wKFxyXG4gICAgICAgICAgICAgICAgXCJzdHJva2VcIixcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQgaW5zdGFuY2VvZiBTVkdMaW5lRWxlbWVudCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgaW5zdGFuY2VvZiBTVkdUZXh0RWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgID8gXCJib3JkZXItY29sb3JcIlxyXG4gICAgICAgICAgICAgICAgICAgIDogXCJjb2xvclwiLFxyXG4gICAgICAgICAgICAgICAgdmFsdWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbWVudC5zdHlsZSAmJlxyXG4gICAgICAgICAgICBpdGVyYXRlQ1NTRGVjbGFyYXRpb25zKGVsZW1lbnQuc3R5bGUsIGZ1bmN0aW9uIChwcm9wZXJ0eSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gXCJiYWNrZ3JvdW5kLWltYWdlXCIgJiYgdmFsdWUuaW5jbHVkZXMoXCJ1cmxcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVzJDEuaGFzT3duUHJvcGVydHkocHJvcGVydHkpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgKHByb3BlcnR5LnN0YXJ0c1dpdGgoXCItLVwiKSAmJiAhbm9ybWFsaXplZFByb3BMaXN0W3Byb3BlcnR5XSlcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEN1c3RvbVByb3AocHJvcGVydHksIHByb3BlcnR5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5ID09PSBcImJhY2tncm91bmRcIiAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmluY2x1ZGVzKFwidmFyKFwiKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0Q3VzdG9tUHJvcChcImJhY2tncm91bmRcIiwgXCJiYWNrZ3JvdW5kXCIsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG92ZXJyaWRkZW5Qcm9wID0gbm9ybWFsaXplZFByb3BMaXN0W3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJyaWRkZW5Qcm9wICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICFlbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUob3ZlcnJpZGRlblByb3ApICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICFlbGVtZW50Lmhhc0F0dHJpYnV0ZShvdmVycmlkZGVuUHJvcClcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGRlblByb3AgPT09IFwiYmFja2dyb3VuZC1jb2xvclwiICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lmhhc0F0dHJpYnV0ZShcImJnY29sb3JcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShwcm9wZXJ0eSwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUgJiZcclxuICAgICAgICAgICAgZWxlbWVudCBpbnN0YW5jZW9mIFNWR1RleHRFbGVtZW50ICYmXHJcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuZmlsbFxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBzZXRDdXN0b21Qcm9wKFxyXG4gICAgICAgICAgICAgICAgXCJmaWxsXCIsXHJcbiAgICAgICAgICAgICAgICBcImNvbG9yXCIsXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJmaWxsXCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgKF9hID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMFxyXG4gICAgICAgICAgICAgICAgPyB2b2lkIDBcclxuICAgICAgICAgICAgICAgIDogX2EuaW5jbHVkZXMoXCItLVwiKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5hZGRJbmxpbmVTdHlsZUZvck1hdGNoaW5nKGVsZW1lbnQuc3R5bGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3JFYWNoKHVuc2V0UHJvcHMsIGZ1bmN0aW9uIChjc3NQcm9wKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKG92ZXJyaWRlcyQxW2Nzc1Byb3BdLmRhdGFBdHRyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpbmxpbmVTdHlsZUNhY2hlLnNldChlbGVtZW50LCBnZXRJbmxpbmVTdHlsZUNhY2hlS2V5KGVsZW1lbnQsIHRoZW1lKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG1ldGFUaGVtZUNvbG9yTmFtZSA9IFwidGhlbWUtY29sb3JcIjtcclxuICAgIHZhciBtZXRhVGhlbWVDb2xvclNlbGVjdG9yID0gJ21ldGFbbmFtZT1cIicuY29uY2F0KG1ldGFUaGVtZUNvbG9yTmFtZSwgJ1wiXScpO1xyXG4gICAgdmFyIHNyY01ldGFUaGVtZUNvbG9yID0gbnVsbDtcclxuICAgIHZhciBvYnNlcnZlciA9IG51bGw7XHJcbiAgICBmdW5jdGlvbiBjaGFuZ2VNZXRhVGhlbWVDb2xvcihtZXRhLCB0aGVtZSkge1xyXG4gICAgICAgIHNyY01ldGFUaGVtZUNvbG9yID0gc3JjTWV0YVRoZW1lQ29sb3IgfHwgbWV0YS5jb250ZW50O1xyXG4gICAgICAgIHZhciBjb2xvciA9IHBhcnNlQ29sb3JXaXRoQ2FjaGUoc3JjTWV0YVRoZW1lQ29sb3IpO1xyXG4gICAgICAgIGlmICghY29sb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXRhLmNvbnRlbnQgPSBtb2RpZnlCYWNrZ3JvdW5kQ29sb3IoY29sb3IsIHRoZW1lKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNoYW5nZU1ldGFUaGVtZUNvbG9yV2hlbkF2YWlsYWJsZSh0aGVtZSkge1xyXG4gICAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihtZXRhVGhlbWVDb2xvclNlbGVjdG9yKTtcclxuICAgICAgICBpZiAobWV0YSkge1xyXG4gICAgICAgICAgICBjaGFuZ2VNZXRhVGhlbWVDb2xvcihtZXRhLCB0aGVtZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBsb29wOiBmb3IgKHZhciBpID0gMDsgaSA8IG11dGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhZGRlZE5vZGVzID0gbXV0YXRpb25zW2ldLmFkZGVkTm9kZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBhZGRlZE5vZGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gYWRkZWROb2Rlc1tqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSBpbnN0YW5jZW9mIEhUTUxNZXRhRWxlbWVudCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5uYW1lID09PSBtZXRhVGhlbWVDb2xvck5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNZXRhVGhlbWVDb2xvcihub2RlLCB0aGVtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBsb29wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5oZWFkLCB7Y2hpbGRMaXN0OiB0cnVlfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcmVzdG9yZU1ldGFUaGVtZUNvbG9yKCkge1xyXG4gICAgICAgIGlmIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1ldGEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1ldGFUaGVtZUNvbG9yU2VsZWN0b3IpO1xyXG4gICAgICAgIGlmIChtZXRhICYmIHNyY01ldGFUaGVtZUNvbG9yKSB7XHJcbiAgICAgICAgICAgIG1ldGEuY29udGVudCA9IHNyY01ldGFUaGVtZUNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGhlbWVDYWNoZUtleXMgPSBbXHJcbiAgICAgICAgXCJtb2RlXCIsXHJcbiAgICAgICAgXCJicmlnaHRuZXNzXCIsXHJcbiAgICAgICAgXCJjb250cmFzdFwiLFxyXG4gICAgICAgIFwiZ3JheXNjYWxlXCIsXHJcbiAgICAgICAgXCJzZXBpYVwiLFxyXG4gICAgICAgIFwiZGFya1NjaGVtZUJhY2tncm91bmRDb2xvclwiLFxyXG4gICAgICAgIFwiZGFya1NjaGVtZVRleHRDb2xvclwiLFxyXG4gICAgICAgIFwibGlnaHRTY2hlbWVCYWNrZ3JvdW5kQ29sb3JcIixcclxuICAgICAgICBcImxpZ2h0U2NoZW1lVGV4dENvbG9yXCJcclxuICAgIF07XHJcbiAgICBmdW5jdGlvbiBnZXRUaGVtZUtleSh0aGVtZSkge1xyXG4gICAgICAgIHZhciByZXN1bHRLZXkgPSBcIlwiO1xyXG4gICAgICAgIHRoZW1lQ2FjaGVLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICByZXN1bHRLZXkgKz0gXCJcIi5jb25jYXQoa2V5LCBcIjpcIikuY29uY2F0KHRoZW1lW2tleV0sIFwiO1wiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0S2V5O1xyXG4gICAgfVxyXG4gICAgdmFyIGFzeW5jUXVldWUgPSBjcmVhdGVBc3luY1Rhc2tzUXVldWUoKTtcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZVN0eWxlU2hlZXRNb2RpZmllcigpIHtcclxuICAgICAgICB2YXIgcmVuZGVySWQgPSAwO1xyXG4gICAgICAgIHZhciBydWxlc1RleHRDYWNoZSA9IG5ldyBTZXQoKTtcclxuICAgICAgICB2YXIgcnVsZXNNb2RDYWNoZSA9IG5ldyBNYXAoKTtcclxuICAgICAgICB2YXIgdmFyVHlwZUNoYW5nZUNsZWFuZXJzID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHZhciBwcmV2RmlsdGVyS2V5ID0gbnVsbDtcclxuICAgICAgICB2YXIgaGFzTm9uTG9hZGVkTGluayA9IGZhbHNlO1xyXG4gICAgICAgIHZhciB3YXNSZWJ1aWx0ID0gZmFsc2U7XHJcbiAgICAgICAgZnVuY3Rpb24gc2hvdWxkUmVidWlsZFN0eWxlKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGFzTm9uTG9hZGVkTGluayAmJiAhd2FzUmVidWlsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gbW9kaWZ5U2hlZXQob3B0aW9ucykge1xyXG4gICAgICAgICAgICB2YXIgcnVsZXMgPSBvcHRpb25zLnNvdXJjZUNTU1J1bGVzO1xyXG4gICAgICAgICAgICB2YXIgdGhlbWUgPSBvcHRpb25zLnRoZW1lLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlSW1hZ2VBbmFseXNpcyA9IG9wdGlvbnMuaWdub3JlSW1hZ2VBbmFseXNpcyxcclxuICAgICAgICAgICAgICAgIGZvcmNlID0gb3B0aW9ucy5mb3JjZSxcclxuICAgICAgICAgICAgICAgIHByZXBhcmVTaGVldCA9IG9wdGlvbnMucHJlcGFyZVNoZWV0LFxyXG4gICAgICAgICAgICAgICAgaXNBc3luY0NhbmNlbGxlZCA9IG9wdGlvbnMuaXNBc3luY0NhbmNlbGxlZDtcclxuICAgICAgICAgICAgdmFyIHJ1bGVzQ2hhbmdlZCA9IHJ1bGVzTW9kQ2FjaGUuc2l6ZSA9PT0gMDtcclxuICAgICAgICAgICAgdmFyIG5vdEZvdW5kQ2FjaGVLZXlzID0gbmV3IFNldChydWxlc01vZENhY2hlLmtleXMoKSk7XHJcbiAgICAgICAgICAgIHZhciB0aGVtZUtleSA9IGdldFRoZW1lS2V5KHRoZW1lKTtcclxuICAgICAgICAgICAgdmFyIHRoZW1lQ2hhbmdlZCA9IHRoZW1lS2V5ICE9PSBwcmV2RmlsdGVyS2V5O1xyXG4gICAgICAgICAgICBpZiAoaGFzTm9uTG9hZGVkTGluaykge1xyXG4gICAgICAgICAgICAgICAgd2FzUmVidWlsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1vZFJ1bGVzID0gW107XHJcbiAgICAgICAgICAgIGl0ZXJhdGVDU1NSdWxlcyhcclxuICAgICAgICAgICAgICAgIHJ1bGVzLFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJ1bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3NzVGV4dCA9IHJ1bGUuY3NzVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dERpZmZlcnNGcm9tUHJldiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdEZvdW5kQ2FjaGVLZXlzLmRlbGV0ZShjc3NUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5wYXJlbnRSdWxlIGluc3RhbmNlb2YgQ1NTTWVkaWFSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gXCI7XCIuY29uY2F0KHJ1bGUucGFyZW50UnVsZS5tZWRpYS5tZWRpYVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJ1bGVzVGV4dENhY2hlLmhhcyhjc3NUZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlc1RleHRDYWNoZS5hZGQoY3NzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHREaWZmZXJzRnJvbVByZXYgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGV4dERpZmZlcnNGcm9tUHJldikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlc0NoYW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZFJ1bGVzLnB1c2gocnVsZXNNb2RDYWNoZS5nZXQoY3NzVGV4dCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChydWxlLnN0eWxlLmFsbCA9PT0gXCJyZXZlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2REZWNzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgcnVsZS5zdHlsZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRlQ1NTRGVjbGFyYXRpb25zKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5zdHlsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChwcm9wZXJ0eSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kID0gZ2V0TW9kaWZpYWJsZUNTU0RlY2xhcmF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlc1N0b3JlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVJbWFnZUFuYWx5c2lzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0FzeW5jQ2FuY2VsbGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZERlY3MucHVzaChtb2QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kUnVsZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vZERlY3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50UnVsZSA9IHJ1bGUucGFyZW50UnVsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kUnVsZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBydWxlLnNlbGVjdG9yVGV4dCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogbW9kRGVjcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFJ1bGU6IHBhcmVudFJ1bGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kUnVsZXMucHVzaChtb2RSdWxlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcnVsZXNNb2RDYWNoZS5zZXQoY3NzVGV4dCwgbW9kUnVsZSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc05vbkxvYWRlZExpbmsgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBub3RGb3VuZENhY2hlS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHJ1bGVzVGV4dENhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgcnVsZXNNb2RDYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHByZXZGaWx0ZXJLZXkgPSB0aGVtZUtleTtcclxuICAgICAgICAgICAgaWYgKCFmb3JjZSAmJiAhcnVsZXNDaGFuZ2VkICYmICF0aGVtZUNoYW5nZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZW5kZXJJZCsrO1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRSdWxlKHRhcmdldCwgaW5kZXgsIHJ1bGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlXzEsIF9hO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yID0gcnVsZS5zZWxlY3RvcixcclxuICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnMgPSBydWxlLmRlY2xhcmF0aW9ucztcclxuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvclRleHQgPSBzZWxlY3RvcjtcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICBpc0Nocm9taXVtICYmXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3Iuc3RhcnRzV2l0aChcIjppcyhcIikgJiZcclxuICAgICAgICAgICAgICAgICAgICAoc2VsZWN0b3IuaW5jbHVkZXMoXCI6aXMoKVwiKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rvci5pbmNsdWRlcyhcIjp3aGVyZSgpXCIpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChzZWxlY3Rvci5pbmNsdWRlcyhcIjp3aGVyZShcIikgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yLmluY2x1ZGVzKFwiOi1tb3pcIikpKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3JUZXh0ID0gXCIuZGFya3JlYWRlci11bnN1cHBvcnRlZC1zZWxlY3RvclwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHJ1bGVUZXh0ID0gXCJcIi5jb25jYXQoc2VsZWN0b3JUZXh0LCBcIiB7XCIpO1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVjbGFyYXRpb25zXzEgPSBfX3ZhbHVlcyhkZWNsYXJhdGlvbnMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zXzFfMSA9IGRlY2xhcmF0aW9uc18xLm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIWRlY2xhcmF0aW9uc18xXzEuZG9uZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zXzFfMSA9IGRlY2xhcmF0aW9uc18xLm5leHQoKVxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVjID0gZGVjbGFyYXRpb25zXzFfMS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gZGVjLnByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkZWMudmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQgPSBkZWMuaW1wb3J0YW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVUZXh0ICs9IFwiIFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChwcm9wZXJ0eSwgXCI6IFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQodmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChpbXBvcnRhbnQgPyBcIiAhaW1wb3J0YW50XCIgOiBcIlwiLCBcIjtcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlXzFfMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVfMSA9IHtlcnJvcjogZV8xXzF9O1xyXG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnNfMV8xICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZGVjbGFyYXRpb25zXzFfMS5kb25lICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2EgPSBkZWNsYXJhdGlvbnNfMS5yZXR1cm4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmNhbGwoZGVjbGFyYXRpb25zXzEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydWxlVGV4dCArPSBcIiB9XCI7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0UnVsZShydWxlVGV4dCwgaW5kZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBhc3luY0RlY2xhcmF0aW9ucyA9IG5ldyBNYXAoKTtcclxuICAgICAgICAgICAgdmFyIHZhckRlY2xhcmF0aW9ucyA9IG5ldyBNYXAoKTtcclxuICAgICAgICAgICAgdmFyIGFzeW5jRGVjbGFyYXRpb25Db3VudGVyID0gMDtcclxuICAgICAgICAgICAgdmFyIHZhckRlY2xhcmF0aW9uQ291bnRlciA9IDA7XHJcbiAgICAgICAgICAgIHZhciByb290UmVhZHlHcm91cCA9IHtydWxlOiBudWxsLCBydWxlczogW10sIGlzR3JvdXA6IHRydWV9O1xyXG4gICAgICAgICAgICB2YXIgZ3JvdXBSZWZzID0gbmV3IFdlYWtNYXAoKTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0R3JvdXAocnVsZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ1bGUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByb290UmVhZHlHcm91cDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChncm91cFJlZnMuaGFzKHJ1bGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwUmVmcy5nZXQocnVsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSB7cnVsZTogcnVsZSwgcnVsZXM6IFtdLCBpc0dyb3VwOiB0cnVlfTtcclxuICAgICAgICAgICAgICAgIGdyb3VwUmVmcy5zZXQocnVsZSwgZ3JvdXApO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudEdyb3VwID0gZ2V0R3JvdXAocnVsZS5wYXJlbnRSdWxlKTtcclxuICAgICAgICAgICAgICAgIHBhcmVudEdyb3VwLnJ1bGVzLnB1c2goZ3JvdXApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhclR5cGVDaGFuZ2VDbGVhbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjbGVhcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsZWFyKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXJUeXBlQ2hhbmdlQ2xlYW5lcnMuY2xlYXIoKTtcclxuICAgICAgICAgICAgbW9kUnVsZXNcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSBfYS5zZWxlY3RvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zID0gX2EuZGVjbGFyYXRpb25zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRSdWxlID0gX2EucGFyZW50UnVsZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBnZXRHcm91cChwYXJlbnRSdWxlKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZHlTdHlsZVJ1bGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBzZWxlY3RvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNHcm91cDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWFkeURlY2xhcmF0aW9ucyA9IHJlYWR5U3R5bGVSdWxlLmRlY2xhcmF0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICBncm91cC5ydWxlcy5wdXNoKHJlYWR5U3R5bGVSdWxlKTtcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVBc3luY0RlY2xhcmF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGFudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWVcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzeW5jS2V5ID0gKythc3luY0RlY2xhcmF0aW9uQ291bnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzeW5jRGVjbGFyYXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGFudDogaW1wb3J0YW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmNLZXk6IGFzeW5jS2V5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWU6IHNvdXJjZVZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5RGVjbGFyYXRpb25zLnB1c2goYXN5bmNEZWNsYXJhdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UmVuZGVySWQgPSByZW5kZXJJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWQudGhlbihmdW5jdGlvbiAoYXN5bmNWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFhc3luY1ZhbHVlIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBc3luY0NhbmNlbGxlZCgpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJlbmRlcklkICE9PSByZW5kZXJJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmNEZWNsYXJhdGlvbi52YWx1ZSA9IGFzeW5jVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luY1F1ZXVlLmFkZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0FzeW5jQ2FuY2VsbGVkKCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJlbmRlcklkICE9PSByZW5kZXJJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYnVpbGRBc3luY1J1bGUoYXN5bmNLZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVWYXJEZWNsYXJhdGlvbnMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0YW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFyRGVjcyA9IG1vZGlmaWVkLmRlY2xhcmF0aW9ucyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVHlwZUNoYW5nZSA9IG1vZGlmaWVkLm9uVHlwZUNoYW5nZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhcktleSA9ICsrdmFyRGVjbGFyYXRpb25Db3VudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFJlbmRlcklkID0gcmVuZGVySWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbml0aWFsSW5kZXggPSByZWFkeURlY2xhcmF0aW9ucy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGREZWNzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJEZWNzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBEZWMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzb3VyY2VWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQ6IGltcG9ydGFudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZTogc291cmNlVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyS2V5OiB2YXJLZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkeURlY2xhcmF0aW9ucy5wdXNoKHRlbXBEZWMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkRGVjcyA9IFt0ZW1wRGVjXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJEZWNzLmZvckVhY2goZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZC52YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVBc3luY0RlY2xhcmF0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2QucHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZC52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0YW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWFkeURlYyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IG1vZC5wcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG1vZC52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0YW50OiBpbXBvcnRhbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlOiBzb3VyY2VWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyS2V5OiB2YXJLZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5RGVjbGFyYXRpb25zLnB1c2gocmVhZHlEZWMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZERlY3MucHVzaChyZWFkeURlYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvblR5cGVDaGFuZ2UuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKG5ld0RlY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0FzeW5jQ2FuY2VsbGVkKCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVuZGVySWQgIT09IHJlbmRlcklkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZHlWYXJEZWNzID0gbmV3RGVjcy5tYXAoZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBtb2QucHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtb2QudmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGFudDogaW1wb3J0YW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZTogc291cmNlVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcktleTogdmFyS2V5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gcmVhZHlEZWNsYXJhdGlvbnMuaW5kZXhPZihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGREZWNzWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxJbmRleFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5RGVjbGFyYXRpb25zLnNwbGljZS5hcHBseShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkeURlY2xhcmF0aW9ucyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3NwcmVhZEFycmF5KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaW5kZXgsIG9sZERlY3MubGVuZ3RoXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19yZWFkKHJlYWR5VmFyRGVjcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZERlY3MgPSByZWFkeVZhckRlY3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWJ1aWxkVmFyUnVsZSh2YXJLZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyVHlwZUNoYW5nZUNsZWFuZXJzLmFkZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb25UeXBlQ2hhbmdlLnJlbW92ZUxpc3RlbmVycygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IF9hLnByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfYS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGFudCA9IF9hLmltcG9ydGFudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlID0gX2Euc291cmNlVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGlmaWVkID0gdmFsdWUodGhlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVkIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUFzeW5jRGVjbGFyYXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0YW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BlcnR5LnN0YXJ0c1dpdGgoXCItLVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVZhckRlY2xhcmF0aW9ucyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHlEZWNsYXJhdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG1vZGlmaWVkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRhbnQ6IGltcG9ydGFudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVmFsdWU6IHNvdXJjZVZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkeURlY2xhcmF0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGFudDogaW1wb3J0YW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVZhbHVlOiBzb3VyY2VWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgc2hlZXQgPSBwcmVwYXJlU2hlZXQoKTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gYnVpbGRTdHlsZVNoZWV0KCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlVGFyZ2V0KGdyb3VwLCBwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcnVsZSA9IGdyb3VwLnJ1bGU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUgaW5zdGFuY2VvZiBDU1NNZWRpYVJ1bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lZGlhID0gcnVsZS5tZWRpYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gcGFyZW50LmNzc1J1bGVzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmluc2VydFJ1bGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBtZWRpYSBcIi5jb25jYXQobWVkaWEubWVkaWFUZXh0LCBcIiB7fVwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQuY3NzUnVsZXNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXRlcmF0ZVJlYWR5UnVsZXMoZ3JvdXAsIHRhcmdldCwgc3R5bGVJdGVyYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwLnJ1bGVzLmZvckVhY2goZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIuaXNHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBjcmVhdGVUYXJnZXQociwgdGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGVSZWFkeVJ1bGVzKHIsIHQsIHN0eWxlSXRlcmF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVJdGVyYXRvcihyLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpdGVyYXRlUmVhZHlSdWxlcyhcclxuICAgICAgICAgICAgICAgICAgICByb290UmVhZHlHcm91cCxcclxuICAgICAgICAgICAgICAgICAgICBzaGVldCxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocnVsZSwgdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRhcmdldC5jc3NSdWxlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZGVjbGFyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNLZXkgPSBfYS5hc3luY0tleSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJLZXkgPSBfYS52YXJLZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXN5bmNLZXkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jRGVjbGFyYXRpb25zLnNldChhc3luY0tleSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlOiBydWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyS2V5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJEZWNsYXJhdGlvbnMuc2V0KHZhcktleSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlOiBydWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRSdWxlKHRhcmdldCwgaW5kZXgsIHJ1bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gcmVidWlsZEFzeW5jUnVsZShrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYSA9IGFzeW5jRGVjbGFyYXRpb25zLmdldChrZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUgPSBfYS5ydWxlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IF9hLnRhcmdldCxcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IF9hLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRlbGV0ZVJ1bGUoaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgc2V0UnVsZSh0YXJnZXQsIGluZGV4LCBydWxlKTtcclxuICAgICAgICAgICAgICAgIGFzeW5jRGVjbGFyYXRpb25zLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlYnVpbGRWYXJSdWxlKGtleSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hID0gdmFyRGVjbGFyYXRpb25zLmdldChrZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUgPSBfYS5ydWxlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IF9hLnRhcmdldCxcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IF9hLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRlbGV0ZVJ1bGUoaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgc2V0UnVsZSh0YXJnZXQsIGluZGV4LCBydWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBidWlsZFN0eWxlU2hlZXQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbW9kaWZ5U2hlZXQ6IG1vZGlmeVNoZWV0LFxyXG4gICAgICAgICAgICBzaG91bGRSZWJ1aWxkU3R5bGU6IHNob3VsZFJlYnVpbGRTdHlsZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIFNUWUxFX1NFTEVDVE9SID0gJ3N0eWxlLCBsaW5rW3JlbCo9XCJzdHlsZXNoZWV0XCIgaV06bm90KFtkaXNhYmxlZF0pJztcclxuICAgIGZ1bmN0aW9uIGlzRm9udHNHb29nbGVBcGlTdHlsZShlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFlbGVtZW50LmhyZWYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudFVSTCA9IG5ldyBVUkwoZWxlbWVudC5ocmVmKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRVUkwuaG9zdG5hbWUgPT09IFwiZm9udHMuZ29vZ2xlYXBpcy5jb21cIjtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgbG9nSW5mbyhcIkNvdWxkbid0IGNvbnN0cnVjdCBcIi5jb25jYXQoZWxlbWVudC5ocmVmLCBcIiBhcyBVUkxcIikpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc2hvdWxkTWFuYWdlU3R5bGUoZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTFN0eWxlRWxlbWVudCB8fFxyXG4gICAgICAgICAgICAgICAgZWxlbWVudCBpbnN0YW5jZW9mIFNWR1N0eWxlRWxlbWVudCB8fFxyXG4gICAgICAgICAgICAgICAgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQgJiZcclxuICAgICAgICAgICAgICAgICAgICBCb29sZWFuKGVsZW1lbnQucmVsKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVsLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzdHlsZXNoZWV0XCIpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgQm9vbGVhbihlbGVtZW50LmhyZWYpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIWVsZW1lbnQuZGlzYWJsZWQgJiZcclxuICAgICAgICAgICAgICAgICAgICAoaXNGaXJlZm94XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gIWVsZW1lbnQuaHJlZi5zdGFydHNXaXRoKFwibW96LWV4dGVuc2lvbjovL1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRydWUpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIWlzRm9udHNHb29nbGVBcGlTdHlsZShlbGVtZW50KSkpICYmXHJcbiAgICAgICAgICAgICFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcImRhcmtyZWFkZXJcIikgJiZcclxuICAgICAgICAgICAgZWxlbWVudC5tZWRpYS50b0xvd2VyQ2FzZSgpICE9PSBcInByaW50XCIgJiZcclxuICAgICAgICAgICAgIWVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwic3R5bHVzXCIpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldE1hbmFnZWFibGVTdHlsZXMobm9kZSwgcmVzdWx0cywgZGVlcCkge1xyXG4gICAgICAgIGlmIChyZXN1bHRzID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGVlcCA9PT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIGRlZXAgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2hvdWxkTWFuYWdlU3R5bGUobm9kZSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKG5vZGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50IHx8XHJcbiAgICAgICAgICAgIChpc1NoYWRvd0RvbVN1cHBvcnRlZCAmJiBub2RlIGluc3RhbmNlb2YgU2hhZG93Um9vdCkgfHxcclxuICAgICAgICAgICAgbm9kZSA9PT0gZG9jdW1lbnRcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgZm9yRWFjaChub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoU1RZTEVfU0VMRUNUT1IpLCBmdW5jdGlvbiAoc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRNYW5hZ2VhYmxlU3R5bGVzKHN0eWxlLCByZXN1bHRzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoZGVlcCkge1xyXG4gICAgICAgICAgICAgICAgaXRlcmF0ZVNoYWRvd0hvc3RzKG5vZGUsIGZ1bmN0aW9uIChob3N0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldE1hbmFnZWFibGVTdHlsZXMoaG9zdC5zaGFkb3dSb290LCByZXN1bHRzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgIH1cclxuICAgIHZhciBzeW5jU3R5bGVTZXQgPSBuZXcgV2Vha1NldCgpO1xyXG4gICAgdmFyIGNvcnNTdHlsZVNldCA9IG5ldyBXZWFrU2V0KCk7XHJcbiAgICB2YXIgY2FuT3B0aW1pemVVc2luZ1Byb3h5JDEgPSBmYWxzZTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgXCJfX2RhcmtyZWFkZXJfX2lubGluZVNjcmlwdHNBbGxvd2VkXCIsXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjYW5PcHRpbWl6ZVVzaW5nUHJveHkkMSA9IHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB7b25jZTogdHJ1ZSwgcGFzc2l2ZTogdHJ1ZX1cclxuICAgICk7XHJcbiAgICB2YXIgbG9hZGluZ0xpbmtDb3VudGVyID0gMDtcclxuICAgIHZhciByZWplY3RvcnNGb3JMb2FkaW5nTGlua3MgPSBuZXcgTWFwKCk7XHJcbiAgICBmdW5jdGlvbiBjbGVhbkxvYWRpbmdMaW5rcygpIHtcclxuICAgICAgICByZWplY3RvcnNGb3JMb2FkaW5nTGlua3MuY2xlYXIoKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG1hbmFnZVN0eWxlKGVsZW1lbnQsIF9hKSB7XHJcbiAgICAgICAgdmFyIHVwZGF0ZSA9IF9hLnVwZGF0ZSxcclxuICAgICAgICAgICAgbG9hZGluZ1N0YXJ0ID0gX2EubG9hZGluZ1N0YXJ0LFxyXG4gICAgICAgICAgICBsb2FkaW5nRW5kID0gX2EubG9hZGluZ0VuZDtcclxuICAgICAgICB2YXIgcHJldlN0eWxlcyA9IFtdO1xyXG4gICAgICAgIHZhciBuZXh0ID0gZWxlbWVudDtcclxuICAgICAgICB3aGlsZSAoXHJcbiAgICAgICAgICAgIChuZXh0ID0gbmV4dC5uZXh0RWxlbWVudFNpYmxpbmcpICYmXHJcbiAgICAgICAgICAgIG5leHQubWF0Y2hlcyhcIi5kYXJrcmVhZGVyXCIpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHByZXZTdHlsZXMucHVzaChuZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvcnNDb3B5ID1cclxuICAgICAgICAgICAgcHJldlN0eWxlcy5maW5kKGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsLm1hdGNoZXMoXCIuZGFya3JlYWRlci0tY29yc1wiKSAmJiAhY29yc1N0eWxlU2V0LmhhcyhlbCk7XHJcbiAgICAgICAgICAgIH0pIHx8IG51bGw7XHJcbiAgICAgICAgdmFyIHN5bmNTdHlsZSA9XHJcbiAgICAgICAgICAgIHByZXZTdHlsZXMuZmluZChmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbC5tYXRjaGVzKFwiLmRhcmtyZWFkZXItLXN5bmNcIikgJiYgIXN5bmNTdHlsZVNldC5oYXMoZWwpO1xyXG4gICAgICAgICAgICB9KSB8fCBudWxsO1xyXG4gICAgICAgIHZhciBjb3JzQ29weVBvc2l0aW9uV2F0Y2hlciA9IG51bGw7XHJcbiAgICAgICAgdmFyIHN5bmNTdHlsZVBvc2l0aW9uV2F0Y2hlciA9IG51bGw7XHJcbiAgICAgICAgdmFyIGNhbmNlbEFzeW5jT3BlcmF0aW9ucyA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBpc092ZXJyaWRlRW1wdHkgPSB0cnVlO1xyXG4gICAgICAgIHZhciBzaGVldE1vZGlmaWVyID0gY3JlYXRlU3R5bGVTaGVldE1vZGlmaWVyKCk7XHJcbiAgICAgICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1cGRhdGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXJPcHRpb25zID0ge1xyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxyXG4gICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICAgICAgICAgIGNoYXJhY3RlckRhdGE6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZ1bmN0aW9uIGNvbnRhaW5zQ1NTSW1wb3J0KCkge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MU3R5bGVFbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjc3NUZXh0ID0gcmVtb3ZlQ1NTQ29tbWVudHMoXHJcbiAgICAgICAgICAgICAgICAoX2EgPSBlbGVtZW50LnRleHRDb250ZW50KSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBcIlwiXHJcbiAgICAgICAgICAgICkudHJpbSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gY3NzVGV4dC5tYXRjaChjc3NJbXBvcnRSZWdleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGhhc0ltcG9ydHMoY3NzUnVsZXMsIGNoZWNrQ3Jvc3NPcmlnaW4pIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoY3NzUnVsZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBydWxlID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgY3NzUnVsZXNMb29wOiBmb3IgKFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMCwgbGVuID0gY3NzUnVsZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPCBsZW47XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICBydWxlID0gY3NzUnVsZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUuaHJlZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tDcm9zc09yaWdpbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFydWxlLmhyZWYuc3RhcnRzV2l0aChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaHJlZi5zdGFydHNXaXRoKFwiaHR0cFwiKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFydWxlLmhyZWYuc3RhcnRzV2l0aChsb2NhdGlvbi5vcmlnaW4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGNzc1J1bGVzTG9vcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBjc3NSdWxlc0xvb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UnVsZXNTeW5jKCkge1xyXG4gICAgICAgICAgICBpZiAoY29yc0NvcHkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb3JzQ29weS5zaGVldC5jc3NSdWxlcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGFpbnNDU1NJbXBvcnQoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGNzc1J1bGVzID0gc2FmZUdldFNoZWV0UnVsZXMoKTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCAmJlxyXG4gICAgICAgICAgICAgICAgIWlzUmVsYXRpdmVIcmVmT25BYnNvbHV0ZVBhdGgoZWxlbWVudC5ocmVmKSAmJlxyXG4gICAgICAgICAgICAgICAgaGFzSW1wb3J0cyhjc3NSdWxlcywgZmFsc2UpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGhhc0ltcG9ydHMoY3NzUnVsZXMsIHRydWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY3NzUnVsZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGluc2VydFN0eWxlKCkge1xyXG4gICAgICAgICAgICBpZiAoY29yc0NvcHkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lm5leHRTaWJsaW5nICE9PSBjb3JzQ29weSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcnNDb3B5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm5leHRTaWJsaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjb3JzQ29weS5uZXh0U2libGluZyAhPT0gc3luY1N0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3luY1N0eWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JzQ29weS5uZXh0U2libGluZ1xyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5uZXh0U2libGluZyAhPT0gc3luY1N0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHN5bmNTdHlsZSwgZWxlbWVudC5uZXh0U2libGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU3luY1N0eWxlKCkge1xyXG4gICAgICAgICAgICBzeW5jU3R5bGUgPVxyXG4gICAgICAgICAgICAgICAgZWxlbWVudCBpbnN0YW5jZW9mIFNWR1N0eWxlRWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0eWxlXCJcclxuICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcclxuICAgICAgICAgICAgc3luY1N0eWxlLmNsYXNzTGlzdC5hZGQoXCJkYXJrcmVhZGVyXCIpO1xyXG4gICAgICAgICAgICBzeW5jU3R5bGUuY2xhc3NMaXN0LmFkZChcImRhcmtyZWFkZXItLXN5bmNcIik7XHJcbiAgICAgICAgICAgIHN5bmNTdHlsZS5tZWRpYSA9IFwic2NyZWVuXCI7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnRpdGxlKSB7XHJcbiAgICAgICAgICAgICAgICBzeW5jU3R5bGUudGl0bGUgPSBlbGVtZW50LnRpdGxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN5bmNTdHlsZVNldC5hZGQoc3luY1N0eWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlzTG9hZGluZ1J1bGVzID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHdhc0xvYWRpbmdFcnJvciA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBsb2FkaW5nTGlua0lkID0gKytsb2FkaW5nTGlua0NvdW50ZXI7XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UnVsZXNBc3luYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNzc1RleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY3NzQmFzZVBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgX2EsXHJcbiAgICAgICAgICAgICAgICAgICAgY3NzUnVsZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzRXJyb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVsbENTU1RleHQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2I7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgSFRNTExpbmtFbGVtZW50KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9hID0gX19yZWFkKGdldFJ1bGVzT3JFcnJvcigpLCAyKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNzc1J1bGVzID0gX2FbMF0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhY2Nlc3NFcnJvciA9IF9hWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaXNTYWZhcmkgJiYgIWVsZW1lbnQuc2hlZXQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghaXNTYWZhcmkgJiYgIWNzc1J1bGVzICYmICFhY2Nlc3NFcnJvcikgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdGlsbExvYWRpbmdFcnJvcihhY2Nlc3NFcnJvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgbGlua0xvYWRpbmcoZWxlbWVudCwgbG9hZGluZ0xpbmtJZCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXNMb2FkaW5nRXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbmNlbEFzeW5jT3BlcmF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgbnVsbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2IgPSBfX3JlYWQoZ2V0UnVsZXNPckVycm9yKCksIDIpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY3NzUnVsZXMgPSBfYlswXSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGFjY2Vzc0Vycm9yID0gX2JbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3NzUnVsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc0ltcG9ydHMoY3NzUnVsZXMsIGZhbHNlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIGNzc1J1bGVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGxvYWRUZXh0KGVsZW1lbnQuaHJlZildO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzQmFzZVBhdGggPSBnZXRDU1NCYXNlQmF0aChlbGVtZW50LmhyZWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbmNlbEFzeW5jT3BlcmF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgbnVsbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbnNDU1NJbXBvcnQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1RleHQgPSBlbGVtZW50LnRleHRDb250ZW50LnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NCYXNlUGF0aCA9IGdldENTU0Jhc2VCYXRoKGxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSA4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNzc1RleHQpIHJldHVybiBbMywgMTNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSA5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYy50cnlzLnB1c2goWzksIDExLCAsIDEyXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIHJlcGxhY2VDU1NJbXBvcnRzKGNzc1RleHQsIGNzc0Jhc2VQYXRoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsQ1NTVGV4dCA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcnNDb3B5ID0gY3JlYXRlQ09SU0NvcHkoZWxlbWVudCwgZnVsbENTU1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDEyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3JzQ29weSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcnNDb3B5UG9zaXRpb25XYXRjaGVyID0gd2F0Y2hGb3JOb2RlUG9zaXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcnNDb3B5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByZXYtc2libGluZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIGNvcnNDb3B5LnNoZWV0LmNzc1J1bGVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZGV0YWlscyhvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHZhciBydWxlcyA9IGdldFJ1bGVzU3luYygpO1xyXG4gICAgICAgICAgICBpZiAoIXJ1bGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zZWNvbmRSb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGlzTG9hZGluZ1J1bGVzIHx8IHdhc0xvYWRpbmdFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaXNMb2FkaW5nUnVsZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZ1N0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICBnZXRSdWxlc0FzeW5jKClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0xvYWRpbmdSdWxlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nRW5kKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNMb2FkaW5nUnVsZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ0VuZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHtydWxlczogcnVsZXN9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZm9yY2VSZW5kZXJTdHlsZSA9IGZhbHNlO1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcih0aGVtZSwgaWdub3JlSW1hZ2VBbmFseXNpcykge1xyXG4gICAgICAgICAgICB2YXIgcnVsZXMgPSBnZXRSdWxlc1N5bmMoKTtcclxuICAgICAgICAgICAgaWYgKCFydWxlcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhbmNlbEFzeW5jT3BlcmF0aW9ucyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVDU1NSdWxlc0Zyb21TaGVldChzaGVldCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzaGVldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBzaGVldC5jc3NSdWxlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoZWV0LmRlbGV0ZVJ1bGUoaSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gcHJlcGFyZU92ZXJyaWRlc1NoZWV0KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzeW5jU3R5bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVTeW5jU3R5bGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN5bmNTdHlsZVBvc2l0aW9uV2F0Y2hlciAmJiBzeW5jU3R5bGVQb3NpdGlvbldhdGNoZXIuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgaW5zZXJ0U3R5bGUoKTtcclxuICAgICAgICAgICAgICAgIGlmIChzeW5jU3R5bGUuc2hlZXQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN5bmNTdHlsZS50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgc2hlZXQgPSBzeW5jU3R5bGUuc2hlZXQ7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVDU1NSdWxlc0Zyb21TaGVldChzaGVldCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3luY1N0eWxlUG9zaXRpb25XYXRjaGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3luY1N0eWxlUG9zaXRpb25XYXRjaGVyLnJ1bigpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzeW5jU3R5bGVQb3NpdGlvbldhdGNoZXIgPSB3YXRjaEZvck5vZGVQb3NpdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3luY1N0eWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByZXYtc2libGluZ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JjZVJlbmRlclN0eWxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkT3ZlcnJpZGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bmNTdHlsZS5zaGVldDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBidWlsZE92ZXJyaWRlcygpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmb3JjZSA9IGZvcmNlUmVuZGVyU3R5bGU7XHJcbiAgICAgICAgICAgICAgICBmb3JjZVJlbmRlclN0eWxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzaGVldE1vZGlmaWVyLm1vZGlmeVNoZWV0KHtcclxuICAgICAgICAgICAgICAgICAgICBwcmVwYXJlU2hlZXQ6IHByZXBhcmVPdmVycmlkZXNTaGVldCxcclxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VDU1NSdWxlczogcnVsZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6IHRoZW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGlnbm9yZUltYWdlQW5hbHlzaXM6IGlnbm9yZUltYWdlQW5hbHlzaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yY2U6IGZvcmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzQXN5bmNDYW5jZWxsZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbmNlbEFzeW5jT3BlcmF0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlzT3ZlcnJpZGVFbXB0eSA9IHN5bmNTdHlsZS5zaGVldC5jc3NSdWxlcy5sZW5ndGggPT09IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hlZXRNb2RpZmllci5zaG91bGRSZWJ1aWxkU3R5bGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkZFJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJ1aWxkT3ZlcnJpZGVzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFJ1bGVzT3JFcnJvcigpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnNoZWV0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW251bGwsIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtlbGVtZW50LnNoZWV0LmNzc1J1bGVzLCBudWxsXTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW251bGwsIGVycl07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gaXNTdGlsbExvYWRpbmdFcnJvcihlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZXJyb3IgJiYgZXJyb3IubWVzc2FnZSAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwibG9hZGluZ1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gc2FmZUdldFNoZWV0UnVsZXMoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IF9fcmVhZChnZXRSdWxlc09yRXJyb3IoKSwgMiksXHJcbiAgICAgICAgICAgICAgICBjc3NSdWxlcyA9IF9hWzBdLFxyXG4gICAgICAgICAgICAgICAgZXJyID0gX2FbMV07XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjc3NSdWxlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gd2F0Y2hGb3JTaGVldENoYW5nZXMoKSB7XHJcbiAgICAgICAgICAgIHdhdGNoRm9yU2hlZXRDaGFuZ2VzVXNpbmdQcm94eSgpO1xyXG4gICAgICAgICAgICBpZiAoIShjYW5PcHRpbWl6ZVVzaW5nUHJveHkkMSAmJiBlbGVtZW50LnNoZWV0KSkge1xyXG4gICAgICAgICAgICAgICAgd2F0Y2hGb3JTaGVldENoYW5nZXNVc2luZ1JBRigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBydWxlc0NoYW5nZUtleSA9IG51bGw7XHJcbiAgICAgICAgdmFyIHJ1bGVzQ2hlY2tGcmFtZUlkID0gbnVsbDtcclxuICAgICAgICBmdW5jdGlvbiBnZXRSdWxlc0NoYW5nZUtleSgpIHtcclxuICAgICAgICAgICAgdmFyIHJ1bGVzID0gc2FmZUdldFNoZWV0UnVsZXMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJ1bGVzID8gcnVsZXMubGVuZ3RoIDogbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZGlkUnVsZXNLZXlDaGFuZ2UoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRSdWxlc0NoYW5nZUtleSgpICE9PSBydWxlc0NoYW5nZUtleTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gd2F0Y2hGb3JTaGVldENoYW5nZXNVc2luZ1JBRigpIHtcclxuICAgICAgICAgICAgcnVsZXNDaGFuZ2VLZXkgPSBnZXRSdWxlc0NoYW5nZUtleSgpO1xyXG4gICAgICAgICAgICBzdG9wV2F0Y2hpbmdGb3JTaGVldENoYW5nZXNVc2luZ1JBRigpO1xyXG4gICAgICAgICAgICB2YXIgY2hlY2tGb3JVcGRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlkUnVsZXNLZXlDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGVzQ2hhbmdlS2V5ID0gZ2V0UnVsZXNDaGFuZ2VLZXkoKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjYW5PcHRpbWl6ZVVzaW5nUHJveHkkMSAmJiBlbGVtZW50LnNoZWV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvcFdhdGNoaW5nRm9yU2hlZXRDaGFuZ2VzVXNpbmdSQUYoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydWxlc0NoZWNrRnJhbWVJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShjaGVja0ZvclVwZGF0ZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNoZWNrRm9yVXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0b3BXYXRjaGluZ0ZvclNoZWV0Q2hhbmdlc1VzaW5nUkFGKCkge1xyXG4gICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShydWxlc0NoZWNrRnJhbWVJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhcmVTaGVldENoYW5nZXNQZW5kaW5nID0gZmFsc2U7XHJcbiAgICAgICAgZnVuY3Rpb24gb25TaGVldENoYW5nZSgpIHtcclxuICAgICAgICAgICAgY2FuT3B0aW1pemVVc2luZ1Byb3h5JDEgPSB0cnVlO1xyXG4gICAgICAgICAgICBzdG9wV2F0Y2hpbmdGb3JTaGVldENoYW5nZXNVc2luZ1JBRigpO1xyXG4gICAgICAgICAgICBpZiAoYXJlU2hlZXRDaGFuZ2VzUGVuZGluZykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVNoZWV0Q2hhbmdlcygpIHtcclxuICAgICAgICAgICAgICAgIGFyZVNoZWV0Q2hhbmdlc1BlbmRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmIChjYW5jZWxBc3luY09wZXJhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB1cGRhdGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhcmVTaGVldENoYW5nZXNQZW5kaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBxdWV1ZU1pY3JvdGFzayA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICBxdWV1ZU1pY3JvdGFzayhoYW5kbGVTaGVldENoYW5nZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGhhbmRsZVNoZWV0Q2hhbmdlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gd2F0Y2hGb3JTaGVldENoYW5nZXNVc2luZ1Byb3h5KCkge1xyXG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICAgICBcIl9fZGFya3JlYWRlcl9fdXBkYXRlU2hlZXRcIixcclxuICAgICAgICAgICAgICAgIG9uU2hlZXRDaGFuZ2UsXHJcbiAgICAgICAgICAgICAgICB7cGFzc2l2ZTogdHJ1ZX1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RvcFdhdGNoaW5nRm9yU2hlZXRDaGFuZ2VzVXNpbmdQcm94eSgpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAgICAgXCJfX2RhcmtyZWFkZXJfX3VwZGF0ZVNoZWV0XCIsXHJcbiAgICAgICAgICAgICAgICBvblNoZWV0Q2hhbmdlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0b3BXYXRjaGluZ0ZvclNoZWV0Q2hhbmdlcygpIHtcclxuICAgICAgICAgICAgc3RvcFdhdGNoaW5nRm9yU2hlZXRDaGFuZ2VzVXNpbmdQcm94eSgpO1xyXG4gICAgICAgICAgICBzdG9wV2F0Y2hpbmdGb3JTaGVldENoYW5nZXNVc2luZ1JBRigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwYXVzZSgpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICBjYW5jZWxBc3luY09wZXJhdGlvbnMgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb3JzQ29weVBvc2l0aW9uV2F0Y2hlciAmJiBjb3JzQ29weVBvc2l0aW9uV2F0Y2hlci5zdG9wKCk7XHJcbiAgICAgICAgICAgIHN5bmNTdHlsZVBvc2l0aW9uV2F0Y2hlciAmJiBzeW5jU3R5bGVQb3NpdGlvbldhdGNoZXIuc3RvcCgpO1xyXG4gICAgICAgICAgICBzdG9wV2F0Y2hpbmdGb3JTaGVldENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgcGF1c2UoKTtcclxuICAgICAgICAgICAgcmVtb3ZlTm9kZShjb3JzQ29weSk7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUoc3luY1N0eWxlKTtcclxuICAgICAgICAgICAgbG9hZGluZ0VuZCgpO1xyXG4gICAgICAgICAgICBpZiAocmVqZWN0b3JzRm9yTG9hZGluZ0xpbmtzLmhhcyhsb2FkaW5nTGlua0lkKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHJlamVjdG9yc0ZvckxvYWRpbmdMaW5rcy5nZXQobG9hZGluZ0xpbmtJZCk7XHJcbiAgICAgICAgICAgICAgICByZWplY3RvcnNGb3JMb2FkaW5nTGlua3MuZGVsZXRlKGxvYWRpbmdMaW5rSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0ICYmIHJlamVjdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHdhdGNoKCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQsIG9ic2VydmVyT3B0aW9ucyk7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTFN0eWxlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgd2F0Y2hGb3JTaGVldENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWF4TW92ZUNvdW50ID0gMTA7XHJcbiAgICAgICAgdmFyIG1vdmVDb3VudCA9IDA7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVzdG9yZSgpIHtcclxuICAgICAgICAgICAgaWYgKCFzeW5jU3R5bGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBtb3ZlQ291bnQrKztcclxuICAgICAgICAgICAgaWYgKG1vdmVDb3VudCA+IG1heE1vdmVDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGluc2VydFN0eWxlKCk7XHJcbiAgICAgICAgICAgIGNvcnNDb3B5UG9zaXRpb25XYXRjaGVyICYmIGNvcnNDb3B5UG9zaXRpb25XYXRjaGVyLnNraXAoKTtcclxuICAgICAgICAgICAgc3luY1N0eWxlUG9zaXRpb25XYXRjaGVyICYmIHN5bmNTdHlsZVBvc2l0aW9uV2F0Y2hlci5za2lwKCk7XHJcbiAgICAgICAgICAgIGlmICghaXNPdmVycmlkZUVtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICBmb3JjZVJlbmRlclN0eWxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGRldGFpbHM6IGRldGFpbHMsXHJcbiAgICAgICAgICAgIHJlbmRlcjogcmVuZGVyLFxyXG4gICAgICAgICAgICBwYXVzZTogcGF1c2UsXHJcbiAgICAgICAgICAgIGRlc3Ryb3k6IGRlc3Ryb3ksXHJcbiAgICAgICAgICAgIHdhdGNoOiB3YXRjaCxcclxuICAgICAgICAgICAgcmVzdG9yZTogcmVzdG9yZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBsaW5rTG9hZGluZyhsaW5rLCBsb2FkaW5nSWQpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgMixcclxuICAgICAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGVhblVwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCBvbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgb25FcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RvcnNGb3JMb2FkaW5nTGlua3MuZGVsZXRlKGxvYWRpbmdJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbkxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhblVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5VcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTGlua2VsZW1lbnQgXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChsb2FkaW5nSWQsIFwiIGNvdWxkbid0IGJlIGxvYWRlZC4gXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQobGluay5ocmVmKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0b3JzRm9yTG9hZGluZ0xpbmtzLnNldChsb2FkaW5nSWQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGluay5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBvbkxvYWQsIHtwYXNzaXZlOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIG9uRXJyb3IsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3NpdmU6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGluay5ocmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRDU1NJbXBvcnRVUkwoaW1wb3J0RGVjbGFyYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gZ2V0Q1NTVVJMVmFsdWUoXHJcbiAgICAgICAgICAgIGltcG9ydERlY2xhcmF0aW9uXHJcbiAgICAgICAgICAgICAgICAuc3Vic3RyaW5nKDcpXHJcbiAgICAgICAgICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvOyQvLCBcIlwiKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL3NjcmVlbiQvLCBcIlwiKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBsb2FkVGV4dCh1cmwpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdXJsLnN0YXJ0c1dpdGgoXCJkYXRhOlwiKSkgcmV0dXJuIFszLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBmZXRjaCh1cmwpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgX2Euc2VudCgpLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmV0Y2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IFwidGV4dC9jc3NcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcmVwbGFjZUNTU0ltcG9ydHMoY3NzVGV4dCwgYmFzZVBhdGgsIGNhY2hlKSB7XHJcbiAgICAgICAgaWYgKGNhY2hlID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgY2FjaGUgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGltcG9ydE1hdGNoZXMsXHJcbiAgICAgICAgICAgICAgICBpbXBvcnRNYXRjaGVzXzEsXHJcbiAgICAgICAgICAgICAgICBpbXBvcnRNYXRjaGVzXzFfMSxcclxuICAgICAgICAgICAgICAgIG1hdGNoLFxyXG4gICAgICAgICAgICAgICAgaW1wb3J0VVJMLFxyXG4gICAgICAgICAgICAgICAgYWJzb2x1dGVVUkwsXHJcbiAgICAgICAgICAgICAgICBpbXBvcnRlZENTUyxcclxuICAgICAgICAgICAgICAgIGVfMV8xO1xyXG4gICAgICAgICAgICB2YXIgZV8xLCBfYTtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzVGV4dCA9IHJlbW92ZUNTU0NvbW1lbnRzKGNzc1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ID0gcmVwbGFjZUNTU0ZvbnRGYWNlKGNzc1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ID0gcmVwbGFjZUNTU1JlbGF0aXZlVVJMc1dpdGhBYnNvbHV0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1RleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlUGF0aFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRNYXRjaGVzID0gZ2V0TWF0Y2hlcyhjc3NJbXBvcnRSZWdleCwgY3NzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgMTAsIDExLCAxMl0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAoaW1wb3J0TWF0Y2hlc18xID0gX192YWx1ZXMoaW1wb3J0TWF0Y2hlcykpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGltcG9ydE1hdGNoZXNfMV8xID0gaW1wb3J0TWF0Y2hlc18xLm5leHQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWltcG9ydE1hdGNoZXNfMV8xLmRvbmUpIHJldHVybiBbMywgOV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gaW1wb3J0TWF0Y2hlc18xXzEudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydFVSTCA9IGdldENTU0ltcG9ydFVSTChtYXRjaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFic29sdXRlVVJMID0gZ2V0QWJzb2x1dGVVUkwoYmFzZVBhdGgsIGltcG9ydFVSTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGVkQ1NTID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNhY2hlLmhhcyhhYnNvbHV0ZVVSTCkpIHJldHVybiBbMywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGVkQ1NTID0gY2FjaGUuZ2V0KGFic29sdXRlVVJMKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMywgNiwgLCA3XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgbG9hZFRleHQoYWJzb2x1dGVVUkwpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGVkQ1NTID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZS5zZXQoYWJzb2x1dGVVUkwsIGltcG9ydGVkQ1NTKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlQ1NTSW1wb3J0cyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRlZENTUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRDU1NCYXNlQmF0aChhYnNvbHV0ZVVSTCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGVkQ1NTID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDddO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRlZENTUyA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ID0gY3NzVGV4dC5zcGxpdChtYXRjaCkuam9pbihpbXBvcnRlZENTUyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gODtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydE1hdGNoZXNfMV8xID0gaW1wb3J0TWF0Y2hlc18xLm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgMTJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMV8xID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSB7ZXJyb3I6IGVfMV8xfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCAxMl07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRNYXRjaGVzXzFfMSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFpbXBvcnRNYXRjaGVzXzFfMS5kb25lICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9hID0gaW1wb3J0TWF0Y2hlc18xLnJldHVybilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5jYWxsKGltcG9ydE1hdGNoZXNfMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ID0gY3NzVGV4dC50cmltKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgY3NzVGV4dF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlQ09SU0NvcHkoc3JjRWxlbWVudCwgY3NzVGV4dCkge1xyXG4gICAgICAgIGlmICghY3NzVGV4dCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvcnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcbiAgICAgICAgY29ycy5jbGFzc0xpc3QuYWRkKFwiZGFya3JlYWRlclwiKTtcclxuICAgICAgICBjb3JzLmNsYXNzTGlzdC5hZGQoXCJkYXJrcmVhZGVyLS1jb3JzXCIpO1xyXG4gICAgICAgIGNvcnMubWVkaWEgPSBcInNjcmVlblwiO1xyXG4gICAgICAgIGNvcnMudGV4dENvbnRlbnQgPSBjc3NUZXh0O1xyXG4gICAgICAgIHNyY0VsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY29ycywgc3JjRWxlbWVudC5uZXh0U2libGluZyk7XHJcbiAgICAgICAgY29ycy5zaGVldC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgY29yc1N0eWxlU2V0LmFkZChjb3JzKTtcclxuICAgICAgICByZXR1cm4gY29ycztcclxuICAgIH1cclxuXHJcbiAgICB2YXIgb2JzZXJ2ZXJzID0gW107XHJcbiAgICB2YXIgb2JzZXJ2ZWRSb290cztcclxuICAgIHZhciBkZWZpbmVkQ3VzdG9tRWxlbWVudHMgPSBuZXcgU2V0KCk7XHJcbiAgICB2YXIgdW5kZWZpbmVkR3JvdXBzID0gbmV3IE1hcCgpO1xyXG4gICAgdmFyIGVsZW1lbnRzRGVmaW5pdGlvbkNhbGxiYWNrO1xyXG4gICAgZnVuY3Rpb24gaXNDdXN0b21FbGVtZW50KGVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoZWxlbWVudC50YWdOYW1lLmluY2x1ZGVzKFwiLVwiKSB8fCBlbGVtZW50LmdldEF0dHJpYnV0ZShcImlzXCIpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZWNvcmRVbmRlZmluZWRFbGVtZW50KGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgdGFnID0gZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgaWYgKCF0YWcuaW5jbHVkZXMoXCItXCIpKSB7XHJcbiAgICAgICAgICAgIHZhciBleHRlbmRlZFRhZyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiaXNcIik7XHJcbiAgICAgICAgICAgIGlmIChleHRlbmRlZFRhZykge1xyXG4gICAgICAgICAgICAgICAgdGFnID0gZXh0ZW5kZWRUYWc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF1bmRlZmluZWRHcm91cHMuaGFzKHRhZykpIHtcclxuICAgICAgICAgICAgdW5kZWZpbmVkR3JvdXBzLnNldCh0YWcsIG5ldyBTZXQoKSk7XHJcbiAgICAgICAgICAgIGN1c3RvbUVsZW1lbnRzV2hlbkRlZmluZWQodGFnKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50c0RlZmluaXRpb25DYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IHVuZGVmaW5lZEdyb3Vwcy5nZXQodGFnKTtcclxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWRHcm91cHMuZGVsZXRlKHRhZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNEZWZpbml0aW9uQ2FsbGJhY2soQXJyYXkuZnJvbShlbGVtZW50cykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdW5kZWZpbmVkR3JvdXBzLmdldCh0YWcpLmFkZChlbGVtZW50KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNvbGxlY3RVbmRlZmluZWRFbGVtZW50cyhyb290KSB7XHJcbiAgICAgICAgaWYgKCFpc0RlZmluZWRTZWxlY3RvclN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvckVhY2goXHJcbiAgICAgICAgICAgIHJvb3QucXVlcnlTZWxlY3RvckFsbChcIjpub3QoOmRlZmluZWQpXCIpLFxyXG4gICAgICAgICAgICByZWNvcmRVbmRlZmluZWRFbGVtZW50XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIHZhciBjYW5PcHRpbWl6ZVVzaW5nUHJveHkgPSBmYWxzZTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgXCJfX2RhcmtyZWFkZXJfX2lubGluZVNjcmlwdHNBbGxvd2VkXCIsXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjYW5PcHRpbWl6ZVVzaW5nUHJveHkgPSB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge29uY2U6IHRydWUsIHBhc3NpdmU6IHRydWV9XHJcbiAgICApO1xyXG4gICAgdmFyIHJlc29sdmVycyA9IG5ldyBNYXAoKTtcclxuICAgIGZ1bmN0aW9uIGhhbmRsZUlzRGVmaW5lZChlKSB7XHJcbiAgICAgICAgY2FuT3B0aW1pemVVc2luZ1Byb3h5ID0gdHJ1ZTtcclxuICAgICAgICB2YXIgdGFnID0gZS5kZXRhaWwudGFnO1xyXG4gICAgICAgIGRlZmluZWRDdXN0b21FbGVtZW50cy5hZGQodGFnKTtcclxuICAgICAgICBpZiAocmVzb2x2ZXJzLmhhcyh0YWcpKSB7XHJcbiAgICAgICAgICAgIHZhciByID0gcmVzb2x2ZXJzLmdldCh0YWcpO1xyXG4gICAgICAgICAgICByZXNvbHZlcnMuZGVsZXRlKHRhZyk7XHJcbiAgICAgICAgICAgIHIuZm9yRWFjaChmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3VzdG9tRWxlbWVudHNXaGVuRGVmaW5lZCh0YWcpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkZWZpbmVkQ3VzdG9tRWxlbWVudHMuaGFzKHRhZykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzJdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICAyLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jdXN0b21FbGVtZW50cyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkID09PSBcImZ1bmN0aW9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZCh0YWcpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjYW5PcHRpbWl6ZVVzaW5nUHJveHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNvbHZlcnMuaGFzKHRhZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlcnMuZ2V0KHRhZykucHVzaChyZXNvbHZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXJzLnNldCh0YWcsIFtyZXNvbHZlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBDdXN0b21FdmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfX2RhcmtyZWFkZXJfX2FkZFVuZGVmaW5lZFJlc29sdmVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkZXRhaWw6IHt0YWc6IHRhZ319XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGVja0lmRGVmaW5lZF8xID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IHVuZGVmaW5lZEdyb3Vwcy5nZXQodGFnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudHMgJiYgZWxlbWVudHMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsdWVzKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubmV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlLm1hdGNoZXMoXCI6ZGVmaW5lZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShjaGVja0lmRGVmaW5lZF8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2hlY2tJZkRlZmluZWRfMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB3YXRjaFdoZW5DdXN0b21FbGVtZW50c0RlZmluZWQoY2FsbGJhY2spIHtcclxuICAgICAgICBlbGVtZW50c0RlZmluaXRpb25DYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdW5zdWJzY3JpYmVGcm9tRGVmaW5lQ3VzdG9tRWxlbWVudHMoKSB7XHJcbiAgICAgICAgZWxlbWVudHNEZWZpbml0aW9uQ2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHVuZGVmaW5lZEdyb3Vwcy5jbGVhcigpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgIFwiX19kYXJrcmVhZGVyX19pc0RlZmluZWRcIixcclxuICAgICAgICAgICAgaGFuZGxlSXNEZWZpbmVkXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHdhdGNoRm9yU3R5bGVDaGFuZ2VzKGN1cnJlbnRTdHlsZXMsIHVwZGF0ZSwgc2hhZG93Um9vdERpc2NvdmVyZWQpIHtcclxuICAgICAgICBzdG9wV2F0Y2hpbmdGb3JTdHlsZUNoYW5nZXMoKTtcclxuICAgICAgICB2YXIgcHJldlN0eWxlcyA9IG5ldyBTZXQoY3VycmVudFN0eWxlcyk7XHJcbiAgICAgICAgdmFyIHByZXZTdHlsZVNpYmxpbmdzID0gbmV3IFdlYWtNYXAoKTtcclxuICAgICAgICB2YXIgbmV4dFN0eWxlU2libGluZ3MgPSBuZXcgV2Vha01hcCgpO1xyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVTdHlsZVBvc2l0aW9uKHN0eWxlKSB7XHJcbiAgICAgICAgICAgIHByZXZTdHlsZVNpYmxpbmdzLnNldChzdHlsZSwgc3R5bGUucHJldmlvdXNFbGVtZW50U2libGluZyk7XHJcbiAgICAgICAgICAgIG5leHRTdHlsZVNpYmxpbmdzLnNldChzdHlsZSwgc3R5bGUubmV4dEVsZW1lbnRTaWJsaW5nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZm9yZ2V0U3R5bGVQb3NpdGlvbihzdHlsZSkge1xyXG4gICAgICAgICAgICBwcmV2U3R5bGVTaWJsaW5ncy5kZWxldGUoc3R5bGUpO1xyXG4gICAgICAgICAgICBuZXh0U3R5bGVTaWJsaW5ncy5kZWxldGUoc3R5bGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBkaWRTdHlsZVBvc2l0aW9uQ2hhbmdlKHN0eWxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICBzdHlsZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nICE9PSBwcmV2U3R5bGVTaWJsaW5ncy5nZXQoc3R5bGUpIHx8XHJcbiAgICAgICAgICAgICAgICBzdHlsZS5uZXh0RWxlbWVudFNpYmxpbmcgIT09IG5leHRTdHlsZVNpYmxpbmdzLmdldChzdHlsZSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3VycmVudFN0eWxlcy5mb3JFYWNoKHNhdmVTdHlsZVBvc2l0aW9uKTtcclxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVTdHlsZU9wZXJhdGlvbnMob3BlcmF0aW9ucykge1xyXG4gICAgICAgICAgICB2YXIgY3JlYXRlZFN0eWxlcyA9IG9wZXJhdGlvbnMuY3JlYXRlZFN0eWxlcyxcclxuICAgICAgICAgICAgICAgIHJlbW92ZWRTdHlsZXMgPSBvcGVyYXRpb25zLnJlbW92ZWRTdHlsZXMsXHJcbiAgICAgICAgICAgICAgICBtb3ZlZFN0eWxlcyA9IG9wZXJhdGlvbnMubW92ZWRTdHlsZXM7XHJcbiAgICAgICAgICAgIGNyZWF0ZWRTdHlsZXMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNhdmVTdHlsZVBvc2l0aW9uKHMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbW92ZWRTdHlsZXMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNhdmVTdHlsZVBvc2l0aW9uKHMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVtb3ZlZFN0eWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9yZ2V0U3R5bGVQb3NpdGlvbihzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNyZWF0ZWRTdHlsZXMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByZXZTdHlsZXMuYWRkKHMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVtb3ZlZFN0eWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJldlN0eWxlcy5kZWxldGUocyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkU3R5bGVzLnNpemUgKyByZW1vdmVkU3R5bGVzLnNpemUgKyBtb3ZlZFN0eWxlcy5zaXplID5cclxuICAgICAgICAgICAgICAgIDBcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IEFycmF5LmZyb20oY3JlYXRlZFN0eWxlcyksXHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZDogQXJyYXkuZnJvbShyZW1vdmVkU3R5bGVzKSxcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlZDogQXJyYXkuZnJvbShtb3ZlZFN0eWxlcyksXHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZDogW11cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZU1pbm9yVHJlZU11dGF0aW9ucyhfYSkge1xyXG4gICAgICAgICAgICB2YXIgYWRkaXRpb25zID0gX2EuYWRkaXRpb25zLFxyXG4gICAgICAgICAgICAgICAgbW92ZXMgPSBfYS5tb3ZlcyxcclxuICAgICAgICAgICAgICAgIGRlbGV0aW9ucyA9IF9hLmRlbGV0aW9ucztcclxuICAgICAgICAgICAgdmFyIGNyZWF0ZWRTdHlsZXMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVkU3R5bGVzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICB2YXIgbW92ZWRTdHlsZXMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgICAgIGFkZGl0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0TWFuYWdlYWJsZVN0eWxlcyhub2RlKS5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVkU3R5bGVzLmFkZChzdHlsZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRlbGV0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0TWFuYWdlYWJsZVN0eWxlcyhub2RlKS5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdmVkU3R5bGVzLmFkZChzdHlsZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG1vdmVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRNYW5hZ2VhYmxlU3R5bGVzKG5vZGUpLmZvckVhY2goZnVuY3Rpb24gKHN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vdmVkU3R5bGVzLmFkZChzdHlsZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGhhbmRsZVN0eWxlT3BlcmF0aW9ucyh7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkU3R5bGVzOiBjcmVhdGVkU3R5bGVzLFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlZFN0eWxlczogcmVtb3ZlZFN0eWxlcyxcclxuICAgICAgICAgICAgICAgIG1vdmVkU3R5bGVzOiBtb3ZlZFN0eWxlc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYWRkaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG4pIHtcclxuICAgICAgICAgICAgICAgIGV4dGVuZGVkSXRlcmF0ZVNoYWRvd0hvc3RzKG4pO1xyXG4gICAgICAgICAgICAgICAgY29sbGVjdFVuZGVmaW5lZEVsZW1lbnRzKG4pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYWRkaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpc0N1c3RvbUVsZW1lbnQobm9kZSkgJiYgcmVjb3JkVW5kZWZpbmVkRWxlbWVudChub2RlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZUh1Z2VUcmVlTXV0YXRpb25zKHJvb3QpIHtcclxuICAgICAgICAgICAgdmFyIHN0eWxlcyA9IG5ldyBTZXQoZ2V0TWFuYWdlYWJsZVN0eWxlcyhyb290KSk7XHJcbiAgICAgICAgICAgIHZhciBjcmVhdGVkU3R5bGVzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFN0eWxlcyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgdmFyIG1vdmVkU3R5bGVzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICBzdHlsZXMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwcmV2U3R5bGVzLmhhcyhzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRTdHlsZXMuYWRkKHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcHJldlN0eWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXN0eWxlcy5oYXMocykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkU3R5bGVzLmFkZChzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHN0eWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgIWNyZWF0ZWRTdHlsZXMuaGFzKHMpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIXJlbW92ZWRTdHlsZXMuaGFzKHMpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgZGlkU3R5bGVQb3NpdGlvbkNoYW5nZShzKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZWRTdHlsZXMuYWRkKHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaGFuZGxlU3R5bGVPcGVyYXRpb25zKHtcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRTdHlsZXM6IGNyZWF0ZWRTdHlsZXMsXHJcbiAgICAgICAgICAgICAgICByZW1vdmVkU3R5bGVzOiByZW1vdmVkU3R5bGVzLFxyXG4gICAgICAgICAgICAgICAgbW92ZWRTdHlsZXM6IG1vdmVkU3R5bGVzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBleHRlbmRlZEl0ZXJhdGVTaGFkb3dIb3N0cyhyb290KTtcclxuICAgICAgICAgICAgY29sbGVjdFVuZGVmaW5lZEVsZW1lbnRzKHJvb3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVBdHRyaWJ1dGVNdXRhdGlvbnMobXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgIHZhciB1cGRhdGVkU3R5bGVzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFN0eWxlcyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtLnRhcmdldDtcclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuaXNDb25uZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkTWFuYWdlU3R5bGUodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkU3R5bGVzLmFkZCh0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldCBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZGlzYWJsZWRcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZFN0eWxlcy5hZGQodGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAodXBkYXRlZFN0eWxlcy5zaXplICsgcmVtb3ZlZFN0eWxlcy5zaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkOiBBcnJheS5mcm9tKHVwZGF0ZWRTdHlsZXMpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZWQ6IEFycmF5LmZyb20ocmVtb3ZlZFN0eWxlcyksXHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZWQ6IFtdXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvYnNlcnZlKHJvb3QpIHtcclxuICAgICAgICAgICAgaWYgKG9ic2VydmVkUm9vdHMuaGFzKHJvb3QpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHRyZWVPYnNlcnZlciA9IGNyZWF0ZU9wdGltaXplZFRyZWVPYnNlcnZlcihyb290LCB7XHJcbiAgICAgICAgICAgICAgICBvbk1pbm9yTXV0YXRpb25zOiBoYW5kbGVNaW5vclRyZWVNdXRhdGlvbnMsXHJcbiAgICAgICAgICAgICAgICBvbkh1Z2VNdXRhdGlvbnM6IGhhbmRsZUh1Z2VUcmVlTXV0YXRpb25zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgYXR0ck9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoaGFuZGxlQXR0cmlidXRlTXV0YXRpb25zKTtcclxuICAgICAgICAgICAgYXR0ck9ic2VydmVyLm9ic2VydmUocm9vdCwge1xyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbXCJyZWxcIiwgXCJkaXNhYmxlZFwiLCBcIm1lZGlhXCIsIFwiaHJlZlwiXSxcclxuICAgICAgICAgICAgICAgIHN1YnRyZWU6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG9ic2VydmVycy5wdXNoKHRyZWVPYnNlcnZlciwgYXR0ck9ic2VydmVyKTtcclxuICAgICAgICAgICAgb2JzZXJ2ZWRSb290cy5hZGQocm9vdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN1YnNjcmliZUZvclNoYWRvd1Jvb3RDaGFuZ2VzKG5vZGUpIHtcclxuICAgICAgICAgICAgdmFyIHNoYWRvd1Jvb3QgPSBub2RlLnNoYWRvd1Jvb3Q7XHJcbiAgICAgICAgICAgIGlmIChzaGFkb3dSb290ID09IG51bGwgfHwgb2JzZXJ2ZWRSb290cy5oYXMoc2hhZG93Um9vdCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvYnNlcnZlKHNoYWRvd1Jvb3QpO1xyXG4gICAgICAgICAgICBzaGFkb3dSb290RGlzY292ZXJlZChzaGFkb3dSb290KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZXh0ZW5kZWRJdGVyYXRlU2hhZG93SG9zdHMobm9kZSkge1xyXG4gICAgICAgICAgICBpdGVyYXRlU2hhZG93SG9zdHMobm9kZSwgc3Vic2NyaWJlRm9yU2hhZG93Um9vdENoYW5nZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBvYnNlcnZlKGRvY3VtZW50KTtcclxuICAgICAgICBleHRlbmRlZEl0ZXJhdGVTaGFkb3dIb3N0cyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xyXG4gICAgICAgIHdhdGNoV2hlbkN1c3RvbUVsZW1lbnRzRGVmaW5lZChmdW5jdGlvbiAoaG9zdHMpIHtcclxuICAgICAgICAgICAgdmFyIG5ld1N0eWxlcyA9IFtdO1xyXG4gICAgICAgICAgICBob3N0cy5mb3JFYWNoKGZ1bmN0aW9uIChob3N0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHVzaChuZXdTdHlsZXMsIGdldE1hbmFnZWFibGVTdHlsZXMoaG9zdC5zaGFkb3dSb290KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB1cGRhdGUoe2NyZWF0ZWQ6IG5ld1N0eWxlcywgdXBkYXRlZDogW10sIHJlbW92ZWQ6IFtdLCBtb3ZlZDogW119KTtcclxuICAgICAgICAgICAgaG9zdHMuZm9yRWFjaChmdW5jdGlvbiAoaG9zdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNoYWRvd1Jvb3QgPSBob3N0LnNoYWRvd1Jvb3Q7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hhZG93Um9vdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlRm9yU2hhZG93Um9vdENoYW5nZXMoaG9zdCk7XHJcbiAgICAgICAgICAgICAgICBleHRlbmRlZEl0ZXJhdGVTaGFkb3dIb3N0cyhzaGFkb3dSb290KTtcclxuICAgICAgICAgICAgICAgIGNvbGxlY3RVbmRlZmluZWRFbGVtZW50cyhzaGFkb3dSb290KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIl9fZGFya3JlYWRlcl9faXNEZWZpbmVkXCIsIGhhbmRsZUlzRGVmaW5lZCwge1xyXG4gICAgICAgICAgICBwYXNzaXZlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29sbGVjdFVuZGVmaW5lZEVsZW1lbnRzKGRvY3VtZW50KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlc2V0T2JzZXJ2ZXJzKCkge1xyXG4gICAgICAgIG9ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBvYnNlcnZlcnMuc3BsaWNlKDAsIG9ic2VydmVycy5sZW5ndGgpO1xyXG4gICAgICAgIG9ic2VydmVkUm9vdHMgPSBuZXcgV2Vha1NldCgpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc3RvcFdhdGNoaW5nRm9yU3R5bGVDaGFuZ2VzKCkge1xyXG4gICAgICAgIHJlc2V0T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgdW5zdWJzY3JpYmVGcm9tRGVmaW5lQ3VzdG9tRWxlbWVudHMoKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgb3ZlcnJpZGVzID0gbmV3IFdlYWtTZXQoKTtcclxuICAgIGZ1bmN0aW9uIGhhc0Fkb3B0ZWRTdHlsZVNoZWV0cyhub2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgQXJyYXkuaXNBcnJheShub2RlLmFkb3B0ZWRTdHlsZVNoZWV0cykgJiZcclxuICAgICAgICAgICAgbm9kZS5hZG9wdGVkU3R5bGVTaGVldHMubGVuZ3RoID4gMFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVBZG9wdGVkU3R5bGVTaGVldE92ZXJyaWRlKG5vZGUpIHtcclxuICAgICAgICB2YXIgY2FuY2VsQXN5bmNPcGVyYXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgZnVuY3Rpb24gaXRlcmF0ZVNvdXJjZVNoZWV0cyhpdGVyYXRvcikge1xyXG4gICAgICAgICAgICBub2RlLmFkb3B0ZWRTdHlsZVNoZWV0cy5mb3JFYWNoKGZ1bmN0aW9uIChzaGVldCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvdmVycmlkZXMuaGFzKHNoZWV0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yKHNoZWV0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGluamVjdFNoZWV0KHNoZWV0LCBvdmVycmlkZSkge1xyXG4gICAgICAgICAgICB2YXIgbmV3U2hlZXRzID0gX19zcHJlYWRBcnJheShcclxuICAgICAgICAgICAgICAgIFtdLFxyXG4gICAgICAgICAgICAgICAgX19yZWFkKG5vZGUuYWRvcHRlZFN0eWxlU2hlZXRzKSxcclxuICAgICAgICAgICAgICAgIGZhbHNlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHZhciBzaGVldEluZGV4ID0gbmV3U2hlZXRzLmluZGV4T2Yoc2hlZXQpO1xyXG4gICAgICAgICAgICB2YXIgb3ZlcnJpZGVJbmRleCA9IG5ld1NoZWV0cy5pbmRleE9mKG92ZXJyaWRlKTtcclxuICAgICAgICAgICAgaWYgKG92ZXJyaWRlSW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgbmV3U2hlZXRzLnNwbGljZShvdmVycmlkZUluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuZXdTaGVldHMuc3BsaWNlKHNoZWV0SW5kZXggKyAxLCAwLCBvdmVycmlkZSk7XHJcbiAgICAgICAgICAgIG5vZGUuYWRvcHRlZFN0eWxlU2hlZXRzID0gbmV3U2hlZXRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBjbGVhcigpIHtcclxuICAgICAgICAgICAgdmFyIG5ld1NoZWV0cyA9IF9fc3ByZWFkQXJyYXkoXHJcbiAgICAgICAgICAgICAgICBbXSxcclxuICAgICAgICAgICAgICAgIF9fcmVhZChub2RlLmFkb3B0ZWRTdHlsZVNoZWV0cyksXHJcbiAgICAgICAgICAgICAgICBmYWxzZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gbmV3U2hlZXRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2hlZXQgPSBuZXdTaGVldHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAob3ZlcnJpZGVzLmhhcyhzaGVldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdTaGVldHMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJyaWRlcy5kZWxldGUoc2hlZXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChub2RlLmFkb3B0ZWRTdHlsZVNoZWV0cy5sZW5ndGggIT09IG5ld1NoZWV0cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuYWRvcHRlZFN0eWxlU2hlZXRzID0gbmV3U2hlZXRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgIGNhbmNlbEFzeW5jT3BlcmF0aW9ucyA9IHRydWU7XHJcbiAgICAgICAgICAgIGNsZWFyKCk7XHJcbiAgICAgICAgICAgIGlmIChmcmFtZUlkKSB7XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShmcmFtZUlkKTtcclxuICAgICAgICAgICAgICAgIGZyYW1lSWQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBydWxlc0NoYW5nZUtleSA9IDA7XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UnVsZXNDaGFuZ2VLZXkoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgICAgIGl0ZXJhdGVTb3VyY2VTaGVldHMoZnVuY3Rpb24gKHNoZWV0KSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCArPSBzaGVldC5jc3NSdWxlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoY291bnQgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBydWxlID0gbm9kZS5hZG9wdGVkU3R5bGVTaGVldHNbMF0uY3NzUnVsZXNbMF07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcnVsZSBpbnN0YW5jZW9mIENTU1N0eWxlUnVsZSA/IHJ1bGUuc3R5bGUubGVuZ3RoIDogY291bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIodGhlbWUsIGlnbm9yZUltYWdlQW5hbHlzaXMpIHtcclxuICAgICAgICAgICAgY2xlYXIoKTtcclxuICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNoZWV0ID0gbm9kZS5hZG9wdGVkU3R5bGVTaGVldHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAob3ZlcnJpZGVzLmhhcyhzaGVldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHJ1bGVzID0gc2hlZXQuY3NzUnVsZXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3ZlcnJpZGUgPSBuZXcgQ1NTU3R5bGVTaGVldCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHByZXBhcmVTaGVldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaV8xID0gb3ZlcnJpZGUuY3NzUnVsZXMubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaV8xID49IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlfMS0tXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJyaWRlLmRlbGV0ZVJ1bGUoaV8xKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaW5qZWN0U2hlZXQoc2hlZXQsIG92ZXJyaWRlKTtcclxuICAgICAgICAgICAgICAgICAgICBvdmVycmlkZXMuYWRkKG92ZXJyaWRlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3ZlcnJpZGU7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIHNoZWV0TW9kaWZpZXIgPSBjcmVhdGVTdHlsZVNoZWV0TW9kaWZpZXIoKTtcclxuICAgICAgICAgICAgICAgIHNoZWV0TW9kaWZpZXIubW9kaWZ5U2hlZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXBhcmVTaGVldDogcHJlcGFyZVNoZWV0LFxyXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUNTU1J1bGVzOiBydWxlcyxcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogdGhlbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWdub3JlSW1hZ2VBbmFseXNpczogaWdub3JlSW1hZ2VBbmFseXNpcyxcclxuICAgICAgICAgICAgICAgICAgICBmb3JjZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNBc3luY0NhbmNlbGxlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FuY2VsQXN5bmNPcGVyYXRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gbm9kZS5hZG9wdGVkU3R5bGVTaGVldHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgIF9sb29wXzEoaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcnVsZXNDaGFuZ2VLZXkgPSBnZXRSdWxlc0NoYW5nZUtleSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBjaGVja0ZvclVwZGF0ZXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRSdWxlc0NoYW5nZUtleSgpICE9PSBydWxlc0NoYW5nZUtleTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZyYW1lSWQgPSBudWxsO1xyXG4gICAgICAgIGZ1bmN0aW9uIHdhdGNoKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIGZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrRm9yVXBkYXRlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoZWV0cyA9IG5vZGUuYWRvcHRlZFN0eWxlU2hlZXRzLmZpbHRlcihmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIW92ZXJyaWRlcy5oYXMocyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soc2hlZXRzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdhdGNoKGNhbGxiYWNrKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlbmRlcjogcmVuZGVyLFxyXG4gICAgICAgICAgICBkZXN0cm95OiBkZXN0cm95LFxyXG4gICAgICAgICAgICB3YXRjaDogd2F0Y2hcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgdmFyIFN0eWxlU2hlZXRDb21tYW5kQnVpbGRlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gU3R5bGVTaGVldENvbW1hbmRCdWlsZGVyKG9uQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3NzUnVsZXMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5jb21tYW5kcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlID0gb25DaGFuZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFN0eWxlU2hlZXRDb21tYW5kQnVpbGRlci5wcm90b3R5cGUuaW5zZXJ0UnVsZSA9IGZ1bmN0aW9uIChcclxuICAgICAgICAgICAgY3NzVGV4dCxcclxuICAgICAgICAgICAgaW5kZXhcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJpbnNlcnRcIixcclxuICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgICAgIGNzc1RleHQ6IGNzc1RleHRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3NzUnVsZXMuc3BsaWNlKFxyXG4gICAgICAgICAgICAgICAgaW5kZXgsXHJcbiAgICAgICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICAgICAgbmV3IFN0eWxlU2hlZXRDb21tYW5kQnVpbGRlcih0aGlzLm9uQ2hhbmdlKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFN0eWxlU2hlZXRDb21tYW5kQnVpbGRlci5wcm90b3R5cGUuZGVsZXRlUnVsZSA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzLnB1c2goe3R5cGU6IFwiZGVsZXRlXCIsIGluZGV4OiBpbmRleH0pO1xyXG4gICAgICAgICAgICB0aGlzLmNzc1J1bGVzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFN0eWxlU2hlZXRDb21tYW5kQnVpbGRlci5wcm90b3R5cGUucmVwbGFjZVN5bmMgPSBmdW5jdGlvbiAoY3NzVGV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzLnNwbGljZSgwKTtcclxuICAgICAgICAgICAgdGhpcy5jb21tYW5kcy5wdXNoKHt0eXBlOiBcInJlcGxhY2VcIiwgY3NzVGV4dDogY3NzVGV4dH0pO1xyXG4gICAgICAgICAgICBpZiAoY3NzVGV4dCA9PT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jc3NSdWxlcy5zcGxpY2UoMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJTdHlsZVNoZWV0Q29tbWFuZEJ1aWxkZXIucmVwbGFjZVN5bmMoKSBpcyBub3QgZnVsbHkgc3VwcG9ydGVkXCJcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgU3R5bGVTaGVldENvbW1hbmRCdWlsZGVyLnByb3RvdHlwZS5nZXREZWVwQ1NTQ29tbWFuZHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkZWVwID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZHMuZm9yRWFjaChmdW5jdGlvbiAoY29tbWFuZCkge1xyXG4gICAgICAgICAgICAgICAgZGVlcC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBjb21tYW5kLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgY3NzVGV4dDogY29tbWFuZC50eXBlICE9PSBcImRlbGV0ZVwiID8gY29tbWFuZC5jc3NUZXh0IDogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBjb21tYW5kLnR5cGUgPT09IFwicmVwbGFjZVwiID8gW10gOiBbY29tbWFuZC5pbmRleF1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5jc3NSdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChydWxlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRDb21tYW5kcyA9IHJ1bGUuZ2V0RGVlcENTU0NvbW1hbmRzKCk7XHJcbiAgICAgICAgICAgICAgICBjaGlsZENvbW1hbmRzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5wYXRoLnVuc2hpZnQoaSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWVwO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgU3R5bGVTaGVldENvbW1hbmRCdWlsZGVyLnByb3RvdHlwZS5jbGVhckRlZXBDU1NDb21tYW5kcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jb21tYW5kcy5zcGxpY2UoMCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3NzUnVsZXMuZm9yRWFjaChmdW5jdGlvbiAocnVsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUuY2xlYXJEZWVwQ1NTQ29tbWFuZHMoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gU3R5bGVTaGVldENvbW1hbmRCdWlsZGVyO1xyXG4gICAgfSkoKTtcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZUFkb3B0ZWRTdHlsZVNoZWV0RmFsbGJhY2sob25DaGFuZ2UpIHtcclxuICAgICAgICB2YXIgY2FuY2VsQXN5bmNPcGVyYXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHNvdXJjZUNTU1J1bGVzID0gW107XHJcbiAgICAgICAgdmFyIGxhc3RUaGVtZTtcclxuICAgICAgICB2YXIgbGFzdElnbm9yZUltYWdlQW5hbHlzaXM7XHJcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQ1NTKGNzc1J1bGVzKSB7XHJcbiAgICAgICAgICAgIHNvdXJjZUNTU1J1bGVzID0gY3NzUnVsZXM7XHJcbiAgICAgICAgICAgIGlmIChsYXN0VGhlbWUgJiYgbGFzdElnbm9yZUltYWdlQW5hbHlzaXMpIHtcclxuICAgICAgICAgICAgICAgIHJlbmRlcihsYXN0VGhlbWUsIGxhc3RJZ25vcmVJbWFnZUFuYWx5c2lzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYnVpbGRlciA9IG5ldyBTdHlsZVNoZWV0Q29tbWFuZEJ1aWxkZXIob25DaGFuZ2UpO1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcih0aGVtZSwgaWdub3JlSW1hZ2VBbmFseXNpcykge1xyXG4gICAgICAgICAgICBsYXN0VGhlbWUgPSB0aGVtZTtcclxuICAgICAgICAgICAgbGFzdElnbm9yZUltYWdlQW5hbHlzaXMgPSBpZ25vcmVJbWFnZUFuYWx5c2lzO1xyXG4gICAgICAgICAgICB2YXIgcHJlcGFyZVNoZWV0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYnVpbGRlci5yZXBsYWNlU3luYyhcIlwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZGVyO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgc2hlZXRNb2RpZmllciA9IGNyZWF0ZVN0eWxlU2hlZXRNb2RpZmllcigpO1xyXG4gICAgICAgICAgICBzaGVldE1vZGlmaWVyLm1vZGlmeVNoZWV0KHtcclxuICAgICAgICAgICAgICAgIHByZXBhcmVTaGVldDogcHJlcGFyZVNoZWV0LFxyXG4gICAgICAgICAgICAgICAgc291cmNlQ1NTUnVsZXM6IHNvdXJjZUNTU1J1bGVzLFxyXG4gICAgICAgICAgICAgICAgdGhlbWU6IHRoZW1lLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlSW1hZ2VBbmFseXNpczogaWdub3JlSW1hZ2VBbmFseXNpcyxcclxuICAgICAgICAgICAgICAgIGZvcmNlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGlzQXN5bmNDYW5jZWxsZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FuY2VsQXN5bmNPcGVyYXRpb25zO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gY29tbWFuZHMoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb21tYW5kcyA9IGJ1aWxkZXIuZ2V0RGVlcENTU0NvbW1hbmRzKCk7XHJcbiAgICAgICAgICAgIGJ1aWxkZXIuY2xlYXJEZWVwQ1NTQ29tbWFuZHMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICBjYW5jZWxBc3luY09wZXJhdGlvbnMgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZW5kZXI6IHJlbmRlcixcclxuICAgICAgICAgICAgZGVzdHJveTogZGVzdHJveSxcclxuICAgICAgICAgICAgdXBkYXRlQ1NTOiB1cGRhdGVDU1MsXHJcbiAgICAgICAgICAgIGNvbW1hbmRzOiBjb21tYW5kc1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5qZWN0UHJveHkoXHJcbiAgICAgICAgZW5hYmxlU3R5bGVTaGVldHNQcm94eSxcclxuICAgICAgICBlbmFibGVDdXN0b21FbGVtZW50UmVnaXN0cnlQcm94eVxyXG4gICAgKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChcclxuICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KFwiX19kYXJrcmVhZGVyX19pbmxpbmVTY3JpcHRzQWxsb3dlZFwiKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyIGFkZFJ1bGVEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihcclxuICAgICAgICAgICAgQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgIFwiYWRkUnVsZVwiXHJcbiAgICAgICAgKTtcclxuICAgICAgICB2YXIgaW5zZXJ0UnVsZURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKFxyXG4gICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgXCJpbnNlcnRSdWxlXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIHZhciBkZWxldGVSdWxlRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoXHJcbiAgICAgICAgICAgIENTU1N0eWxlU2hlZXQucHJvdG90eXBlLFxyXG4gICAgICAgICAgICBcImRlbGV0ZVJ1bGVcIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyIHJlbW92ZVJ1bGVEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihcclxuICAgICAgICAgICAgQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgIFwicmVtb3ZlUnVsZVwiXHJcbiAgICAgICAgKTtcclxuICAgICAgICB2YXIgcmVwbGFjZURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKFxyXG4gICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgXCJyZXBsYWNlXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIHZhciByZXBsYWNlU3luY0Rlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKFxyXG4gICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgXCJyZXBsYWNlU3luY1wiXHJcbiAgICAgICAgKTtcclxuICAgICAgICB2YXIgZG9jdW1lbnRTdHlsZVNoZWV0c0Rlc2NyaXB0b3IgPSBlbmFibGVTdHlsZVNoZWV0c1Byb3h5XHJcbiAgICAgICAgICAgID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihEb2N1bWVudC5wcm90b3R5cGUsIFwic3R5bGVTaGVldHNcIilcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIHZhciBjdXN0b21FbGVtZW50UmVnaXN0cnlEZWZpbmVEZXNjcmlwdG9yID1cclxuICAgICAgICAgICAgZW5hYmxlQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5UHJveHlcclxuICAgICAgICAgICAgICAgID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihcclxuICAgICAgICAgICAgICAgICAgICAgIEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICBcImRlZmluZVwiXHJcbiAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIDogbnVsbDtcclxuICAgICAgICB2YXIgc2hvdWxkV3JhcEhUTUxFbGVtZW50ID0gW1xyXG4gICAgICAgICAgICBcImJhaWR1LmNvbVwiLFxyXG4gICAgICAgICAgICBcImJhaWtlLmJhaWR1LmNvbVwiLFxyXG4gICAgICAgICAgICBcImRpdHUuYmFpZHUuY29tXCIsXHJcbiAgICAgICAgICAgIFwibWFwLmJhaWR1LmNvbVwiLFxyXG4gICAgICAgICAgICBcIm1hcHMuYmFpZHUuY29tXCIsXHJcbiAgICAgICAgICAgIFwiaGFva2FuLmJhaWR1LmNvbVwiLFxyXG4gICAgICAgICAgICBcInBhbi5iYWlkdS5jb21cIixcclxuICAgICAgICAgICAgXCJwYXNzcG9ydC5iYWlkdS5jb21cIixcclxuICAgICAgICAgICAgXCJ0aWViYS5iYWlkdS5jb21cIixcclxuICAgICAgICAgICAgXCJ3d3cuYmFpZHUuY29tXCJcclxuICAgICAgICBdLmluY2x1ZGVzKGxvY2F0aW9uLmhvc3RuYW1lKTtcclxuICAgICAgICB2YXIgZ2V0RWxlbWVudHNCeVRhZ05hbWVEZXNjcmlwdG9yID0gc2hvdWxkV3JhcEhUTUxFbGVtZW50XHJcbiAgICAgICAgICAgID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihcclxuICAgICAgICAgICAgICAgICAgRWxlbWVudC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgICAgICAgIFwiZ2V0RWxlbWVudHNCeVRhZ05hbWVcIlxyXG4gICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIHZhciBzaG91bGRQcm94eUNoaWxkTm9kZXMgPSBsb2NhdGlvbi5ob3N0bmFtZSA9PT0gXCJ3d3cudnkubm9cIjtcclxuICAgICAgICB2YXIgY2hpbGROb2Rlc0Rlc2NyaXB0b3IgPSBzaG91bGRQcm94eUNoaWxkTm9kZXNcclxuICAgICAgICAgICAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE5vZGUucHJvdG90eXBlLCBcImNoaWxkTm9kZXNcIilcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIHZhciBjbGVhbmVycyA9IFtdO1xyXG4gICAgICAgIHZhciBjbGVhblVwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgICAgIFwiYWRkUnVsZVwiLFxyXG4gICAgICAgICAgICAgICAgYWRkUnVsZURlc2NyaXB0b3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICAgICAgQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgICAgICBcImluc2VydFJ1bGVcIixcclxuICAgICAgICAgICAgICAgIGluc2VydFJ1bGVEZXNjcmlwdG9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShcclxuICAgICAgICAgICAgICAgIENTU1N0eWxlU2hlZXQucHJvdG90eXBlLFxyXG4gICAgICAgICAgICAgICAgXCJkZWxldGVSdWxlXCIsXHJcbiAgICAgICAgICAgICAgICBkZWxldGVSdWxlRGVzY3JpcHRvclxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgICAgIFwicmVtb3ZlUnVsZVwiLFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlUnVsZURlc2NyaXB0b3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICAgICAgQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgICAgICBcInJlcGxhY2VcIixcclxuICAgICAgICAgICAgICAgIHJlcGxhY2VEZXNjcmlwdG9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShcclxuICAgICAgICAgICAgICAgIENTU1N0eWxlU2hlZXQucHJvdG90eXBlLFxyXG4gICAgICAgICAgICAgICAgXCJyZXBsYWNlU3luY1wiLFxyXG4gICAgICAgICAgICAgICAgcmVwbGFjZVN5bmNEZXNjcmlwdG9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJfX2RhcmtyZWFkZXJfX2NsZWFuVXBcIiwgY2xlYW5VcCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICAgICBcIl9fZGFya3JlYWRlcl9fYWRkVW5kZWZpbmVkUmVzb2x2ZXJcIixcclxuICAgICAgICAgICAgICAgIGFkZFVuZGVmaW5lZFJlc29sdmVyXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICAgICBcIl9fZGFya3JlYWRlcl9fYmxvYlVSTENoZWNrUmVxdWVzdFwiLFxyXG4gICAgICAgICAgICAgICAgY2hlY2tCbG9iVVJMU3VwcG9ydFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoZW5hYmxlU3R5bGVTaGVldHNQcm94eSkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICAgICAgICAgIERvY3VtZW50LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBcInN0eWxlU2hlZXRzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRTdHlsZVNoZWV0c0Rlc2NyaXB0b3JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVuYWJsZUN1c3RvbUVsZW1lbnRSZWdpc3RyeVByb3h5KSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICAgICAgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBcImRlZmluZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUVsZW1lbnRSZWdpc3RyeURlZmluZURlc2NyaXB0b3JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNob3VsZFdyYXBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICAgICAgICAgIEVsZW1lbnQucHJvdG90eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZ2V0RWxlbWVudHNCeVRhZ05hbWVcIixcclxuICAgICAgICAgICAgICAgICAgICBnZXRFbGVtZW50c0J5VGFnTmFtZURlc2NyaXB0b3JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNob3VsZFByb3h5Q2hpbGROb2Rlcykge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICAgICAgICAgIE5vZGUucHJvdG90eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY2hpbGROb2Rlc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTm9kZXNEZXNjcmlwdG9yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNsZWFuZXJzLmZvckVhY2goZnVuY3Rpb24gKGNsZWFuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2xlYW4oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNsZWFuZXJzLnNwbGljZSgwKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBhZGRVbmRlZmluZWRSZXNvbHZlcklubmVyID0gZnVuY3Rpb24gKHRhZykge1xyXG4gICAgICAgICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZCh0YWcpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChcclxuICAgICAgICAgICAgICAgICAgICBuZXcgQ3VzdG9tRXZlbnQoXCJfX2RhcmtyZWFkZXJfX2lzRGVmaW5lZFwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDoge3RhZzogdGFnfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBhZGRVbmRlZmluZWRSZXNvbHZlciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhZGRVbmRlZmluZWRSZXNvbHZlcklubmVyKGUuZGV0YWlsLnRhZyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiX19kYXJrcmVhZGVyX19jbGVhblVwXCIsIGNsZWFuVXAsIHtcclxuICAgICAgICAgICAgcGFzc2l2ZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgIFwiX19kYXJrcmVhZGVyX19hZGRVbmRlZmluZWRSZXNvbHZlclwiLFxyXG4gICAgICAgICAgICBhZGRVbmRlZmluZWRSZXNvbHZlcixcclxuICAgICAgICAgICAge3Bhc3NpdmU6IHRydWV9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICBcIl9fZGFya3JlYWRlcl9fYmxvYlVSTENoZWNrUmVxdWVzdFwiLFxyXG4gICAgICAgICAgICBjaGVja0Jsb2JVUkxTdXBwb3J0LFxyXG4gICAgICAgICAgICB7b25jZTogdHJ1ZX1cclxuICAgICAgICApO1xyXG4gICAgICAgIHZhciB1cGRhdGVTaGVldEV2ZW50ID0gbmV3IEV2ZW50KFwiX19kYXJrcmVhZGVyX191cGRhdGVTaGVldFwiKTtcclxuICAgICAgICBmdW5jdGlvbiBwcm94eUFkZFJ1bGUoc2VsZWN0b3IsIHN0eWxlLCBpbmRleCkge1xyXG4gICAgICAgICAgICBhZGRSdWxlRGVzY3JpcHRvci52YWx1ZS5jYWxsKHRoaXMsIHNlbGVjdG9yLCBzdHlsZSwgaW5kZXgpO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QgJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QuY29udGFpbnMoXCJkYXJrcmVhZGVyXCIpXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vd25lck5vZGUuZGlzcGF0Y2hFdmVudCh1cGRhdGVTaGVldEV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHByb3h5SW5zZXJ0UnVsZShydWxlLCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSBpbnNlcnRSdWxlRGVzY3JpcHRvci52YWx1ZS5jYWxsKFxyXG4gICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgIHJ1bGUsXHJcbiAgICAgICAgICAgICAgICBpbmRleFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QgJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QuY29udGFpbnMoXCJkYXJrcmVhZGVyXCIpXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vd25lck5vZGUuZGlzcGF0Y2hFdmVudCh1cGRhdGVTaGVldEV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHByb3h5RGVsZXRlUnVsZShpbmRleCkge1xyXG4gICAgICAgICAgICBkZWxldGVSdWxlRGVzY3JpcHRvci52YWx1ZS5jYWxsKHRoaXMsIGluZGV4KTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5vd25lck5vZGUgJiZcclxuICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vd25lck5vZGUuY2xhc3NMaXN0ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vd25lck5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZGFya3JlYWRlclwiKVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3duZXJOb2RlLmRpc3BhdGNoRXZlbnQodXBkYXRlU2hlZXRFdmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gcHJveHlSZW1vdmVSdWxlKGluZGV4KSB7XHJcbiAgICAgICAgICAgIHJlbW92ZVJ1bGVEZXNjcmlwdG9yLnZhbHVlLmNhbGwodGhpcywgaW5kZXgpO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QgJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QuY29udGFpbnMoXCJkYXJrcmVhZGVyXCIpXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vd25lck5vZGUuZGlzcGF0Y2hFdmVudCh1cGRhdGVTaGVldEV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcm94eVJlcGxhY2UoY3NzVGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSByZXBsYWNlRGVzY3JpcHRvci52YWx1ZS5jYWxsKHRoaXMsIGNzc1RleHQpO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QgJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5jbGFzc0xpc3QuY29udGFpbnMoXCJkYXJrcmVhZGVyXCIpXHJcbiAgICAgICAgICAgICAgICApICYmXHJcbiAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSAmJlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLm93bmVyTm9kZS5kaXNwYXRjaEV2ZW50KHVwZGF0ZVNoZWV0RXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcm94eVJlcGxhY2VTeW5jKGNzc1RleHQpIHtcclxuICAgICAgICAgICAgcmVwbGFjZVN5bmNEZXNjcmlwdG9yLnZhbHVlLmNhbGwodGhpcywgY3NzVGV4dCk7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIHRoaXMub3duZXJOb2RlICYmXHJcbiAgICAgICAgICAgICAgICAhKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3duZXJOb2RlLmNsYXNzTGlzdCAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3duZXJOb2RlLmNsYXNzTGlzdC5jb250YWlucyhcImRhcmtyZWFkZXJcIilcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyTm9kZS5kaXNwYXRjaEV2ZW50KHVwZGF0ZVNoZWV0RXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHByb3h5RG9jdW1lbnRTdHlsZVNoZWV0cygpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGdldEN1cnJlbnRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2NTaGVldHMgPSBkb2N1bWVudFN0eWxlU2hlZXRzRGVzY3JpcHRvci5nZXQuY2FsbChfdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmlsdGVyZWRTaGVldHMgPSBfX3NwcmVhZEFycmF5KFxyXG4gICAgICAgICAgICAgICAgICAgIFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIF9fcmVhZChkb2NTaGVldHMpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlXHJcbiAgICAgICAgICAgICAgICApLmZpbHRlcihmdW5jdGlvbiAoc3R5bGVTaGVldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQub3duZXJOb2RlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0Lm93bmVyTm9kZS5jbGFzc0xpc3QgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQub3duZXJOb2RlLmNsYXNzTGlzdC5jb250YWlucyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhcmtyZWFkZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyZWRTaGVldHMuaXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkU2hlZXRzW2l0ZW1dO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRTaGVldHMsXHJcbiAgICAgICAgICAgICAgICAgICAgU3R5bGVTaGVldExpc3QucHJvdG90eXBlXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBnZXRDdXJyZW50VmFsdWUoKTtcclxuICAgICAgICAgICAgdmFyIHN0eWxlU2hlZXRMaXN0QmVoYXZpb3IgPSB7XHJcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIChfLCBwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDdXJyZW50VmFsdWUoKVtwcm9wZXJ0eV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGVsZW1lbnRzID0gbmV3IFByb3h5KGVsZW1lbnRzLCBzdHlsZVNoZWV0TGlzdEJlaGF2aW9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcm94eUN1c3RvbUVsZW1lbnRSZWdpc3RyeURlZmluZShuYW1lLCBjb25zdHJ1Y3Rvciwgb3B0aW9ucykge1xyXG4gICAgICAgICAgICBhZGRVbmRlZmluZWRSZXNvbHZlcklubmVyKG5hbWUpO1xyXG4gICAgICAgICAgICBjdXN0b21FbGVtZW50UmVnaXN0cnlEZWZpbmVEZXNjcmlwdG9yLnZhbHVlLmNhbGwoXHJcbiAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uc1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcm94eUdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgaWYgKHRhZ05hbWUgIT09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEVsZW1lbnRzQnlUYWdOYW1lRGVzY3JpcHRvci52YWx1ZS5jYWxsKHRoaXMsIHRhZ05hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnZXRDdXJyZW50RWxlbWVudFZhbHVlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gZ2V0RWxlbWVudHNCeVRhZ05hbWVEZXNjcmlwdG9yLnZhbHVlLmNhbGwoXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgdGFnTmFtZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoXHJcbiAgICAgICAgICAgICAgICAgICAgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGVsZW1lbnRzKSwgZmFsc2UpLmZpbHRlcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZGFya3JlYWRlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICAgIE5vZGVMaXN0LnByb3RvdHlwZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gZ2V0Q3VycmVudEVsZW1lbnRWYWx1ZSgpO1xyXG4gICAgICAgICAgICB2YXIgbm9kZUxpc3RCZWhhdmlvciA9IHtcclxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKF8sIHByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEN1cnJlbnRFbGVtZW50VmFsdWUoKVtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTnVtYmVyKHByb3BlcnR5KSB8fCBwcm9wZXJ0eVxyXG4gICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGVsZW1lbnRzID0gbmV3IFByb3h5KGVsZW1lbnRzLCBub2RlTGlzdEJlaGF2aW9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcm94eUNoaWxkTm9kZXMoKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZE5vZGVzID0gY2hpbGROb2Rlc0Rlc2NyaXB0b3IuZ2V0LmNhbGwodGhpcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoXHJcbiAgICAgICAgICAgICAgICBfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQoY2hpbGROb2RlcyksIGZhbHNlKS5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICFlbGVtZW50LmNsYXNzTGlzdCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZGFya3JlYWRlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBOb2RlTGlzdC5wcm90b3R5cGVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gY2hlY2tCbG9iVVJMU3VwcG9ydCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN2ZywgYnl0ZXMsIGksIGJsb2IsIG9iamVjdFVSTCwgYmxvYlVSTEFsbG93ZWQsIGltYWdlXzE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdmcgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjFcIiBoZWlnaHQ9XCIxXCI+PHJlY3Qgd2lkdGg9XCIxXCIgaGVpZ2h0PVwiMVwiIGZpbGw9XCJ0cmFuc3BhcmVudFwiLz48L3N2Zz4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMgPSBuZXcgVWludDhBcnJheShzdmcubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlc1tpXSA9IHN2Zy5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYiA9IG5ldyBCbG9iKFtieXRlc10sIHt0eXBlOiBcImltYWdlL3N2Zyt4bWxcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlXzEgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlXzEub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VfMS5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZV8xLnNyYyA9IG9iamVjdFVSTDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYlVSTEFsbG93ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYlVSTEFsbG93ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9fZGFya3JlYWRlcl9fYmxvYlVSTENoZWNrUmVzcG9uc2VcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RldGFpbDoge2Jsb2JVUkxBbGxvd2VkOiBibG9iVVJMQWxsb3dlZH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgIENTU1N0eWxlU2hlZXQucHJvdG90eXBlLFxyXG4gICAgICAgICAgICBcImFkZFJ1bGVcIixcclxuICAgICAgICAgICAgX19hc3NpZ24oX19hc3NpZ24oe30sIGFkZFJ1bGVEZXNjcmlwdG9yKSwge3ZhbHVlOiBwcm94eUFkZFJ1bGV9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgXCJpbnNlcnRSdWxlXCIsXHJcbiAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCBpbnNlcnRSdWxlRGVzY3JpcHRvciksIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBwcm94eUluc2VydFJ1bGVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShcclxuICAgICAgICAgICAgQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgIFwiZGVsZXRlUnVsZVwiLFxyXG4gICAgICAgICAgICBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZGVsZXRlUnVsZURlc2NyaXB0b3IpLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogcHJveHlEZWxldGVSdWxlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgIENTU1N0eWxlU2hlZXQucHJvdG90eXBlLFxyXG4gICAgICAgICAgICBcInJlbW92ZVJ1bGVcIixcclxuICAgICAgICAgICAgX19hc3NpZ24oX19hc3NpZ24oe30sIHJlbW92ZVJ1bGVEZXNjcmlwdG9yKSwge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHByb3h5UmVtb3ZlUnVsZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgXCJyZXBsYWNlXCIsXHJcbiAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCByZXBsYWNlRGVzY3JpcHRvciksIHt2YWx1ZTogcHJveHlSZXBsYWNlfSlcclxuICAgICAgICApO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShcclxuICAgICAgICAgICAgQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgIFwicmVwbGFjZVN5bmNcIixcclxuICAgICAgICAgICAgX19hc3NpZ24oX19hc3NpZ24oe30sIHJlcGxhY2VTeW5jRGVzY3JpcHRvciksIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBwcm94eVJlcGxhY2VTeW5jXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAoZW5hYmxlU3R5bGVTaGVldHNQcm94eSkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICBEb2N1bWVudC5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgICAgICBcInN0eWxlU2hlZXRzXCIsXHJcbiAgICAgICAgICAgICAgICBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZG9jdW1lbnRTdHlsZVNoZWV0c0Rlc2NyaXB0b3IpLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBwcm94eURvY3VtZW50U3R5bGVTaGVldHNcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbmFibGVDdXN0b21FbGVtZW50UmVnaXN0cnlQcm94eSkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICBDdXN0b21FbGVtZW50UmVnaXN0cnkucHJvdG90eXBlLFxyXG4gICAgICAgICAgICAgICAgXCJkZWZpbmVcIixcclxuICAgICAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCBjdXN0b21FbGVtZW50UmVnaXN0cnlEZWZpbmVEZXNjcmlwdG9yKSwge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwcm94eUN1c3RvbUVsZW1lbnRSZWdpc3RyeURlZmluZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNob3VsZFdyYXBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICBFbGVtZW50LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgICAgIFwiZ2V0RWxlbWVudHNCeVRhZ05hbWVcIixcclxuICAgICAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCBnZXRFbGVtZW50c0J5VGFnTmFtZURlc2NyaXB0b3IpLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHByb3h5R2V0RWxlbWVudHNCeVRhZ05hbWVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaG91bGRQcm94eUNoaWxkTm9kZXMpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICAgICAgICAgICAgTm9kZS5wcm90b3R5cGUsXHJcbiAgICAgICAgICAgICAgICBcImNoaWxkTm9kZXNcIixcclxuICAgICAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCBjaGlsZE5vZGVzRGVzY3JpcHRvciksIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6IHByb3h5Q2hpbGROb2Rlc1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGRvY3VtZW50VmlzaWJpbGl0eUxpc3RlbmVyID0gbnVsbDtcclxuICAgIHZhciBkb2N1bWVudElzVmlzaWJsZV8gPSAhZG9jdW1lbnQuaGlkZGVuO1xyXG4gICAgdmFyIGxpc3RlbmVyT3B0aW9ucyA9IHtcclxuICAgICAgICBjYXB0dXJlOiB0cnVlLFxyXG4gICAgICAgIHBhc3NpdmU6IHRydWVcclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiB3YXRjaEZvckRvY3VtZW50VmlzaWJpbGl0eSgpIHtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICBcInZpc2liaWxpdHljaGFuZ2VcIixcclxuICAgICAgICAgICAgZG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIsXHJcbiAgICAgICAgICAgIGxpc3RlbmVyT3B0aW9uc1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgIFwicGFnZXNob3dcIixcclxuICAgICAgICAgICAgZG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIsXHJcbiAgICAgICAgICAgIGxpc3RlbmVyT3B0aW9uc1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgIFwiZm9jdXNcIixcclxuICAgICAgICAgICAgZG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIsXHJcbiAgICAgICAgICAgIGxpc3RlbmVyT3B0aW9uc1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBzdG9wV2F0Y2hpbmdGb3JEb2N1bWVudFZpc2liaWxpdHkoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsXHJcbiAgICAgICAgICAgIGRvY3VtZW50VmlzaWJpbGl0eUxpc3RlbmVyLFxyXG4gICAgICAgICAgICBsaXN0ZW5lck9wdGlvbnNcclxuICAgICAgICApO1xyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICBcInBhZ2VzaG93XCIsXHJcbiAgICAgICAgICAgIGRvY3VtZW50VmlzaWJpbGl0eUxpc3RlbmVyLFxyXG4gICAgICAgICAgICBsaXN0ZW5lck9wdGlvbnNcclxuICAgICAgICApO1xyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICBcImZvY3VzXCIsXHJcbiAgICAgICAgICAgIGRvY3VtZW50VmlzaWJpbGl0eUxpc3RlbmVyLFxyXG4gICAgICAgICAgICBsaXN0ZW5lck9wdGlvbnNcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc2V0RG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgYWxyZWFkeVdhdGNoaW5nID0gQm9vbGVhbihkb2N1bWVudFZpc2liaWxpdHlMaXN0ZW5lcik7XHJcbiAgICAgICAgZG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuaGlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVEb2N1bWVudFZpc2liaWxpdHlMaXN0ZW5lcigpO1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50SXNWaXNpYmxlXyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICghYWxyZWFkeVdhdGNoaW5nKSB7XHJcbiAgICAgICAgICAgIHdhdGNoRm9yRG9jdW1lbnRWaXNpYmlsaXR5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlRG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIoKSB7XHJcbiAgICAgICAgc3RvcFdhdGNoaW5nRm9yRG9jdW1lbnRWaXNpYmlsaXR5KCk7XHJcbiAgICAgICAgZG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZG9jdW1lbnRJc1Zpc2libGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50SXNWaXNpYmxlXztcclxuICAgIH1cclxuXHJcbiAgICB2YXIgSU5TVEFOQ0VfSUQgPSBnZW5lcmF0ZVVJRCgpO1xyXG4gICAgdmFyIHN0eWxlTWFuYWdlcnMgPSBuZXcgTWFwKCk7XHJcbiAgICB2YXIgYWRvcHRlZFN0eWxlTWFuYWdlcnMgPSBbXTtcclxuICAgIHZhciBhZG9wdGVkU3R5bGVGYWxsYmFja3MgPSBuZXcgTWFwKCk7XHJcbiAgICB2YXIgYWRvcHRlZFN0eWxlTm9kZUlkcyA9IG5ldyBXZWFrTWFwKCk7XHJcbiAgICB2YXIgYWRvcHRlZFN0eWxlQ2hhbmdlVG9rZW5zID0gbmV3IFdlYWtNYXAoKTtcclxuICAgIHZhciBmaWx0ZXIgPSBudWxsO1xyXG4gICAgdmFyIGZpeGVzID0gbnVsbDtcclxuICAgIHZhciBpc0lGcmFtZSQxID0gbnVsbDtcclxuICAgIHZhciBpZ25vcmVkSW1hZ2VBbmFseXNpc1NlbGVjdG9ycyA9IFtdO1xyXG4gICAgdmFyIGlnbm9yZWRJbmxpbmVTZWxlY3RvcnMgPSBbXTtcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU9yVXBkYXRlU3R5bGUoY2xhc3NOYW1lLCByb290KSB7XHJcbiAgICAgICAgaWYgKHJvb3QgPT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICByb290ID0gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSByb290LnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KGNsYXNzTmFtZSkpO1xyXG4gICAgICAgIGlmICghZWxlbWVudCkge1xyXG4gICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkYXJrcmVhZGVyXCIpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgZWxlbWVudC5tZWRpYSA9IFwic2NyZWVuXCI7XHJcbiAgICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU9yVXBkYXRlU2NyaXB0KGNsYXNzTmFtZSwgcm9vdCkge1xyXG4gICAgICAgIGlmIChyb290ID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgcm9vdCA9IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBlbGVtZW50ID0gcm9vdC5xdWVyeVNlbGVjdG9yKFwiLlwiLmNvbmNhdChjbGFzc05hbWUpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnQpIHtcclxuICAgICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImRhcmtyZWFkZXJcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgIH1cclxuICAgIHZhciBub2RlUG9zaXRpb25XYXRjaGVycyA9IG5ldyBNYXAoKTtcclxuICAgIGZ1bmN0aW9uIHNldHVwTm9kZVBvc2l0aW9uV2F0Y2hlcihub2RlLCBhbGlhcykge1xyXG4gICAgICAgIG5vZGVQb3NpdGlvbldhdGNoZXJzLmhhcyhhbGlhcykgJiZcclxuICAgICAgICAgICAgbm9kZVBvc2l0aW9uV2F0Y2hlcnMuZ2V0KGFsaWFzKS5zdG9wKCk7XHJcbiAgICAgICAgbm9kZVBvc2l0aW9uV2F0Y2hlcnMuc2V0KGFsaWFzLCB3YXRjaEZvck5vZGVQb3NpdGlvbihub2RlLCBcImhlYWRcIikpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc3RvcFN0eWxlUG9zaXRpb25XYXRjaGVycygpIHtcclxuICAgICAgICBmb3JFYWNoKG5vZGVQb3NpdGlvbldhdGNoZXJzLnZhbHVlcygpLCBmdW5jdGlvbiAod2F0Y2hlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gd2F0Y2hlci5zdG9wKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbm9kZVBvc2l0aW9uV2F0Y2hlcnMuY2xlYXIoKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZVN0YXRpY1N0eWxlT3ZlcnJpZGVzKCkge1xyXG4gICAgICAgIHZhciBmYWxsYmFja1N0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcclxuICAgICAgICAgICAgXCJkYXJrcmVhZGVyLS1mYWxsYmFja1wiLFxyXG4gICAgICAgICAgICBkb2N1bWVudFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZmFsbGJhY2tTdHlsZS50ZXh0Q29udGVudCA9IGdldE1vZGlmaWVkRmFsbGJhY2tTdHlsZShmaWx0ZXIsIHtcclxuICAgICAgICAgICAgc3RyaWN0OiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUoZmFsbGJhY2tTdHlsZSwgZG9jdW1lbnQuaGVhZC5maXJzdENoaWxkKTtcclxuICAgICAgICBzZXR1cE5vZGVQb3NpdGlvbldhdGNoZXIoZmFsbGJhY2tTdHlsZSwgXCJmYWxsYmFja1wiKTtcclxuICAgICAgICB2YXIgdXNlckFnZW50U3R5bGUgPSBjcmVhdGVPclVwZGF0ZVN0eWxlKFwiZGFya3JlYWRlci0tdXNlci1hZ2VudFwiKTtcclxuICAgICAgICB1c2VyQWdlbnRTdHlsZS50ZXh0Q29udGVudCA9IGdldE1vZGlmaWVkVXNlckFnZW50U3R5bGUoXHJcbiAgICAgICAgICAgIGZpbHRlcixcclxuICAgICAgICAgICAgaXNJRnJhbWUkMSxcclxuICAgICAgICAgICAgZmlsdGVyLnN0eWxlU3lzdGVtQ29udHJvbHNcclxuICAgICAgICApO1xyXG4gICAgICAgIGRvY3VtZW50LmhlYWQuaW5zZXJ0QmVmb3JlKHVzZXJBZ2VudFN0eWxlLCBmYWxsYmFja1N0eWxlLm5leHRTaWJsaW5nKTtcclxuICAgICAgICBzZXR1cE5vZGVQb3NpdGlvbldhdGNoZXIodXNlckFnZW50U3R5bGUsIFwidXNlci1hZ2VudFwiKTtcclxuICAgICAgICB2YXIgdGV4dFN0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcImRhcmtyZWFkZXItLXRleHRcIik7XHJcbiAgICAgICAgaWYgKGZpbHRlci51c2VGb250IHx8IGZpbHRlci50ZXh0U3Ryb2tlID4gMCkge1xyXG4gICAgICAgICAgICB0ZXh0U3R5bGUudGV4dENvbnRlbnQgPSBjcmVhdGVUZXh0U3R5bGUoZmlsdGVyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0ZXh0U3R5bGUudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb2N1bWVudC5oZWFkLmluc2VydEJlZm9yZSh0ZXh0U3R5bGUsIGZhbGxiYWNrU3R5bGUubmV4dFNpYmxpbmcpO1xyXG4gICAgICAgIHNldHVwTm9kZVBvc2l0aW9uV2F0Y2hlcih0ZXh0U3R5bGUsIFwidGV4dFwiKTtcclxuICAgICAgICB2YXIgaW52ZXJ0U3R5bGUgPSBjcmVhdGVPclVwZGF0ZVN0eWxlKFwiZGFya3JlYWRlci0taW52ZXJ0XCIpO1xyXG4gICAgICAgIGlmIChmaXhlcyAmJiBBcnJheS5pc0FycmF5KGZpeGVzLmludmVydCkgJiYgZml4ZXMuaW52ZXJ0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgaW52ZXJ0U3R5bGUudGV4dENvbnRlbnQgPSBbXHJcbiAgICAgICAgICAgICAgICBcIlwiLmNvbmNhdChmaXhlcy5pbnZlcnQuam9pbihcIiwgXCIpLCBcIiB7XCIpLFxyXG4gICAgICAgICAgICAgICAgXCIgICAgZmlsdGVyOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q1NTRmlsdGVyVmFsdWUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9fYXNzaWduKF9fYXNzaWduKHt9LCBmaWx0ZXIpLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmFzdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIubW9kZSA9PT0gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGZpbHRlci5jb250cmFzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNsYW1wKGZpbHRlci5jb250cmFzdCAtIDEwLCAwLCAxMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgICBcIiAhaW1wb3J0YW50O1wiXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgXCJ9XCJcclxuICAgICAgICAgICAgXS5qb2luKFwiXFxuXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGludmVydFN0eWxlLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUoaW52ZXJ0U3R5bGUsIHRleHRTdHlsZS5uZXh0U2libGluZyk7XHJcbiAgICAgICAgc2V0dXBOb2RlUG9zaXRpb25XYXRjaGVyKGludmVydFN0eWxlLCBcImludmVydFwiKTtcclxuICAgICAgICB2YXIgaW5saW5lU3R5bGUgPSBjcmVhdGVPclVwZGF0ZVN0eWxlKFwiZGFya3JlYWRlci0taW5saW5lXCIpO1xyXG4gICAgICAgIGlubGluZVN0eWxlLnRleHRDb250ZW50ID0gZ2V0SW5saW5lT3ZlcnJpZGVTdHlsZSgpO1xyXG4gICAgICAgIGRvY3VtZW50LmhlYWQuaW5zZXJ0QmVmb3JlKGlubGluZVN0eWxlLCBpbnZlcnRTdHlsZS5uZXh0U2libGluZyk7XHJcbiAgICAgICAgc2V0dXBOb2RlUG9zaXRpb25XYXRjaGVyKGlubGluZVN0eWxlLCBcImlubGluZVwiKTtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVTdHlsZSA9IGNyZWF0ZU9yVXBkYXRlU3R5bGUoXCJkYXJrcmVhZGVyLS1vdmVycmlkZVwiKTtcclxuICAgICAgICBvdmVycmlkZVN0eWxlLnRleHRDb250ZW50ID1cclxuICAgICAgICAgICAgZml4ZXMgJiYgZml4ZXMuY3NzID8gcmVwbGFjZUNTU1RlbXBsYXRlcyhmaXhlcy5jc3MpIDogXCJcIjtcclxuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKG92ZXJyaWRlU3R5bGUpO1xyXG4gICAgICAgIHNldHVwTm9kZVBvc2l0aW9uV2F0Y2hlcihvdmVycmlkZVN0eWxlLCBcIm92ZXJyaWRlXCIpO1xyXG4gICAgICAgIHZhciB2YXJpYWJsZVN0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcImRhcmtyZWFkZXItLXZhcmlhYmxlc1wiKTtcclxuICAgICAgICB2YXIgc2VsZWN0aW9uQ29sb3JzID0gZ2V0U2VsZWN0aW9uQ29sb3IoZmlsdGVyKTtcclxuICAgICAgICB2YXIgX2EgPSBmaWx0ZXIsXHJcbiAgICAgICAgICAgIGRhcmtTY2hlbWVCYWNrZ3JvdW5kQ29sb3IgPSBfYS5kYXJrU2NoZW1lQmFja2dyb3VuZENvbG9yLFxyXG4gICAgICAgICAgICBkYXJrU2NoZW1lVGV4dENvbG9yID0gX2EuZGFya1NjaGVtZVRleHRDb2xvcixcclxuICAgICAgICAgICAgbGlnaHRTY2hlbWVCYWNrZ3JvdW5kQ29sb3IgPSBfYS5saWdodFNjaGVtZUJhY2tncm91bmRDb2xvcixcclxuICAgICAgICAgICAgbGlnaHRTY2hlbWVUZXh0Q29sb3IgPSBfYS5saWdodFNjaGVtZVRleHRDb2xvcixcclxuICAgICAgICAgICAgbW9kZSA9IF9hLm1vZGU7XHJcbiAgICAgICAgdmFyIHNjaGVtZUJhY2tncm91bmRDb2xvciA9XHJcbiAgICAgICAgICAgIG1vZGUgPT09IDAgPyBsaWdodFNjaGVtZUJhY2tncm91bmRDb2xvciA6IGRhcmtTY2hlbWVCYWNrZ3JvdW5kQ29sb3I7XHJcbiAgICAgICAgdmFyIHNjaGVtZVRleHRDb2xvciA9XHJcbiAgICAgICAgICAgIG1vZGUgPT09IDAgPyBsaWdodFNjaGVtZVRleHRDb2xvciA6IGRhcmtTY2hlbWVUZXh0Q29sb3I7XHJcbiAgICAgICAgc2NoZW1lQmFja2dyb3VuZENvbG9yID0gbW9kaWZ5QmFja2dyb3VuZENvbG9yKFxyXG4gICAgICAgICAgICBwYXJzZUNvbG9yV2l0aENhY2hlKHNjaGVtZUJhY2tncm91bmRDb2xvciksXHJcbiAgICAgICAgICAgIGZpbHRlclxyXG4gICAgICAgICk7XHJcbiAgICAgICAgc2NoZW1lVGV4dENvbG9yID0gbW9kaWZ5Rm9yZWdyb3VuZENvbG9yKFxyXG4gICAgICAgICAgICBwYXJzZUNvbG9yV2l0aENhY2hlKHNjaGVtZVRleHRDb2xvciksXHJcbiAgICAgICAgICAgIGZpbHRlclxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyaWFibGVTdHlsZS50ZXh0Q29udGVudCA9IFtcclxuICAgICAgICAgICAgXCI6cm9vdCB7XCIsXHJcbiAgICAgICAgICAgIFwiICAgLS1kYXJrcmVhZGVyLW5ldXRyYWwtYmFja2dyb3VuZDogXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgc2NoZW1lQmFja2dyb3VuZENvbG9yLFxyXG4gICAgICAgICAgICAgICAgXCI7XCJcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgXCIgICAtLWRhcmtyZWFkZXItbmV1dHJhbC10ZXh0OiBcIi5jb25jYXQoc2NoZW1lVGV4dENvbG9yLCBcIjtcIiksXHJcbiAgICAgICAgICAgIFwiICAgLS1kYXJrcmVhZGVyLXNlbGVjdGlvbi1iYWNrZ3JvdW5kOiBcIi5jb25jYXQoXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb25Db2xvcnMuYmFja2dyb3VuZENvbG9yU2VsZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgXCI7XCJcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgXCIgICAtLWRhcmtyZWFkZXItc2VsZWN0aW9uLXRleHQ6IFwiLmNvbmNhdChcclxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbkNvbG9ycy5mb3JlZ3JvdW5kQ29sb3JTZWxlY3Rpb24sXHJcbiAgICAgICAgICAgICAgICBcIjtcIlxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBcIn1cIlxyXG4gICAgICAgIF0uam9pbihcIlxcblwiKTtcclxuICAgICAgICBkb2N1bWVudC5oZWFkLmluc2VydEJlZm9yZSh2YXJpYWJsZVN0eWxlLCBpbmxpbmVTdHlsZS5uZXh0U2libGluZyk7XHJcbiAgICAgICAgc2V0dXBOb2RlUG9zaXRpb25XYXRjaGVyKHZhcmlhYmxlU3R5bGUsIFwidmFyaWFibGVzXCIpO1xyXG4gICAgICAgIHZhciByb290VmFyc1N0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcImRhcmtyZWFkZXItLXJvb3QtdmFyc1wiKTtcclxuICAgICAgICBkb2N1bWVudC5oZWFkLmluc2VydEJlZm9yZShyb290VmFyc1N0eWxlLCB2YXJpYWJsZVN0eWxlLm5leHRTaWJsaW5nKTtcclxuICAgICAgICB2YXIgZW5hYmxlU3R5bGVTaGVldHNQcm94eSA9ICEoZml4ZXMgJiYgZml4ZXMuZGlzYWJsZVN0eWxlU2hlZXRzUHJveHkpO1xyXG4gICAgICAgIHZhciBlbmFibGVDdXN0b21FbGVtZW50UmVnaXN0cnlQcm94eSA9ICEoXHJcbiAgICAgICAgICAgIGZpeGVzICYmIGZpeGVzLmRpc2FibGVDdXN0b21FbGVtZW50UmVnaXN0cnlQcm94eVxyXG4gICAgICAgICk7XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgcHJveHlTY3JpcHQgPSBjcmVhdGVPclVwZGF0ZVNjcmlwdChcImRhcmtyZWFkZXItLXByb3h5XCIpO1xyXG4gICAgICAgICAgICBwcm94eVNjcmlwdC5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICBcIihcIlxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQoaW5qZWN0UHJveHksIFwiKShcIilcclxuICAgICAgICAgICAgICAgICAgICAuY29uY2F0KGVuYWJsZVN0eWxlU2hlZXRzUHJveHksIFwiLCBcIilcclxuICAgICAgICAgICAgICAgICAgICAuY29uY2F0KGVuYWJsZUN1c3RvbUVsZW1lbnRSZWdpc3RyeVByb3h5LCBcIilcIilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUocHJveHlTY3JpcHQsIHJvb3RWYXJzU3R5bGUubmV4dFNpYmxpbmcpO1xyXG4gICAgICAgICAgICBwcm94eVNjcmlwdC5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgc2hhZG93Um9vdHNXaXRoT3ZlcnJpZGVzID0gbmV3IFNldCgpO1xyXG4gICAgZnVuY3Rpb24gY3JlYXRlU2hhZG93U3RhdGljU3R5bGVPdmVycmlkZXNJbm5lcihyb290KSB7XHJcbiAgICAgICAgdmFyIGlubGluZVN0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcImRhcmtyZWFkZXItLWlubGluZVwiLCByb290KTtcclxuICAgICAgICBpbmxpbmVTdHlsZS50ZXh0Q29udGVudCA9IGdldElubGluZU92ZXJyaWRlU3R5bGUoKTtcclxuICAgICAgICByb290Lmluc2VydEJlZm9yZShpbmxpbmVTdHlsZSwgcm9vdC5maXJzdENoaWxkKTtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVTdHlsZSA9IGNyZWF0ZU9yVXBkYXRlU3R5bGUoXCJkYXJrcmVhZGVyLS1vdmVycmlkZVwiLCByb290KTtcclxuICAgICAgICBvdmVycmlkZVN0eWxlLnRleHRDb250ZW50ID1cclxuICAgICAgICAgICAgZml4ZXMgJiYgZml4ZXMuY3NzID8gcmVwbGFjZUNTU1RlbXBsYXRlcyhmaXhlcy5jc3MpIDogXCJcIjtcclxuICAgICAgICByb290Lmluc2VydEJlZm9yZShvdmVycmlkZVN0eWxlLCBpbmxpbmVTdHlsZS5uZXh0U2libGluZyk7XHJcbiAgICAgICAgdmFyIGludmVydFN0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcImRhcmtyZWFkZXItLWludmVydFwiLCByb290KTtcclxuICAgICAgICBpZiAoZml4ZXMgJiYgQXJyYXkuaXNBcnJheShmaXhlcy5pbnZlcnQpICYmIGZpeGVzLmludmVydC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGludmVydFN0eWxlLnRleHRDb250ZW50ID0gW1xyXG4gICAgICAgICAgICAgICAgXCJcIi5jb25jYXQoZml4ZXMuaW52ZXJ0LmpvaW4oXCIsIFwiKSwgXCIge1wiKSxcclxuICAgICAgICAgICAgICAgIFwiICAgIGZpbHRlcjogXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgIGdldENTU0ZpbHRlclZhbHVlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmlsdGVyKSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJhc3Q6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyLm1vZGUgPT09IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBmaWx0ZXIuY29udHJhc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjbGFtcChmaWx0ZXIuY29udHJhc3QgLSAxMCwgMCwgMTAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICAgICAgXCIgIWltcG9ydGFudDtcIlxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIFwifVwiXHJcbiAgICAgICAgICAgIF0uam9pbihcIlxcblwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpbnZlcnRTdHlsZS50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJvb3QuaW5zZXJ0QmVmb3JlKGludmVydFN0eWxlLCBvdmVycmlkZVN0eWxlLm5leHRTaWJsaW5nKTtcclxuICAgICAgICBzaGFkb3dSb290c1dpdGhPdmVycmlkZXMuYWRkKHJvb3QpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZGVsYXllZENyZWF0ZVNoYWRvd1N0YXRpY1N0eWxlT3ZlcnJpZGVzKHJvb3QpIHtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zLCBvYnNlcnZlcikge1xyXG4gICAgICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbXV0YXRpb25zXzEgPSBfX3ZhbHVlcyhtdXRhdGlvbnMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbnNfMV8xID0gbXV0YXRpb25zXzEubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICFtdXRhdGlvbnNfMV8xLmRvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25zXzFfMSA9IG11dGF0aW9uc18xLm5leHQoKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jID0gbXV0YXRpb25zXzFfMS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IF9jLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWROb2RlcyA9IF9jLnJlbW92ZWROb2RlcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJjaGlsZExpc3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2QgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKChlXzIgPSB2b2lkIDApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX192YWx1ZXMocmVtb3ZlZE5vZGVzKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lID0gX2QubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFfZS5kb25lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lID0gX2QubmV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2YgPSBfZS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWUgPSBfZi5ub2RlTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gX2YuY2xhc3NOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU5hbWUgPT09IFwiU1RZTEVcIiAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhcmtyZWFkZXIgZGFya3JlYWRlci0taW5saW5lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhcmtyZWFkZXIgZGFya3JlYWRlci0tb3ZlcnJpZGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGFya3JlYWRlciBkYXJrcmVhZGVyLS1pbnZlcnRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmluY2x1ZGVzKGNsYXNzTmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2hhZG93U3RhdGljU3R5bGVPdmVycmlkZXNJbm5lcihyb290KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZV8yXzEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMiA9IHtlcnJvcjogZV8yXzF9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2UgJiYgIV9lLmRvbmUgJiYgKF9iID0gX2QucmV0dXJuKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IuY2FsbChfZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZV8xXzEpIHtcclxuICAgICAgICAgICAgICAgIGVfMSA9IHtlcnJvcjogZV8xXzF9O1xyXG4gICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uc18xXzEgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgIW11dGF0aW9uc18xXzEuZG9uZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoX2EgPSBtdXRhdGlvbnNfMS5yZXR1cm4pXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5jYWxsKG11dGF0aW9uc18xKTtcclxuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShyb290LCB7Y2hpbGRMaXN0OiB0cnVlfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVTaGFkb3dTdGF0aWNTdHlsZU92ZXJyaWRlcyhyb290KSB7XHJcbiAgICAgICAgdmFyIHVuaW5pdCA9IHJvb3QuZmlyc3RDaGlsZCA9PT0gbnVsbDtcclxuICAgICAgICBjcmVhdGVTaGFkb3dTdGF0aWNTdHlsZU92ZXJyaWRlc0lubmVyKHJvb3QpO1xyXG4gICAgICAgIGlmICh1bmluaXQpIHtcclxuICAgICAgICAgICAgZGVsYXllZENyZWF0ZVNoYWRvd1N0YXRpY1N0eWxlT3ZlcnJpZGVzKHJvb3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlcGxhY2VDU1NUZW1wbGF0ZXMoJGNzc1RleHQpIHtcclxuICAgICAgICByZXR1cm4gJGNzc1RleHQucmVwbGFjZSgvXFwkeyguKz8pfS9nLCBmdW5jdGlvbiAoXywgJGNvbG9yKSB7XHJcbiAgICAgICAgICAgIHZhciBjb2xvciA9IHBhcnNlQ29sb3JXaXRoQ2FjaGUoJGNvbG9yKTtcclxuICAgICAgICAgICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZ5Q29sb3IoY29sb3IsIGZpbHRlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICRjb2xvcjtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNsZWFuRmFsbGJhY2tTdHlsZSgpIHtcclxuICAgICAgICB2YXIgZmFsbGJhY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhcmtyZWFkZXItLWZhbGxiYWNrXCIpO1xyXG4gICAgICAgIGlmIChmYWxsYmFjaykge1xyXG4gICAgICAgICAgICBmYWxsYmFjay50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlRHluYW1pY1N0eWxlT3ZlcnJpZGVzKCkge1xyXG4gICAgICAgIGNhbmNlbFJlbmRlcmluZygpO1xyXG4gICAgICAgIHZhciBhbGxTdHlsZXMgPSBnZXRNYW5hZ2VhYmxlU3R5bGVzKGRvY3VtZW50KTtcclxuICAgICAgICB2YXIgbmV3TWFuYWdlcnMgPSBhbGxTdHlsZXNcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhc3R5bGVNYW5hZ2Vycy5oYXMoc3R5bGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChzdHlsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU1hbmFnZXIoc3R5bGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBuZXdNYW5hZ2Vyc1xyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChtYW5hZ2VyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWFuYWdlci5kZXRhaWxzKHtzZWNvbmRSb3VuZDogZmFsc2V9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZGV0YWlsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGV0YWlsICYmIGRldGFpbC5ydWxlcy5sZW5ndGggPiAwO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoZGV0YWlsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5hZGRSdWxlc0Zvck1hdGNoaW5nKGRldGFpbC5ydWxlcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHZhcmlhYmxlc1N0b3JlLm1hdGNoVmFyaWFibGVzQW5kRGVwZW5kZW50cygpO1xyXG4gICAgICAgIHZhcmlhYmxlc1N0b3JlLnNldE9uUm9vdFZhcmlhYmxlQ2hhbmdlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJvb3RWYXJzU3R5bGUgPSBjcmVhdGVPclVwZGF0ZVN0eWxlKFwiZGFya3JlYWRlci0tcm9vdC12YXJzXCIpO1xyXG4gICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5wdXRSb290VmFycyhyb290VmFyc1N0eWxlLCBmaWx0ZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciByb290VmFyc1N0eWxlID0gY3JlYXRlT3JVcGRhdGVTdHlsZShcImRhcmtyZWFkZXItLXJvb3QtdmFyc1wiKTtcclxuICAgICAgICB2YXJpYWJsZXNTdG9yZS5wdXRSb290VmFycyhyb290VmFyc1N0eWxlLCBmaWx0ZXIpO1xyXG4gICAgICAgIHN0eWxlTWFuYWdlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFuYWdlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbWFuYWdlci5yZW5kZXIoZmlsdGVyLCBpZ25vcmVkSW1hZ2VBbmFseXNpc1NlbGVjdG9ycyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGxvYWRpbmdTdHlsZXMuc2l6ZSA9PT0gMCkge1xyXG4gICAgICAgICAgICBjbGVhbkZhbGxiYWNrU3R5bGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbmV3TWFuYWdlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFuYWdlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbWFuYWdlci53YXRjaCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBpbmxpbmVTdHlsZUVsZW1lbnRzID0gdG9BcnJheShcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChJTkxJTkVfU1RZTEVfU0VMRUNUT1IpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpdGVyYXRlU2hhZG93SG9zdHMoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBmdW5jdGlvbiAoaG9zdCkge1xyXG4gICAgICAgICAgICBjcmVhdGVTaGFkb3dTdGF0aWNTdHlsZU92ZXJyaWRlcyhob3N0LnNoYWRvd1Jvb3QpO1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBob3N0LnNoYWRvd1Jvb3QucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgICAgICAgICAgIElOTElORV9TVFlMRV9TRUxFQ1RPUlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcHVzaChpbmxpbmVTdHlsZUVsZW1lbnRzLCBlbGVtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpbmxpbmVTdHlsZUVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvdmVycmlkZUlubGluZVN0eWxlKFxyXG4gICAgICAgICAgICAgICAgZWwsXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXIsXHJcbiAgICAgICAgICAgICAgICBpZ25vcmVkSW5saW5lU2VsZWN0b3JzLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlZEltYWdlQW5hbHlzaXNTZWxlY3RvcnNcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBoYW5kbGVBZG9wdGVkU3R5bGVTaGVldHMoZG9jdW1lbnQpO1xyXG4gICAgICAgIHZhcmlhYmxlc1N0b3JlLm1hdGNoVmFyaWFibGVzQW5kRGVwZW5kZW50cygpO1xyXG4gICAgICAgIGlmIChpc0ZpcmVmb3gpIHtcclxuICAgICAgICAgICAgdmFyIE1BVENIX1ZBUl8xID0gU3ltYm9sKCk7XHJcbiAgICAgICAgICAgIHZhciBvbkFkb3B0ZWRDU1NDaGFuZ2VfMSA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBlLmRldGFpbCxcclxuICAgICAgICAgICAgICAgICAgICBub2RlID0gX2Eubm9kZSxcclxuICAgICAgICAgICAgICAgICAgICBpZCA9IF9hLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGNzc1J1bGVzID0gX2EuY3NzUnVsZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZW50cmllcyA9IF9hLmVudHJpZXM7XHJcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShlbnRyaWVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3NzUnVsZXMgPSBlWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5hZGRSdWxlc0Zvck1hdGNoaW5nKGNzc1J1bGVzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5tYXRjaFZhcmlhYmxlc0FuZERlcGVuZGVudHMoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3NzUnVsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5hZGRSdWxlc0Zvck1hdGNoaW5nKGNzc1J1bGVzKTtcclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWVPbmNlKE1BVENIX1ZBUl8xLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YXJpYWJsZXNTdG9yZS5tYXRjaFZhcmlhYmxlc0FuZERlcGVuZGVudHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciB0dXBsZXMgPSBBcnJheS5pc0FycmF5KGVudHJpZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgPyBlbnRyaWVzXHJcbiAgICAgICAgICAgICAgICAgICAgOiBub2RlICYmIGNzc1J1bGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICA/IFtbbm9kZSwgaWQsIGNzc1J1bGVzXV1cclxuICAgICAgICAgICAgICAgICAgICAgIDogW107XHJcbiAgICAgICAgICAgICAgICB0dXBsZXMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgX2IgPSBfX3JlYWQoX2EsIDMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gX2JbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gX2JbMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc1J1bGVzID0gX2JbMl07XHJcbiAgICAgICAgICAgICAgICAgICAgYWRvcHRlZFN0eWxlTm9kZUlkcy5zZXQobm9kZSwgaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWxsYmFjayA9IGdldEFkb3B0ZWRTdHlsZVNoZWV0RmFsbGJhY2sobm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmFsbGJhY2sudXBkYXRlQ1NTKGNzc1J1bGVzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAgICAgXCJfX2RhcmtyZWFkZXJfX2Fkb3B0ZWRTdHlsZVNoZWV0c0NoYW5nZVwiLFxyXG4gICAgICAgICAgICAgICAgb25BZG9wdGVkQ1NTQ2hhbmdlXzFcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgY2xlYW5lcnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgICAgICAgICBcIl9fZGFya3JlYWRlcl9fYWRvcHRlZFN0eWxlU2hlZXRzQ2hhbmdlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgb25BZG9wdGVkQ1NTQ2hhbmdlXzFcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KFxyXG4gICAgICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KFwiX19kYXJrcmVhZGVyX19zdGFydEFkb3B0ZWRTdHlsZVNoZWV0c1dhdGNoZXJcIilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgbG9hZGluZ1N0eWxlc0NvdW50ZXIgPSAwO1xyXG4gICAgdmFyIGxvYWRpbmdTdHlsZXMgPSBuZXcgU2V0KCk7XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVNYW5hZ2VyKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgbG9hZGluZ1N0eWxlSWQgPSArK2xvYWRpbmdTdHlsZXNDb3VudGVyO1xyXG4gICAgICAgIGZ1bmN0aW9uIGxvYWRpbmdTdGFydCgpIHtcclxuICAgICAgICAgICAgaWYgKCFpc0RPTVJlYWR5KCkgfHwgIWRvY3VtZW50SXNWaXNpYmxlKCkpIHtcclxuICAgICAgICAgICAgICAgIGxvYWRpbmdTdHlsZXMuYWRkKGxvYWRpbmdTdHlsZUlkKTtcclxuICAgICAgICAgICAgICAgIGxvZ0luZm8oXHJcbiAgICAgICAgICAgICAgICAgICAgXCJDdXJyZW50IGFtb3VudCBvZiBzdHlsZXMgbG9hZGluZzogXCIuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nU3R5bGVzLnNpemVcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZhbGxiYWNrU3R5bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgICAgICAgICAgICAgIFwiLmRhcmtyZWFkZXItLWZhbGxiYWNrXCJcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWZhbGxiYWNrU3R5bGUudGV4dENvbnRlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmYWxsYmFja1N0eWxlLnRleHRDb250ZW50ID0gZ2V0TW9kaWZpZWRGYWxsYmFja1N0eWxlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtzdHJpY3Q6IGZhbHNlfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gbG9hZGluZ0VuZCgpIHtcclxuICAgICAgICAgICAgbG9hZGluZ1N0eWxlcy5kZWxldGUobG9hZGluZ1N0eWxlSWQpO1xyXG4gICAgICAgICAgICBsb2dJbmZvKFxyXG4gICAgICAgICAgICAgICAgXCJSZW1vdmVkIGxvYWRpbmdTdHlsZSBcIlxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQobG9hZGluZ1N0eWxlSWQsIFwiLCBub3cgYXdhaXRpbmc6IFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQobG9hZGluZ1N0eWxlcy5zaXplKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAobG9hZGluZ1N0eWxlcy5zaXplID09PSAwICYmIGlzRE9NUmVhZHkoKSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYW5GYWxsYmFja1N0eWxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlKCkge1xyXG4gICAgICAgICAgICB2YXIgZGV0YWlscyA9IG1hbmFnZXIuZGV0YWlscyh7c2Vjb25kUm91bmQ6IHRydWV9KTtcclxuICAgICAgICAgICAgaWYgKCFkZXRhaWxzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUuYWRkUnVsZXNGb3JNYXRjaGluZyhkZXRhaWxzLnJ1bGVzKTtcclxuICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUubWF0Y2hWYXJpYWJsZXNBbmREZXBlbmRlbnRzKCk7XHJcbiAgICAgICAgICAgIG1hbmFnZXIucmVuZGVyKGZpbHRlciwgaWdub3JlZEltYWdlQW5hbHlzaXNTZWxlY3RvcnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWFuYWdlciA9IG1hbmFnZVN0eWxlKGVsZW1lbnQsIHtcclxuICAgICAgICAgICAgdXBkYXRlOiB1cGRhdGUsXHJcbiAgICAgICAgICAgIGxvYWRpbmdTdGFydDogbG9hZGluZ1N0YXJ0LFxyXG4gICAgICAgICAgICBsb2FkaW5nRW5kOiBsb2FkaW5nRW5kXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3R5bGVNYW5hZ2Vycy5zZXQoZWxlbWVudCwgbWFuYWdlcik7XHJcbiAgICAgICAgcmV0dXJuIG1hbmFnZXI7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZW1vdmVNYW5hZ2VyKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgbWFuYWdlciA9IHN0eWxlTWFuYWdlcnMuZ2V0KGVsZW1lbnQpO1xyXG4gICAgICAgIGlmIChtYW5hZ2VyKSB7XHJcbiAgICAgICAgICAgIG1hbmFnZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICBzdHlsZU1hbmFnZXJzLmRlbGV0ZShlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgdGhyb3R0bGVkUmVuZGVyQWxsU3R5bGVzID0gdGhyb3R0bGUoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgc3R5bGVNYW5hZ2Vycy5mb3JFYWNoKGZ1bmN0aW9uIChtYW5hZ2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYW5hZ2VyLnJlbmRlcihmaWx0ZXIsIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBhZG9wdGVkU3R5bGVNYW5hZ2Vycy5mb3JFYWNoKGZ1bmN0aW9uIChtYW5hZ2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYW5hZ2VyLnJlbmRlcihmaWx0ZXIsIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjaygpO1xyXG4gICAgfSk7XHJcbiAgICB2YXIgY2FuY2VsUmVuZGVyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRocm90dGxlZFJlbmRlckFsbFN0eWxlcy5jYW5jZWwoKTtcclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBvbkRPTVJlYWR5KCkge1xyXG4gICAgICAgIGlmIChsb2FkaW5nU3R5bGVzLnNpemUgPT09IDApIHtcclxuICAgICAgICAgICAgY2xlYW5GYWxsYmFja1N0eWxlKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBydW5EeW5hbWljU3R5bGUoKSB7XHJcbiAgICAgICAgY3JlYXRlRHluYW1pY1N0eWxlT3ZlcnJpZGVzKCk7XHJcbiAgICAgICAgd2F0Y2hGb3JVcGRhdGVzKCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVUaGVtZUFuZFdhdGNoRm9yVXBkYXRlcygpIHtcclxuICAgICAgICBjcmVhdGVTdGF0aWNTdHlsZU92ZXJyaWRlcygpO1xyXG4gICAgICAgIGlmICghZG9jdW1lbnRJc1Zpc2libGUoKSAmJiAhZmlsdGVyLmltbWVkaWF0ZU1vZGlmeSkge1xyXG4gICAgICAgICAgICBzZXREb2N1bWVudFZpc2liaWxpdHlMaXN0ZW5lcihydW5EeW5hbWljU3R5bGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJ1bkR5bmFtaWNTdHlsZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjaGFuZ2VNZXRhVGhlbWVDb2xvcldoZW5BdmFpbGFibGUoZmlsdGVyKTtcclxuICAgIH1cclxuICAgIHZhciBwZW5kaW5nQWRvcHRlZFZhck1hdGNoID0gZmFsc2U7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVBZG9wdGVkU3R5bGVTaGVldHMobm9kZSkge1xyXG4gICAgICAgIHZhciB0aGVtZSA9IGZpbHRlcjtcclxuICAgICAgICBpZiAoaXNGaXJlZm94KSB7XHJcbiAgICAgICAgICAgIHZhciBmYWxsYmFjayA9IGdldEFkb3B0ZWRTdHlsZVNoZWV0RmFsbGJhY2sobm9kZSk7XHJcbiAgICAgICAgICAgIGZhbGxiYWNrLnJlbmRlcih0aGVtZSwgaWdub3JlZEltYWdlQW5hbHlzaXNTZWxlY3RvcnMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoYXNBZG9wdGVkU3R5bGVTaGVldHMobm9kZSkpIHtcclxuICAgICAgICAgICAgbm9kZS5hZG9wdGVkU3R5bGVTaGVldHMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUuYWRkUnVsZXNGb3JNYXRjaGluZyhzLmNzc1J1bGVzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBuZXdNYW5nZXJfMSA9IGNyZWF0ZUFkb3B0ZWRTdHlsZVNoZWV0T3ZlcnJpZGUobm9kZSk7XHJcbiAgICAgICAgICAgIGFkb3B0ZWRTdHlsZU1hbmFnZXJzLnB1c2gobmV3TWFuZ2VyXzEpO1xyXG4gICAgICAgICAgICBuZXdNYW5nZXJfMS5yZW5kZXIodGhlbWUsIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzKTtcclxuICAgICAgICAgICAgbmV3TWFuZ2VyXzEud2F0Y2goZnVuY3Rpb24gKHNoZWV0cykge1xyXG4gICAgICAgICAgICAgICAgc2hlZXRzLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNTdG9yZS5hZGRSdWxlc0Zvck1hdGNoaW5nKHMuY3NzUnVsZXMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBuZXdNYW5nZXJfMS5yZW5kZXIodGhlbWUsIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzKTtcclxuICAgICAgICAgICAgICAgIHBlbmRpbmdBZG9wdGVkVmFyTWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcG90ZW50aWFsQWRvcHRlZFN0eWxlTm9kZXMuZGVsZXRlKG5vZGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIXBvdGVudGlhbEFkb3B0ZWRTdHlsZU5vZGVzLmhhcyhub2RlKSkge1xyXG4gICAgICAgICAgICBwb3RlbnRpYWxBZG9wdGVkU3R5bGVOb2Rlcy5hZGQobm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIHBvdGVudGlhbEFkb3B0ZWRTdHlsZU5vZGVzID0gbmV3IFNldCgpO1xyXG4gICAgdmFyIHBvdGVudGlhbEFkb3B0ZWRTdHlsZUZyYW1lSWQgPSBudWxsO1xyXG4gICAgZnVuY3Rpb24gd2F0Y2hQb3RlbnRpYWxBZG9wdGVkU3R5bGVOb2RlcygpIHtcclxuICAgICAgICBwb3RlbnRpYWxBZG9wdGVkU3R5bGVGcmFtZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcG90ZW50aWFsQWRvcHRlZFN0eWxlTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuaXNDb25uZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVBZG9wdGVkU3R5bGVTaGVldHMobm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbEFkb3B0ZWRTdHlsZU5vZGVzLmRlbGV0ZShub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkIHx8IHBlbmRpbmdBZG9wdGVkVmFyTWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIHZhcmlhYmxlc1N0b3JlLm1hdGNoVmFyaWFibGVzQW5kRGVwZW5kZW50cygpO1xyXG4gICAgICAgICAgICAgICAgcGVuZGluZ0Fkb3B0ZWRWYXJNYXRjaCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdhdGNoUG90ZW50aWFsQWRvcHRlZFN0eWxlTm9kZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHN0b3BXYXRjaGluZ1BvdGVudGlhbEFkb3B0ZWRTdHlsZU5vZGVzKCkge1xyXG4gICAgICAgIHBvdGVudGlhbEFkb3B0ZWRTdHlsZUZyYW1lSWQgJiZcclxuICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUocG90ZW50aWFsQWRvcHRlZFN0eWxlRnJhbWVJZCk7XHJcbiAgICAgICAgcG90ZW50aWFsQWRvcHRlZFN0eWxlTm9kZXMuY2xlYXIoKTtcclxuICAgICAgICBpZiAoaXNGaXJlZm94KSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoXHJcbiAgICAgICAgICAgICAgICBuZXcgQ3VzdG9tRXZlbnQoXCJfX2RhcmtyZWFkZXJfX3N0b3BBZG9wdGVkU3R5bGVTaGVldHNXYXRjaGVyXCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0QWRvcHRlZFN0eWxlQ2hhbmdlVG9rZW4obm9kZSkge1xyXG4gICAgICAgIGlmIChhZG9wdGVkU3R5bGVDaGFuZ2VUb2tlbnMuaGFzKG5vZGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhZG9wdGVkU3R5bGVDaGFuZ2VUb2tlbnMuZ2V0KG5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdG9rZW4gPSBTeW1ib2woKTtcclxuICAgICAgICBhZG9wdGVkU3R5bGVDaGFuZ2VUb2tlbnMuc2V0KG5vZGUsIHRva2VuKTtcclxuICAgICAgICByZXR1cm4gdG9rZW47XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRBZG9wdGVkU3R5bGVTaGVldEZhbGxiYWNrKG5vZGUpIHtcclxuICAgICAgICB2YXIgZmFsbGJhY2sgPSBhZG9wdGVkU3R5bGVGYWxsYmFja3MuZ2V0KG5vZGUpO1xyXG4gICAgICAgIGlmICghZmFsbGJhY2spIHtcclxuICAgICAgICAgICAgZmFsbGJhY2sgPSBjcmVhdGVBZG9wdGVkU3R5bGVTaGVldEZhbGxiYWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IGdldEFkb3B0ZWRTdHlsZUNoYW5nZVRva2VuKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lT25jZSh0b2tlbiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IGFkb3B0ZWRTdHlsZU5vZGVJZHMuZ2V0KG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21tYW5kcyA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbGxiYWNrID09PSBudWxsIHx8IGZhbGxiYWNrID09PSB2b2lkIDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdm9pZCAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGZhbGxiYWNrLmNvbW1hbmRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7aWQ6IGlkLCBjb21tYW5kczogY29tbWFuZHN9O1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBDdXN0b21FdmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX19kYXJrcmVhZGVyX19hZG9wdGVkU3R5bGVTaGVldENvbW1hbmRzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGV0YWlsOiBKU09OLnN0cmluZ2lmeShkYXRhKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFkb3B0ZWRTdHlsZUZhbGxiYWNrcy5zZXQobm9kZSwgZmFsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsbGJhY2s7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB3YXRjaEZvclVwZGF0ZXMoKSB7XHJcbiAgICAgICAgdmFyIG1hbmFnZWRTdHlsZXMgPSBBcnJheS5mcm9tKHN0eWxlTWFuYWdlcnMua2V5cygpKTtcclxuICAgICAgICB3YXRjaEZvclN0eWxlQ2hhbmdlcyhcclxuICAgICAgICAgICAgbWFuYWdlZFN0eWxlcyxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlZCA9IF9hLmNyZWF0ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZCA9IF9hLnVwZGF0ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZCA9IF9hLnJlbW92ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZWQgPSBfYS5tb3ZlZDtcclxuICAgICAgICAgICAgICAgIHZhciBzdHlsZXNUb1JlbW92ZSA9IHJlbW92ZWQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGVzVG9NYW5hZ2UgPSBjcmVhdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbmNhdCh1cGRhdGVkKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQobW92ZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFzdHlsZU1hbmFnZXJzLmhhcyhzdHlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGVzVG9SZXN0b3JlID0gbW92ZWQuZmlsdGVyKGZ1bmN0aW9uIChzdHlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZU1hbmFnZXJzLmhhcyhzdHlsZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHN0eWxlc1RvUmVtb3ZlLmZvckVhY2goZnVuY3Rpb24gKHN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW92ZU1hbmFnZXIoc3R5bGUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3TWFuYWdlcnMgPSBzdHlsZXNUb01hbmFnZS5tYXAoZnVuY3Rpb24gKHN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU1hbmFnZXIoc3R5bGUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBuZXdNYW5hZ2Vyc1xyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKG1hbmFnZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmFnZXIuZGV0YWlscyh7c2Vjb25kUm91bmQ6IGZhbHNlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChkZXRhaWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRldGFpbCAmJiBkZXRhaWwucnVsZXMubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChkZXRhaWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUuYWRkUnVsZXNGb3JNYXRjaGluZyhkZXRhaWwucnVsZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdmFyaWFibGVzU3RvcmUubWF0Y2hWYXJpYWJsZXNBbmREZXBlbmRlbnRzKCk7XHJcbiAgICAgICAgICAgICAgICBuZXdNYW5hZ2Vycy5mb3JFYWNoKGZ1bmN0aW9uIChtYW5hZ2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmFnZXIucmVuZGVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgbmV3TWFuYWdlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFuYWdlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW5hZ2VyLndhdGNoKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHN0eWxlc1RvUmVzdG9yZS5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZU1hbmFnZXJzLmdldChzdHlsZSkucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIChzaGFkb3dSb290KSB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVTaGFkb3dTdGF0aWNTdHlsZU92ZXJyaWRlcyhzaGFkb3dSb290KTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZUFkb3B0ZWRTdHlsZVNoZWV0cyhzaGFkb3dSb290KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgd2F0Y2hQb3RlbnRpYWxBZG9wdGVkU3R5bGVOb2RlcygpO1xyXG4gICAgICAgIHdhdGNoRm9ySW5saW5lU3R5bGVzKFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgb3ZlcnJpZGVJbmxpbmVTdHlsZShcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcixcclxuICAgICAgICAgICAgICAgICAgICBpZ25vcmVkSW5saW5lU2VsZWN0b3JzLFxyXG4gICAgICAgICAgICAgICAgICAgIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgPT09IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHlsZUF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcInN0eWxlXCIpIHx8IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0eWxlQXR0ci5pbmNsdWRlcyhcIi0tXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlc1N0b3JlLm1hdGNoVmFyaWFibGVzQW5kRGVwZW5kZW50cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vdFZhcnNTdHlsZSA9IGNyZWF0ZU9yVXBkYXRlU3R5bGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhcmtyZWFkZXItLXJvb3QtdmFyc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlc1N0b3JlLnB1dFJvb3RWYXJzKHJvb3RWYXJzU3R5bGUsIGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAocm9vdCkge1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlU2hhZG93U3RhdGljU3R5bGVPdmVycmlkZXMocm9vdCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5saW5lU3R5bGVFbGVtZW50cyA9IHJvb3QucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgICAgICAgICAgICAgICBJTkxJTkVfU1RZTEVfU0VMRUNUT1JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5saW5lU3R5bGVFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yRWFjaChpbmxpbmVTdHlsZUVsZW1lbnRzLCBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG92ZXJyaWRlSW5saW5lU3R5bGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZWRJbmxpbmVTZWxlY3RvcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVkSW1hZ2VBbmFseXNpc1NlbGVjdG9yc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBhZGRET01SZWFkeUxpc3RlbmVyKG9uRE9NUmVhZHkpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc3RvcFdhdGNoaW5nRm9yVXBkYXRlcygpIHtcclxuICAgICAgICBzdHlsZU1hbmFnZXJzLmZvckVhY2goZnVuY3Rpb24gKG1hbmFnZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1hbmFnZXIucGF1c2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdG9wU3R5bGVQb3NpdGlvbldhdGNoZXJzKCk7XHJcbiAgICAgICAgc3RvcFdhdGNoaW5nRm9yU3R5bGVDaGFuZ2VzKCk7XHJcbiAgICAgICAgc3RvcFdhdGNoaW5nRm9ySW5saW5lU3R5bGVzKCk7XHJcbiAgICAgICAgcmVtb3ZlRE9NUmVhZHlMaXN0ZW5lcihvbkRPTVJlYWR5KTtcclxuICAgICAgICBjbGVhblJlYWR5U3RhdGVDb21wbGV0ZUxpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gICAgdmFyIG1ldGFPYnNlcnZlcjtcclxuICAgIGZ1bmN0aW9uIGFkZE1ldGFMaXN0ZW5lcigpIHtcclxuICAgICAgICBtZXRhT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJkYXJrcmVhZGVyLWxvY2tcIl0nKSkge1xyXG4gICAgICAgICAgICAgICAgbWV0YU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICAgICAgICAgIHJlbW92ZUR5bmFtaWNUaGVtZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbWV0YU9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuaGVhZCwge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlRGFya1JlYWRlckluc3RhbmNlTWFya2VyKCkge1xyXG4gICAgICAgIHZhciBtZXRhRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJtZXRhXCIpO1xyXG4gICAgICAgIG1ldGFFbGVtZW50Lm5hbWUgPSBcImRhcmtyZWFkZXJcIjtcclxuICAgICAgICBtZXRhRWxlbWVudC5jb250ZW50ID0gSU5TVEFOQ0VfSUQ7XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChtZXRhRWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpc0Fub3RoZXJEYXJrUmVhZGVySW5zdGFuY2VBY3RpdmUoKSB7XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cImRhcmtyZWFkZXItbG9ja1wiXScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWV0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cImRhcmtyZWFkZXJcIl0nKTtcclxuICAgICAgICBpZiAobWV0YSkge1xyXG4gICAgICAgICAgICBpZiAobWV0YS5jb250ZW50ICE9PSBJTlNUQU5DRV9JRCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjcmVhdGVEYXJrUmVhZGVySW5zdGFuY2VNYXJrZXIoKTtcclxuICAgICAgICBhZGRNZXRhTGlzdGVuZXIoKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVPclVwZGF0ZUR5bmFtaWNUaGVtZUludGVybmFsKFxyXG4gICAgICAgIGZpbHRlckNvbmZpZyxcclxuICAgICAgICBkeW5hbWljVGhlbWVGaXhlcyxcclxuICAgICAgICBpZnJhbWVcclxuICAgICkge1xyXG4gICAgICAgIGZpbHRlciA9IGZpbHRlckNvbmZpZztcclxuICAgICAgICBmaXhlcyA9IGR5bmFtaWNUaGVtZUZpeGVzO1xyXG4gICAgICAgIGlmIChmaXhlcykge1xyXG4gICAgICAgICAgICBpZ25vcmVkSW1hZ2VBbmFseXNpc1NlbGVjdG9ycyA9IEFycmF5LmlzQXJyYXkoXHJcbiAgICAgICAgICAgICAgICBmaXhlcy5pZ25vcmVJbWFnZUFuYWx5c2lzXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgID8gZml4ZXMuaWdub3JlSW1hZ2VBbmFseXNpc1xyXG4gICAgICAgICAgICAgICAgOiBbXTtcclxuICAgICAgICAgICAgaWdub3JlZElubGluZVNlbGVjdG9ycyA9IEFycmF5LmlzQXJyYXkoZml4ZXMuaWdub3JlSW5saW5lU3R5bGUpXHJcbiAgICAgICAgICAgICAgICA/IGZpeGVzLmlnbm9yZUlubGluZVN0eWxlXHJcbiAgICAgICAgICAgICAgICA6IFtdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlnbm9yZWRJbWFnZUFuYWx5c2lzU2VsZWN0b3JzID0gW107XHJcbiAgICAgICAgICAgIGlnbm9yZWRJbmxpbmVTZWxlY3RvcnMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZpbHRlci5pbW1lZGlhdGVNb2RpZnkpIHtcclxuICAgICAgICAgICAgc2V0SXNET01SZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlzSUZyYW1lJDEgPSBpZnJhbWU7XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LmhlYWQpIHtcclxuICAgICAgICAgICAgaWYgKGlzQW5vdGhlckRhcmtSZWFkZXJJbnN0YW5jZUFjdGl2ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVEeW5hbWljVGhlbWUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgICAgXCJkYXRhLWRhcmtyZWFkZXItbW9kZVwiLFxyXG4gICAgICAgICAgICAgICAgXCJkeW5hbWljXCJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgICAgIFwiZGF0YS1kYXJrcmVhZGVyLXNjaGVtZVwiLFxyXG4gICAgICAgICAgICAgICAgZmlsdGVyLm1vZGUgPyBcImRhcmtcIiA6IFwiZGltbWVkXCJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgY3JlYXRlVGhlbWVBbmRXYXRjaEZvclVwZGF0ZXMoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoIWlzRmlyZWZveCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZhbGxiYWNrU3R5bGUgPSBjcmVhdGVPclVwZGF0ZVN0eWxlKFwiZGFya3JlYWRlci0tZmFsbGJhY2tcIik7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZmFsbGJhY2tTdHlsZSk7XHJcbiAgICAgICAgICAgICAgICBmYWxsYmFja1N0eWxlLnRleHRDb250ZW50ID0gZ2V0TW9kaWZpZWRGYWxsYmFja1N0eWxlKGZpbHRlciwge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmljdDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGhlYWRPYnNlcnZlcl8xID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmhlYWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWFkT2JzZXJ2ZXJfMS5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQW5vdGhlckRhcmtSZWFkZXJJbnN0YW5jZUFjdGl2ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUR5bmFtaWNUaGVtZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVRoZW1lQW5kV2F0Y2hGb3JVcGRhdGVzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBoZWFkT2JzZXJ2ZXJfMS5vYnNlcnZlKGRvY3VtZW50LCB7Y2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlUHJveHkoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJfX2RhcmtyZWFkZXJfX2NsZWFuVXBcIikpO1xyXG4gICAgICAgIHJlbW92ZU5vZGUoZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKFwiLmRhcmtyZWFkZXItLXByb3h5XCIpKTtcclxuICAgIH1cclxuICAgIHZhciBjbGVhbmVycyA9IFtdO1xyXG4gICAgZnVuY3Rpb24gcmVtb3ZlRHluYW1pY1RoZW1lKCkge1xyXG4gICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLWRhcmtyZWFkZXItbW9kZVwiKTtcclxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1kYXJrcmVhZGVyLXNjaGVtZVwiKTtcclxuICAgICAgICBjbGVhbkR5bmFtaWNUaGVtZUNhY2hlKCk7XHJcbiAgICAgICAgcmVtb3ZlTm9kZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhcmtyZWFkZXItLWZhbGxiYWNrXCIpKTtcclxuICAgICAgICBpZiAoZG9jdW1lbnQuaGVhZCkge1xyXG4gICAgICAgICAgICByZXN0b3JlTWV0YVRoZW1lQ29sb3IoKTtcclxuICAgICAgICAgICAgcmVtb3ZlTm9kZShkb2N1bWVudC5oZWFkLnF1ZXJ5U2VsZWN0b3IoXCIuZGFya3JlYWRlci0tdXNlci1hZ2VudFwiKSk7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUoZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKFwiLmRhcmtyZWFkZXItLXRleHRcIikpO1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKGRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcihcIi5kYXJrcmVhZGVyLS1pbnZlcnRcIikpO1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKGRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcihcIi5kYXJrcmVhZGVyLS1pbmxpbmVcIikpO1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKGRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcihcIi5kYXJrcmVhZGVyLS1vdmVycmlkZVwiKSk7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUoZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKFwiLmRhcmtyZWFkZXItLXZhcmlhYmxlc1wiKSk7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUoZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKFwiLmRhcmtyZWFkZXItLXJvb3QtdmFyc1wiKSk7XHJcbiAgICAgICAgICAgIHJlbW92ZU5vZGUoZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJkYXJrcmVhZGVyXCJdJykpO1xyXG4gICAgICAgICAgICByZW1vdmVQcm94eSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzaGFkb3dSb290c1dpdGhPdmVycmlkZXMuZm9yRWFjaChmdW5jdGlvbiAocm9vdCkge1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKHJvb3QucXVlcnlTZWxlY3RvcihcIi5kYXJrcmVhZGVyLS1pbmxpbmVcIikpO1xyXG4gICAgICAgICAgICByZW1vdmVOb2RlKHJvb3QucXVlcnlTZWxlY3RvcihcIi5kYXJrcmVhZGVyLS1vdmVycmlkZVwiKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2hhZG93Um9vdHNXaXRoT3ZlcnJpZGVzLmNsZWFyKCk7XHJcbiAgICAgICAgZm9yRWFjaChzdHlsZU1hbmFnZXJzLmtleXMoKSwgZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZW1vdmVNYW5hZ2VyKGVsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBsb2FkaW5nU3R5bGVzLmNsZWFyKCk7XHJcbiAgICAgICAgY2xlYW5Mb2FkaW5nTGlua3MoKTtcclxuICAgICAgICBmb3JFYWNoKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZGFya3JlYWRlclwiKSwgcmVtb3ZlTm9kZSk7XHJcbiAgICAgICAgYWRvcHRlZFN0eWxlTWFuYWdlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFuYWdlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbWFuYWdlci5kZXN0cm95KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYWRvcHRlZFN0eWxlTWFuYWdlcnMuc3BsaWNlKDApO1xyXG4gICAgICAgIGFkb3B0ZWRTdHlsZUZhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChmYWxsYmFjaykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsbGJhY2suZGVzdHJveSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGFkb3B0ZWRTdHlsZUZhbGxiYWNrcy5jbGVhcigpO1xyXG4gICAgICAgIHN0b3BXYXRjaGluZ1BvdGVudGlhbEFkb3B0ZWRTdHlsZU5vZGVzKCk7XHJcbiAgICAgICAgbWV0YU9ic2VydmVyICYmIG1ldGFPYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgY2xlYW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoY2xlYW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNsZWFuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2xlYW5lcnMuc3BsaWNlKDApO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY2xlYW5EeW5hbWljVGhlbWVDYWNoZSgpIHtcclxuICAgICAgICB2YXJpYWJsZXNTdG9yZS5jbGVhcigpO1xyXG4gICAgICAgIHBhcnNlZFVSTENhY2hlLmNsZWFyKCk7XHJcbiAgICAgICAgcmVtb3ZlRG9jdW1lbnRWaXNpYmlsaXR5TGlzdGVuZXIoKTtcclxuICAgICAgICBjYW5jZWxSZW5kZXJpbmcoKTtcclxuICAgICAgICBzdG9wV2F0Y2hpbmdGb3JVcGRhdGVzKCk7XHJcbiAgICAgICAgY2xlYW5Nb2RpZmljYXRpb25DYWNoZSgpO1xyXG4gICAgICAgIGNsZWFyQ29sb3JDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBibG9iUmVnZXggPSAvdXJsXFwoXFxcIihibG9iXFw6Lio/KVxcXCJcXCkvZztcclxuICAgIGZ1bmN0aW9uIHJlcGxhY2VCbG9icyh0ZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcHJvbWlzZXMsIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldE1hdGNoZXMoYmxvYlJlZ2V4LCB0ZXh0LCAxKS5mb3JFYWNoKGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gbG9hZEFzRGF0YVVSTCh1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChwcm9taXNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgUHJvbWlzZS5hbGwocHJvbWlzZXMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5yZXBsYWNlKGJsb2JSZWdleCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAndXJsKFwiJy5jb25jYXQoZGF0YS5zaGlmdCgpLCAnXCIpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHZhciBiYW5uZXIgPVxyXG4gICAgICAgICcvKlxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9fX19fX19cXG4gICAgICAgICAgICAgICAgICAgICAgIC8gICAgICAgXFxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAuPT0uICAgIC49PS5cXG4gICAgICAgICAgICAgICAgICAgICAoKCAgKSk9PSgoICApKVxcbiAgICAgICAgICAgICAgICAgICAgLyBcIj09XCIgICAgXCI9PVwiXFxcXFxcbiAgICAgICAgICAgICAgICAgICAvX19fX3x8IHx8IHx8X19fXFxcXFxcbiAgICAgICBfX19fX19fXyAgICAgX19fXyAgICBfX19fX19fXyAgX19fICAgIF9fX1xcbiAgICAgICB8ICBfX18gIFxcXFwgICAvICAgIFxcXFwgICB8ICBfX18gIFxcXFwgfCAgfCAgLyAgL1xcbiAgICAgICB8ICB8ICBcXFxcICBcXFxcIC8gIC9cXFxcICBcXFxcICB8ICB8ICBcXFxcICBcXFxcfCAgfF8vICAvXFxuICAgICAgIHwgIHwgICApICAvICAvX19cXFxcICBcXFxcIHwgIHxfXy8gIC98ICBfX18gIFxcXFxcXG4gICAgICAgfCAgfF9fLyAgLyAgX19fX19fICBcXFxcfCAgX19fXyAgXFxcXHwgIHwgIFxcXFwgIFxcXFxcXG5fX19fX19ffF9fX19fX18vX18vIF9fX18gXFxcXF9fXFxcXF9ffF9fX1xcXFxfX1xcXFxfX3xfX19cXFxcX19cXFxcX19fX1xcbnwgIF9fXyAgXFxcXCB8ICBfX19fLyAvICAgIFxcXFwgICB8ICBfX18gIFxcXFwgfCAgX19fX3wgIF9fXyAgXFxcXFxcbnwgIHwgIFxcXFwgIFxcXFx8ICB8X19fIC8gIC9cXFxcICBcXFxcICB8ICB8ICBcXFxcICBcXFxcfCAgfF9fX3wgIHwgIFxcXFwgIFxcXFxcXG58ICB8X18vICAvfCAgX19fXy8gIC9fX1xcXFwgIFxcXFwgfCAgfCAgICkgIHwgIF9fX198ICB8X18vICAvXFxufCAgX19fXyAgXFxcXHwgIHxfXy8gIF9fX19fXyAgXFxcXHwgIHxfXy8gIC98ICB8X19ffCAgX19fXyAgXFxcXFxcbnxfX3wgICBcXFxcX19cXFxcX19fXy9fXy8gICAgICBcXFxcX19cXFxcX19fX19fXy8gfF9fX19fX3xfX3wgICBcXFxcX19cXFxcXFxuICAgICAgICAgICAgICAgIGh0dHBzOi8vZGFya3JlYWRlci5vcmdcXG4qL1xcblxcbi8qISBEYXJrIHJlYWRlciBnZW5lcmF0ZWQgQ1NTIHwgTGljZW5zZWQgdW5kZXIgTUlUIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrcmVhZGVyL2RhcmtyZWFkZXIvYmxvYi9tYWluL0xJQ0VOU0UgKi9cXG4nO1xyXG4gICAgZnVuY3Rpb24gY29sbGVjdENTUygpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGFkZFN0YXRpY0NTUyhzZWxlY3RvciwgY29tbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXRpY1N0eWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGljU3R5bGUgJiYgc3RhdGljU3R5bGUudGV4dENvbnRlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjc3MucHVzaChcIi8qIFwiLmNvbmNhdChjb21tZW50LCBcIiAqL1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3NzLnB1c2goc3RhdGljU3R5bGUudGV4dENvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNzcy5wdXNoKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjc3MsIG1vZGlmaWVkQ1NTLCBmb3JtYXR0ZWRDU1MsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzID0gW2Jhbm5lcl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFN0YXRpY0NTUyhcIi5kYXJrcmVhZGVyLS1mYWxsYmFja1wiLCBcIkZhbGxiYWNrIFN0eWxlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRTdGF0aWNDU1MoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi5kYXJrcmVhZGVyLS11c2VyLWFnZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlVzZXItQWdlbnQgU3R5bGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRTdGF0aWNDU1MoXCIuZGFya3JlYWRlci0tdGV4dFwiLCBcIlRleHQgU3R5bGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFN0YXRpY0NTUyhcIi5kYXJrcmVhZGVyLS1pbnZlcnRcIiwgXCJJbnZlcnQgU3R5bGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFN0YXRpY0NTUyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLmRhcmtyZWFkZXItLXZhcmlhYmxlc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJWYXJpYWJsZXMgU3R5bGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZENTUyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZGFya3JlYWRlci0tc3luY1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JFYWNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNoZWV0LmNzc1J1bGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocnVsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuY3NzVGV4dCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkQ1NTLnB1c2gocnVsZS5jc3NUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtb2RpZmllZENTUy5sZW5ndGgpIHJldHVybiBbMywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZENTUyA9IGZvcm1hdENTUyhtb2RpZmllZENTUy5qb2luKFwiXFxuXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzLnB1c2goXCIvKiBNb2RpZmllZCBDU1MgKi9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gKF9hID0gY3NzKS5wdXNoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIHJlcGxhY2VCbG9icyhmb3JtYXR0ZWRDU1MpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmFwcGx5KF9hLCBbX2Muc2VudCgpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy5wdXNoKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRTdGF0aWNDU1MoXCIuZGFya3JlYWRlci0tb3ZlcnJpZGVcIiwgXCJPdmVycmlkZSBTdHlsZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBjc3Muam9pbihcIlxcblwiKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpc0RhcmtSZWFkZXJFbmFibGVkID0gZmFsc2U7XHJcbiAgICB2YXIgaXNJRnJhbWUgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcDtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0pKCk7XHJcbiAgICBmdW5jdGlvbiBlbmFibGUodGhlbWVPcHRpb25zLCBmaXhlcykge1xyXG4gICAgICAgIGlmICh0aGVtZU9wdGlvbnMgPT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICB0aGVtZU9wdGlvbnMgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZpeGVzID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgZml4ZXMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGhlbWUgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgREVGQVVMVF9USEVNRSksIHRoZW1lT3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHRoZW1lLmVuZ2luZSAhPT0gVGhlbWVFbmdpbmUuZHluYW1pY1RoZW1lKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZW1lIGVuZ2luZSBpcyBub3Qgc3VwcG9ydGVkLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3JlYXRlT3JVcGRhdGVEeW5hbWljVGhlbWVJbnRlcm5hbCh0aGVtZSwgZml4ZXMsIGlzSUZyYW1lKTtcclxuICAgICAgICBpc0RhcmtSZWFkZXJFbmFibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGlzRW5hYmxlZCgpIHtcclxuICAgICAgICByZXR1cm4gaXNEYXJrUmVhZGVyRW5hYmxlZDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGRpc2FibGUoKSB7XHJcbiAgICAgICAgcmVtb3ZlRHluYW1pY1RoZW1lKCk7XHJcbiAgICAgICAgaXNEYXJrUmVhZGVyRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFyIGRhcmtTY2hlbWUgPSBtYXRjaE1lZGlhKFwiKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKVwiKTtcclxuICAgIHZhciBzdG9yZSA9IHtcclxuICAgICAgICB0aGVtZU9wdGlvbnM6IG51bGwsXHJcbiAgICAgICAgZml4ZXM6IG51bGxcclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVDb2xvclNjaGVtZSgpIHtcclxuICAgICAgICBpZiAoZGFya1NjaGVtZS5tYXRjaGVzKSB7XHJcbiAgICAgICAgICAgIGVuYWJsZShzdG9yZS50aGVtZU9wdGlvbnMsIHN0b3JlLmZpeGVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkaXNhYmxlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYXV0byh0aGVtZU9wdGlvbnMsIGZpeGVzKSB7XHJcbiAgICAgICAgaWYgKHRoZW1lT3B0aW9ucyA9PT0gdm9pZCAwKSB7XHJcbiAgICAgICAgICAgIHRoZW1lT3B0aW9ucyA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZml4ZXMgPT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICBmaXhlcyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGVtZU9wdGlvbnMpIHtcclxuICAgICAgICAgICAgc3RvcmUgPSB7dGhlbWVPcHRpb25zOiB0aGVtZU9wdGlvbnMsIGZpeGVzOiBmaXhlc307XHJcbiAgICAgICAgICAgIGhhbmRsZUNvbG9yU2NoZW1lKCk7XHJcbiAgICAgICAgICAgIGlmIChpc01hdGNoTWVkaWFDaGFuZ2VFdmVudExpc3RlbmVyU3VwcG9ydGVkKSB7XHJcbiAgICAgICAgICAgICAgICBkYXJrU2NoZW1lLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgaGFuZGxlQ29sb3JTY2hlbWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZGFya1NjaGVtZS5hZGRMaXN0ZW5lcihoYW5kbGVDb2xvclNjaGVtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoaXNNYXRjaE1lZGlhQ2hhbmdlRXZlbnRMaXN0ZW5lclN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICAgICAgZGFya1NjaGVtZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGhhbmRsZUNvbG9yU2NoZW1lKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhcmtTY2hlbWUucmVtb3ZlTGlzdGVuZXIoaGFuZGxlQ29sb3JTY2hlbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRpc2FibGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBleHBvcnRHZW5lcmF0ZWRDU1MoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGNvbGxlY3RDU1MoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdmFyIHNldEZldGNoTWV0aG9kID0gc2V0RmV0Y2hNZXRob2QkMTtcclxuXHJcbiAgICBleHBvcnRzLmF1dG8gPSBhdXRvO1xyXG4gICAgZXhwb3J0cy5kaXNhYmxlID0gZGlzYWJsZTtcclxuICAgIGV4cG9ydHMuZW5hYmxlID0gZW5hYmxlO1xyXG4gICAgZXhwb3J0cy5leHBvcnRHZW5lcmF0ZWRDU1MgPSBleHBvcnRHZW5lcmF0ZWRDU1M7XHJcbiAgICBleHBvcnRzLmlzRW5hYmxlZCA9IGlzRW5hYmxlZDtcclxuICAgIGV4cG9ydHMuc2V0RmV0Y2hNZXRob2QgPSBzZXRGZXRjaE1ldGhvZDtcclxuXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHt2YWx1ZTogdHJ1ZX0pO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/darkreader/darkreader.js\n"));

/***/ }),

/***/ "./src/components/layouts/MainLayout/MainLayout.tsx":
/*!**********************************************************!*\
  !*** ./src/components/layouts/MainLayout/MainLayout.tsx ***!
  \**********************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"./node_modules/react/jsx-dev-runtime.js\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _mantine_core__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @mantine/core */ \"./node_modules/@mantine/core/esm/index.js\");\n/* harmony import */ var _mantine_hooks__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @mantine/hooks */ \"./node_modules/@mantine/hooks/esm/index.js\");\n/* harmony import */ var _mantine_notifications__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @mantine/notifications */ \"./node_modules/@mantine/notifications/esm/index.js\");\n/* harmony import */ var _tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @tabler/icons-react */ \"./node_modules/@tabler/icons-react/dist/esm/tabler-icons-react.mjs\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! classnames */ \"./node_modules/classnames/index.js\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var darkreader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! darkreader */ \"./node_modules/darkreader/darkreader.js\");\n/* harmony import */ var darkreader__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(darkreader__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var react_device_detect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-device-detect */ \"./node_modules/react-device-detect/dist/lib.js\");\n/* harmony import */ var react_use__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! react-use */ \"./node_modules/react-use/esm/index.js\");\n/* harmony import */ var _components_misc_FunnyEmoji__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/components/misc/FunnyEmoji */ \"./src/components/misc/FunnyEmoji.tsx\");\n/* harmony import */ var _components_pages_MainPage_MainPage_style__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/components/pages/MainPage/MainPage.style */ \"./src/components/pages/MainPage/MainPage.style.tsx\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/config */ \"./src/config.ts\");\n/* harmony import */ var _states_states__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/states/states */ \"./src/states/states.tsx\");\n/* harmony import */ var _utility_store__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/utility/store */ \"./src/utility/store.ts\");\n\nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst links = [\n    {\n        icon: _tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconMessage,\n        label: \"Agents\",\n        key: \"nullgpt\",\n        canAddCollections: true,\n        collectionsLabel: \"Agents\"\n    }\n];\nconst MainLayout = (param)=>{\n    let { children  } = param;\n    _s();\n    const { classes  } = (0,_components_pages_MainPage_MainPage_style__WEBPACK_IMPORTED_MODULE_7__.useStyles)();\n    const [collections] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCollections)();\n    const [globalCurrentTool, setGlobalCurrentTool] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentTool)();\n    const [currentTool, setCurrentTool] = (0,react_use__WEBPACK_IMPORTED_MODULE_12__.useLocalStorage)(\":currentTool\", globalCurrentTool);\n    const currentLink = (0,react__WEBPACK_IMPORTED_MODULE_4__.useMemo)(()=>{\n        return links.find((v)=>v.key === currentTool);\n    }, [\n        currentTool\n    ]);\n    const [addAction] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useAddCollectionAction)();\n    const [currentCollection, setCurrentCollection] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollection)();\n    const [, setCollectionEditId] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionEditId)();\n    const [, setCollectionRemoveId] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionRemoveId)();\n    const [, setCollectionUpId] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionUpId)();\n    const [, setCollectionDownId] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionDownId)();\n    const theme = (0,_mantine_core__WEBPACK_IMPORTED_MODULE_13__.useMantineTheme)();\n    const [opened, setOpened] = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(false);\n    const [highContrast, setHighContrast] = (0,react_use__WEBPACK_IMPORTED_MODULE_12__.useLocalStorage)(\"highContrast\", \"0\");\n    const logoText = (0,react__WEBPACK_IMPORTED_MODULE_4__.useMemo)(()=>{\n        return localStorage.getItem(\":logoText\") || _config__WEBPACK_IMPORTED_MODULE_8__.appName;\n    }, []);\n    const [, setSubCollectionId] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useSubCollectionId)();\n    const [lastMessageByCollection, setLastMessageByCollection] = (0,_states_states__WEBPACK_IMPORTED_MODULE_9__.useLastMessageByCollection)();\n    const viewport = (0,_mantine_hooks__WEBPACK_IMPORTED_MODULE_14__.useViewportSize)();\n    const [renderKey, setRenderKey] = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(Date.now());\n    const viewportRef = (0,react__WEBPACK_IMPORTED_MODULE_4__.useRef)({\n        width: 0,\n        height: 0\n    });\n    const hotkeySwitchCollection = (index)=>{\n        if (index <= collections.length - 1) {\n            setCurrentCollection(collections[index].key);\n        }\n    };\n    (0,_mantine_hooks__WEBPACK_IMPORTED_MODULE_14__.useHotkeys)((0,lodash__WEBPACK_IMPORTED_MODULE_3__.range)(0, 9).map((i)=>[\n            \"mod+\".concat(i + 1),\n            ()=>hotkeySwitchCollection(i)\n        ]));\n    (0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(()=>{\n        setGlobalCurrentTool(currentTool);\n    }, [\n        currentTool\n    ]);\n    (0,react_use__WEBPACK_IMPORTED_MODULE_12__.useDebounce)(()=>{\n        if (!currentTool) return;\n        if (collections.length > 0 && !(0,lodash__WEBPACK_IMPORTED_MODULE_3__.find)(collections, (v)=>v.key === currentCollection)) {\n            const dbCurrentCollection = localStorage.getItem(\":currentCollection:\".concat(currentTool));\n            const tempCollection = (0,lodash__WEBPACK_IMPORTED_MODULE_3__.find)(collections, (v)=>v.key.toString() === dbCurrentCollection);\n            if (tempCollection) {\n                setCurrentCollection(tempCollection.key);\n            } else {\n                setCurrentCollection(collections[0].key);\n            }\n        }\n        if (collections.length === 0) {\n            setCurrentCollection(undefined);\n        }\n    }, 42, [\n        collections,\n        currentCollection,\n        currentTool\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(()=>{\n        if (currentTool && currentCollection) {\n            localStorage.setItem(\":currentCollection:\".concat(currentTool), currentCollection.toString());\n        }\n    }, [\n        currentCollection,\n        currentTool\n    ]);\n    (0,react_use__WEBPACK_IMPORTED_MODULE_12__.useMount)(()=>{\n        // enableDarkMode({\n        //   // brightness: 100,\n        //   // contrast: 100,\n        //   sepia: 10,\n        // });\n        //\n        // collectCSS().then(console.log);\n        if (sessionStorage.getItem(\":importLocalStorageFromFile\")) {\n            sessionStorage.removeItem(\":importLocalStorageFromFile\");\n            _mantine_notifications__WEBPACK_IMPORTED_MODULE_15__.notifications.show({\n                title: \"Success\",\n                message: \"Data import successful.\",\n                radius: \"lg\",\n                withCloseButton: true,\n                color: \"green\",\n                icon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconCircleCheckFilled, {}, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                    lineNumber: 173,\n                    columnNumber: 15\n                }, undefined)\n            });\n        }\n    });\n    (0,react_use__WEBPACK_IMPORTED_MODULE_12__.useDebounce)(()=>{\n        if (highContrast === \"1\") {\n            (0,darkreader__WEBPACK_IMPORTED_MODULE_2__.enable)({\n                // brightness: 100,\n                // contrast: 100,\n                sepia: 10\n            });\n        } else {\n            (0,darkreader__WEBPACK_IMPORTED_MODULE_2__.disable)();\n        }\n    }, 500, [\n        highContrast\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(()=>{\n        const collection = collections.find((v)=>v.key === currentCollection);\n        if (collection) {\n            document.title = \"\".concat(collection.emoji, \" \").concat(collection.label);\n        }\n    }, [\n        currentCollection,\n        collections\n    ]);\n    (0,_mantine_hooks__WEBPACK_IMPORTED_MODULE_14__.useShallowEffect)(()=>{\n        if (collections.length === 0) return;\n        if (Object.keys(lastMessageByCollection).length > 0) return;\n        const result = {};\n        Promise.all((0,lodash__WEBPACK_IMPORTED_MODULE_3__.map)(collections, async (collection)=>{\n            const messages = await _utility_store__WEBPACK_IMPORTED_MODULE_10__[\"default\"].getItem((0,_utility_store__WEBPACK_IMPORTED_MODULE_10__.messagesKey)(collection.key)) || [];\n            for(let i = messages.length - 1; i >= 0; i--){\n                if (messages[i].source === \"user\") {\n                    result[collection.key] = messages[i].content;\n                    break;\n                }\n            }\n        })).then(()=>{\n            result[\"ok\"] = \"OK\";\n            setLastMessageByCollection(result);\n        });\n    }, [\n        collections,\n        lastMessageByCollection\n    ]);\n    (0,react_use__WEBPACK_IMPORTED_MODULE_12__.useDebounce)(()=>{\n        if (viewport.width > 0) {\n            if (viewportRef.current.width === 0) {\n                viewportRef.current = viewport;\n            }\n            if (viewportRef.current.width !== viewport.width || viewportRef.current.height !== viewport.height) {\n                viewportRef.current = viewport;\n                setRenderKey(Date.now());\n            }\n        }\n    }, 500, [\n        viewport.width,\n        viewport.height\n    ]);\n    const mainLinks = links.map((link)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.UnstyledButton, {\n            className: classes.mainLink,\n            onClick: ()=>{\n                setCurrentTool(link.key);\n                setOpened(false);\n            },\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Text, {\n                    color: currentTool === link.key ? \"white\" : \"dimmed\",\n                    className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(classes.mainLinkInner, {\n                        \"opacity-80\": currentTool !== link.key\n                    }),\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(link.icon, {\n                            size: \"1.3rem\",\n                            className: classes.mainLinkIcon,\n                            stroke: 1.5\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                            lineNumber: 255,\n                            columnNumber: 9\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                            className: \"font-normal\",\n                            children: link.label\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                            lineNumber: 256,\n                            columnNumber: 9\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                    lineNumber: 249,\n                    columnNumber: 7\n                }, undefined),\n                link.notifications && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Badge, {\n                    size: \"sm\",\n                    variant: \"filled\",\n                    className: classes.mainLinkBadge,\n                    children: link.notifications\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                    lineNumber: 259,\n                    columnNumber: 9\n                }, undefined)\n            ]\n        }, link.label, true, {\n            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n            lineNumber: 241,\n            columnNumber: 5\n        }, undefined));\n    const collectionLinks = collections.map((collection, index)=>{\n        /*#__PURE__*/ return (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            onClick: ()=>{\n                setCurrentCollection(collection.key);\n                setOpened(false);\n            },\n            className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(classes.collectionLink, \"pr-2\", {\n                \"opacity-80\": collection.key !== currentCollection,\n                // 'font-bold': collection.key === currentCollection,\n                [classes.selectedCollectionLink]: collection.key === currentCollection,\n                \"shadow\": collection.key === currentCollection\n            }),\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex flex-row gap-3 items-center relative flex-grow\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex-grow flex gap-1 items-center text-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-[40px] justify-center flex items-center relative z-10\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    style: {\n                                        marginRight: (0,_mantine_core__WEBPACK_IMPORTED_MODULE_13__.rem)(8),\n                                        fontSize: \"1rem\"\n                                    },\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"rounded-full w-[32px] h-[32px] p-1 overflow-hidden\",\n                                        style: {\n                                            background: \"#333333\"\n                                        },\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_misc_FunnyEmoji__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n                                            emoji: collection.emoji,\n                                            emojiType: collection.key === currentCollection ? \"anim\" : \"3d\",\n                                            size: \"100%\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                            lineNumber: 289,\n                                            columnNumber: 17\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 283,\n                                        columnNumber: 15\n                                    }, undefined)\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                    lineNumber: 282,\n                                    columnNumber: 13\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                lineNumber: 281,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex flex-col items-start justify-center h-[50px] pb-1\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Text, {\n                                        color: collection.key === currentCollection ? \"white\" : undefined,\n                                        className: \"whitespace-nowrap\",\n                                        children: collection.label\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 298,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    !!collection.description && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Text, {\n                                        color: collection.key === currentCollection ? \"white\" : undefined,\n                                        className: \"font-normal text-xs text-left line-clamp-1 max-w-full\",\n                                        title: collection.description,\n                                        style: {\n                                            lineHeight: \"20px\"\n                                        },\n                                        children: lastMessageByCollection[collection.key] || collection.description || collection.label\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 305,\n                                        columnNumber: 15\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                lineNumber: 297,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                        lineNumber: 280,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(\"absolute right-[-5px] flex flex-row gap-1 items-center justify-center collection-action px-2 py-1 rounded shadow-xl\", {\n                            \"collection-action-disabled\": !(currentLink === null || currentLink === void 0 ? void 0 : currentLink.canAddCollections)\n                        }, classes.listActions),\n                        children: [\n                            !react_device_detect__WEBPACK_IMPORTED_MODULE_5__.isMobile && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.ActionIcon, {\n                                        variant: \"outline\",\n                                        color: \"blue\",\n                                        size: \"md\",\n                                        onClick: (e)=>{\n                                            e.stopPropagation();\n                                            setSubCollectionId(collection.key);\n                                        },\n                                        title: \"Open in a dialog\",\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconArrowsMaximize, {\n                                            size: \"2rem\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                            lineNumber: 353,\n                                            columnNumber: 17\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 343,\n                                        columnNumber: 15\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Divider, {\n                                        orientation: \"vertical\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 355,\n                                        columnNumber: 15\n                                    }, undefined)\n                                ]\n                            }, void 0, true),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex flex-col gap-1\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex flex-row gap-1\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.ActionIcon, {\n                                                variant: \"default\",\n                                                color: \"blue\",\n                                                size: \"xs\",\n                                                onClick: (e)=>{\n                                                    e.stopPropagation();\n                                                    setCollectionUpId(collection.key);\n                                                },\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconArrowUp, {\n                                                    size: \"1rem\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                    lineNumber: 369,\n                                                    columnNumber: 17\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                lineNumber: 360,\n                                                columnNumber: 15\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.ActionIcon, {\n                                                variant: \"default\",\n                                                color: \"blue\",\n                                                size: \"xs\",\n                                                onClick: (e)=>{\n                                                    e.stopPropagation();\n                                                    setCollectionDownId(collection.key);\n                                                },\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconArrowDown, {\n                                                    size: \"1rem\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                    lineNumber: 380,\n                                                    columnNumber: 17\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                lineNumber: 371,\n                                                columnNumber: 15\n                                            }, undefined)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 359,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex flex-row gap-1\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.ActionIcon, {\n                                                variant: \"default\",\n                                                color: \"blue\",\n                                                size: \"xs\",\n                                                onClick: (e)=>{\n                                                    e.stopPropagation();\n                                                    setCollectionEditId(collection.key);\n                                                },\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconEdit, {\n                                                    size: \"1rem\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                    lineNumber: 393,\n                                                    columnNumber: 17\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                lineNumber: 384,\n                                                columnNumber: 15\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.ActionIcon, {\n                                                variant: \"outline\",\n                                                color: \"red\",\n                                                size: \"xs\",\n                                                onClick: (e)=>{\n                                                    e.stopPropagation();\n                                                    setCollectionRemoveId(collection.key);\n                                                },\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconTrash, {\n                                                    size: \"1rem\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                    lineNumber: 404,\n                                                    columnNumber: 17\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                                lineNumber: 395,\n                                                columnNumber: 15\n                                            }, undefined)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                        lineNumber: 383,\n                                        columnNumber: 13\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                                lineNumber: 358,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                        lineNumber: 332,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 279,\n                columnNumber: 7\n            }, undefined)\n        }, collection.key, false, {\n            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n            lineNumber: 266,\n            columnNumber: 5\n        }, undefined);\n    });\n    const renderedScrollContent = /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"pb-5 w-full\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Group, {\n                className: classes.collectionsHeader,\n                position: \"apart\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Text, {\n                        size: \"xs\",\n                        weight: 500,\n                        color: \"dimmed\",\n                        children: currentLink === null || currentLink === void 0 ? void 0 : currentLink.collectionsLabel\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                        lineNumber: 416,\n                        columnNumber: 9\n                    }, undefined),\n                    (currentLink === null || currentLink === void 0 ? void 0 : currentLink.canAddCollections) && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.ActionIcon, {\n                        variant: \"default\",\n                        size: 18,\n                        onClick: addAction,\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconPlus, {\n                            size: \"1rem\",\n                            stroke: 1.5\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                            lineNumber: 421,\n                            columnNumber: 13\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                        lineNumber: 420,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 415,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(classes.collections, \"flex flex-col gap-0.5 mt-3\"),\n                children: collectionLinks\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 425,\n                columnNumber: 7\n            }, undefined),\n            (currentLink === null || currentLink === void 0 ? void 0 : currentLink.canAddCollections) && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"px-4\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Button, {\n                    fullWidth: true,\n                    variant: \"default\",\n                    size: \"xs\",\n                    leftIcon: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tabler_icons_react__WEBPACK_IMPORTED_MODULE_11__.IconPlus, {}, void 0, false, void 0, void 0),\n                    onClick: addAction,\n                    children: \"New agent\"\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                    lineNumber: 430,\n                    columnNumber: 11\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 429,\n                columnNumber: 9\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n        lineNumber: 414,\n        columnNumber: 5\n    }, undefined);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_notifications__WEBPACK_IMPORTED_MODULE_15__.Notifications, {}, void 0, false, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 446,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.AppShell, {\n                padding: 0,\n                pl: 12,\n                pr: 12,\n                navbar: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Navbar, {\n                    hidden: !opened,\n                    width: {\n                        sm: 300\n                    },\n                    p: \"0\",\n                    className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(\"flex flex-col z-50\", classes.navbar, {}),\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Navbar.Section, {\n                            className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(classes.section, \"pt-5\"),\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: classes.mainLinks,\n                                children: mainLinks\n                            }, void 0, false, void 0, void 0)\n                        }, void 0, false, void 0, void 0),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Navbar.Section, {\n                            className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(classes.section, \"w-full\"),\n                            grow: true,\n                            component: _mantine_core__WEBPACK_IMPORTED_MODULE_13__.ScrollArea,\n                            children: renderedScrollContent\n                        }, void 0, false, void 0, void 0),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Navbar.Section, {\n                            className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(classes.section, \"px-5\"),\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex items-center\"\n                            }, void 0, false, void 0, void 0)\n                        }, void 0, false, void 0, void 0)\n                    ]\n                }, void 0, true, void 0, void 0),\n                header: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Header, {\n                    height: {\n                        base: 33\n                    },\n                    p: \"md\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        style: {\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            height: \"100%\"\n                        },\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.MediaQuery, {\n                                largerThan: \"md\",\n                                styles: {\n                                    display: \"none\"\n                                },\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Burger, {\n                                    opened: opened,\n                                    onClick: ()=>setOpened((o)=>!o),\n                                    size: \"sm\",\n                                    color: theme.colors.gray[6],\n                                    mr: \"xl\"\n                                }, void 0, false, void 0, void 0)\n                            }, void 0, false, void 0, void 0),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex items-center justify-center\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mantine_core__WEBPACK_IMPORTED_MODULE_13__.Text, {\n                                        style: {\n                                            fontWeight: 800,\n                                            lineHeight: 0,\n                                            fontSize: 20,\n                                            color: \"white\",\n                                            letterSpacing: 0.1\n                                        },\n                                        children: logoText\n                                    }, void 0, false, void 0, void 0),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"-ml-2 -mb-2\"\n                                    }, void 0, false, void 0, void 0)\n                                ]\n                            }, void 0, true, void 0, void 0)\n                        ]\n                    }, void 0, true, void 0, void 0)\n                }, void 0, false, void 0, void 0),\n                children: children\n            }, renderKey, false, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 447,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                id: \"import_config_input\",\n                type: \"file\",\n                accept: \"application/json\",\n                className: \"hidden\"\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\Usuario\\\\Desktop\\\\WaihekeGPT\\\\src\\\\components\\\\layouts\\\\MainLayout\\\\MainLayout.tsx\",\n                lineNumber: 543,\n                columnNumber: 7\n            }, undefined)\n        ]\n    }, void 0, true);\n};\n_s(MainLayout, \"wWsNddLJCKGfUaJz4/jGmbzBfbQ=\", false, function() {\n    return [\n        _components_pages_MainPage_MainPage_style__WEBPACK_IMPORTED_MODULE_7__.useStyles,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCollections,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentTool,\n        react_use__WEBPACK_IMPORTED_MODULE_12__.useLocalStorage,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useAddCollectionAction,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollection,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionEditId,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionRemoveId,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionUpId,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useCurrentCollectionDownId,\n        _mantine_core__WEBPACK_IMPORTED_MODULE_13__.useMantineTheme,\n        react_use__WEBPACK_IMPORTED_MODULE_12__.useLocalStorage,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useSubCollectionId,\n        _states_states__WEBPACK_IMPORTED_MODULE_9__.useLastMessageByCollection,\n        _mantine_hooks__WEBPACK_IMPORTED_MODULE_14__.useViewportSize,\n        _mantine_hooks__WEBPACK_IMPORTED_MODULE_14__.useHotkeys,\n        react_use__WEBPACK_IMPORTED_MODULE_12__.useDebounce,\n        react_use__WEBPACK_IMPORTED_MODULE_12__.useMount,\n        react_use__WEBPACK_IMPORTED_MODULE_12__.useDebounce,\n        _mantine_hooks__WEBPACK_IMPORTED_MODULE_14__.useShallowEffect,\n        react_use__WEBPACK_IMPORTED_MODULE_12__.useDebounce\n    ];\n});\n_c = MainLayout;\n/* harmony default export */ __webpack_exports__[\"default\"] = (MainLayout);\nvar _c;\n$RefreshReg$(_c, \"MainLayout\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports on update so we can compare the boundary\n                // signatures.\n                module.hot.dispose(function (data) {\n                    data.prevExports = currentExports;\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevExports !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevExports !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9sYXlvdXRzL01haW5MYXlvdXQvTWFpbkxheW91dC50c3guanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBbUJ1QjtBQUN3RDtBQUNUO0FBYXpDO0FBQ087QUFDOEM7QUFDakM7QUFDbUI7QUFDckI7QUFDb0I7QUFFYjtBQUNpQjtBQUNwQztBQVlWO0FBQzRCO0FBVXJELE1BQU00RCxRQU9EO0lBQ0g7UUFDRUMsTUFBTXBDLDZEQUFXQTtRQUNqQnFDLE9BQU87UUFDUEMsS0FBSztRQUNMQyxtQkFBbUIsSUFBSTtRQUN2QkMsa0JBQWtCO0lBQ3BCO0NBUUQ7QUFNRCxNQUFNQyxhQUFhLFNBQW1DO1FBQWxDLEVBQUVDLFNBQVEsRUFBbUI7O0lBQy9DLE1BQU0sRUFBRUMsUUFBTyxFQUFFLEdBQUd0QixvRkFBU0E7SUFDN0IsTUFBTSxDQUFDdUIsWUFBWSxHQUFHcEIsOERBQWNBO0lBQ3BDLE1BQU0sQ0FBQ3FCLG1CQUFtQkMscUJBQXFCLEdBQUdoQiw4REFBY0E7SUFDaEUsTUFBTSxDQUFDaUIsYUFBYUMsZUFBZSxHQUFHOUIsMkRBQWVBLENBQUMsZ0JBQWdCMkI7SUFDdEUsTUFBTUksY0FBY3BDLDhDQUFPQSxDQUFDLElBQU07UUFDaEMsT0FBT3NCLE1BQU0zQixJQUFJLENBQUMsQ0FBQzBDLElBQU1BLEVBQUVaLEdBQUcsS0FBS1M7SUFDckMsR0FBRztRQUFDQTtLQUFZO0lBQ2hCLE1BQU0sQ0FBQ0ksVUFBVSxHQUFHNUIsc0VBQXNCQTtJQUMxQyxNQUFNLENBQUM2QixtQkFBbUJDLHFCQUFxQixHQUFHNUIsb0VBQW9CQTtJQUN0RSxNQUFNLEdBQUc2QixvQkFBb0IsR0FBRzNCLDBFQUEwQkE7SUFDMUQsTUFBTSxHQUFHNEIsc0JBQXNCLEdBQUczQiw0RUFBNEJBO0lBQzlELE1BQU0sR0FBRzRCLGtCQUFrQixHQUFHM0Isd0VBQXdCQTtJQUN0RCxNQUFNLEdBQUc0QixvQkFBb0IsR0FBRy9CLDBFQUEwQkE7SUFDMUQsTUFBTWdDLFFBQVFyRSwrREFBZUE7SUFDN0IsTUFBTSxDQUFDc0UsUUFBUUMsVUFBVSxHQUFHN0MsK0NBQVFBLENBQUMsS0FBSztJQUMxQyxNQUFNLENBQUM4QyxjQUFjQyxnQkFBZ0IsR0FBRzVDLDJEQUFlQSxDQUFDLGdCQUFnQjtJQUN4RSxNQUFNNkMsV0FBV2xELDhDQUFPQSxDQUFDLElBQU07UUFDN0IsT0FBT21ELGFBQWFDLE9BQU8sQ0FBQyxnQkFBZ0IzQyw0Q0FBT0E7SUFDckQsR0FBRyxFQUFFO0lBQ0wsTUFBTSxHQUFHNEMsbUJBQW1CLEdBQUdsQyxrRUFBa0JBO0lBQ2pELE1BQU0sQ0FBQ21DLHlCQUF5QkMsMkJBQTJCLEdBQUdyQywwRUFBMEJBO0lBQ3hGLE1BQU1zQyxXQUFXN0UsZ0VBQWVBO0lBQ2hDLE1BQU0sQ0FBQzhFLFdBQVdDLGFBQWEsR0FBR3hELCtDQUFRQSxDQUFDeUQsS0FBS0MsR0FBRztJQUNuRCxNQUFNQyxjQUFjNUQsNkNBQU1BLENBQUM7UUFBRTZELE9BQU87UUFBR0MsUUFBUTtJQUFFO0lBRWpELE1BQU1DLHlCQUF5QixDQUFDQyxRQUFrQjtRQUNoRCxJQUFJQSxTQUFTbEMsWUFBWW1DLE1BQU0sR0FBRyxHQUFHO1lBQ25DMUIscUJBQXFCVCxXQUFXLENBQUNrQyxNQUFNLENBQUN4QyxHQUFHO1FBQzdDLENBQUM7SUFDSDtJQUVBaEQsMkRBQVVBLENBQUNvQiw2Q0FBS0EsQ0FBQyxHQUFHLEdBQUdELEdBQUcsQ0FBQyxDQUFDdUUsSUFBTTtZQUFFLE9BQVksT0FBTkEsSUFBSTtZQUFLLElBQU1ILHVCQUF1Qkc7U0FBRztJQUNuRnBFLGdEQUFTQSxDQUFDLElBQU07UUFDZGtDLHFCQUFxQkM7SUFDdkIsR0FBRztRQUFDQTtLQUFZO0lBQ2hCOUIsdURBQVdBLENBQ1QsSUFBTTtRQUNKLElBQUksQ0FBQzhCLGFBQWE7UUFDbEIsSUFBSUgsWUFBWW1DLE1BQU0sR0FBRyxLQUFLLENBQUN2RSw0Q0FBSUEsQ0FBQ29DLGFBQWEsQ0FBQ00sSUFBTUEsRUFBRVosR0FBRyxLQUFLYyxvQkFBb0I7WUFDcEYsTUFBTTZCLHNCQUFzQmpCLGFBQWFDLE9BQU8sQ0FBQyxzQkFBa0MsT0FBWmxCO1lBQ3ZFLE1BQU1tQyxpQkFBaUIxRSw0Q0FBSUEsQ0FBQ29DLGFBQWEsQ0FBQ00sSUFBTUEsRUFBRVosR0FBRyxDQUFDNkMsUUFBUSxPQUFPRjtZQUNyRSxJQUFJQyxnQkFBZ0I7Z0JBQ2xCN0IscUJBQXFCNkIsZUFBZTVDLEdBQUc7WUFDekMsT0FBTztnQkFDTGUscUJBQXFCVCxXQUFXLENBQUMsRUFBRSxDQUFDTixHQUFHO1lBQ3pDLENBQUM7UUFDSCxDQUFDO1FBQ0QsSUFBSU0sWUFBWW1DLE1BQU0sS0FBSyxHQUFHO1lBQzVCMUIscUJBQXFCK0I7UUFDdkIsQ0FBQztJQUNILEdBQ0EsSUFDQTtRQUFDeEM7UUFBYVE7UUFBbUJMO0tBQVk7SUFFL0NuQyxnREFBU0EsQ0FBQyxJQUFNO1FBQ2QsSUFBSW1DLGVBQWVLLG1CQUFtQjtZQUNwQ1ksYUFBYXFCLE9BQU8sQ0FBQyxzQkFBa0MsT0FBWnRDLGNBQWVLLGtCQUFrQitCLFFBQVE7UUFDdEYsQ0FBQztJQUNILEdBQUc7UUFBQy9CO1FBQW1CTDtLQUFZO0lBQ25DNUIsb0RBQVFBLENBQUMsSUFBTTtRQUNiLG1CQUFtQjtRQUNuQix3QkFBd0I7UUFDeEIsc0JBQXNCO1FBQ3RCLGVBQWU7UUFDZixNQUFNO1FBQ04sRUFBRTtRQUNGLGtDQUFrQztRQUVsQyxJQUFJbUUsZUFBZXJCLE9BQU8sQ0FBQyxnQ0FBZ0M7WUFDekRxQixlQUFlQyxVQUFVLENBQUM7WUFDMUI3Rix1RUFBa0IsQ0FBQztnQkFDakIrRixPQUFPO2dCQUNQQyxTQUFTO2dCQUNUQyxRQUFRO2dCQUNSQyxpQkFBaUIsSUFBSTtnQkFDckJDLE9BQU87Z0JBQ1B6RCxvQkFBTSw4REFBQ3RDLHVFQUFxQkE7Ozs7O1lBQzlCO1FBQ0YsQ0FBQztJQUNIO0lBRUFtQix1REFBV0EsQ0FDVCxJQUFNO1FBQ0osSUFBSTRDLGlCQUFpQixLQUFLO1lBQ3hCdEQsa0RBQWNBLENBQUM7Z0JBQ2IsbUJBQW1CO2dCQUNuQixpQkFBaUI7Z0JBQ2pCdUYsT0FBTztZQUNUO1FBQ0YsT0FBTztZQUNMekYsbURBQWVBO1FBQ2pCLENBQUM7SUFDSCxHQUNBLEtBQ0E7UUFBQ3dEO0tBQWE7SUFFaEJqRCxnREFBU0EsQ0FBQyxJQUFNO1FBQ2QsTUFBTW1GLGFBQWFuRCxZQUFZcEMsSUFBSSxDQUFDLENBQUMwQyxJQUFNQSxFQUFFWixHQUFHLEtBQUtjO1FBQ3JELElBQUkyQyxZQUFZO1lBQ2RDLFNBQVNQLEtBQUssR0FBRyxHQUF1Qk0sT0FBcEJBLFdBQVdFLEtBQUssRUFBQyxLQUFvQixPQUFqQkYsV0FBVzFELEtBQUs7UUFDMUQsQ0FBQztJQUNILEdBQUc7UUFBQ2U7UUFBbUJSO0tBQVk7SUFDbkNyRCxpRUFBZ0JBLENBQUMsSUFBTTtRQUNyQixJQUFJcUQsWUFBWW1DLE1BQU0sS0FBSyxHQUFHO1FBQzlCLElBQUltQixPQUFPQyxJQUFJLENBQUNoQyx5QkFBeUJZLE1BQU0sR0FBRyxHQUFHO1FBRXJELE1BQU1xQixTQUE4QixDQUFDO1FBRXJDQyxRQUFRQyxHQUFHLENBQ1Q3RiwyQ0FBR0EsQ0FBQ21DLGFBQWEsT0FBT21ELGFBQWU7WUFDckMsTUFBTVEsV0FBa0IsTUFBT3RFLCtEQUFhLENBQUNDLDREQUFXQSxDQUFDNkQsV0FBV3pELEdBQUcsTUFBTyxFQUFFO1lBQ2hGLElBQUssSUFBSTBDLElBQUl1QixTQUFTeEIsTUFBTSxHQUFHLEdBQUdDLEtBQUssR0FBR0EsSUFBSztnQkFDN0MsSUFBSXVCLFFBQVEsQ0FBQ3ZCLEVBQUUsQ0FBQ3dCLE1BQU0sS0FBSyxRQUFRO29CQUNqQ0osTUFBTSxDQUFDTCxXQUFXekQsR0FBRyxDQUFDLEdBQUdpRSxRQUFRLENBQUN2QixFQUFFLENBQUN5QixPQUFPO29CQUM1QyxLQUFNO2dCQUNSLENBQUM7WUFDSDtRQUNGLElBQ0FDLElBQUksQ0FBQyxJQUFNO1lBQ1hOLE1BQU0sQ0FBQyxLQUFLLEdBQUc7WUFDZmhDLDJCQUEyQmdDO1FBQzdCO0lBQ0YsR0FBRztRQUFDeEQ7UUFBYXVCO0tBQXdCO0lBQ3pDbEQsdURBQVdBLENBQ1QsSUFBTTtRQUNKLElBQUlvRCxTQUFTTSxLQUFLLEdBQUcsR0FBRztZQUN0QixJQUFJRCxZQUFZaUMsT0FBTyxDQUFDaEMsS0FBSyxLQUFLLEdBQUc7Z0JBQ25DRCxZQUFZaUMsT0FBTyxHQUFHdEM7WUFDeEIsQ0FBQztZQUVELElBQ0VLLFlBQVlpQyxPQUFPLENBQUNoQyxLQUFLLEtBQUtOLFNBQVNNLEtBQUssSUFDNUNELFlBQVlpQyxPQUFPLENBQUMvQixNQUFNLEtBQUtQLFNBQVNPLE1BQU0sRUFDOUM7Z0JBQ0FGLFlBQVlpQyxPQUFPLEdBQUd0QztnQkFDdEJFLGFBQWFDLEtBQUtDLEdBQUc7WUFDdkIsQ0FBQztRQUNILENBQUM7SUFDSCxHQUNBLEtBQ0E7UUFBQ0osU0FBU00sS0FBSztRQUFFTixTQUFTTyxNQUFNO0tBQUM7SUFHbkMsTUFBTWdDLFlBQVl6RSxNQUFNMUIsR0FBRyxDQUFDLENBQUNvRyxxQkFDM0IsOERBQUMxSCwwREFBY0E7WUFFYjJILFdBQVduRSxRQUFRb0UsUUFBUTtZQUMzQkMsU0FBUyxJQUFNO2dCQUNiaEUsZUFBZTZELEtBQUt2RSxHQUFHO2dCQUN2QnNCLFVBQVUsS0FBSztZQUNqQjs7OEJBRUEsOERBQUMxRSxnREFBSUE7b0JBQ0gyRyxPQUFPOUMsZ0JBQWdCOEQsS0FBS3ZFLEdBQUcsR0FBRyxVQUFVLFFBQVE7b0JBQ3BEd0UsV0FBVzNHLGlEQUFVQSxDQUFDd0MsUUFBUXNFLGFBQWEsRUFBRTt3QkFDM0MsY0FBY2xFLGdCQUFnQjhELEtBQUt2RSxHQUFHO29CQUN4Qzs7c0NBRUEsOERBQUN1RSxLQUFLekUsSUFBSTs0QkFBQzhFLE1BQU07NEJBQVVKLFdBQVduRSxRQUFRd0UsWUFBWTs0QkFBRUMsUUFBUTs7Ozs7O3NDQUNwRSw4REFBQ0M7NEJBQUtQLFdBQVc7c0NBQWdCRCxLQUFLeEUsS0FBSzs7Ozs7Ozs7Ozs7O2dCQUU1Q3dFLEtBQUtuSCxhQUFhLGtCQUNqQiw4REFBQ2pCLGlEQUFLQTtvQkFBQ3lJLE1BQUs7b0JBQUtJLFNBQVE7b0JBQVNSLFdBQVduRSxRQUFRNEUsYUFBYTs4QkFDL0RWLEtBQUtuSCxhQUFhOzs7Ozs7O1dBbEJsQm1ILEtBQUt4RSxLQUFLOzs7OztJQXVCbkIsTUFBTW1GLGtCQUFrQjVFLFlBQVluQyxHQUFHLENBQUMsQ0FBQ3NGLFlBQTRCakI7c0JBQ25FLHFFQUFDMkM7WUFDQ1QsU0FBUyxJQUFNO2dCQUNiM0QscUJBQXFCMEMsV0FBV3pELEdBQUc7Z0JBQ25Dc0IsVUFBVSxLQUFLO1lBQ2pCO1lBRUFrRCxXQUFXM0csaURBQVVBLENBQUN3QyxRQUFRK0UsY0FBYyxFQUFFLFFBQVE7Z0JBQ3BELGNBQWMzQixXQUFXekQsR0FBRyxLQUFLYztnQkFDakMscURBQXFEO2dCQUNyRCxDQUFDVCxRQUFRZ0Ysc0JBQXNCLENBQUMsRUFBRTVCLFdBQVd6RCxHQUFHLEtBQUtjO2dCQUNyRCxVQUFVMkMsV0FBV3pELEdBQUcsS0FBS2M7WUFDL0I7c0JBRUEsNEVBQUNxRTtnQkFBSVgsV0FBVTs7a0NBQ2IsOERBQUNXO3dCQUFJWCxXQUFVOzswQ0FDYiw4REFBQ1c7Z0NBQUlYLFdBQVc7MENBQ2QsNEVBQUNPO29DQUFLTyxPQUFPO3dDQUFFQyxhQUFhekksbURBQUdBLENBQUM7d0NBQUkwSSxVQUFVO29DQUFPOzhDQUNuRCw0RUFBQ0w7d0NBQ0NYLFdBQVc7d0NBQ1hjLE9BQU87NENBQ0xHLFlBQVk7d0NBQ2Q7a0RBRUEsNEVBQUMzRyxtRUFBVUE7NENBQ1Q2RSxPQUFPRixXQUFXRSxLQUFLOzRDQUN2QitCLFdBQVdqQyxXQUFXekQsR0FBRyxLQUFLYyxvQkFBb0IsU0FBUyxJQUFJOzRDQUMvRDhELE1BQU07Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzswQ0FLZCw4REFBQ087Z0NBQUlYLFdBQVU7O2tEQUNiLDhEQUFDNUgsZ0RBQUlBO3dDQUNIMkcsT0FBT0UsV0FBV3pELEdBQUcsS0FBS2Msb0JBQW9CLFVBQVVnQyxTQUFTO3dDQUNqRTBCLFdBQVU7a0RBRVRmLFdBQVcxRCxLQUFLOzs7Ozs7b0NBRWxCLENBQUMsQ0FBQzBELFdBQVdrQyxXQUFXLGtCQUN2Qiw4REFBQy9JLGdEQUFJQTt3Q0FDSDJHLE9BQU9FLFdBQVd6RCxHQUFHLEtBQUtjLG9CQUFvQixVQUFVZ0MsU0FBUzt3Q0FDakUwQixXQUFVO3dDQUNWckIsT0FBT00sV0FBV2tDLFdBQVc7d0NBQzdCTCxPQUFPOzRDQUNMTSxZQUFZO3dDQUNkO2tEQUVDL0QsdUJBQXVCLENBQUM0QixXQUFXekQsR0FBRyxDQUFDLElBQ3RDeUQsV0FBV2tDLFdBQVcsSUFDdEJsQyxXQUFXMUQsS0FBSzs7Ozs7Ozs7Ozs7Ozs7Ozs7O2tDQWlCMUIsOERBQUNvRjt3QkFDQ1gsV0FBVzNHLGlEQUFVQSxDQUNuQix1SEFDQTs0QkFDRSw4QkFBOEIsQ0FBQzhDLENBQUFBLHdCQUFBQSx5QkFBQUEsS0FBQUEsSUFBQUEsWUFBYVYsaUJBQWlCO3dCQUMvRCxHQUNBSSxRQUFRd0YsV0FBVzs7NEJBR3BCLENBQUNuSCx5REFBUUEsa0JBQ1I7O2tEQUNFLDhEQUFDekMsc0RBQVVBO3dDQUNUK0ksU0FBUTt3Q0FDUnpCLE9BQU07d0NBQ05xQixNQUFLO3dDQUNMRixTQUFTLENBQUNvQixJQUFNOzRDQUNkQSxFQUFFQyxlQUFlOzRDQUNqQm5FLG1CQUFtQjZCLFdBQVd6RCxHQUFHO3dDQUNuQzt3Q0FDQW1ELE9BQU87a0RBRVAsNEVBQUM1RixvRUFBa0JBOzRDQUFDcUgsTUFBSzs7Ozs7Ozs7Ozs7a0RBRTNCLDhEQUFDdEksbURBQU9BO3dDQUFDMEosYUFBYTs7Ozs7Ozs7MENBRzFCLDhEQUFDYjtnQ0FBSVgsV0FBVzs7a0RBQ2QsOERBQUNXO3dDQUFJWCxXQUFXOzswREFDZCw4REFBQ3ZJLHNEQUFVQTtnREFDVCtJLFNBQVE7Z0RBQ1J6QixPQUFNO2dEQUNOcUIsTUFBSztnREFDTEYsU0FBUyxDQUFDb0IsSUFBTTtvREFDZEEsRUFBRUMsZUFBZTtvREFDakI3RSxrQkFBa0J1QyxXQUFXekQsR0FBRztnREFDbEM7MERBRUEsNEVBQUMxQyw2REFBV0E7b0RBQUNzSCxNQUFLOzs7Ozs7Ozs7OzswREFFcEIsOERBQUMzSSxzREFBVUE7Z0RBQ1QrSSxTQUFRO2dEQUNSekIsT0FBTTtnREFDTnFCLE1BQUs7Z0RBQ0xGLFNBQVMsQ0FBQ29CLElBQU07b0RBQ2RBLEVBQUVDLGVBQWU7b0RBQ2pCNUUsb0JBQW9Cc0MsV0FBV3pELEdBQUc7Z0RBQ3BDOzBEQUVBLDRFQUFDM0MsK0RBQWFBO29EQUFDdUgsTUFBSzs7Ozs7Ozs7Ozs7Ozs7Ozs7a0RBR3hCLDhEQUFDTzt3Q0FBSVgsV0FBVzs7MERBQ2QsOERBQUN2SSxzREFBVUE7Z0RBQ1QrSSxTQUFRO2dEQUNSekIsT0FBTTtnREFDTnFCLE1BQUs7Z0RBQ0xGLFNBQVMsQ0FBQ29CLElBQU07b0RBQ2RBLEVBQUVDLGVBQWU7b0RBQ2pCL0Usb0JBQW9CeUMsV0FBV3pELEdBQUc7Z0RBQ3BDOzBEQUVBLDRFQUFDdkMsMERBQVFBO29EQUFDbUgsTUFBSzs7Ozs7Ozs7Ozs7MERBRWpCLDhEQUFDM0ksc0RBQVVBO2dEQUNUK0ksU0FBUTtnREFDUnpCLE9BQU07Z0RBQ05xQixNQUFLO2dEQUNMRixTQUFTLENBQUNvQixJQUFNO29EQUNkQSxFQUFFQyxlQUFlO29EQUNqQjlFLHNCQUFzQndDLFdBQVd6RCxHQUFHO2dEQUN0QzswREFFQSw0RUFBQ3BDLDJEQUFTQTtvREFBQ2dILE1BQUs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1dBcklyQm5CLFdBQVd6RCxHQUFHOzs7Ozs7SUE4SXZCLE1BQU1pRyxzQ0FDSiw4REFBQ2Q7UUFBSVgsV0FBVzs7MEJBQ2QsOERBQUNqSSxpREFBS0E7Z0JBQUNpSSxXQUFXbkUsUUFBUTZGLGlCQUFpQjtnQkFBRUMsVUFBUzs7a0NBQ3BELDhEQUFDdkosZ0RBQUlBO3dCQUFDZ0ksTUFBSzt3QkFBS3dCLFFBQVE7d0JBQUs3QyxPQUFNO2tDQUNoQzVDLHdCQUFBQSx5QkFBQUEsS0FBQUEsSUFBQUEsWUFBYVQsZ0JBQWdCOzs7Ozs7b0JBRS9CUyxDQUFBQSx3QkFBQUEseUJBQUFBLEtBQUFBLElBQUFBLFlBQWFWLGlCQUFpQixtQkFDN0IsOERBQUNoRSxzREFBVUE7d0JBQUMrSSxTQUFRO3dCQUFVSixNQUFNO3dCQUFJRixTQUFTN0Q7a0NBQy9DLDRFQUFDbEQsMERBQVFBOzRCQUFDaUgsTUFBSzs0QkFBT0UsUUFBUTs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBSXBDLDhEQUFDSztnQkFBSVgsV0FBVzNHLGlEQUFVQSxDQUFDd0MsUUFBUUMsV0FBVyxFQUFFOzBCQUM3QzRFOzs7Ozs7WUFFRnZFLENBQUFBLHdCQUFBQSx5QkFBQUEsS0FBQUEsSUFBQUEsWUFBYVYsaUJBQWlCLG1CQUM3Qiw4REFBQ2tGO2dCQUFJWCxXQUFVOzBCQUNiLDRFQUFDbkksa0RBQU1BO29CQUNMZ0ssV0FBVyxJQUFJO29CQUNmckIsU0FBUTtvQkFDUkosTUFBSztvQkFDTDBCLHdCQUFVLDhEQUFDM0ksMERBQVFBO29CQUNuQitHLFNBQVM3RDs4QkFDVjs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFRVCxxQkFDRTs7MEJBQ0UsOERBQUMxRCxrRUFBYUE7Ozs7OzBCQUNkLDhEQUFDakIsb0RBQVFBO2dCQUVQcUssU0FBUztnQkFDVEMsSUFBSTtnQkFDSkMsSUFBSTtnQkFDSkMsc0JBQ0UsOERBQUNoSyxrREFBTUE7b0JBQ0xpSyxRQUFRLENBQUN0RjtvQkFDVGdCLE9BQU87d0JBQUV1RSxJQUFJO29CQUFJO29CQUNqQkMsR0FBRztvQkFDSHJDLFdBQVczRyxpREFBVUEsQ0FBQyxzQkFBc0J3QyxRQUFRcUcsTUFBTSxFQUFFLENBQUM7O3NDQUU3RCw4REFBQ2hLLDBEQUFjOzRCQUFDOEgsV0FBVzNHLGlEQUFVQSxDQUFDd0MsUUFBUTBHLE9BQU8sRUFBRTtzQ0FDckQsNEVBQUM1QjtnQ0FBSVgsV0FBV25FLFFBQVFpRSxTQUFTOzBDQUFHQTs7O3NDQUV0Qyw4REFBQzVILDBEQUFjOzRCQUNiOEgsV0FBVzNHLGlEQUFVQSxDQUFDd0MsUUFBUTBHLE9BQU8sRUFBRTs0QkFDdkNDLElBQUk7NEJBQ0pDLFdBQVd0SyxzREFBVUE7c0NBRXBCc0o7O3NDQUVILDhEQUFDdkosMERBQWM7NEJBQUM4SCxXQUFXM0csaURBQVVBLENBQUN3QyxRQUFRMEcsT0FBTyxFQUFFO3NDQUNyRCw0RUFBQzVCO2dDQUFJWCxXQUFXOzs7OztnQkF5Q3RCMEMsc0JBQ0UsOERBQUMxSyxrREFBTUE7b0JBQUM4RixRQUFRO3dCQUFFNkUsTUFBTTtvQkFBRztvQkFBR04sR0FBRTs4QkFDOUIsNEVBQUMxQjt3QkFBSUcsT0FBTzs0QkFBRThCLFNBQVM7NEJBQVFDLFlBQVk7NEJBQVUvRSxRQUFRO3dCQUFPOzswQ0FDbEUsOERBQUM3RixzREFBVUE7Z0NBQUM2SyxZQUFXO2dDQUFLQyxRQUFRO29DQUFFSCxTQUFTO2dDQUFPOzBDQUNwRCw0RUFBQ2hMLGtEQUFNQTtvQ0FDTGlGLFFBQVFBO29DQUNScUQsU0FBUyxJQUFNcEQsVUFBVSxDQUFDa0csSUFBTSxDQUFDQTtvQ0FDakM1QyxNQUFLO29DQUNMckIsT0FBT25DLE1BQU1xRyxNQUFNLENBQUNDLElBQUksQ0FBQyxFQUFFO29DQUMzQkMsSUFBRzs7OzBDQUdQLDhEQUFDeEM7Z0NBQUlYLFdBQVc7O2tEQUNkLDhEQUFDNUgsZ0RBQUlBO3dDQUNIMEksT0FBTzs0Q0FDTHNDLFlBQVk7NENBQ1poQyxZQUFZOzRDQUNaSixVQUFVOzRDQUNWakMsT0FBTzs0Q0FDUHNFLGVBQWU7d0NBQ2pCO2tEQUVDcEc7O2tEQUVILDhEQUFDMEQ7d0NBQUlYLFdBQVc7Ozs7Ozs7MEJBTXZCcEU7ZUE3Rkk0Qjs7Ozs7MEJBK0ZQLDhEQUFDOEY7Z0JBQU1DLElBQUc7Z0JBQXNCQyxNQUFLO2dCQUFPQyxRQUFPO2dCQUFtQnpELFdBQVc7Ozs7Ozs7O0FBR3ZGO0dBbGNNckU7O1FBQ2dCcEIsZ0ZBQVNBO1FBQ1BHLDBEQUFjQTtRQUNjTSwwREFBY0E7UUFDMUJaLHVEQUFlQTtRQUlqQ0ssa0VBQXNCQTtRQUNRRSxnRUFBb0JBO1FBQ3RDRSxzRUFBMEJBO1FBQ3hCQyx3RUFBNEJBO1FBQ2hDQyxvRUFBd0JBO1FBQ3RCSCxzRUFBMEJBO1FBQzVDckMsMkRBQWVBO1FBRVc2Qix1REFBZUE7UUFJeEJjLDhEQUFrQkE7UUFDYUQsc0VBQTBCQTtRQUN2RXZDLDREQUFlQTtRQVVoQ0YsdURBQVVBO1FBSVYyQixtREFBV0E7UUF3QlhFLGdEQUFRQTtRQXNCUkYsbURBQVdBO1FBcUJYMUIsNkRBQWdCQTtRQXFCaEIwQixtREFBV0E7OztLQTVIUHdCO0FBb2NOLCtEQUFlQSxVQUFVQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9jb21wb25lbnRzL2xheW91dHMvTWFpbkxheW91dC9NYWluTGF5b3V0LnRzeD9jNTYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQWN0aW9uSWNvbixcclxuICBBcHBTaGVsbCxcclxuICBCYWRnZSxcclxuICBCdXJnZXIsXHJcbiAgQnV0dG9uLFxyXG4gIENoZWNrYm94LFxyXG4gIERpdmlkZXIsXHJcbiAgR3JvdXAsXHJcbiAgSGVhZGVyLFxyXG4gIEtiZCxcclxuICBNZWRpYVF1ZXJ5LFxyXG4gIE1lbnUsXHJcbiAgTmF2YmFyLFxyXG4gIFNjcm9sbEFyZWEsXHJcbiAgVGV4dCxcclxuICBVbnN0eWxlZEJ1dHRvbixcclxuICByZW0sXHJcbiAgdXNlTWFudGluZVRoZW1lLFxyXG59IGZyb20gJ0BtYW50aW5lL2NvcmUnO1xyXG5pbXBvcnQgeyB1c2VIb3RrZXlzLCB1c2VTaGFsbG93RWZmZWN0LCB1c2VWaWV3cG9ydFNpemUgfSBmcm9tICdAbWFudGluZS9ob29rcyc7XHJcbmltcG9ydCB7IE5vdGlmaWNhdGlvbnMsIG5vdGlmaWNhdGlvbnMgfSBmcm9tICdAbWFudGluZS9ub3RpZmljYXRpb25zJztcclxuaW1wb3J0IHtcclxuICBJY29uQWxlcnRDaXJjbGUsXHJcbiAgSWNvbkFycm93RG93bixcclxuICBJY29uQXJyb3dVcCxcclxuICBJY29uQXJyb3dzTWF4aW1pemUsXHJcbiAgSWNvbkNpcmNsZUNoZWNrRmlsbGVkLFxyXG4gIEljb25EYXRhYmFzZUNvZyxcclxuICBJY29uRWRpdCxcclxuICBJY29uTWVzc2FnZSxcclxuICBJY29uUGx1cyxcclxuICBJY29uU2V0dGluZ3MsXHJcbiAgSWNvblRyYXNoLFxyXG59IGZyb20gJ0B0YWJsZXIvaWNvbnMtcmVhY3QnO1xyXG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcclxuaW1wb3J0IHsgZGlzYWJsZSBhcyBkaXNhYmxlRGFya01vZGUsIGVuYWJsZSBhcyBlbmFibGVEYXJrTW9kZSB9IGZyb20gJ2RhcmtyZWFkZXInO1xyXG5pbXBvcnQgeyBjbG9uZSwgZmluZCwgbWFwLCByYW5nZSB9IGZyb20gJ2xvZGFzaCc7XHJcbmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IGlzTW9iaWxlIH0gZnJvbSAncmVhY3QtZGV2aWNlLWRldGVjdCc7XHJcbmltcG9ydCB7IHVzZURlYm91bmNlLCB1c2VMb2NhbFN0b3JhZ2UsIHVzZU1vdW50IH0gZnJvbSAncmVhY3QtdXNlJztcclxuXHJcbmltcG9ydCBGdW5ueUVtb2ppIGZyb20gJ0AvY29tcG9uZW50cy9taXNjL0Z1bm55RW1vamknO1xyXG5pbXBvcnQgeyB1c2VTdHlsZXMgfSBmcm9tICdAL2NvbXBvbmVudHMvcGFnZXMvTWFpblBhZ2UvTWFpblBhZ2Uuc3R5bGUnO1xyXG5pbXBvcnQgeyBhcHBOYW1lIH0gZnJvbSAnQC9jb25maWcnO1xyXG5pbXBvcnQge1xyXG4gIHVzZUFkZENvbGxlY3Rpb25BY3Rpb24sXHJcbiAgdXNlQ29sbGVjdGlvbnMsXHJcbiAgdXNlQ3VycmVudENvbGxlY3Rpb24sXHJcbiAgdXNlQ3VycmVudENvbGxlY3Rpb25Eb3duSWQsXHJcbiAgdXNlQ3VycmVudENvbGxlY3Rpb25FZGl0SWQsXHJcbiAgdXNlQ3VycmVudENvbGxlY3Rpb25SZW1vdmVJZCxcclxuICB1c2VDdXJyZW50Q29sbGVjdGlvblVwSWQsXHJcbiAgdXNlQ3VycmVudFRvb2wsXHJcbiAgdXNlTGFzdE1lc3NhZ2VCeUNvbGxlY3Rpb24sXHJcbiAgdXNlU3ViQ29sbGVjdGlvbklkLFxyXG59IGZyb20gJ0Avc3RhdGVzL3N0YXRlcyc7XHJcbmltcG9ydCBzdG9yZSwgeyBtZXNzYWdlc0tleSB9IGZyb20gJ0AvdXRpbGl0eS9zdG9yZSc7XHJcbmltcG9ydCB7IGV4cG9ydExvY2FsU3RvcmFnZVRvSlNPTiwgaW1wb3J0TG9jYWxTdG9yYWdlRnJvbUZpbGUgfSBmcm9tICdAL3V0aWxpdHkvdXRpbGl0eSc7XHJcblxyXG5leHBvcnQgdHlwZSBDb2xsZWN0aW9uSXRlbSA9IHtcclxuICBlbW9qaTogc3RyaW5nO1xyXG4gIGxhYmVsOiBzdHJpbmc7XHJcbiAga2V5OiBhbnk7XHJcbiAgcGFyZW50OiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxufTtcclxuY29uc3QgbGlua3M6IEFycmF5PHtcclxuICBpY29uPzogYW55O1xyXG4gIGtleTogc3RyaW5nO1xyXG4gIGxhYmVsOiBzdHJpbmc7XHJcbiAgbm90aWZpY2F0aW9ucz86IHN0cmluZyB8IG51bWJlcjtcclxuICBjYW5BZGRDb2xsZWN0aW9uczogYm9vbGVhbjtcclxuICBjb2xsZWN0aW9uc0xhYmVsOiBzdHJpbmc7XHJcbn0+ID0gW1xyXG4gIHtcclxuICAgIGljb246IEljb25NZXNzYWdlLFxyXG4gICAgbGFiZWw6ICdBZ2VudHMnLFxyXG4gICAga2V5OiAnbnVsbGdwdCcsXHJcbiAgICBjYW5BZGRDb2xsZWN0aW9uczogdHJ1ZSxcclxuICAgIGNvbGxlY3Rpb25zTGFiZWw6ICdBZ2VudHMnLFxyXG4gIH0sXHJcbiAgLyoge1xyXG4gICAgaWNvbjogSWNvblNldHRpbmdzLFxyXG4gICAgbGFiZWw6ICdTZXR0aW5ncycsXHJcbiAgICBrZXk6ICdzZXR0aW5ncycsXHJcbiAgICBjYW5BZGRDb2xsZWN0aW9uczogZmFsc2UsXHJcbiAgICBjb2xsZWN0aW9uc0xhYmVsOiAnU2V0dGluZ3MnLFxyXG4gIH0sICovXHJcbl07XHJcblxyXG5leHBvcnQgdHlwZSBNYWluTGF5b3V0UHJvcHMgPSB7XHJcbiAgY2hpbGRyZW46IGFueTtcclxufTtcclxuXHJcbmNvbnN0IE1haW5MYXlvdXQgPSAoeyBjaGlsZHJlbiB9OiBNYWluTGF5b3V0UHJvcHMpID0+IHtcclxuICBjb25zdCB7IGNsYXNzZXMgfSA9IHVzZVN0eWxlcygpO1xyXG4gIGNvbnN0IFtjb2xsZWN0aW9uc10gPSB1c2VDb2xsZWN0aW9ucygpO1xyXG4gIGNvbnN0IFtnbG9iYWxDdXJyZW50VG9vbCwgc2V0R2xvYmFsQ3VycmVudFRvb2xdID0gdXNlQ3VycmVudFRvb2woKTtcclxuICBjb25zdCBbY3VycmVudFRvb2wsIHNldEN1cnJlbnRUb29sXSA9IHVzZUxvY2FsU3RvcmFnZSgnOmN1cnJlbnRUb29sJywgZ2xvYmFsQ3VycmVudFRvb2wpO1xyXG4gIGNvbnN0IGN1cnJlbnRMaW5rID0gdXNlTWVtbygoKSA9PiB7XHJcbiAgICByZXR1cm4gbGlua3MuZmluZCgodikgPT4gdi5rZXkgPT09IGN1cnJlbnRUb29sKTtcclxuICB9LCBbY3VycmVudFRvb2xdKTtcclxuICBjb25zdCBbYWRkQWN0aW9uXSA9IHVzZUFkZENvbGxlY3Rpb25BY3Rpb24oKTtcclxuICBjb25zdCBbY3VycmVudENvbGxlY3Rpb24sIHNldEN1cnJlbnRDb2xsZWN0aW9uXSA9IHVzZUN1cnJlbnRDb2xsZWN0aW9uKCk7XHJcbiAgY29uc3QgWywgc2V0Q29sbGVjdGlvbkVkaXRJZF0gPSB1c2VDdXJyZW50Q29sbGVjdGlvbkVkaXRJZCgpO1xyXG4gIGNvbnN0IFssIHNldENvbGxlY3Rpb25SZW1vdmVJZF0gPSB1c2VDdXJyZW50Q29sbGVjdGlvblJlbW92ZUlkKCk7XHJcbiAgY29uc3QgWywgc2V0Q29sbGVjdGlvblVwSWRdID0gdXNlQ3VycmVudENvbGxlY3Rpb25VcElkKCk7XHJcbiAgY29uc3QgWywgc2V0Q29sbGVjdGlvbkRvd25JZF0gPSB1c2VDdXJyZW50Q29sbGVjdGlvbkRvd25JZCgpO1xyXG4gIGNvbnN0IHRoZW1lID0gdXNlTWFudGluZVRoZW1lKCk7XHJcbiAgY29uc3QgW29wZW5lZCwgc2V0T3BlbmVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbaGlnaENvbnRyYXN0LCBzZXRIaWdoQ29udHJhc3RdID0gdXNlTG9jYWxTdG9yYWdlKCdoaWdoQ29udHJhc3QnLCAnMCcpO1xyXG4gIGNvbnN0IGxvZ29UZXh0ID0gdXNlTWVtbygoKSA9PiB7XHJcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJzpsb2dvVGV4dCcpIHx8IGFwcE5hbWU7XHJcbiAgfSwgW10pO1xyXG4gIGNvbnN0IFssIHNldFN1YkNvbGxlY3Rpb25JZF0gPSB1c2VTdWJDb2xsZWN0aW9uSWQoKTtcclxuICBjb25zdCBbbGFzdE1lc3NhZ2VCeUNvbGxlY3Rpb24sIHNldExhc3RNZXNzYWdlQnlDb2xsZWN0aW9uXSA9IHVzZUxhc3RNZXNzYWdlQnlDb2xsZWN0aW9uKCk7XHJcbiAgY29uc3Qgdmlld3BvcnQgPSB1c2VWaWV3cG9ydFNpemUoKTtcclxuICBjb25zdCBbcmVuZGVyS2V5LCBzZXRSZW5kZXJLZXldID0gdXNlU3RhdGUoRGF0ZS5ub3coKSk7XHJcbiAgY29uc3Qgdmlld3BvcnRSZWYgPSB1c2VSZWYoeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0pO1xyXG5cclxuICBjb25zdCBob3RrZXlTd2l0Y2hDb2xsZWN0aW9uID0gKGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgIGlmIChpbmRleCA8PSBjb2xsZWN0aW9ucy5sZW5ndGggLSAxKSB7XHJcbiAgICAgIHNldEN1cnJlbnRDb2xsZWN0aW9uKGNvbGxlY3Rpb25zW2luZGV4XS5rZXkpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHVzZUhvdGtleXMocmFuZ2UoMCwgOSkubWFwKChpKSA9PiBbYG1vZCske2kgKyAxfWAsICgpID0+IGhvdGtleVN3aXRjaENvbGxlY3Rpb24oaSldKSBhcyBhbnkpO1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBzZXRHbG9iYWxDdXJyZW50VG9vbChjdXJyZW50VG9vbCk7XHJcbiAgfSwgW2N1cnJlbnRUb29sXSk7XHJcbiAgdXNlRGVib3VuY2UoXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGlmICghY3VycmVudFRvb2wpIHJldHVybjtcclxuICAgICAgaWYgKGNvbGxlY3Rpb25zLmxlbmd0aCA+IDAgJiYgIWZpbmQoY29sbGVjdGlvbnMsICh2KSA9PiB2LmtleSA9PT0gY3VycmVudENvbGxlY3Rpb24pKSB7XHJcbiAgICAgICAgY29uc3QgZGJDdXJyZW50Q29sbGVjdGlvbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGA6Y3VycmVudENvbGxlY3Rpb246JHtjdXJyZW50VG9vbH1gKTtcclxuICAgICAgICBjb25zdCB0ZW1wQ29sbGVjdGlvbiA9IGZpbmQoY29sbGVjdGlvbnMsICh2KSA9PiB2LmtleS50b1N0cmluZygpID09PSBkYkN1cnJlbnRDb2xsZWN0aW9uKTtcclxuICAgICAgICBpZiAodGVtcENvbGxlY3Rpb24pIHtcclxuICAgICAgICAgIHNldEN1cnJlbnRDb2xsZWN0aW9uKHRlbXBDb2xsZWN0aW9uLmtleSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNldEN1cnJlbnRDb2xsZWN0aW9uKGNvbGxlY3Rpb25zWzBdLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChjb2xsZWN0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBzZXRDdXJyZW50Q29sbGVjdGlvbih1bmRlZmluZWQpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgNDIsXHJcbiAgICBbY29sbGVjdGlvbnMsIGN1cnJlbnRDb2xsZWN0aW9uLCBjdXJyZW50VG9vbF0sXHJcbiAgKTtcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKGN1cnJlbnRUb29sICYmIGN1cnJlbnRDb2xsZWN0aW9uKSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGA6Y3VycmVudENvbGxlY3Rpb246JHtjdXJyZW50VG9vbH1gLCBjdXJyZW50Q29sbGVjdGlvbi50b1N0cmluZygpKTtcclxuICAgIH1cclxuICB9LCBbY3VycmVudENvbGxlY3Rpb24sIGN1cnJlbnRUb29sXSk7XHJcbiAgdXNlTW91bnQoKCkgPT4ge1xyXG4gICAgLy8gZW5hYmxlRGFya01vZGUoe1xyXG4gICAgLy8gICAvLyBicmlnaHRuZXNzOiAxMDAsXHJcbiAgICAvLyAgIC8vIGNvbnRyYXN0OiAxMDAsXHJcbiAgICAvLyAgIHNlcGlhOiAxMCxcclxuICAgIC8vIH0pO1xyXG4gICAgLy9cclxuICAgIC8vIGNvbGxlY3RDU1MoKS50aGVuKGNvbnNvbGUubG9nKTtcclxuXHJcbiAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnOmltcG9ydExvY2FsU3RvcmFnZUZyb21GaWxlJykpIHtcclxuICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgnOmltcG9ydExvY2FsU3RvcmFnZUZyb21GaWxlJyk7XHJcbiAgICAgIG5vdGlmaWNhdGlvbnMuc2hvdyh7XHJcbiAgICAgICAgdGl0bGU6ICdTdWNjZXNzJyxcclxuICAgICAgICBtZXNzYWdlOiAnRGF0YSBpbXBvcnQgc3VjY2Vzc2Z1bC4nLFxyXG4gICAgICAgIHJhZGl1czogJ2xnJyxcclxuICAgICAgICB3aXRoQ2xvc2VCdXR0b246IHRydWUsXHJcbiAgICAgICAgY29sb3I6ICdncmVlbicsXHJcbiAgICAgICAgaWNvbjogPEljb25DaXJjbGVDaGVja0ZpbGxlZCAvPixcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHVzZURlYm91bmNlKFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBpZiAoaGlnaENvbnRyYXN0ID09PSAnMScpIHtcclxuICAgICAgICBlbmFibGVEYXJrTW9kZSh7XHJcbiAgICAgICAgICAvLyBicmlnaHRuZXNzOiAxMDAsXHJcbiAgICAgICAgICAvLyBjb250cmFzdDogMTAwLFxyXG4gICAgICAgICAgc2VwaWE6IDEwLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRpc2FibGVEYXJrTW9kZSgpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgNTAwLFxyXG4gICAgW2hpZ2hDb250cmFzdF0sXHJcbiAgKTtcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgY29uc3QgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb25zLmZpbmQoKHYpID0+IHYua2V5ID09PSBjdXJyZW50Q29sbGVjdGlvbik7XHJcbiAgICBpZiAoY29sbGVjdGlvbikge1xyXG4gICAgICBkb2N1bWVudC50aXRsZSA9IGAke2NvbGxlY3Rpb24uZW1vaml9ICR7Y29sbGVjdGlvbi5sYWJlbH1gO1xyXG4gICAgfVxyXG4gIH0sIFtjdXJyZW50Q29sbGVjdGlvbiwgY29sbGVjdGlvbnNdKTtcclxuICB1c2VTaGFsbG93RWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChjb2xsZWN0aW9ucy5sZW5ndGggPT09IDApIHJldHVybjtcclxuICAgIGlmIChPYmplY3Qua2V5cyhsYXN0TWVzc2FnZUJ5Q29sbGVjdGlvbikubGVuZ3RoID4gMCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdDogUmVjb3JkPGFueSwgc3RyaW5nPiA9IHt9O1xyXG5cclxuICAgIFByb21pc2UuYWxsKFxyXG4gICAgICBtYXAoY29sbGVjdGlvbnMsIGFzeW5jIChjb2xsZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZXM6IGFueVtdID0gKGF3YWl0IHN0b3JlLmdldEl0ZW0obWVzc2FnZXNLZXkoY29sbGVjdGlvbi5rZXkpKSkgfHwgW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IG1lc3NhZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICBpZiAobWVzc2FnZXNbaV0uc291cmNlID09PSAndXNlcicpIHtcclxuICAgICAgICAgICAgcmVzdWx0W2NvbGxlY3Rpb24ua2V5XSA9IG1lc3NhZ2VzW2ldLmNvbnRlbnQ7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSksXHJcbiAgICApLnRoZW4oKCkgPT4ge1xyXG4gICAgICByZXN1bHRbJ29rJ10gPSAnT0snO1xyXG4gICAgICBzZXRMYXN0TWVzc2FnZUJ5Q29sbGVjdGlvbihyZXN1bHQpO1xyXG4gICAgfSk7XHJcbiAgfSwgW2NvbGxlY3Rpb25zLCBsYXN0TWVzc2FnZUJ5Q29sbGVjdGlvbl0pO1xyXG4gIHVzZURlYm91bmNlKFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBpZiAodmlld3BvcnQud2lkdGggPiAwKSB7XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0UmVmLmN1cnJlbnQud2lkdGggPT09IDApIHtcclxuICAgICAgICAgIHZpZXdwb3J0UmVmLmN1cnJlbnQgPSB2aWV3cG9ydDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIHZpZXdwb3J0UmVmLmN1cnJlbnQud2lkdGggIT09IHZpZXdwb3J0LndpZHRoIHx8XHJcbiAgICAgICAgICB2aWV3cG9ydFJlZi5jdXJyZW50LmhlaWdodCAhPT0gdmlld3BvcnQuaGVpZ2h0XHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICB2aWV3cG9ydFJlZi5jdXJyZW50ID0gdmlld3BvcnQ7XHJcbiAgICAgICAgICBzZXRSZW5kZXJLZXkoRGF0ZS5ub3coKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgNTAwLFxyXG4gICAgW3ZpZXdwb3J0LndpZHRoLCB2aWV3cG9ydC5oZWlnaHRdLFxyXG4gICk7XHJcblxyXG4gIGNvbnN0IG1haW5MaW5rcyA9IGxpbmtzLm1hcCgobGluaykgPT4gKFxyXG4gICAgPFVuc3R5bGVkQnV0dG9uXHJcbiAgICAgIGtleT17bGluay5sYWJlbH1cclxuICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLm1haW5MaW5rfVxyXG4gICAgICBvbkNsaWNrPXsoKSA9PiB7XHJcbiAgICAgICAgc2V0Q3VycmVudFRvb2wobGluay5rZXkpO1xyXG4gICAgICAgIHNldE9wZW5lZChmYWxzZSk7XHJcbiAgICAgIH19XHJcbiAgICA+XHJcbiAgICAgIDxUZXh0XHJcbiAgICAgICAgY29sb3I9e2N1cnJlbnRUb29sID09PSBsaW5rLmtleSA/ICd3aGl0ZScgOiAnZGltbWVkJ31cclxuICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoY2xhc3Nlcy5tYWluTGlua0lubmVyLCB7XHJcbiAgICAgICAgICAnb3BhY2l0eS04MCc6IGN1cnJlbnRUb29sICE9PSBsaW5rLmtleSxcclxuICAgICAgICB9KX1cclxuICAgICAgPlxyXG4gICAgICAgIDxsaW5rLmljb24gc2l6ZT17JzEuM3JlbSd9IGNsYXNzTmFtZT17Y2xhc3Nlcy5tYWluTGlua0ljb259IHN0cm9rZT17MS41fSAvPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT17J2ZvbnQtbm9ybWFsJ30+e2xpbmsubGFiZWx9PC9zcGFuPlxyXG4gICAgICA8L1RleHQ+XHJcbiAgICAgIHtsaW5rLm5vdGlmaWNhdGlvbnMgJiYgKFxyXG4gICAgICAgIDxCYWRnZSBzaXplPVwic21cIiB2YXJpYW50PVwiZmlsbGVkXCIgY2xhc3NOYW1lPXtjbGFzc2VzLm1haW5MaW5rQmFkZ2V9PlxyXG4gICAgICAgICAge2xpbmsubm90aWZpY2F0aW9uc31cclxuICAgICAgICA8L0JhZGdlPlxyXG4gICAgICApfVxyXG4gICAgPC9VbnN0eWxlZEJ1dHRvbj5cclxuICApKTtcclxuICBjb25zdCBjb2xsZWN0aW9uTGlua3MgPSBjb2xsZWN0aW9ucy5tYXAoKGNvbGxlY3Rpb246IENvbGxlY3Rpb25JdGVtLCBpbmRleCkgPT4gKFxyXG4gICAgPGRpdlxyXG4gICAgICBvbkNsaWNrPXsoKSA9PiB7XHJcbiAgICAgICAgc2V0Q3VycmVudENvbGxlY3Rpb24oY29sbGVjdGlvbi5rZXkpO1xyXG4gICAgICAgIHNldE9wZW5lZChmYWxzZSk7XHJcbiAgICAgIH19XHJcbiAgICAgIGtleT17Y29sbGVjdGlvbi5rZXl9XHJcbiAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhjbGFzc2VzLmNvbGxlY3Rpb25MaW5rLCAncHItMicsIHtcclxuICAgICAgICAnb3BhY2l0eS04MCc6IGNvbGxlY3Rpb24ua2V5ICE9PSBjdXJyZW50Q29sbGVjdGlvbixcclxuICAgICAgICAvLyAnZm9udC1ib2xkJzogY29sbGVjdGlvbi5rZXkgPT09IGN1cnJlbnRDb2xsZWN0aW9uLFxyXG4gICAgICAgIFtjbGFzc2VzLnNlbGVjdGVkQ29sbGVjdGlvbkxpbmtdOiBjb2xsZWN0aW9uLmtleSA9PT0gY3VycmVudENvbGxlY3Rpb24sXHJcbiAgICAgICAgJ3NoYWRvdyc6IGNvbGxlY3Rpb24ua2V5ID09PSBjdXJyZW50Q29sbGVjdGlvbixcclxuICAgICAgfSl9XHJcbiAgICA+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LXJvdyBnYXAtMyBpdGVtcy1jZW50ZXIgcmVsYXRpdmUgZmxleC1ncm93XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LWdyb3cgZmxleCBnYXAtMSBpdGVtcy1jZW50ZXIgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXsndy1bNDBweF0ganVzdGlmeS1jZW50ZXIgZmxleCBpdGVtcy1jZW50ZXIgcmVsYXRpdmUgei0xMCd9PlxyXG4gICAgICAgICAgICA8c3BhbiBzdHlsZT17eyBtYXJnaW5SaWdodDogcmVtKDgpLCBmb250U2l6ZTogJzFyZW0nIH19PlxyXG4gICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17J3JvdW5kZWQtZnVsbCB3LVszMnB4XSBoLVszMnB4XSBwLTEgb3ZlcmZsb3ctaGlkZGVuJ31cclxuICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICcjMzMzMzMzJyxcclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPEZ1bm55RW1vamlcclxuICAgICAgICAgICAgICAgICAgZW1vamk9e2NvbGxlY3Rpb24uZW1vaml9XHJcbiAgICAgICAgICAgICAgICAgIGVtb2ppVHlwZT17Y29sbGVjdGlvbi5rZXkgPT09IGN1cnJlbnRDb2xsZWN0aW9uID8gJ2FuaW0nIDogJzNkJ31cclxuICAgICAgICAgICAgICAgICAgc2l6ZT17JzEwMCUnfVxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgaXRlbXMtc3RhcnQganVzdGlmeS1jZW50ZXIgaC1bNTBweF0gcGItMVwiPlxyXG4gICAgICAgICAgICA8VGV4dFxyXG4gICAgICAgICAgICAgIGNvbG9yPXtjb2xsZWN0aW9uLmtleSA9PT0gY3VycmVudENvbGxlY3Rpb24gPyAnd2hpdGUnIDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndoaXRlc3BhY2Utbm93cmFwXCJcclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgIHtjb2xsZWN0aW9uLmxhYmVsfVxyXG4gICAgICAgICAgICA8L1RleHQ+XHJcbiAgICAgICAgICAgIHshIWNvbGxlY3Rpb24uZGVzY3JpcHRpb24gJiYgKFxyXG4gICAgICAgICAgICAgIDxUZXh0XHJcbiAgICAgICAgICAgICAgICBjb2xvcj17Y29sbGVjdGlvbi5rZXkgPT09IGN1cnJlbnRDb2xsZWN0aW9uID8gJ3doaXRlJyA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvbnQtbm9ybWFsIHRleHQteHMgdGV4dC1sZWZ0IGxpbmUtY2xhbXAtMSBtYXgtdy1mdWxsXCJcclxuICAgICAgICAgICAgICAgIHRpdGxlPXtjb2xsZWN0aW9uLmRlc2NyaXB0aW9ufVxyXG4gICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogJzIwcHgnLFxyXG4gICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICB7bGFzdE1lc3NhZ2VCeUNvbGxlY3Rpb25bY29sbGVjdGlvbi5rZXldIHx8XHJcbiAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uZGVzY3JpcHRpb24gfHxcclxuICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5sYWJlbH1cclxuICAgICAgICAgICAgICA8L1RleHQ+XHJcbiAgICAgICAgICAgICl9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIHsvKntpbmRleCA8IDkgJiYgKCovfVxyXG4gICAgICAgICAgey8qICA8ZGl2Ki99XHJcbiAgICAgICAgICB7LyogICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKCdmbGV4LWdyb3cgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1lbmQnLCB7fSl9Ki99XHJcbiAgICAgICAgICB7LyogICAgc3R5bGU9e3sqL31cclxuICAgICAgICAgIHsvKiAgICAgIG1hcmdpblRvcDogLTYsKi99XHJcbiAgICAgICAgICB7LyogICAgfX0qL31cclxuICAgICAgICAgIHsvKiAgPiovfVxyXG4gICAgICAgICAgey8qICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrIHdoaXRlc3BhY2Utbm93cmFwIG1sLTIgb3BhY2l0eS01MFwiPiovfVxyXG4gICAgICAgICAgey8qICAgICAgPEtiZCBzaXplPVwieHNcIj7ijJgre2luZGV4ICsgMX08L0tiZD4qL31cclxuICAgICAgICAgIHsvKiAgICA8L2Rpdj4qL31cclxuICAgICAgICAgIHsvKiAgPC9kaXY+Ki99XHJcbiAgICAgICAgICB7LyopfSovfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXZcclxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhcclxuICAgICAgICAgICAgJ2Fic29sdXRlIHJpZ2h0LVstNXB4XSBmbGV4IGZsZXgtcm93IGdhcC0xIGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBjb2xsZWN0aW9uLWFjdGlvbiBweC0yIHB5LTEgcm91bmRlZCBzaGFkb3cteGwnLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgJ2NvbGxlY3Rpb24tYWN0aW9uLWRpc2FibGVkJzogIWN1cnJlbnRMaW5rPy5jYW5BZGRDb2xsZWN0aW9ucyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2xhc3Nlcy5saXN0QWN0aW9ucyxcclxuICAgICAgICAgICl9XHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgeyFpc01vYmlsZSAmJiAoXHJcbiAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgPEFjdGlvbkljb25cclxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcclxuICAgICAgICAgICAgICAgIGNvbG9yPVwiYmx1ZVwiXHJcbiAgICAgICAgICAgICAgICBzaXplPVwibWRcIlxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgc2V0U3ViQ29sbGVjdGlvbklkKGNvbGxlY3Rpb24ua2V5KTtcclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICB0aXRsZT17J09wZW4gaW4gYSBkaWFsb2cnfVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxJY29uQXJyb3dzTWF4aW1pemUgc2l6ZT1cIjJyZW1cIiAvPlxyXG4gICAgICAgICAgICAgIDwvQWN0aW9uSWNvbj5cclxuICAgICAgICAgICAgICA8RGl2aWRlciBvcmllbnRhdGlvbj17J3ZlcnRpY2FsJ30gLz5cclxuICAgICAgICAgICAgPC8+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9eydmbGV4IGZsZXgtY29sIGdhcC0xJ30+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXsnZmxleCBmbGV4LXJvdyBnYXAtMSd9PlxyXG4gICAgICAgICAgICAgIDxBY3Rpb25JY29uXHJcbiAgICAgICAgICAgICAgICB2YXJpYW50PVwiZGVmYXVsdFwiXHJcbiAgICAgICAgICAgICAgICBjb2xvcj1cImJsdWVcIlxyXG4gICAgICAgICAgICAgICAgc2l6ZT1cInhzXCJcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgIHNldENvbGxlY3Rpb25VcElkKGNvbGxlY3Rpb24ua2V5KTtcclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPEljb25BcnJvd1VwIHNpemU9XCIxcmVtXCIgLz5cclxuICAgICAgICAgICAgICA8L0FjdGlvbkljb24+XHJcbiAgICAgICAgICAgICAgPEFjdGlvbkljb25cclxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJkZWZhdWx0XCJcclxuICAgICAgICAgICAgICAgIGNvbG9yPVwiYmx1ZVwiXHJcbiAgICAgICAgICAgICAgICBzaXplPVwieHNcIlxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgc2V0Q29sbGVjdGlvbkRvd25JZChjb2xsZWN0aW9uLmtleSk7XHJcbiAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxJY29uQXJyb3dEb3duIHNpemU9XCIxcmVtXCIgLz5cclxuICAgICAgICAgICAgICA8L0FjdGlvbkljb24+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17J2ZsZXggZmxleC1yb3cgZ2FwLTEnfT5cclxuICAgICAgICAgICAgICA8QWN0aW9uSWNvblxyXG4gICAgICAgICAgICAgICAgdmFyaWFudD1cImRlZmF1bHRcIlxyXG4gICAgICAgICAgICAgICAgY29sb3I9XCJibHVlXCJcclxuICAgICAgICAgICAgICAgIHNpemU9XCJ4c1wiXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICBzZXRDb2xsZWN0aW9uRWRpdElkKGNvbGxlY3Rpb24ua2V5KTtcclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPEljb25FZGl0IHNpemU9XCIxcmVtXCIgLz5cclxuICAgICAgICAgICAgICA8L0FjdGlvbkljb24+XHJcbiAgICAgICAgICAgICAgPEFjdGlvbkljb25cclxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcclxuICAgICAgICAgICAgICAgIGNvbG9yPVwicmVkXCJcclxuICAgICAgICAgICAgICAgIHNpemU9XCJ4c1wiXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICBzZXRDb2xsZWN0aW9uUmVtb3ZlSWQoY29sbGVjdGlvbi5rZXkpO1xyXG4gICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8SWNvblRyYXNoIHNpemU9XCIxcmVtXCIgLz5cclxuICAgICAgICAgICAgICA8L0FjdGlvbkljb24+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgKSk7XHJcblxyXG4gIGNvbnN0IHJlbmRlcmVkU2Nyb2xsQ29udGVudCA9IChcclxuICAgIDxkaXYgY2xhc3NOYW1lPXsncGItNSB3LWZ1bGwnfT5cclxuICAgICAgPEdyb3VwIGNsYXNzTmFtZT17Y2xhc3Nlcy5jb2xsZWN0aW9uc0hlYWRlcn0gcG9zaXRpb249XCJhcGFydFwiPlxyXG4gICAgICAgIDxUZXh0IHNpemU9XCJ4c1wiIHdlaWdodD17NTAwfSBjb2xvcj1cImRpbW1lZFwiPlxyXG4gICAgICAgICAge2N1cnJlbnRMaW5rPy5jb2xsZWN0aW9uc0xhYmVsfVxyXG4gICAgICAgIDwvVGV4dD5cclxuICAgICAgICB7Y3VycmVudExpbms/LmNhbkFkZENvbGxlY3Rpb25zICYmIChcclxuICAgICAgICAgIDxBY3Rpb25JY29uIHZhcmlhbnQ9XCJkZWZhdWx0XCIgc2l6ZT17MTh9IG9uQ2xpY2s9e2FkZEFjdGlvbn0+XHJcbiAgICAgICAgICAgIDxJY29uUGx1cyBzaXplPVwiMXJlbVwiIHN0cm9rZT17MS41fSAvPlxyXG4gICAgICAgICAgPC9BY3Rpb25JY29uPlxyXG4gICAgICAgICl9XHJcbiAgICAgIDwvR3JvdXA+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc05hbWVzKGNsYXNzZXMuY29sbGVjdGlvbnMsICdmbGV4IGZsZXgtY29sIGdhcC0wLjUgbXQtMycpfT5cclxuICAgICAgICB7Y29sbGVjdGlvbkxpbmtzfVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAge2N1cnJlbnRMaW5rPy5jYW5BZGRDb2xsZWN0aW9ucyAmJiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJweC00XCI+XHJcbiAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgIGZ1bGxXaWR0aD17dHJ1ZX1cclxuICAgICAgICAgICAgdmFyaWFudD1cImRlZmF1bHRcIlxyXG4gICAgICAgICAgICBzaXplPVwieHNcIlxyXG4gICAgICAgICAgICBsZWZ0SWNvbj17PEljb25QbHVzIC8+fVxyXG4gICAgICAgICAgICBvbkNsaWNrPXthZGRBY3Rpb259XHJcbiAgICAgICAgICA+XHJcbiAgICAgICAgICAgIE5ldyBhZ2VudFxyXG4gICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPD5cclxuICAgICAgPE5vdGlmaWNhdGlvbnMgLz5cclxuICAgICAgPEFwcFNoZWxsXHJcbiAgICAgICAga2V5PXtyZW5kZXJLZXl9XHJcbiAgICAgICAgcGFkZGluZz17MH1cclxuICAgICAgICBwbD17MTJ9XHJcbiAgICAgICAgcHI9ezEyfVxyXG4gICAgICAgIG5hdmJhcj17XHJcbiAgICAgICAgICA8TmF2YmFyXHJcbiAgICAgICAgICAgIGhpZGRlbj17IW9wZW5lZH1cclxuICAgICAgICAgICAgd2lkdGg9e3sgc206IDMwMCB9fVxyXG4gICAgICAgICAgICBwPXsnMCd9XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcygnZmxleCBmbGV4LWNvbCB6LTUwJywgY2xhc3Nlcy5uYXZiYXIsIHt9KX1cclxuICAgICAgICAgID5cclxuICAgICAgICAgICAgPE5hdmJhci5TZWN0aW9uIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhjbGFzc2VzLnNlY3Rpb24sICdwdC01Jyl9PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLm1haW5MaW5rc30+e21haW5MaW5rc308L2Rpdj5cclxuICAgICAgICAgICAgPC9OYXZiYXIuU2VjdGlvbj5cclxuICAgICAgICAgICAgPE5hdmJhci5TZWN0aW9uXHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKGNsYXNzZXMuc2VjdGlvbiwgJ3ctZnVsbCcpfVxyXG4gICAgICAgICAgICAgIGdyb3dcclxuICAgICAgICAgICAgICBjb21wb25lbnQ9e1Njcm9sbEFyZWF9XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICB7cmVuZGVyZWRTY3JvbGxDb250ZW50fVxyXG4gICAgICAgICAgICA8L05hdmJhci5TZWN0aW9uPlxyXG4gICAgICAgICAgICA8TmF2YmFyLlNlY3Rpb24gY2xhc3NOYW1lPXtjbGFzc05hbWVzKGNsYXNzZXMuc2VjdGlvbiwgJ3B4LTUnKX0+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9eydmbGV4IGl0ZW1zLWNlbnRlcid9PlxyXG4gICAgICAgICAgICAgICAgey8qIDxkaXYgY2xhc3NOYW1lPXsnZmxleC1ncm93J30+XHJcbiAgICAgICAgICAgICAgICAgIDxNZW51IHNoYWRvdz1cIm1kXCIgd2lkdGg9eycxMDAlJ30+XHJcbiAgICAgICAgICAgICAgICAgICAgPE1lbnUuVGFyZ2V0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBzaXplPXsneHMnfSB2YXJpYW50PXsnZGVmYXVsdCd9IGxlZnRJY29uPXs8SWNvbkRhdGFiYXNlQ29nIC8+fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgQmFja3VwXHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8L01lbnUuVGFyZ2V0PlxyXG4gICAgICAgICAgICAgICAgICAgIDxNZW51LkRyb3Bkb3duPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPFRleHQgc2l6ZT17J3hzJ30gY29sb3I9eyd5ZWxsb3cnfSBjbGFzc05hbWU9eydwLTInfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPEljb25BbGVydENpcmNsZSBzaXplPXsnMXJlbSd9IGNsYXNzTmFtZT17J21yLTInfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBBZnRlciBpbXBvcnRpbmcgbmV3IGRhdGEsIGFsbCBleGlzdGluZyBkYXRhIHdpbGwgYmUgb3ZlcndyaXR0ZW4sIHNvIHBsZWFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zaWRlciB1c2luZyBpdCBjYXJlZnVsbHkhXHJcbiAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8RGl2aWRlciAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPE1lbnUuSXRlbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydExvY2FsU3RvcmFnZUZyb21GaWxlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJzppbXBvcnRMb2NhbFN0b3JhZ2VGcm9tRmlsZScsICdPSycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBJbXBvcnRcclxuICAgICAgICAgICAgICAgICAgICAgIDwvTWVudS5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPE1lbnUuSXRlbSBvbkNsaWNrPXsoKSA9PiBleHBvcnRMb2NhbFN0b3JhZ2VUb0pTT04oKX0+RXhwb3J0PC9NZW51Lkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9NZW51LkRyb3Bkb3duPlxyXG4gICAgICAgICAgICAgICAgICA8L01lbnU+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj4gKi99XHJcbiAgICAgICAgICAgICAgICB7LyogPENoZWNrYm94XHJcbiAgICAgICAgICAgICAgICAgIHNpemU9eyd4cyd9XHJcbiAgICAgICAgICAgICAgICAgIGxhYmVsPVwiaGlnaCBjb250cmFzdFwiXHJcbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEhpZ2hDb250cmFzdChlLnRhcmdldC5jaGVja2VkID8gJzEnIDogJzAnKTtcclxuICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgY2hlY2tlZD17aGlnaENvbnRyYXN0ID09PSAnMSd9XHJcbiAgICAgICAgICAgICAgICAvPiAqL31cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9OYXZiYXIuU2VjdGlvbj5cclxuICAgICAgICAgIDwvTmF2YmFyPlxyXG4gICAgICAgIH1cclxuICAgICAgICBoZWFkZXI9e1xyXG4gICAgICAgICAgPEhlYWRlciBoZWlnaHQ9e3sgYmFzZTogMzMgfX0gcD1cIm1kXCI+XHJcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3sgZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgaGVpZ2h0OiAnMTAwJScgfX0+XHJcbiAgICAgICAgICAgICAgPE1lZGlhUXVlcnkgbGFyZ2VyVGhhbj1cIm1kXCIgc3R5bGVzPXt7IGRpc3BsYXk6ICdub25lJyB9fT5cclxuICAgICAgICAgICAgICAgIDxCdXJnZXJcclxuICAgICAgICAgICAgICAgICAgb3BlbmVkPXtvcGVuZWR9XHJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldE9wZW5lZCgobykgPT4gIW8pfVxyXG4gICAgICAgICAgICAgICAgICBzaXplPVwic21cIlxyXG4gICAgICAgICAgICAgICAgICBjb2xvcj17dGhlbWUuY29sb3JzLmdyYXlbNl19XHJcbiAgICAgICAgICAgICAgICAgIG1yPVwieGxcIlxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICA8L01lZGlhUXVlcnk+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9eydmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlcid9PlxyXG4gICAgICAgICAgICAgICAgPFRleHRcclxuICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICBmb250V2VpZ2h0OiA4MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogMCxcclxuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICd3aGl0ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0dGVyU3BhY2luZzogMC4xLFxyXG4gICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICB7bG9nb1RleHR9XHJcbiAgICAgICAgICAgICAgICA8L1RleHQ+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Jy1tbC0yIC1tYi0yJ30+ey8qPFR5cGluZ0JsaW5rQ3Vyc29yIC8+Ki99PC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9IZWFkZXI+XHJcbiAgICAgICAgfVxyXG4gICAgICA+XHJcbiAgICAgICAge2NoaWxkcmVufVxyXG4gICAgICA8L0FwcFNoZWxsPlxyXG4gICAgICA8aW5wdXQgaWQ9XCJpbXBvcnRfY29uZmlnX2lucHV0XCIgdHlwZT1cImZpbGVcIiBhY2NlcHQ9XCJhcHBsaWNhdGlvbi9qc29uXCIgY2xhc3NOYW1lPXsnaGlkZGVuJ30gLz5cclxuICAgIDwvPlxyXG4gICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNYWluTGF5b3V0O1xyXG4iXSwibmFtZXMiOlsiQWN0aW9uSWNvbiIsIkFwcFNoZWxsIiwiQmFkZ2UiLCJCdXJnZXIiLCJCdXR0b24iLCJEaXZpZGVyIiwiR3JvdXAiLCJIZWFkZXIiLCJNZWRpYVF1ZXJ5IiwiTmF2YmFyIiwiU2Nyb2xsQXJlYSIsIlRleHQiLCJVbnN0eWxlZEJ1dHRvbiIsInJlbSIsInVzZU1hbnRpbmVUaGVtZSIsInVzZUhvdGtleXMiLCJ1c2VTaGFsbG93RWZmZWN0IiwidXNlVmlld3BvcnRTaXplIiwiTm90aWZpY2F0aW9ucyIsIm5vdGlmaWNhdGlvbnMiLCJJY29uQXJyb3dEb3duIiwiSWNvbkFycm93VXAiLCJJY29uQXJyb3dzTWF4aW1pemUiLCJJY29uQ2lyY2xlQ2hlY2tGaWxsZWQiLCJJY29uRWRpdCIsIkljb25NZXNzYWdlIiwiSWNvblBsdXMiLCJJY29uVHJhc2giLCJjbGFzc05hbWVzIiwiZGlzYWJsZSIsImRpc2FibGVEYXJrTW9kZSIsImVuYWJsZSIsImVuYWJsZURhcmtNb2RlIiwiZmluZCIsIm1hcCIsInJhbmdlIiwiUmVhY3QiLCJ1c2VFZmZlY3QiLCJ1c2VNZW1vIiwidXNlUmVmIiwidXNlU3RhdGUiLCJpc01vYmlsZSIsInVzZURlYm91bmNlIiwidXNlTG9jYWxTdG9yYWdlIiwidXNlTW91bnQiLCJGdW5ueUVtb2ppIiwidXNlU3R5bGVzIiwiYXBwTmFtZSIsInVzZUFkZENvbGxlY3Rpb25BY3Rpb24iLCJ1c2VDb2xsZWN0aW9ucyIsInVzZUN1cnJlbnRDb2xsZWN0aW9uIiwidXNlQ3VycmVudENvbGxlY3Rpb25Eb3duSWQiLCJ1c2VDdXJyZW50Q29sbGVjdGlvbkVkaXRJZCIsInVzZUN1cnJlbnRDb2xsZWN0aW9uUmVtb3ZlSWQiLCJ1c2VDdXJyZW50Q29sbGVjdGlvblVwSWQiLCJ1c2VDdXJyZW50VG9vbCIsInVzZUxhc3RNZXNzYWdlQnlDb2xsZWN0aW9uIiwidXNlU3ViQ29sbGVjdGlvbklkIiwic3RvcmUiLCJtZXNzYWdlc0tleSIsImxpbmtzIiwiaWNvbiIsImxhYmVsIiwia2V5IiwiY2FuQWRkQ29sbGVjdGlvbnMiLCJjb2xsZWN0aW9uc0xhYmVsIiwiTWFpbkxheW91dCIsImNoaWxkcmVuIiwiY2xhc3NlcyIsImNvbGxlY3Rpb25zIiwiZ2xvYmFsQ3VycmVudFRvb2wiLCJzZXRHbG9iYWxDdXJyZW50VG9vbCIsImN1cnJlbnRUb29sIiwic2V0Q3VycmVudFRvb2wiLCJjdXJyZW50TGluayIsInYiLCJhZGRBY3Rpb24iLCJjdXJyZW50Q29sbGVjdGlvbiIsInNldEN1cnJlbnRDb2xsZWN0aW9uIiwic2V0Q29sbGVjdGlvbkVkaXRJZCIsInNldENvbGxlY3Rpb25SZW1vdmVJZCIsInNldENvbGxlY3Rpb25VcElkIiwic2V0Q29sbGVjdGlvbkRvd25JZCIsInRoZW1lIiwib3BlbmVkIiwic2V0T3BlbmVkIiwiaGlnaENvbnRyYXN0Iiwic2V0SGlnaENvbnRyYXN0IiwibG9nb1RleHQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2V0U3ViQ29sbGVjdGlvbklkIiwibGFzdE1lc3NhZ2VCeUNvbGxlY3Rpb24iLCJzZXRMYXN0TWVzc2FnZUJ5Q29sbGVjdGlvbiIsInZpZXdwb3J0IiwicmVuZGVyS2V5Iiwic2V0UmVuZGVyS2V5IiwiRGF0ZSIsIm5vdyIsInZpZXdwb3J0UmVmIiwid2lkdGgiLCJoZWlnaHQiLCJob3RrZXlTd2l0Y2hDb2xsZWN0aW9uIiwiaW5kZXgiLCJsZW5ndGgiLCJpIiwiZGJDdXJyZW50Q29sbGVjdGlvbiIsInRlbXBDb2xsZWN0aW9uIiwidG9TdHJpbmciLCJ1bmRlZmluZWQiLCJzZXRJdGVtIiwic2Vzc2lvblN0b3JhZ2UiLCJyZW1vdmVJdGVtIiwic2hvdyIsInRpdGxlIiwibWVzc2FnZSIsInJhZGl1cyIsIndpdGhDbG9zZUJ1dHRvbiIsImNvbG9yIiwic2VwaWEiLCJjb2xsZWN0aW9uIiwiZG9jdW1lbnQiLCJlbW9qaSIsIk9iamVjdCIsImtleXMiLCJyZXN1bHQiLCJQcm9taXNlIiwiYWxsIiwibWVzc2FnZXMiLCJzb3VyY2UiLCJjb250ZW50IiwidGhlbiIsImN1cnJlbnQiLCJtYWluTGlua3MiLCJsaW5rIiwiY2xhc3NOYW1lIiwibWFpbkxpbmsiLCJvbkNsaWNrIiwibWFpbkxpbmtJbm5lciIsInNpemUiLCJtYWluTGlua0ljb24iLCJzdHJva2UiLCJzcGFuIiwidmFyaWFudCIsIm1haW5MaW5rQmFkZ2UiLCJjb2xsZWN0aW9uTGlua3MiLCJkaXYiLCJjb2xsZWN0aW9uTGluayIsInNlbGVjdGVkQ29sbGVjdGlvbkxpbmsiLCJzdHlsZSIsIm1hcmdpblJpZ2h0IiwiZm9udFNpemUiLCJiYWNrZ3JvdW5kIiwiZW1vamlUeXBlIiwiZGVzY3JpcHRpb24iLCJsaW5lSGVpZ2h0IiwibGlzdEFjdGlvbnMiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwib3JpZW50YXRpb24iLCJyZW5kZXJlZFNjcm9sbENvbnRlbnQiLCJjb2xsZWN0aW9uc0hlYWRlciIsInBvc2l0aW9uIiwid2VpZ2h0IiwiZnVsbFdpZHRoIiwibGVmdEljb24iLCJwYWRkaW5nIiwicGwiLCJwciIsIm5hdmJhciIsImhpZGRlbiIsInNtIiwicCIsIlNlY3Rpb24iLCJzZWN0aW9uIiwiZ3JvdyIsImNvbXBvbmVudCIsImhlYWRlciIsImJhc2UiLCJkaXNwbGF5IiwiYWxpZ25JdGVtcyIsImxhcmdlclRoYW4iLCJzdHlsZXMiLCJvIiwiY29sb3JzIiwiZ3JheSIsIm1yIiwiZm9udFdlaWdodCIsImxldHRlclNwYWNpbmciLCJpbnB1dCIsImlkIiwidHlwZSIsImFjY2VwdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/components/layouts/MainLayout/MainLayout.tsx\n"));

/***/ }),

/***/ "./src/components/pages/MainPage/MainPage.style.tsx":
/*!**********************************************************!*\
  !*** ./src/components/pages/MainPage/MainPage.style.tsx ***!
  \**********************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"useStyles\": function() { return /* binding */ useStyles; }\n/* harmony export */ });\n/* harmony import */ var _mantine_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @mantine/core */ \"./node_modules/@mantine/core/esm/index.js\");\n\nconst useStyles = (0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.createStyles)((theme)=>({\n        navbar: {\n            paddingTop: 0,\n            zIndex: 1\n        },\n        section: {\n            // 'marginLeft': `calc(${theme.spacing.md} * -1)`,\n            // 'marginRight': `calc(${theme.spacing.md} * -1)`,\n            \"marginBottom\": theme.spacing.md,\n            \"&:not(:last-of-type)\": {\n                borderBottom: \"\".concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(1), \" solid \").concat(theme.colorScheme === \"dark\" ? theme.colors.dark[4] : theme.colors.gray[3])\n            }\n        },\n        searchCode: {\n            fontWeight: 700,\n            fontSize: (0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(10),\n            backgroundColor: theme.colorScheme === \"dark\" ? theme.colors.dark[7] : theme.colors.gray[0],\n            border: \"\".concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(1), \" solid \").concat(theme.colorScheme === \"dark\" ? theme.colors.dark[7] : theme.colors.gray[2])\n        },\n        mainLinks: {\n            paddingLeft: \"calc(\".concat(theme.spacing.md, \" - \").concat(theme.spacing.xs, \")\"),\n            paddingRight: \"calc(\".concat(theme.spacing.md, \" - \").concat(theme.spacing.xs, \")\"),\n            paddingBottom: theme.spacing.md\n        },\n        mainLink: {\n            \"display\": \"flex\",\n            \"alignItems\": \"center\",\n            \"width\": \"100%\",\n            \"fontSize\": theme.fontSizes.sm,\n            \"padding\": \"\".concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(1), \" \").concat(theme.spacing.xs),\n            \"borderRadius\": theme.radius.sm,\n            \"fontWeight\": 500,\n            \"color\": theme.colorScheme === \"dark\" ? theme.colors.dark[0] : theme.colors.gray[7],\n            \"&:hover\": {\n                backgroundColor: theme.colorScheme === \"dark\" ? theme.colors.dark[6] : theme.colors.gray[0],\n                color: theme.colorScheme === \"dark\" ? theme.white : theme.black\n            }\n        },\n        mainLinkInner: {\n            display: \"flex\",\n            alignItems: \"center\",\n            flex: 1\n        },\n        mainLinkIcon: {\n            marginRight: theme.spacing.sm\n        },\n        mainLinkBadge: {\n            padding: 0,\n            width: (0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(20),\n            height: (0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(20),\n            pointerEvents: \"none\"\n        },\n        collections: {\n            paddingLeft: \"calc(\".concat(theme.spacing.md, \" - \").concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(6), \")\"),\n            paddingRight: \"calc(\".concat(theme.spacing.md, \" - \").concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(6), \")\"),\n            paddingBottom: theme.spacing.md\n        },\n        collectionsHeader: {\n            paddingLeft: \"calc(\".concat(theme.spacing.md, \" + \").concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(2), \")\"),\n            paddingRight: theme.spacing.md,\n            marginBottom: (0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(5)\n        },\n        selectedCollectionLink: {\n            background: theme.colorScheme === \"dark\" ? theme.colors.dark[6] : theme.colors.gray[0],\n            border: \"1px solid rgba(255,255,255,0.1) !important\"\n        },\n        collectionLink: {\n            \"display\": \"block\",\n            \"padding\": \"\".concat((0,_mantine_core__WEBPACK_IMPORTED_MODULE_0__.rem)(1), \" \").concat(theme.spacing.xs),\n            \"textDecoration\": \"none\",\n            \"borderRadius\": theme.radius.sm,\n            \"fontSize\": theme.fontSizes.sm,\n            \"border\": \"1px solid transparent\",\n            // lineHeight: 1,\n            // fontWeight: 500,\n            \"cursor\": \"pointer\",\n            \".collection-action\": {\n                opacity: 0,\n                pointerEvents: \"none\"\n            },\n            \"&:hover\": {\n                \"backgroundColor\": theme.colorScheme === \"dark\" ? theme.colors.dark[6] : theme.colors.gray[0],\n                \".collection-action\": {\n                    opacity: 1,\n                    pointerEvents: \"auto\"\n                },\n                \"border\": \"1px solid rgba(255,255,255,0.1)\"\n            },\n            \".collection-action-disabled\": {\n                opacity: \"0!important\",\n                pointerEvents: \"none!important\"\n            }\n        },\n        listActions: {\n            background: theme.colorScheme === \"dark\" ? theme.colors.dark[6] : theme.colors.gray[0],\n            border: \"1px solid #373A40\"\n        }\n    }));\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports on update so we can compare the boundary\n                // signatures.\n                module.hot.dispose(function (data) {\n                    data.prevExports = currentExports;\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevExports !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevExports !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9wYWdlcy9NYWluUGFnZS9NYWluUGFnZS5zdHlsZS50c3guanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBa0Q7QUFFM0MsTUFBTUUsWUFBWUYsMkRBQVlBLENBQUMsQ0FBQ0csUUFBVztRQUNoREMsUUFBUTtZQUNOQyxZQUFZO1lBQ1pDLFFBQVE7UUFDVjtRQUVBQyxTQUFTO1lBQ1Asa0RBQWtEO1lBQ2xELG1EQUFtRDtZQUNuRCxnQkFBZ0JKLE1BQU1LLE9BQU8sQ0FBQ0MsRUFBRTtZQUVoQyx3QkFBd0I7Z0JBQ3RCQyxjQUFjLEdBQW1CUCxPQUFoQkYsa0RBQUdBLENBQUMsSUFBRyxXQUFvRixPQUEzRUUsTUFBTVEsV0FBVyxLQUFLLFNBQVNSLE1BQU1TLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLEVBQUUsR0FBR1YsTUFBTVMsTUFBTSxDQUFDRSxJQUFJLENBQUMsRUFBRTtZQUM3RztRQUNGO1FBRUFDLFlBQVk7WUFDVkMsWUFBWTtZQUNaQyxVQUFVaEIsa0RBQUdBLENBQUM7WUFDZGlCLGlCQUFpQmYsTUFBTVEsV0FBVyxLQUFLLFNBQVNSLE1BQU1TLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLEVBQUUsR0FBR1YsTUFBTVMsTUFBTSxDQUFDRSxJQUFJLENBQUMsRUFBRTtZQUMzRkssUUFBUSxHQUFtQmhCLE9BQWhCRixrREFBR0EsQ0FBQyxJQUFHLFdBQW9GLE9BQTNFRSxNQUFNUSxXQUFXLEtBQUssU0FBU1IsTUFBTVMsTUFBTSxDQUFDQyxJQUFJLENBQUMsRUFBRSxHQUFHVixNQUFNUyxNQUFNLENBQUNFLElBQUksQ0FBQyxFQUFFO1FBQ3ZHO1FBRUFNLFdBQVc7WUFDVEMsYUFBYSxRQUE4QmxCLE9BQXRCQSxNQUFNSyxPQUFPLENBQUNDLEVBQUUsRUFBQyxPQUFzQixPQUFqQk4sTUFBTUssT0FBTyxDQUFDYyxFQUFFLEVBQUM7WUFDNURDLGNBQWMsUUFBOEJwQixPQUF0QkEsTUFBTUssT0FBTyxDQUFDQyxFQUFFLEVBQUMsT0FBc0IsT0FB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QVEsYUFBYTtZQUNYSCxZQUFZNUMsTUFBTVEsV0FBVyxLQUFLLFNBQVNSLE1BQU1TLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLEVBQUUsR0FBR1YsTUFBTVMsTUFBTSxDQUFDRSxJQUFJLENBQUMsRUFBRTtZQUN0RkssUUFBUTtRQUNWO0lBQ0YsSUFBSSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvY29tcG9uZW50cy9wYWdlcy9NYWluUGFnZS9NYWluUGFnZS5zdHlsZS50c3g/NmJiNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTdHlsZXMsIHJlbSB9IGZyb20gJ0BtYW50aW5lL2NvcmUnO1xyXG5cclxuZXhwb3J0IGNvbnN0IHVzZVN0eWxlcyA9IGNyZWF0ZVN0eWxlcygodGhlbWUpID0+ICh7XHJcbiAgbmF2YmFyOiB7XHJcbiAgICBwYWRkaW5nVG9wOiAwLFxyXG4gICAgekluZGV4OiAxLFxyXG4gIH0sXHJcblxyXG4gIHNlY3Rpb246IHtcclxuICAgIC8vICdtYXJnaW5MZWZ0JzogYGNhbGMoJHt0aGVtZS5zcGFjaW5nLm1kfSAqIC0xKWAsXHJcbiAgICAvLyAnbWFyZ2luUmlnaHQnOiBgY2FsYygke3RoZW1lLnNwYWNpbmcubWR9ICogLTEpYCxcclxuICAgICdtYXJnaW5Cb3R0b20nOiB0aGVtZS5zcGFjaW5nLm1kLFxyXG5cclxuICAgICcmOm5vdCg6bGFzdC1vZi10eXBlKSc6IHtcclxuICAgICAgYm9yZGVyQm90dG9tOiBgJHtyZW0oMSl9IHNvbGlkICR7dGhlbWUuY29sb3JTY2hlbWUgPT09ICdkYXJrJyA/IHRoZW1lLmNvbG9ycy5kYXJrWzRdIDogdGhlbWUuY29sb3JzLmdyYXlbM119YCxcclxuICAgIH0sXHJcbiAgfSxcclxuXHJcbiAgc2VhcmNoQ29kZToge1xyXG4gICAgZm9udFdlaWdodDogNzAwLFxyXG4gICAgZm9udFNpemU6IHJlbSgxMCksXHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLmNvbG9yU2NoZW1lID09PSAnZGFyaycgPyB0aGVtZS5jb2xvcnMuZGFya1s3XSA6IHRoZW1lLmNvbG9ycy5ncmF5WzBdLFxyXG4gICAgYm9yZGVyOiBgJHtyZW0oMSl9IHNvbGlkICR7dGhlbWUuY29sb3JTY2hlbWUgPT09ICdkYXJrJyA/IHRoZW1lLmNvbG9ycy5kYXJrWzddIDogdGhlbWUuY29sb3JzLmdyYXlbMl19YCxcclxuICB9LFxyXG5cclxuICBtYWluTGlua3M6IHtcclxuICAgIHBhZGRpbmdMZWZ0OiBgY2FsYygke3RoZW1lLnNwYWNpbmcubWR9IC0gJHt0aGVtZS5zcGFjaW5nLnhzfSlgLFxyXG4gICAgcGFkZGluZ1JpZ2h0OiBgY2FsYygke3RoZW1lLnNwYWNpbmcubWR9IC0gJHt0aGVtZS5zcGFjaW5nLnhzfSlgLFxyXG4gICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZy5tZCxcclxuICB9LFxyXG5cclxuICBtYWluTGluazoge1xyXG4gICAgJ2Rpc3BsYXknOiAnZmxleCcsXHJcbiAgICAnYWxpZ25JdGVtcyc6ICdjZW50ZXInLFxyXG4gICAgJ3dpZHRoJzogJzEwMCUnLFxyXG4gICAgJ2ZvbnRTaXplJzogdGhlbWUuZm9udFNpemVzLnNtLFxyXG4gICAgJ3BhZGRpbmcnOiBgJHtyZW0oMSl9ICR7dGhlbWUuc3BhY2luZy54c31gLFxyXG4gICAgJ2JvcmRlclJhZGl1cyc6IHRoZW1lLnJhZGl1cy5zbSxcclxuICAgICdmb250V2VpZ2h0JzogNTAwLFxyXG4gICAgJ2NvbG9yJzogdGhlbWUuY29sb3JTY2hlbWUgPT09ICdkYXJrJyA/IHRoZW1lLmNvbG9ycy5kYXJrWzBdIDogdGhlbWUuY29sb3JzLmdyYXlbN10sXHJcblxyXG4gICAgJyY6aG92ZXInOiB7XHJcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUuY29sb3JTY2hlbWUgPT09ICdkYXJrJyA/IHRoZW1lLmNvbG9ycy5kYXJrWzZdIDogdGhlbWUuY29sb3JzLmdyYXlbMF0sXHJcbiAgICAgIGNvbG9yOiB0aGVtZS5jb2xvclNjaGVtZSA9PT0gJ2RhcmsnID8gdGhlbWUud2hpdGUgOiB0aGVtZS5ibGFjayxcclxuICAgIH0sXHJcbiAgfSxcclxuXHJcbiAgbWFpbkxpbmtJbm5lcjoge1xyXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxyXG4gICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXHJcbiAgICBmbGV4OiAxLFxyXG4gIH0sXHJcblxyXG4gIG1haW5MaW5rSWNvbjoge1xyXG4gICAgbWFyZ2luUmlnaHQ6IHRoZW1lLnNwYWNpbmcuc20sXHJcbiAgICAvLyBjb2xvcjogdGhlbWUuY29sb3JTY2hlbWUgPT09IFwiZGFya1wiID8gdGhlbWUuY29sb3JzLmRhcmtbMl0gOiB0aGVtZS5jb2xvcnMuZ3JheVs2XSxcclxuICB9LFxyXG5cclxuICBtYWluTGlua0JhZGdlOiB7XHJcbiAgICBwYWRkaW5nOiAwLFxyXG4gICAgd2lkdGg6IHJlbSgyMCksXHJcbiAgICBoZWlnaHQ6IHJlbSgyMCksXHJcbiAgICBwb2ludGVyRXZlbnRzOiAnbm9uZScsXHJcbiAgfSxcclxuXHJcbiAgY29sbGVjdGlvbnM6IHtcclxuICAgIHBhZGRpbmdMZWZ0OiBgY2FsYygke3RoZW1lLnNwYWNpbmcubWR9IC0gJHtyZW0oNil9KWAsXHJcbiAgICBwYWRkaW5nUmlnaHQ6IGBjYWxjKCR7dGhlbWUuc3BhY2luZy5tZH0gLSAke3JlbSg2KX0pYCxcclxuICAgIHBhZGRpbmdCb3R0b206IHRoZW1lLnNwYWNpbmcubWQsXHJcbiAgfSxcclxuXHJcbiAgY29sbGVjdGlvbnNIZWFkZXI6IHtcclxuICAgIHBhZGRpbmdMZWZ0OiBgY2FsYygke3RoZW1lLnNwYWNpbmcubWR9ICsgJHtyZW0oMil9KWAsXHJcbiAgICBwYWRkaW5nUmlnaHQ6IHRoZW1lLnNwYWNpbmcubWQsXHJcbiAgICBtYXJnaW5Cb3R0b206IHJlbSg1KSxcclxuICB9LFxyXG5cclxuICBzZWxlY3RlZENvbGxlY3Rpb25MaW5rOiB7XHJcbiAgICBiYWNrZ3JvdW5kOiB0aGVtZS5jb2xvclNjaGVtZSA9PT0gJ2RhcmsnID8gdGhlbWUuY29sb3JzLmRhcmtbNl0gOiB0aGVtZS5jb2xvcnMuZ3JheVswXSxcclxuICAgIGJvcmRlcjogJzFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMSkgIWltcG9ydGFudCcsXHJcbiAgfSxcclxuXHJcbiAgY29sbGVjdGlvbkxpbms6IHtcclxuICAgICdkaXNwbGF5JzogJ2Jsb2NrJyxcclxuICAgICdwYWRkaW5nJzogYCR7cmVtKDEpfSAke3RoZW1lLnNwYWNpbmcueHN9YCxcclxuICAgICd0ZXh0RGVjb3JhdGlvbic6ICdub25lJyxcclxuICAgICdib3JkZXJSYWRpdXMnOiB0aGVtZS5yYWRpdXMuc20sXHJcbiAgICAnZm9udFNpemUnOiB0aGVtZS5mb250U2l6ZXMuc20sXHJcbiAgICAnYm9yZGVyJzogJzFweCBzb2xpZCB0cmFuc3BhcmVudCcsXHJcbiAgICAvLyBsaW5lSGVpZ2h0OiAxLFxyXG4gICAgLy8gZm9udFdlaWdodDogNTAwLFxyXG4gICAgJ2N1cnNvcic6ICdwb2ludGVyJyxcclxuICAgICcuY29sbGVjdGlvbi1hY3Rpb24nOiB7XHJcbiAgICAgIG9wYWNpdHk6IDAsXHJcbiAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcclxuICAgIH0sXHJcbiAgICAnJjpob3Zlcic6IHtcclxuICAgICAgJ2JhY2tncm91bmRDb2xvcic6IHRoZW1lLmNvbG9yU2NoZW1lID09PSAnZGFyaycgPyB0aGVtZS5jb2xvcnMuZGFya1s2XSA6IHRoZW1lLmNvbG9ycy5ncmF5WzBdLFxyXG4gICAgICAnLmNvbGxlY3Rpb24tYWN0aW9uJzoge1xyXG4gICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgcG9pbnRlckV2ZW50czogJ2F1dG8nLFxyXG4gICAgICB9LFxyXG4gICAgICAnYm9yZGVyJzogJzFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMSknLFxyXG4gICAgfSxcclxuICAgICcuY29sbGVjdGlvbi1hY3Rpb24tZGlzYWJsZWQnOiB7XHJcbiAgICAgIG9wYWNpdHk6ICcwIWltcG9ydGFudCcgYXMgYW55LFxyXG4gICAgICBwb2ludGVyRXZlbnRzOiAnbm9uZSFpbXBvcnRhbnQnIGFzIGFueSxcclxuICAgIH0sXHJcbiAgfSxcclxuICBsaXN0QWN0aW9uczoge1xyXG4gICAgYmFja2dyb3VuZDogdGhlbWUuY29sb3JTY2hlbWUgPT09ICdkYXJrJyA/IHRoZW1lLmNvbG9ycy5kYXJrWzZdIDogdGhlbWUuY29sb3JzLmdyYXlbMF0sXHJcbiAgICBib3JkZXI6ICcxcHggc29saWQgIzM3M0E0MCcsXHJcbiAgfSxcclxufSkpO1xyXG4iXSwibmFtZXMiOlsiY3JlYXRlU3R5bGVzIiwicmVtIiwidXNlU3R5bGVzIiwidGhlbWUiLCJuYXZiYXIiLCJwYWRkaW5nVG9wIiwiekluZGV4Iiwic2VjdGlvbiIsInNwYWNpbmciLCJtZCIsImJvcmRlckJvdHRvbSIsImNvbG9yU2NoZW1lIiwiY29sb3JzIiwiZGFyayIsImdyYXkiLCJzZWFyY2hDb2RlIiwiZm9udFdlaWdodCIsImZvbnRTaXplIiwiYmFja2dyb3VuZENvbG9yIiwiYm9yZGVyIiwibWFpbkxpbmtzIiwicGFkZGluZ0xlZnQiLCJ4cyIsInBhZGRpbmdSaWdodCIsInBhZGRpbmdCb3R0b20iLCJtYWluTGluayIsImZvbnRTaXplcyIsInNtIiwicmFkaXVzIiwiY29sb3IiLCJ3aGl0ZSIsImJsYWNrIiwibWFpbkxpbmtJbm5lciIsImRpc3BsYXkiLCJhbGlnbkl0ZW1zIiwiZmxleCIsIm1haW5MaW5rSWNvbiIsIm1hcmdpblJpZ2h0IiwibWFpbkxpbmtCYWRnZSIsInBhZGRpbmciLCJ3aWR0aCIsImhlaWdodCIsInBvaW50ZXJFdmVudHMiLCJjb2xsZWN0aW9ucyIsImNvbGxlY3Rpb25zSGVhZGVyIiwibWFyZ2luQm90dG9tIiwic2VsZWN0ZWRDb2xsZWN0aW9uTGluayIsImJhY2tncm91bmQiLCJjb2xsZWN0aW9uTGluayIsIm9wYWNpdHkiLCJsaXN0QWN0aW9ucyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/components/pages/MainPage/MainPage.style.tsx\n"));

/***/ })

}]);